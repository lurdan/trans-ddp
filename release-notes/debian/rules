#!/usr/bin/make -f
# rules file for release-notes

package		:= release-notes

# directory abstraction
prefix		:= debian/$(package)
docdir		:= $(prefix)/usr/share/doc/$(package)
docbaserel	:= /usr/share/doc-base
docbasedir	:= $(prefix)$(docbaserel)

# tool abstraction
install_file	:= install -o root -g root -m 644 -p
install_script	:= install -o root -g root -m 755 -p
make_directory	:= install -d -o root -g root -m 755

# version abstraction
DEB_VERSION	:= $(shell awk -F '[()]' '/^$(package)/{ print $$2; exit }' debian/changelog)
DEB_DATE	:= $(shell dpkg-parsechangelog 2>/dev/null | sed -n 's/^Date: *//p')
# pretty-print the date; I wish this was dynamic like the top-level makefile but oh well
PUBDATE		:= $(shell LC_ALL=C date --date="$(DEB_DATE)" -I)

# debhelper verbose mode
#export DH_VERBOSE=1

build:
	$(MAKE)
	touch build

.PHONY: clean
clean:
	$(MAKE) clean
	rm -f build
	dh_clean

.PHONY: test
test:
#	 nothing to test ATM

.PHONY: install
install:	build
	dh_testroot
	dh_clean -k

# FIXME:
#	dh_installdocs -p$(package) README-contrib \
#	    *.html \
#	    developers-reference.txt \
#	    developers-reference.pdf

.PHONY: binary-indep
binary-indep:	test install
	dh_testroot
	dh_installdirs -i
	dh_installchangelogs -i
	dh_compress -i -X.pdf
	dh_fixperms -i
	dh_installdeb -i
	dh_gencontrol -i
	dh_md5sums -i
	dh_builddeb -i


.PHONY: binary-arch
binary-arch:	build install
#	 There are no architecture-dependent files to be uploaded
#	 generated by this package.

.PHONY: binary
binary:		binary-indep binary-arch
