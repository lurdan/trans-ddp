<!DOCTYPE debiandoc PUBLIC "-//DebianDoc//DTD DebianDoc//EN" [

        <!-- textual data entities -->
        <!-- first definition wins in SGML -->
<!ENTITY % default  SYSTEM "default.ent">  %default;

]>
<!-- CVS revision of this document "$Revision: 1.22 $"  -->
<!-- CVS revision of original english document "1.115"  -->

<debiandoc>

 <book>

  <titlepag>

   <title>Podrêcznik dla nowych opiekunów pakietów Debiana</title>

   <author>Josip Rodin <email/joy-mg@debian.org/
   </author>
   <author>polskie t³umaczenie: Pawe³ Têcza <email/ptecza@debianusers.pl/
   </author>
   <author>korekta t³umaczenia: Marcin Owsiany <email/porridge@debian.org/
   </author>
   <author>wznowienie t³umaczenia: Wojciech Zarêba <email/wojtekz@comp.waw.pl/
   </author>

   <version>wersja orygina³u: 1.2.11, 12-01-2007, wersja t³umaczenia: 1.2.5,
   27-09-2007</version>

   <copyright>
   <copyrightsummary>Copyright &copy; 1998-2002 Josip Rodin.</copyrightsummary>
   <copyrightsummary>Copyright &copy; 2005-2007 Osamu Aoki.</copyrightsummary>
   <copyrightsummary>Copyright &copy; polskiego t³umaczenia 2002-2004
   Pawe³ Têcza, Marcin Owsiany.</copyrightsummary>
   <copyrightsummary>Copyright &copy; polskiego t³umaczenia 2007
   Wojciech Zarêba.</copyrightsummary>

   <p>Ten dokument mo¿e byæ u¿ywany zgodnie z zasadami licencji GNU GPL (General
   Public License) w wersji 2 lub wy¿szej.

   <p>Do stworzenia tego dokumentu wykorzystano, jako przyk³ady, nastêpuj±ce
   dokumenty:

   <p>Making a Debian Package (znany jako Debmake Manual), copyright &copy; 1997
   Jaldhar Vyas.

   <p>The New-Maintainer's Debian Packaging Howto, copyright &copy; 1997
   Will Lowe.
   </copyright>

  </titlepag>

  <toc sect>

  <!-- -------------------------------------------------------------------------->

  <chapt id="start">Rozpoczêcie, jak siê nale¿y

  <p>Ten dokument próbuje opisaæ proces budowania pakietów systemu Debian.
  Jest on przeznaczony dla zwyk³ych u¿ytkowników Debiana i tych, którzy chc±
  zostaæ deweloperami. U¿ywa zwyk³ego jêzyka i daje du¿o dzia³aj±cych przyk³adów.
  Stare rzymskie przys³owie mówi <em>Longum iter est per preaecepta,
  breve et efficax per exempla</em> (D³uga jest droga przez nakazy,
  krótka i skuteczna przez przyk³ady).
  
  <p>Jedn± z rzeczy sprawiaj±cych, ¿e Debian jest wyj±tkow± dystrybucj± Linuksa,
  jest jego system pakietów. Mimo ¿e istnieje ogromna ilo¶æ oprogramowania ju¿
  spakowanego do formatu Debiana, to czasami zachodzi konieczno¶æ
  zainstalowania programu, który nie posiada swojej paczki. Pewnie siê dziwisz,
  ¿e mo¿esz sam zbudowaæ w³asne pakiety i my¶lisz, ¿e to bardzo trudne zadanie.
  No có¿, je¶li jeste¶ zupe³nym nowicjuszem w Linuksie, to rzeczywi¶cie bêdziesz
  mia³ k³opoty, ale czy gdyby¶ by³ ¿ó³todziobem, to czyta³by¶ teraz ten
  dokument? :-) Musisz trochê wiedzieæ na temat programowania pod Unix'em,
  ale nie musisz od razu byæ ekspertem.

  <p>Jedna rzecz jest pewna: aby odpowiednio tworzyæ i zarz±dzaæ pakietami
  Debiana konieczne s± osobogodziny. Staraj siê nie pope³niaæ b³êdów,
  gdy¿ nasz system, aby dzia³aæ, wymaga od opiekunów zarówno kompetencji
  technicznych jak i rzetelno¶ci.
  
  <p>Ten dokument wyja¶ni wszystkie kroki potrzebne do zbudowania pakietu
  (choæ niektóre z nich mog± na pocz±tku wydaæ siê nieistotne) i pomo¿e Ci
  stworzyæ Twój pierwszy pakiet. Dziêki niemu nabierzesz trochê do¶wiadczenia,
  które przyda Ci siê w trakcie budowania nastêpnych wydañ pakietu, a pó¼niej mo¿e
  równie¿ do tworzenia innych paczek.

  <p>Najnowsza wersja tego dokumentu powinna byæ zawsze dostêpna bezpo¶rednio
  na stronie <url name="http://www.debian.org/doc/maint-guide/"
  id="http://www.debian.org/doc/maint-guide"> oraz w pakiecie
  `<package>maint-guide</package>'. Polskie t³umaczenie jest równie¿ dostêpne
  w pakiecie `<package>maint-guide-pl</package>'.

  <sect id="needprogs">Programy, których potrzebujesz do dewelopmentu

  <p>Zanim zaczniesz cokolwiek robiæ, powiniene¶ upewniæ siê, ¿e masz
  zainstalowanych kilka dodatkowych pakietów niezbêdnych do dewelopmentu.
  Zwróæ uwagê, ¿e na poni¿szej li¶cie nie ma ¿adnych pakietów oznaczonych
  jako `niezbêdne' (essential) lub `wymagane' (required). Po prostu
  zak³adamy, ¿e masz ju¿ je zainstalowane.
  
  <p>Ta wersja podrêcznika zosta³a uaktualniona z my¶l± o pakietach
  wchodz±cych w sk³ad Debiana 2.2 (`potato') oraz 3.0 (`woody').
  
  <p>Nastêpuj±ce pakiety wchodz± w sk³ad standardowej instalacji Debiana,
  wiêc prawdopodobnie masz je (i dodatkowe pakiety, od których one zale¿±)
  ju¿ zainstalowane. Mimo to powiniene¶ sprawdziæ ich status za pomoc±
  polecenia `dpkg -s &lt;pakiet&gt;`.

  <list>
  
  <item><package>dpkg-dev</package> - pakiet zawieraj±cy narzêdzia niezbêdne do
  rozpakowywania, budowania i wysy³ania pakietów ¼ród³owych Debiana
  (wiêcej informacji znajdziesz na stronie podrêcznika <manref name="dpkg-source"
  section="1">).

  <item><package>file</package> - przydatny program do okre¶lania typu pliku
  (zobacz <manref name="file" section="1">).
	  
  <item><package>gcc</package> - kompilator GNU jêzyka C, niezbêdny gdy Twój
  program, tak jak wiêkszo¶æ programów, zosta³ napisany w jêzyku C
  (zobacz <manref name="gcc" section="1">).
  Pakiet ten jest powi±zany z kilkoma innymi pakietami, takimi jak
  <package>binutils</package>, który zawiera zestaw programów s³u¿±cych
  do asemblacji i konsolidacji plików wynikowych (zobacz
  `info binutils` w pakiecie <package>binutils-doc</package>) i
  <package>cpp</package>, zawieraj±cy preprocesor jêzyka C (zobacz
  <manref name="cpp" section="1">).

  <item><package>g++</package> - kompilator GNU jêzyka C++, niezbêdny gdy Twój program
  zosta³ napisany w jêzyku C++ (zobacz <manref name="g++" section="1">).

  <item><package>libc6-dev</package> - biblioteki jêzyka C i pliki nag³ówkowe
  kompilatora gcc niezbêdne do konsolidacji plików wynikowych
  (zobacz `info libc` w pakiecie <package>glibc-doc</package>).

  <item><package>make</package> - na ogó³ proces tworzenia programu sk³ada siê z
  szeregu kroków. Zamiast ci±g³ego powtarzania w kó³ko tych samych komend,
  mo¿esz pos³u¿yæ siê programem, który automatyzuje ca³y proces. Jedyne co
  musisz zrobiæ, to stworzyæ plik(i) `Makefile' (zobacz `info make`).

  <item><package>patch</package> - bardzo u¿yteczne narzêdzie s³u¿±ce do
  tworzenia ³at, czyli utworzonych przez program diff plików z ró¿nicami
  pomiêdzy plikami ¼ród³owymi, i tworzenia w ten sposób "za³atanych" (poprawionych)
  wersji programów (zobacz <manref name="patch" section="1">).

  <item><package>perl</package> - Perl jest jednym z najczê¶ciej stosowanych
  interpretowanych jêzyków skryptowych w systemach kompatybilnych z systemem
  Unix. Czêsto okre¶lany jest jako "Uniksowy scyzoryk z pi³± ³añcuchow±"
  (po angielsku znacznie zabawniej: Unix's Swiss Army Chainsaw) - zobacz
  <manref name="perl" section="1">.
  </list>

  <p>Najprawdopodobniej przydadz± siê równie¿ nastêpuj±ce pakiety:

  <list>
  
  <item><package>autoconf</package> i <package>automake</package> - wiele
  nowszych programów u¿ywa skryptów konfiguracyjnych i plików Makefile
  przetworzonych za pomoc± takich narzêdzi (zobacz `info autoconf`
  i `info automake`).

  <item><package>dh-make</package> i <package>debhelper</package> - pakiet
  dh-make jest niezbêdny do stworzenia szablonu naszego przyk³adowego pakietu.
  U¿ywa on do tworzenia pakietów niektórych narzêdzi z pakietu debhelper.
  Pakiety te nie s± niezbêdne do budowania paczek, ale s± <strong>bardzo</strong>
  zalecane, szczególnie nowym opiekunom. Dziêki nim o wiele ³atwiej rozpocz±æ
  proces budowania pakietu i kontrolowaæ go pó¼niej (zobacz <manref name="dh_make"
  section="1">, <manref name="debhelper" section="1"> i plik
  /usr/share/doc/debhelper/README).

  <item><package>devscripts</package> - pakiet zawieraj±cy parê u¿ytecznych
  i pomocnych dla opiekuna skryptów, które nie s± jednak¿e niezbêdne do budowania
  pakietów (wiêcej informacji znajdziesz w pliku /usr/share/doc/devscripts/README.gz).

  <item><package>fakeroot</package> - narzêdzie, które pozwala "udawaæ" bycie
  administratorem systemu (rootem). Uprawnienia administratora s± niezbêdne
  w niektórych etapach procesu budowania pakietu (zobacz <manref name="fakeroot"
  section="1">).

  <item><package>gnupg</package> - narzêdzie umo¿liwiaj±ce cyfrowe
  <em>podpisanie</em> pakietów. Jest to szczególnie wa¿ne, gdy zamierzasz
  rozpowszechniaæ swój pakiet, a na pewno bêdziesz musia³ to zrobiæ, gdyby Twój
  pakiet mia³ byæ w³±czony do dystrybucji Debiana (zobacz <manref name="gpg"
  section="1">).

  <item><package>g77</package> - kompilator GNU jêzyka Fortran 77,
  niezbêdny gdy Twój program zosta³ napisany w jêzyku Fortran (zobacz
  <manref name="g77" section="1">).

  <item><package>gpc</package> - kompilator GNU jêzyka Pascal, niezbêdny gdy Twój
  program zosta³ napisany w jêzyku Pascal. Warty odnotowania w tym miejscu
  jest równie¿ pakiet <package>fp-compiler</package> (Free Pascal Compiler),
  który tak¿e nadaje siê do tego celu (zobacz <manref name="gpc" section="1">
  i <manref name="ppc386" section="1">).

  <item><package>xutils</package> - niektóre programy, g³ównie dla X11,
  u¿ywaj± tych narzêdzi do wygenerowania plików Makefile z zestawu
  makro-funkcji (zobacz <manref name="imake" section="1">
  i <manref name="xmkmf" section="1">).

  <item><package>lintian</package> - program s³u¿±cy do sprawdzania poprawno¶ci
  pakietów Debiana. Poinformuje Ciê, gdy w zbudowanej paczce znajdzie 
  b³êdy i wyja¶ni ich przyczynê (zobacz <manref name="lintian" section="1">
  oraz /usr/share/doc/lintian/lintian.html/index.html).
  
  <item><package>linda</package> - alternatywny program sprawdzaj±cy pakiety
  (zobacz <manref name="linda" section="1">).

  <item><package>pbuilder</package> - ten pakiet zawiera programy, które
  s± u¿ywane do tworzenia i zarz±dzania ¶rodowiskiem chroot. Budowanie
  pakietów Debiana w tym ¶rodowisku weryfikuje poprawno¶æ zale¿no¶ci
  i zapobiega powstawaniu b³êdów FTBFS (zobacz <manref name="pbuilder"
  section="8"> i <manref name="pdebuild" section="1">).
  
  </list>

  <p>Poni¿ej wymieniamy <em>bardzo wa¿n±</em> dokumentacjê,
  która powinna byæ przeczytana razem z tym podrêcznikiem:

  <list>
  
  <item><package>debian-policy</package> - Polityka Debiana opisuje strukturê
  i zawarto¶æ archiwum Debiana, sprawy dotycz±ce sposobu projektowania systemu
  operacyjnego, FHS (Standard Hierarchii Systemu Plików - Filesystem Hierarchy
  Standard), który mówi, gdzie powinny siê znajdowaæ pliki i katalogi itd.
  Dla Ciebie najwa¿niejszy jest opis wymagañ, które musi spe³niæ ka¿dy pakiet,
  aby móg³ byæ w³±czony do dystrybucji (zobacz &debian-policy;).

  <item><package>developers-reference</package> - opisuje wszystkie zagadnienia
  nie zwi±zane z technicznymi szczegó³ami procesu tworzenia pakietów,
  a wiêc strukturê archiwum, sposób zmian nazw pakietów, procedurê ich
  osierocania i adopcji, umieszczania pakietów w archiwum Debiana, równie¿
  nie bêd±c opiekunem danego pakietu (Non-Maintainer Upload - NMU),
  jak zarz±dzaæ b³êdami, najlepsze praktyki dotycz±ce pakowania,
  kiedy i gdzie umieszczaæ pakiet itd. (zobacz &developers-reference;).
  </list>

  <p>Powy¿sze krótkie opisy s³u¿± jedynie jako wprowadzenie do opisu
  ka¿dego z pakietów. Zanim przejdziesz dalej, prosimy gruntownie zapoznaæ
  siê z dokumentacj± do ka¿dego z programów, a przynajmniej z ich standardowym
  u¿yciem. Byæ mo¿e wydaje Ci siê to teraz trudne, ale pó¼niej bêdziesz
  <em>bardzo</em> zadowolony z przeczytania tej dokumentacji.
  
  <p>Uwaga: pakiet <package>debmake</package> zawiera niektóre programy 
  zbli¿one funkcjonalnie do dh-make, ale ten dokument <strong>nie</strong>
  omawia jego u¿ycia, poniewa¿ jest on <em>przestarza³y</em>.
  
  <sect id="debiandeveloper">Oficjalny Deweloper Debiana

  <p>Po zbudowaniu swojego pierwszego pakietu (albo w czasie budowania)
  byæ mo¿e zechcesz zostaæ oficjalnym Deweloperem Debiana, aby wprowadziæ
  swój pakiet do kolejnej dystrybucji (je¶li program jest u¿yteczny, to
  czemu nie?).
  
  <p>Nie mo¿esz zostaæ oficjalnym Deweloperem Debiana w ci±gu jednej
  nocy, gdy¿ do tego potrzebne jest co¶ wiêcej, ni¿ umiejêtno¶ci
  techniczne. Niech Ciê to jednak nie zniechêca. Mo¿esz wys³aæ swój
  pakiet, je¶li jest u¿yteczny dla innych, jako opiekun sponsorowany
  przez zapisanie siê na
  <url name="stronie Nowych Opiekunów" id="&nm-home;">.
  Sponsor jest oficjalnym Deweloperem Debiana, który pomaga opiekunom
  w³±czaæ pakiety do archiwum Debiana. Wiêcej o procedurze przyjmowania
  nowych opiekunów jest na stronie
  <url id="&mentors-faq;" name="debian-mentors FAQ">.

  <p>Zwracamy uwagê, ¿e nie ma potrzeby tworzenia nowego pakietu, aby
  staæ siê oficjalnym Deweloperem Debiana. Rozwój istniej±cych pakietów
  jest równie¿ drog± mog±c± prowadziæ do zostania oficjalnym Deweloperem.

  <sect id="otherinfo">Inne informacje

  <p>Istniej± dwa rodzaje pakietów, jakie mo¿esz stworzyæ: ¼ród³owe i binarne.
  Pakiet ¼ród³owy zawiera kod, który mo¿esz skompilowaæ, aby otrzymaæ binarn±
  postaæ programu. Pakiet binarny zawiera natomiast ju¿ gotowy do u¿ycia
  program. Prosimy nie myliæ takich pojêæ, jak ¼ród³o programu i pakiet ¼ród³owy!
  Wiêcej szczegó³ów na temat terminologii jest w innych podrêcznikach.

  <p>W Debianie termin `opiekun' (maintainer) oznacza osobê, która tworzy
  pakiety (pakuje programy), `autor' (upstream author) - osobê, która tworzy program,
  a `zewnêtrzny opiekun' (upstream maintainer) - osobê, która aktualnie opiekuje
  siê programem, pozostaj±c poza projektem Debian. Zwykle autor i zewnêtrzny
  opiekun s± t± sam± osob± - czasem nawet t± sam± osob± jest opiekun.
  Je¶li napisa³e¶ jaki¶ program i chcesz, ¿eby wszed³ w sk³ad Debiana,
  przy¶lij swoje zg³oszenie i zostañ opiekunem.
  
  <!-- -------------------------------------------------------------------------->

  <chapt id="first">Pierwsze kroki

  <sect id="choose">Wybierz swój program

  <p>Prawdopodobnie wybra³e¶ ju¿ pakiet, który chcesz zbudowaæ. Pierwsz± rzecz±,
  któr± powiniene¶ zrobiæ, to sprawdziæ, czy pakiet znajduje siê ju¿
  w dystrybucji, przy pomocy programu <prgn>aptitude</prgn>.
  Je¶li u¿ywasz dystrybucji 'stabilnej', zapewne najlepiej przej¶æ do
  <url name="strony wyszukiwania pakietów" id="http://www.debian.org/distrib/packages">.

  <p>Je¶li pakiet ju¿ istnieje, to có¿, zainstaluj go! :-) Je¶li przypadkiem
  jest on osierocony (jego opiekunem jest "Debian QA Group"), to byæ mo¿e
  mo¿esz siê nim zaopiekowaæ.

  <p>Sprawd¼ na stronie
  <url name="Pakietów Rokuj±cych i Wymagaj±cych Pracy" id="http://www.debian.org/devel/wnpp/">
  i stronach powi±zanych ostatni status adopcji/osierocenia pakietu.

  <p>Je¶li mo¿esz zaadoptowaæ pakiet, pobierz jego ¼ród³a (poleceniem
  <tt>apt-get source nazwa_pakietu</tt>) i przetestuj go. Niestety ten
  dokument nie zawiera informacji na temat adopcji pakietów. Za to
  nie musisz mêczyæ siê, rozpracowuj±c dzia³anie danego pakietu, gdy¿
  kto¶ ju¿ wcze¶niej dokona³ wstêpnych ustawieñ. Ale czytaj dalej, bo
  poni¿sze porady bêd± z pewno¶ci± warto¶ciowe równie¿ dla Ciebie.

  <p>Je¶li pakiet jest nowy i chcia³by¶, ¿eby zosta³ w³±czony do dystrybucji
  Debiana, wykonaj poni¿sze instrukcje:

  <list>
  <item>sprawd¼ na stronie <url name="lista pakietów w opracowaniu"
  id="http://www.de.debian.org/devel/wnpp/being_packaged">, czy kto¶ ju¿ nie
  pracuje nad tym pakietem. Je¶li kto¶ ju¿ to robi, to mo¿esz siê z nim
  skontaktowaæ, je¶li s±dzisz, ¿e móg³by¶ mu pomóc. Je¶li nie - znajd¼
  jaki¶ inny interesuj±cy Ciê program, który nie ma jeszcze swojego opiekuna.
  </item>

  <item>program <strong>musi</strong> mieæ licencjê i, je¶li to mo¿liwe,
  najlepiej zgodn± z <url name="Wytycznymi Debiana dotycz±cymi Wolnego
  Oprogramowania" id="http://www.debian.org/social_contract.html#guidelines">
  oraz <strong>nie mo¿e</strong> wymagaæ pakietów spoza sekcji main
  do kompilacji lub wykonania, bo jest to niezgodne z Polityk± Debiana.
  Je¶li nie zgadza siê to z któr±¶ z powy¿szych zasad, program mo¿e byæ
  w³±czony do sekcji `contrib' lub `non-free', zale¿nie od sytauacji.
  Gdy nie jeste¶ pewny, do której sekcji mo¿na w³±czyæ program, wy¶lij tekst
  licencji na listê <email>debian-legal@lists.debian.org</email>
  i popro¶ o poradê.
  </item>

  <item>program z pewno¶ci± <strong>nie</strong> powinien byæ uruchamiany
  z ustanowionym identyfikatorem administratora systemu (setuid root), a
  jeszcze lepiej - nie powinien potrzebowaæ ustanowionego ¿adnego
  identyfikatora u¿ytkownika lub grupy.</item>

  <item>program nie powinien byæ demonem ani innym programem umieszczanym
  w katalogu */sbin, ani nie powinien otwieraæ portu jako administrator
  systemu.</item>

  <item>program powinien mieæ binarn±, wykonywaln± formê, biblioteki s±
  trudniejsze w utrzymaniu.</item>

  <item>program powinien byæ dobrze udokumentowany, a kod 
  zrozumia³y (np. nie zagmatwany).</item>

  <item>powiniene¶ skontaktowaæ siê z autorem(ami) programu, aby sprawdziæ
  czy zgadzaj± siê na jego zapakowanie. Wa¿n± rzecz± jest mo¿liwo¶æ
  konsultacji z autorem w razie wyst±pienia jakich¶ specyficznych problemów.
  Nie próbuj pakowaæ oprogramowania, którym siê nikt nie zajmuje.</item>

  <item>i na koñcu, choæ wcale nie jest to najmniej wa¿ne, musisz wiedzieæ jak
  program dzia³a i wypróbowaæ go przez pewien czas.</item>
  </list>

  <p>Oczywi¶cie powy¿sze zalecenia to po prostu zabezpieczenia, które maj±
  na celu uchroniæ Ciê przed gniewem u¿ytkowników, gdy zrobisz co¶ ¼le w
  jakim¶ demonie z ustanowionym identyfikatorem u¿ytkownika...
  Gdy nabierzesz ju¿ wiêcej do¶wiadczenia, bêdziesz móg³ pakowaæ
  nawet takie programy, ale nawet najbardziej do¶wiadczeni deweloperzy
  konsultuj± siê na li¶cie dyskusyjnej Mentorów Debiana, gdy maj±
  jakie¶ w±tpliwo¶ci. Ludzie stamt±d z pewno¶ci± chêtnie pomog±.

  <p>Wiêcej informacji na te tematy znajdziesz w dokumencie Developer's
  Reference.

  <sect id="getit">We¼ program i wypróbuj go

  <p>Pierwsz± rzecz±, któr± powiniene¶ zrobiæ, to odnalezienie i pobranie
  oryginalnego pakietu. Zak³adam, ¿e ju¿ masz plik ¼ród³owy, który pobra³e¶
  ze strony domowej jego autora. ¬ród³a z wolnym oprogramowaniem dla Uniksa
  s± zwykle rozprowadzane w formacie tar/gzip, z rozszerzeniem
  .tar.gz. Pliki te na ogó³ zawieraj± podkatalog o nazwie program-wersja,
  w którym znajduj± siê wszystkie pliki ¼ród³owe. Je¶li ¼ród³a wybranego przez
  Ciebie programu s± rozprowadzane w innego rodzaju archiwum (na przyk³ad pliki
  koñcz±ce siê na ".Z" lub ".zip"), to wypakuj je przy pomocy odpowiedniego
  narzêdzia. Gdy nie jeste¶ pewien, jak zrobiæ to poprawnie, zapytaj
  (po angielsku) na li¶cie dyskusyjnej Mentorów Debiana (wskazówka:
  temat `file archive.extension`).

  <p>Jako przyk³adu bêdziemy u¿ywaæ programu o nazwie `gentoo' - menad¿era
  plików dla systemu X Windows, który wykorzystuje bibliotekê GTK+. Zwróæ
  uwagê, ¿e program ten jest ju¿ zapakowany i znacznie siê zmieni³ od czasu,
  gdy pisany by³ ten tekst.

  <p>W swoim katalogu domowym utwórz podkatalog o nazwie 'debian', 'deb' lub
  jakkolwiek uwa¿asz za w³a¶ciwe (np. po prostu <file>~/gentoo/</file>
  jest w tym przypadku dobrym rozwi±zaniem). Umie¶æ w nim pobrane archiwum
  i rozpakuj je (za pomoc± `tar xzf gentoo-0.9.12.tar.gz`). Upewnij siê, ¿e nie
  ma ¿adnych b³êdów, nawet jakich¶ nieistotnych, poniewa¿ najprawdopodobniej
  pojawi± siê problemy w czasie rozpakowywania w systemach innych u¿ytkowników,
  których narzêdzia do wypakowywania mog±, ale nie musz±, ignorowaæ takie
  nieprawid³owo¶ci.

  <p>Teraz w katalogu tym powiniene¶ mieæ podkatalog o nazwie
  `gentoo-0.9.12'. Wejd¼ do niego i <strong>dok³adnie</strong> przeczytaj
  znajduj±c± siê tam dokumentacjê. Zwykle powinny tam byæ pliki o nazwach
  README*, INSTALL*, *.lsm lub *.html. Odszukaj w dokumentacji instrukcji,
  jak poprawnie skompilowaæ i zainstalowaæ program (najprawdopodobniej bêd±
  one zak³adaæ, ¿e chcesz zainstalowaæ program do katalogu /usr/local/bin;
  ale Ty nie rób tak, wiêcej o tym w rozdziale <ref id="destdir">).

  <p>Proces instalacji ró¿ni siê w zale¿no¶ci od programu, ale wiele
  nowoczesnych programów jest dostarczanych ze skryptem `configure',
  który konfiguruje ¼ród³a pod Twoim systemem i sprawdza, czy spe³niaj± one
  warunki niezbêdne do poprawnej kompilacji. Po zakoñczeniu konfiguracji
  wykonywanej za pomoc± polecenia `./configure`, programy s± na ogó³
  kompilowane przy u¿yciu komendy `make`. Niektóre z nich pozwalaj± tak¿e
  na u¿ycie `make check`, który uruchamia procedurê samosprawdzaj±c±.
  Instalacja w katalogu przeznaczenia nastêpuje zwykle po wydaniu polecenia
  `make install`.

  <p>Teraz spróbuj skompilowaæ i uruchomiæ program, aby upewniæ siê czy dzia³a
  on prawid³owo i nic siê nie psuje w czasie instalacji lub wykonywania.

  <p>Mo¿esz te¿ zazwyczaj u¿yæ polecenia `make clean` (lub lepiej `make
  distclean`), aby posprz±taæ w katalogu, w którym kompilowa³e¶. Czasem
  mo¿na nawet pos³u¿yæ siê poleceniem `make uninstall`, które usunie wszystkie
  zainstalowane pliki.

  <sect id="namever">Nazwa pakietu i jego wersja

  <p>Powiniene¶ rozpocz±æ pakowanie z zupe³nie wyczyszczonym
  (ang. pristine - pierwotnym) katalogiem ¼ród³owym, ewentualnie ze ¶wie¿o
  rozpakowanymi ¼ród³ami.

  <p>Aby prawid³owo zbudowaæ pakiet, musisz tak zmieniæ nazwê oryginalnego
  programu, ¿eby wystêpowa³y w niej tylko ma³e litery (o ile wystêpuj± tam
  jakie¶ wielkie litery). Powiniene¶ tak¿e przenie¶æ katalog ze ¼ród³ami do
  katalogu &lt;nazwa_pakietu&gt;-&lt;wersja&gt;.

  <p>Je¶li nazwa programu sk³ada siê z wiêcej ni¿ jednego wyrazu, to skróæ
  j± do jednego wyrazu albo utwórz skrót. Na przyk³ad program
  "John's little editor for X" powinien siê nazywaæ johnledx, jle4x lub
  jako¶ tak. Pamiêtaj jednak, aby jego d³ugo¶æ nie przekracza³a jakiej¶
  rozs±dnej warto¶ci, np. 20 znaków.

  <p>Sprawd¼ tak¿e dok³adnie wersjê programu (bêdzie ona w³±czona do nazwy
  pakietu). Je¶li do oznaczenia jego wersji autor nie u¿y³ konwencji X.Y.Z,
  ale pos³u¿y³ siê dat±, to Ty równie¿ mo¿esz jej u¿yæ do okre¶lenia wersji
  pakietu, poprzedzaj±c j± ci±giem "0.0." (na wypadek gdyby autor
  programu zdecydowa³ siê kiedy¶ wydaæ wersjê o mi³o brzmi±cym numerze 1.0).
  Zatem, je¶li dat± wydania danej wersji programu by³o 19 grudnia 1998 r.,
  to powiniene¶ oznaczyæ jego wersjê jako 0.0.19981219.

  <p>Niektóre programy nie s± jednak w ¿aden sposób numerowane. W takich
  przypadkach powiniene¶ skontaktowaæ siê z zewnêtrznym opiekunem, aby
  dowiedzieæ siê, czy u¿ywa on jakiej¶ innej metody do oznaczania kolejnych
  poprawek programu.

  <sect id="dh_make">Wstêpna "debianizacja"

  <p>Upewnij siê, ¿e jeste¶ w katalogu ze ¼ród³ami programu i wydaj nastêpuj±ce
  polecenie:

  <p><example>
  dh_make -e twój.adres@opiekuna.pl -f ../gentoo-0.9.12.tar.gz
  </example>

  <p>Oczywi¶cie musisz zast±piæ ci±g "twój.adres@opiekuna.pl" adresem Twojej
  skrzynki pocztowej, gdy¿ zostanie on wpisany do pliku ze zmianami
  (changelog) i innych plików, oraz zast±piæ nazwê pliku
  nazw± Twojego archiwum ¼ród³owego. Wiêcej szczegó³ów znajdziesz
  na stronie podrêcznika <manref name="dh_make" section="1">.

  <p>Trzeba te¿ wprowadziæ kilka dodatkowych informacji. Zostaniesz poproszony
  o podanie typu pakietu, który tworzysz. Gentoo to pojedynczy pakiet binarny
  - tworzy on tylko plik binarny, a zatem jeden plik .deb. W takim wypadku
  zaznaczamy pierwsz± opcjê za pomoc± klawisza `s'. Nastêpnie sprawdzamy
  informacje na ekranie i, je¶li wszystko siê zgadza, potwierdzamy je
  naciskaj±c &lt;enter&gt;.
  
  <p>Po wykonaniu <prgn>dh_make</prgn> jest tworzona kopia autorskiego
  archiwum jako <file>gentoo_0.9.12.orig.tar.gz</file>, w katalogu
  nadrzêdnym, w celu dostosowania, jako niedebianowego pakietu
  pakietu ¼ród³owego, do <file>diff.gz</file>.
  Nazwa tego pliku ma 2 zasadnicze w³a¶ciwo¶ci:
  
  <list compact>
  <item>Nazwa pakietu i wersja s± rozdzielone przez "<tt>_</tt>" .
  <item>Zosta³ dodany sufiks "<tt>orig.</tt>" przed "<tt>tar.gz</tt>" .
  </list>
  
  <p>Powtórzmy: poniewa¿ jeste¶ jeszcze nowym opiekunem, odradzamy
  Ci tworzenie skomplikowanych pakietów, takich jak:
  <list compact>
  <item>wielokrotne pakiety binarne
  <item>pakiety bibliotek
  <item>z plików ¼ród³owych innych ni¿ <tt>tar.gz.</tt> lub <tt>tar.bz2</tt>, czy te¿
  <item>z archiwów, których zawarto¶æ nie mo¿e byæ dystrybuowana.
  </list>

  <p>Prosimy zauwa¿yæ, ¿e powinno siê uruchomiæ program <prgn>dh_make</prgn>
  <strong>tylko jeden raz</strong>, gdy¿ nie zachowa siê on poprawnie, gdy
  uruchomisz go ponownie w tym samym ju¿ "zdebianizowanym" katalogu. Oznacza
  to równie¿, ¿e bêdziesz musia³ u¿yæ innej metody, aby wprowadziæ
  w przysz³o¶ci now± poprawkê lub now± wersjê pakietu. Wiêcej informacji
  na ten temat znajdziesz dalej w rozdziale <ref id="update">.

  <!-- -------------------------------------------------------------------------->

  <chapt id="modify">Modyfikacja ¼ród³a

  <p>Normalnie programy instaluj± siê w podkatalogach katalogu /usr/local.
  Pakiety Debiana nie mog± jednak u¿ywaæ tego katalogu, gdy¿ jest on
  zarezerwowany do prywatnego u¿ycia przez administratora (lub u¿ytkowników)
  systemu. Oznacza to, ¿e musisz siê przyjrzeæ, jak budowany jest Twój program,
  zwykle za pomoc± pliku Makefile. Jest to skrypt programu <manref name="make"
  section="1"> u¿ywanego do automatycznego budowania programu. Wiêcej szczegó³ów
  na temat plików Makefile znajdziesz w rozdziale <ref id="rules">.

  <p>Zwróæ te¿ uwagê na to, czy Twój program u¿ywa programów GNU
  <manref name="automake" section="1"> i/lub <manref name="autoconf"
  section="1">, czyli czy ¼ród³a programu zawieraj± plik Makefile.am i/lub
  Makefile.in, to je bêdziesz musia³ wtedy modyfikowaæ. Dzieje siê tak,
  poniewa¿ ka¿de wywo³anie programu automake powoduje ponowne utworzenie pliku
  Makefile.in z informacjami wygenerowanymi z pliku Makefile.am. Tak¿e ka¿de
  wywo³anie skryptu ./configure zrobi to samo z plikiem Makefile, na podstawie
  pliku Makefile.in. Edycja plików Makefile.am wymaga pewnej wiedzy
  na temat programu automake, mo¿esz o nim poczytaæ za pomoc± komendy `info
  automake'. Edytowanie plików Makefile.in odbywa siê niemal tak samo, jak
  w przypadku plików Makefile, po prostu trzeba zwracaæ uwagê na zmienne,
  tzn. wszystkie ³añcuchy otoczone przez znaki `@', dla przyk³adu zmienna
  @CFLAGS@ lub @LN_S@ bêdzie zastêpowana odpowiedni± warto¶ci± przy ka¿dym
  wywo³aniu skryptu ./configure. Przeczytaj dokumentacjê
  <file>&autotools-dev;</file>, zanim zaczniesz modyfikacje.

  <p>Zauwa¿ równie¿, ¿e nie ma tu wystarczaj±cego miejsca, aby opisaæ
  <em>wszystkie</em> szczegó³y na temat poprawiania zewnêtrznych ¼róde³.
  Przedstawiam tu jedynie kilka problemów, z którymi czêsto mo¿na siê
  spotkaæ.

  <sect id="destdir">Instalacja w podkatalogu

  <p>Wiekszo¶æ programów posiada swój w³asny sposób instalowania siê
  w istniej±cej strukturze katalogów systemu. Binaria trafiaj± do katalogów
  okre¶lonych zmienn± ¶rodowiskow± $PATH, za¶ dokumentacja i strony podrêcznika
  s± umieszczane w zwykle stosowanych miejscach. Jednak¿e, je¶li pozwolisz
  na takie dzia³anie, program mo¿e siê zainstalowaæ w ka¿dym miejscu systemu.
  Mo¿e sprawiæ to problemy narzêdziom do obs³ugi pakietów, gdy¿ nie bêd± one
  wiedzia³y, które pliki nale¿± do Twojej paczki, a które nie.

  <p>Zatem musisz zrobiæ co¶ innego: zainstalowaæ swój program w tymczasowym
  katalogu, z którego narzêdzia opiekuna zbuduj± dzia³aj±cy pakiet .deb.
  Wszystko co zawiera ten katalog, zostanie zainstalowane w systemie
  u¿ytkowników, gdy zdecyduj± siê oni zainstalowaæ Twój pakiet, z t± tylko
  ró¿nic±, ¿e program dpkg zainstaluje pliki wzglêdem katalogu g³ównego
  systemu.

  <p>Ten tymczasowy katalog jest zazwyczaj tworzony wewn±trz Twojego
  katalogu debian/ w rozpakowanym drzewie ze ¼ród³ami. Na ogó³ ma on nazwê
  <file>debian/nazwa_pakietu</file>.

  <p>Pamiêtaj, ¿e nie wystarczy, ¿eby program zachowywa³ siê poprawnie,
  gdy zostanie on zainstalowany siê w katalogu debian/nazwa_pakietu. Musi on
  zachowywaæ siê w³a¶ciwie tak¿e, gdy zostanie umieszczony w g³ównym katalogu
  systemu. Zatem nie wolno pozwoliæ, ¿eby w plikach pakietu zosta³y "zaszyte"
  pe³ne ¶cie¿ki, np. <tt>/home/ja/deb/gentoo-0.9.12/usr/share/gentoo</tt>.

  <p>Sprawa jest prosta, gdy programy u¿ywaj± narzêdzia GNU autoconf.
  Wiêkszo¶æ z nich posiada pliki Makefile, które domy¶lnie s± ustawione w taki
  sposób, aby zezwalaæ na instalacjê w dowolnym podkatalogu zak³adaj±c,
  ¿e katalog /usr (dla przyk³adu) jest kanonicznym prefiksem. Gdy zostanie
  wykryte, ¿e Twój program u¿ywa autoconfa, to dh_make ustawi
  odpowiednie polecenia tak, ¿eby wszystko zosta³o zrobione automatycznie.
  W takich przypadkach mo¿esz nawet omin±æ dalsze czytanie tej sekcji.
  Jednak z innymi programami bêdziesz mia³ wiêcej pracy i prawdopodobnie
  bêdziesz musia³ przejrzeæ i wyedytowaæ pliki Makefile.

  <p>Poni¿ej znajduje siê odpowiednia czê¶æ pliku Makefile programu gentoo:

  <p><example>
  # Katalog binariów dla 'make install'
  BIN     = /usr/local/bin

  # Katalog ikon dla 'make install'
  ICONS   = /usr/local/share/gentoo
  </example>

  <p>Widzimy, ¿e pliki te zostan± zainstalowane w katalogu
  <file>/usr/local</file>. Zmieñmy zatem ¶cie¿ki na nastêpuj±ce:

  <p><example>
  # Katalog binariów dla 'make install'
  BIN     = $(DESTDIR)/usr/bin

  # Katalog ikon dla 'make install'
  ICONS   = $(DESTDIR)/usr/share/gentoo
  </example>

  <p>Ale dlaczego w³a¶nie w tym katalogu, a nie w jakim¶ innym? Poniewa¿ pakiety
  Debiana nigdy nie instaluj± plików w katalogu <file>/usr/local</file>.
  Ten katalog jest zarezerwowany na potrzeby administratora systemu. W systemie
  Debian za¶ takie pliki trafiaj± do katalogu <file>/usr</file>.

  <p>Dok³adniejsze informacje na temat po³o¿enia binariów, ikon, dokumentacji
  itd. s± opisane w dokumencie Filesystem Hierarchy Standard (zobacz
  w katalogu /usr/share/doc/debian-policy/fhs/). Polecamy Ci przejrzenie tego
  dokumentu i przeczytanie tych sekcji, które mog± dotyczyæ Twojego pakietu.

  <p>Zatem powinni¶my instalowaæ pliki binarne w katalogu /usr/bin, a nie
  w /usr/local/bin, strony podrêcznika w katalogu /usr/share/man/man1, a nie
  w /usr/local/man/man1 itd. Zauwa¿, ¿e w pliku Makefile programu gentoo nie
  wspomniano o jego stronie podrêcznika, ale poniewa¿ Polityka Debiana wymaga,
  ¿eby ka¿dy program posiada³ tak± stronê, to stworzymy j± pó¼niej
  i zainstalujemy w katalogu /usr/share/man/man1.

  <p>Niektóre programy nie u¿ywaj± zmiennych w plikach Makefile do definiowania
  ¶cie¿ek, takich jak te powy¿ej. Oznacza to, ¿e bêdziesz musia³ wyedytowaæ
  niektóre ¼ród³a napisane w jêzyku C i tak je poprawiæ, aby u¿ywa³y w³a¶ciwych
  katalogów. Ale gdzie i czego w³a¶ciwie szukaæ? Mo¿esz to odnale¼æ wydaj±c
  polecenie:

  <p><example>
  grep -nr -e 'usr/local/lib' --include='*.[c|h]' .
  </example>

  <p>Program grep przeszuka rekursywnie ca³e drzewo ze ¼ród³ami i wypisze
  nazwy plików i numery linii, gdy odnajdzie szukany wzorzec.

  <p>Wyedytuj te pliki i w odnalezionych liniach zast±p ci±g /usr/local/*
  ci±giem usr/* &mdash; i to ju¿ wszystko. Zrób to uwa¿nie, aby nie zepsuæ
  pozosta³ej czê¶ci kodu! :-)

  <p>Nastêpnie powiniene¶ odnale¼æ w pliku Makefile cel `install'
  (szukaj linii rozpoczynaj±cej siê od ci±gu "install:') i zmieniæ wszystkie
  odniesienia do katalogów innych, ni¿ te zdefiniowane na pocz±tku
  pliku Makefile. Przed zmian±, cel `install' programu gentoo by³ nastêpuj±cy:

  <p><example>
  install:        gentoo
                  install ./gentoo $(BIN)
                  install icons/* $(ICONS)
                  install gentoorc-example $(HOME)/.gentoorc
  </example>

  <p>Po wykonaniu zmian wygl±da on nastêpuj±co:

  <example>
  install:        gentoo-target
                  install -d $(BIN) $(ICONS) $(DESTDIR)/etc
                  install ./gentoo $(BIN)
                  install -m644 icons/* $(ICONS)
                  install -m644 gentoorc-example $(DESTDIR)/etc/gentoorc
  </example>

  <p>Na pewno zauwa¿y³e¶, ¿e teraz przed pozosta³ymi poleceniami w tej
  regule bêdzie wykonywana komenda <tt>install -d</tt>. Oryginalny plik
  Makefile nie mia³ jej, gdy¿ zwykle katalog /usr/local/bin i inne katalogi
  istniej± ju¿ w systemie, zanim wyda siê polecenie `make install`.
  Jednak¿e, gdy instalujemy program do w³asnego, pustego (lub nawet
  nie istniej±cego) katalogu, to bêdziemy musieli utworzyæ ka¿dy z tych
  katalogów.

  <p>Mo¿emy równie¿ dodaæ inne rzeczy na koñcu tej regu³y, na przyk³ad
  instalacjê dodatkowej dokumentacji, któr± autor programu czasem pomija:

  <p><example>
                  install -d $(DESTDIR)/usr/share/doc/gentoo/html
                  cp -a docs/* $(DESTDIR)/usr/share/doc/gentoo/html
  </example>

  <p>Uwa¿ny czytelnik zauwa¿y, ¿e zmienili¶my `gentoo' na `gentoo-target' w linii
  rozpoczynaj±cej siê od ci±gu `install:'. To jest tzw. poprawka niedotycz±ca
  (unrelated bug fix) :-)

  <p>Ilekroæ dokonasz zmian, które nie s± ¶ci¶le zwi±zane z pakietem Debiana,
  poinformuj o nich opiekuna zewnêtrznego, aby móg³ on je w³±czyæ do nastêpnej
  wersji programu i by równie¿ kto¶ inny móg³ z nich skorzystaæ.
  Pamiêtaj tak¿e, ¿eby tworzyæ poprawki nie specyficzne dla Debiana,
  Linuksa (lub nawet Uniksa!) przed ich wys³aniem &mdash; niech bêd± one
  przeno¶ne. Dziêki temu Twoje ³aty bêdzie ³atwiej na³o¿yæ.

  <p>Zauwa¿, ¿e nie musisz wysy³aæ autorowi programu plików debian/*.

  <sect id="difflibs">Nie zgadzaj±ce siê biblioteki

  <p>Tutaj mamy pewien do¶æ powszechny problem: biblioteki czêsto ró¿ni± siê
  pomiêdzy platformami. Dla przyk³adu, plik Makefile mo¿e zawieraæ odwo³ania
  do biblioteki, której nie ma Debianie. W takim przypadku musimy zamieniæ j±
  na bibliotekê, która jest dostêpna w Debianie i s³u¿y tym samym celom.

  <p>Je¶li zatem w pliku Makefile (lub Makefile.in) Twojego programu istnieje
  linia podobna do tej poni¿ej (i Twój program nie chce siê skompilowaæ):

  <p><example>
  LIBS = -lcurses -lco¶ -lco¶_innego
  </example>
  
  <p>to zmieñ j± w pokazany sposób i to powinno pomóc:

  <p><example>
  LIBS = -lncurses -lco¶ -lco¶_innego
  </example>

  <p>(Autor zdaje sobie sprawê, ¿e to nie jest najlepszy przyk³ad,
  zwa¿ywszy na to, ¿e pakiet libncurses jest teraz dostarczany wraz z
  dowi±zaniem symbolicznym do biblioteki libcurses.so, ale nie móg³ wymy¶liæ
  niczego lepszego. Sugestie bêd± bardzo mile widziane :-)

  <!-- -------------------------------------------------------------------------->

  <chapt id="dreq">Rzeczy wymagane w katalogu debian/

  <p>W katalogu ze ¼ród³ami Twojego programu powsta³ nowy podkatalog,
  który nazywa siê `debian'. Zawiera on kilka plików, które powinni¶my
  wyedytowaæ, aby umo¿liwiæ dzia³anie pakietu. Najwa¿niejszymi z nich s± pliki
  `control', `changelog', `copyright' i 'rules', które s± wymagane
  w ka¿dym pakiecie.

  <sect id="control">Plik `control'

  <p>Ten plik zawiera ró¿ne informacje, których u¿ywaja programy <prgn/dpkg/,
  <prgn/dselect/ oraz inne narzêdzia s³u¿±ce do zarz±dzania pakietem.

  <p>Poni¿ej przedstawiono plik control utworzony przez program dh_make:

  <p><example>
  1  Source: gentoo
  2  Section: unknown
  3  Priority: optional
  4  Maintainer: Josip Rodin &lt;joy-mg@debian.org&gt;
  5  Build-Depends: debhelper (>> 3.0.0)
  6  Standards-Version: 3.6.2
  7
  8  Package: gentoo
  9  Architecture: any
  10 Depends: ${shlibs:Depends}
  11 Description: &lt;insert up to 60 chars description&gt;
  12  &lt;insert long description, indented with spaces&gt;
  </example>
  (doda³em numery linii)

  <p>Linie 1-6 zawieraj± informacje kontrolne dla pakietu ¼ród³owego.
	
  <p>Linia 1. zawiera nazwê pakietu ¼ród³owego.

  <p>Linia 2. oznacza sekcjê dystrybucji, do której nale¿y pakiet ¼ród³owy.
	
  <p>Byæ mo¿e zauwa¿y³e¶, ¿e Debian jest podzielony na nastêpuj±ce sekcje:
  `main' (zawiera wolne oprogramowanie), `non-free' (zawiera oprogramowanie,
  które nie jest wolne) i `contrib' (zawiera wolne oprogramowanie, które
  zale¿y od oprogramowania, które nie jest wolne). Dodatkowo ka¿da z sekcji
  dzieli siê na logiczne podsekcje, które skrótowo opisuj±, do czego s³u¿y
  dany pakiet. Mamy zatem sekcjê `admin', która zawiera programy przeznaczone
  tylko dla administratora systemu, `base' z podstawowymi narzêdziami, `devel'
  z narzêdziami programistów, `doc' z dokumentacj±, `libs' z bibliotekami,
  `mail' z programami do obs³ugi poczty elektronicznej, `net' z aplikacjami
  sieciowymi i demonami us³ug sieciowych, `x11' z programami dla systemów X11,
  które nie pasuj± nigdzie indziej i wiele innych.

  <p>Zmieñmy j± zatem na x11. Prefiks "main/" jest przyjmowany domy¶lnie,
  wiêc mo¿emy go pomin±æ.

  <p>Linia 3. opisuje, jak wa¿ne jest to, aby u¿ytkownik zainstalowa³ dany
  pakiet. Wiêcej informacji na temat warto¶ci, jakie mo¿e przyjmowaæ to pole
  znajdziesz w podrêczniku Polityki Debiana. Dla nowych pakietów zazwyczaj mo¿e
  ono przyjmowaæ warto¶æ "optional".

  <p>Sekcja (Section) i priorytet (Priority) s± u¿ywane przez nak³adki,
  jak program <prgn/dselect/, które u¿ywaj± ich do sortowania pakietów i wyboru
  domy¶lnego zestawu pakietów do zainstalowania. Gdy bêdziesz umieszcza³ swój
  pakiet w archiwum Debiana, warto¶æ tych dwóch pól mo¿e byæ zmieniona przez
  opiekunów archiwum. W takich przypadkach zostaniesz o tym powiadomiony
  e-mailem.

  <p>Poniewa¿ jest to pakiet o normalnym priorytecie i nie jest w konflikcie
  z innym pakietem, to pozostawiamy tam warto¶æ "optional".

  <p>Linia 4. zawiera imiê i nazwisko oraz adres e-mail opiekuna pakietu.
  Upewnij siê, ¿e pole to zawiera warto¶æ odpowiedni± dla nag³ówka "To: "
  wiadomo¶ci pocztowej, gdy¿ po umieszczeniu pakietu w archiwum system
  ¶ledzenia b³êdów u¿yje tego pola do wysy³ania Ci e-maili ze zg³oszeniami
  b³êdów. Nie stosuj przecinków, ampersandów (`&amp;') i nawiasów.

  <p>Linia 5. zawiera listê pakietów wymaganych do zbudowania Twojego
  pakietu. Niektóre pakiety, na przyk³ad gcc czy make, s± za³o¿one z góry,
  wiêcej szczegó³ów na temat znajdziesz w pakiecie <package/build-essential/.
  Je¶li do zbudowania Twojego pakietu jest potrzebny jaki¶ niestandardowy
  kompilator lub inne narzêdzie, to powiniene¶ dodaæ tutaj liniê
  `Build-Depends'. Wpisy s± oddzielane od siebie za pomoc± przecinków;
  przeczytaj obja¶nienia na temat zale¿no¶ci binariów, aby dowiedzieæ siê
  wiêcej na temat sk³adni tego pola.

  <p>Mo¿esz tak¿e u¿yæ w tym miejscu takich pól jak Build-Depends-Indep,
  Build-Conflicts i innych. Dane te s± u¿ywane przez oprogramowanie do
  automatycznego budowania pakietów Debiana w celu stworzenia pakietów
  binarnych przeznaczonych dla innych platform komputerowych. Wiêcej
  informacji na temat zale¿no¶ci budowania pakietów znajdziesz w podrêczniku
  Polityki. Dokument Developers' Reference zawiera szczegó³y na temat innych
  platform (architektur) oraz adaptowania (ang. porting) do nich
  oprogramowania.

  <p>Poni¿ej pokazano sztuczkê, dziêki której odszukasz pakiety,
  których potrzebuje do zbudowania Twój pakiet:

  <example>
  strace -f -o /tmp/log ./configure
  # or make instead of ./configure, if the package doesn't use autoconf
  for x in `dpkg -S $(grep open /tmp/log|\
                      perl -pe 's!.* open\(\"([^\"]*).*!$1!' |\
                      grep "^/"| sort | uniq|\
                      grep -v "^\(/tmp\|/dev\|/proc\)" ) 2>/dev/null|\
                      cut -f1 -d":"| sort | uniq`; \
        do \
          echo -n "$x (>=" `dpkg -s $x|grep ^Version|cut -f2 -d":"` "), "; \
        done
  </example>

  <p>Aby rêcznie znale¼æ kompletny zestaw zale¿no¶ci dla programu
  <prgn><var>/usr/bin/foo</var></prgn>, wykonaj
  <example>
  objdump -p <var>/usr/bin/foo</var> | grep NEEDED
  </example>
  a dla ka¿dej znalezionej biblioteki, np. <prgn>libfoo.so.6</prgn>, wykonaj
  <example>
  dpkg -S libfoo.so.6 
  </example>
  Potem tylko we¼ wersjê -dev ka¿dej z nich jako pozycjê w `Build-deps'.
  Je¶li u¿ywasz do tego celu <prgn>ldd</prgn>, pokazuje on
  równie¿ zale¿no¶ci niebezpo¶rednie, co skutkuje zbyt du¿± liczb±
  wykazywanych zale¿no¶ci.

  <p>Tak wiêc program gentoo wymaga do zbudowania pakietów <package/xlibs-dev/,
  <package/libgtk1.2-dev/ i <package/libglib1.2-dev/, wiêc dodajmy je
  za pakietem <package/debhelper/.

  <p>Linia 6. jest wersj± standardów polityki Debiana, któr± dany pakiet
  spe³nia, wersjê podrêcznika Polityki, który czytasz w trakcie tworzenia
  Twojego pakietu.

  <p>Linia 8. to nazwa pakietu binarnego. Zwykle jest ona taka sama jak nazwa
  pakietu ¼ród³owego, ale nie musi to byæ regu³±.

  <p>Linia 9. opisuje architekturê procesora, dla którego mo¿e byæ
  skompilowany pakiet. Pozostawimy w niej "any", gdy¿ pakiet
  <manref name="dpkg-gencontrol" section="1"> sam wstawi w tym miejscu
  odpowiedni± warto¶æ dla ka¿dego typu maszyny, na której kompilowany jest
  pakiet.

  <p>Je¶li Twój pakiet jest niezale¿ny od architektury procesora (dla przyk³adu
  skrypt pow³oki lub Perla, albo jaki¶ dokument), wpisz tutaj "all"
  i poczytaj pó¼niej w sekcji <ref id="rules"> na temat u¿ywania regu³y
  `binary-indep' zamiast `binary-arch' do budowania pakietu.

  <p>Linia 10. pokazuje jedn± z najpotê¿niejszych cech systemu pakietów
  Debiana. Pakiety mog± znajdowaæ siê w ró¿nych relacjach z innymi pakietami.
  Oprócz pola Depends: mog± te¿ wystêpowaæ pola opisuj±ce inne zwi±zki:
  Recommends:, Suggests:, Pre-Depends:, Conflicts:, Provides: i Replaces:.

  <p>Narzêdzia do zarz±dzania pakietami zwykle zachowuj± siê w ten sam sposób
  w czasie ustalania relacji miêdzy pakietami. Je¶li tak nie jest,
  zostanie to wkrótce wyja¶nione (zobacz <manref name="dpkg" section="8">,
  <manref name="dselect" section="8">, <manref name="apt" section="8">,
  <manref name="aptitude" section="1">, itd.).

  <p>Pola te oznaczaj±:

  <p><list>
  <item>Depends: (Wymaga)
  <p>Pakiet nie zostanie zainstalowany o ile pakiety, których on wymaga nie
  s± ju¿ zainstalowane w systemie. U¿yj tego pola, gdy Twój program absolutnie
  nie mo¿e byæ uruchomiony (lub z du¿ymi trudno¶ciami), je¶li który¶ z tych
  pakietów nie jest obecny w systemie.</item>

  <item>Recommends: (Zaleca)
  <p>Nak³adki takie jak dselect czy aptitude zachêc± Ciê do zainstalowania
  zalecanych pakietów wraz z Twoim pakietem; dselect bêdzie nawet na to
  nalegaæ. Programy dpkg i apt-get jednak zignoruj± te pole. U¿yj go
  dla pakietów, które nie s± niezbêdne, ale s± zwykle u¿ywane razem z Twoim
  programem.</item>

  <item>Suggests: (Poleca)
  <p>Gdy u¿ytkownik instaluje Twój program, wszystkie nak³adki zachêc± go tak¿e
  do zainstalowania pakietów, które on poleca. Programy dpkg i apt-get nie
  bêd± siê o to troszczyæ. U¿yj tego pola dla pakietów, które lepiej dzia³aj±
  z Twoim programem, ale nie s± dla niego niezbêdne.</item>

  <item>Pre-Depends: (Przed-Wymaga)
  <p>Jest to silniejsza relacja ni¿ Depends:. Pakiet nie zostanie zainstalowany
  o ile pakiety, od których jest on przed-zale¿ny nie s± zainstalowane
  w systemie i <em>poprawnie skonfigurowane</em>. U¿ywaj tego pola
  <strong>bardzo</strong> oszczêdnie i jedynie po przedyskutowaniu tego na
  li¶cie debian-devel. Czytaj: nie u¿ywaj go nigdy. :-)</item>

  <item>Conflicts: (PowodujeKonflikt)
  <p>Pakiet nie zostanie zainstalowany, dopóki wszystkie pakiety, które powoduj±
  konflikt nie zostan± wcze¶niej usuniête z systemu. U¿yj tego pola, gdy Twój
  program absolutnie nie mo¿e byæ uruchomiony lub spowoduje jakie¶ problemy,
  je¶li jaki¶ inny pakiet jest obecny w systemie.</item>

  <item>Provides: (Dostarcza)
  <p>Dla niektórych rodzajów pakietów zosta³o zdefiniowanych wiele
  alternatywnych nazw wirtualnych. Pe³n± listê tych pakietów znajdziesz w pliku
  /usr/share/doc/debian-policy/virtual-package-names-list.txt.gz. U¿yj tego
  pola, je¶li Twój program dostarcza funkcjonalno¶ci istniej±cego ju¿ pakietu
  wirtualnego.</item>

  <item>Replaces: (Zastêpuje)
  <p>U¿yj tego pola, gdy Twój program zastêpuje pliki jakiego¶ innego pakietu
  lub zupe³nie zastêpuje jaki¶ pakiet (u¿ywane ³±cznie z polem Conflicts:).
  Pliki z wymienionych pakietów zostan± nadpisane przez pliki z Twojego
  pakietu.
  </item>
  </list>

  <p>Wszystkie te pola maj± jednolit± sk³adniê. Jest to lista nazw pakietów
  oddzielonych za pomoc± przecinka. Nazwy pakietów mog± równie¿ byæ listami
  alternatywnych nazw pakietów oddzielonych przy pomocy symbolu <tt>|</tt>
  (symbol potoku).

  <p>Pola mog± ograniczaæ swoje zastosowanie tylko do szczególnych wersji
  ka¿dego wymienionego pakietu. Wersje te s± umieszczone w nawiasach po ka¿dej
  nazwie pakietu i powinny zawieraæ relacje miêdzy numerami wersji pakietów.
  Dozwolonymi relacjami s±: <tt>&lt;&lt;</tt>, <tt>&lt;=</tt>, <tt>=</tt>,
  <tt>&gt;=</tt> i <tt>&gt;&gt;</tt>, odpowiednio: wcze¶niejszy, wcze¶niejszy
  lub równy, dok³adnie równy, pó¼niejszy lub równy i pó¼niejszy. Dla przyk³adu:

  <p><example>
  Depends: foo (>= 1.2), libbar1 (= 1.3.4)
  Conflicts: baz
  Recommends: libbaz4 (>> 4.0.7)
  Suggests: quux
  Replaces: quux (<< 5), quux-foo (<= 7.6)
  </example>

  <p>Ostatni± cech±, o której powiniene¶ wiedzieæ, jest ${shlibs:Depends}.
  Gdy Twój pakiet zostanie zbudowany i zainstalowany w tymczasowym katalogu,
  program <manref name="dh_shlibdeps" section="1"> "prze¶wietli" go
  w poszukiwaniu binariów i bibliotek, okre¶li jakich
  bibliotek wspó³dzielonych wymaga i wykryje, w których pakietach siê
  one znajduj±, na przyk³ad libc6 lub xlib6g. Nastêpnie program
  <manref name="dh_gencontrol" section="1"> umie¶ci ich nazwy we w³a¶ciwym
  miejscu, wiêc nie musisz siê o to martwiæ.

  <p>Skoro ju¿ wszystko to zosta³o powiedziane, mo¿emy pozostawiæ liniê 10.
  w takiej postaci jak teraz i wstawiæ po niej <tt>Suggests: file</tt>,
  poniewa¿ gentoo mo¿e u¿yæ niektórych funkcjonalno¶ci dostarczanych przez
  ten program/pakiet.

  <p>Linia 11. jest krótkim opisem pakietu. Wiêkszo¶æ ekranów tekstowych ma
  szeroko¶æ 80 kolumn, wiêc nie powinna ona zawieraæ wiêcej ni¿ 60 znaków.
  Ja wpisa³em w niej "fully GUI configurable X file manager using GTK+"
  (w pe³ni konfigurowalny okienkowy manager plików u¿ywaj±cy GTK+).

  <p>Od linii 12. zaczyna siê d³u¿szy opis pakietu. Powinien to byæ akapit
  z wiêksz± liczb± szczegó³ów na temat pakietu. Pierwsza kolumna ka¿dej linii
  d³ugiego opisu powinna byæ pusta. Poniewa¿ opis ten nie mo¿e zawieraæ pustych
  linii, wszêdzie tam gdzie chcia³by¶ je wstawiæ, musisz umie¶ciæ znak .
  (kropka) w kolumnie nr 2. Tak¿e na koñcu d³ugiego opisu nie mo¿e siê pojawiæ
  wiêcej ni¿ jedna pusta linia.

  <p>A oto koñcowa postaæ uaktualnionego pliku `control':

  <p><example>
  1  Source: gentoo
  2  Section: x11
  3  Priority: optional
  4  Maintainer: Josip Rodin &lt;joy-mg@debian.org&gt;
  5  Build-Depends: debhelper (>> 3.0.0), xlibs-dev, libgtk1.2-dev, libglib1.2-dev
  6  Standards-Version: 3.5.2
  7
  8  Package: gentoo
  9  Architecture: any
  10 Depends: ${shlibs:Depends}
  11 Suggests: file
  12 Description: fully GUI configurable X file manager using GTK+
  13  gentoo is a file manager for Linux written from scratch in pure C. It
  14  uses the GTK+ toolkit for all of its interface needs. gentoo provides
  15  100% GUI configurability; no need to edit config files by hand and re-
  16  start the program. gentoo supports identifying the type of various
  17  files (using extension, regular expressions, or the 'file' command),
  18  and can display files of different types with different colors and icons.
  19  .
  20  gentoo borrows some of its look and feel from the classic Amiga file
  21  manager "Directory OPUS" (written by Jonathan Potter).
  </example>
  (numery linii zosta³y dodane przeze mnie)

  <sect id="copyright">Plik `copyright'

  <p>Plik ten zawiera informacje o zewnêtrznych (ang. upstream) zasobach pakietu,
  prawach autorskich i licencji. Jego format nie jest narzucony przez Politykê
  Debiana, ale jego zawarto¶æ ju¿ tak (zobacz sekcjê 12.6 "Informacje o prawach
  autorskich").

  <p>Program dh_make stworzy³ ju¿ domy¶lny plik, którego zawarto¶æ jest
  podobna do tej poni¿ej:

  <p><example>
  1  This package was debianized by Josip Rodin &lt;joy-mg@debian.org&gt; on
  2  Wed, 11 Nov 1998 21:02:14 +0100.
  3
  4  It was downloaded from &lt;fill in ftp site&gt;
  5
  6  Upstream Author(s): &lt;put author(s) name and email here&gt;
  7
  8  Copyright:
  9
  10 &lt;Must follow here&gt;
  </example>
  (numery linii zosta³y dodane przeze mnie)

  <p>Wa¿nymi rzeczami, które powiniene¶ dodaæ do tego pliku, jest miejsce,
  z którego pobra³e¶ pakiet ze ¼ród³ami oraz informacje o prawach autorskich
  i licencji. Musisz do³±czyæ kompletn± tre¶æ licencji, chyba ¿e jest to jedna
  z popularnych licencji wolnego oprogramowania, takich jak GNU GPL czy LGPL,
  BSD lub licencja Artystyczna. W takiej sytuacji mo¿esz po prostu odes³aæ do
  odpowiedniego pliku w katalogu /usr/share/common-licenses/, który wystêpuje
  w ka¿dym systemie Debian.

  <p>Poni¿ej pokazano w skrócie, jak powinien wygl±daæ plik `copyright' dla
  programu gentoo:

  <p><example>
  1  This package was debianized by Josip Rodin &lt;joy-mg@debian.org&gt; on
  2  Wed, 11 Nov 1998 21:02:14 +0100.
  3
  4  It was downloaded from: ftp://ftp.obsession.se/gentoo/
  5
  6  Upstream author: Emil Brink &lt;emil@obsession.se&gt;
  7
  8  This software is copyright (c) 1998-99 by Emil Brink, Obsession
  9  Development.
  10
  11 You are free to distribute this software under the terms of
  12 the GNU General Public License  either version 2 of the License,
  13 or (at your option) any later version.
  14 On Debian systems, the complete text of the GNU General Public
  15 License can be found in the file `/usr/share/common-licenses/GPL-2'.
  </example>
  (numery linii zosta³y dodane przeze mnie)

  <p>Prosimy postêpowaæ zgodnie z plikiem HOWTO z listy debian-devel-announce:
  <url id="&copyright-howto;">.

  <sect id="changelog">Plik `changelog'

  <p>Jest plikiem wymaganym, którego format opisano w Polityce
  Debiana (sekcja 4.4 "debian/changelog"). Format ten jest wykorzystywany przez
  dpkg i inne programy do uzyskiwania informacji o numerze wersji, numerze rewizji
  (poprawki), dystrybucji i pilno¶ci Twojego pakietu.

  <p>Jest on tak¿e wa¿ny dla Ciebie, poniewa¿ dobrze jest mieæ udokumentowane
  wszystkie zmiany, których dokona³e¶. Pomaga to ludziom pobieraj±cym Twój pakiet
  zorientowaæ siê, czy nie zrobi³e¶ z pakietem czego¶, o czym powinni oni
  wiedzieæ. Zmiany te zostan± zapisane do pliku
  `/usr/share/doc/gentoo/changelog.Debian.gz' w pakiecie binarnym.

  <p>Program dh_make równie¿ tworzy ten plik, którego zawarto¶æ wygl±da mniej
  wiêcej tak:

  <p><example>
  1  gentoo (0.9.12-1) unstable; urgency=low
  2
  3   * Initial Release.
  4
  5  -- Josip Rodin &lt;joy-mg@debian.org&gt;  Wed, 11 Nov 1998 21:02:14 +0100
  6
  </example>
  (numery linii zosta³y dodane przeze mnie)

  <p>Linia 1. zawiera nazwê pakietu, wersjê, dystrybucjê i pilno¶æ.
  Nazwa musi siê zgadzaæ z nazw± pakietu ¼ród³owego, dystrybucja powinna mieæ
  warto¶æ albo `unstable' (albo nawet `experimental'), za¶ pilno¶ci nie
  powiniene¶ zmieniaæ na warto¶æ wiêksz± ni¿ `low' (niska). :-)

  <p>Linie 3-5 to wpisy dziennika, w którym dokumentujesz zmiany dokonane w
  ka¿dej z poprawek pakietu (ale nie zmiany zewnêtrzne - do tego celu s³u¿y
  specjalny plik stworzony przez autorów programu, który pó¼niej zainstalujesz
  jako /usr/share/doc/gentoo/changelog.gz). Nowe linie musz± byæ umieszczone
  przed znajduj±c± siê na górze lini±, która rozpoczyna siê od gwiazdki (`*').
  Mo¿esz to zrobiæ przy pomocy <manref name="dch" section="1"> lub u¿ywaj±c
  jakiego¶ edytora tekstu.

  <p>Poprawiony bêdzie wygl±da³ jako¶ tak:

  <p><example>
  1  gentoo (0.9.12-1) unstable; urgency=low
  2
  3   * Initial Release.
  4   * This is my first Debian package.
  5   * Adjusted the Makefile to fix $DESTDIR problems.
  6
  7  -- Josip Rodin &lt;joy-mg@debian.org&gt; Wed, 11 Nov 1998 21:02:14 +0100
  8
  </example>
  (numery linii zosta³y dodane przeze mnie)

  <p>Wiêcej na temat pliku `changelog' bedziesz móg³ przeczytaæ dalej
  w rozdziale <ref id="update">.

  <sect id="rules">Plik `rules'

  <p>Teraz musimy siê przyjrzeæ regu³om (ang. rules), których u¿yje program
  <manref name="dpkg-buildpackage" section="1"> do zbudowania naszego pakietu.
  Plik ten jest w³a¶ciwie odmian± pliku Makefile, lecz ró¿ni siê od tego/tych
  z programu ¼ród³owego. Inaczej ni¿ pozosta³e pliki znajduj±ce siê
  w katalogu debian/, ma on ustawiony atrybut wykonywalno¶ci.

  <p>Ka¿dy plik `rules', tak samo jak inne pliki Makefile, zawiera ró¿ne regu³y,
  które okre¶laj±, jak postêpowaæ ze ¼ród³em. Ka¿da regu³a z kolei zawiera
  cele (targets), czyli nazwy plików b±d¼ akcji, które powinny byæ stworzone
  lub wykonane (na przyk³ad `build:' lub `install:'). Regu³y, które chcesz
  wykonaæ s± wywo³ywane z linii komend jako argumenty poleceñ (dla przyk³adu
  `./debian/rules build` albo `make -f rules install`). Po nazwie celu mo¿esz
  wymieniæ zale¿no¶æ, program lub plik, który od tej regu³y zale¿y. W kolejnych
  liniach mo¿na wymieniæ dowoln± liczbê komend, rozpoczynaj±c je od znaku
  &lt;tab&gt;. Nowa regu³a zaczyna siê od deklaracji w pierwszej kolumnie.
  Puste linie i linie rozpoczynaj±ce siê od znaku `#' (hash) s± traktowane
  jako komentarz i ignorowane.

  <p>Pewnie jeste¶ teraz nieco zagubiony, ale wszystko stanie siê jasne w
  czasie przegl±dania pliku `rules', który domy¶lnie jest tworzony przez
  program dh_make. Powiniene¶ te¿ przeczytaæ o programie `make' (poprzez
  `info make'), aby uzyskaæ wiêcej informacji na jego temat.

  <p>Wa¿ne jest, aby pamiêtaæ, ¿e plik `rules' tworzony przez dh_make jest
  tylko propozycj±. Dzia³a on z prostymi pakietami, ale w przypadku
  bardziej skomplikowanych nie obawiaj siê go modyfikowaæ, zale¿nie od
  potrzeb. Jedyn± rzecz±, której nie mo¿esz zmieniaæ to nazwy regu³, gdy¿
  u¿ywaj± ich wszystkie narzêdzia, zgodnie z wytycznymi zawartymi
  w Polityce Debiana.

  <p>Poni¿ej pokazano przyk³adowy domy¶lny plik debian/rules, który zosta³
  wygenerowany przez program dh_make:

  <p><example>
  1  #!/usr/bin/make -f
  2  # Sample debian/rules that uses debhelper.
  3  # GNU copyright 1997 to 1999 by Joey Hess.
  4
  5  # Uncomment this to turn on verbose mode.
  6  #export DH_VERBOSE=1
  7
  8  # This is the debhelper compatibility version to use.
  9  export DH_COMPAT=4
  10 
  11 CFLAGS = -g
  12 ifneq (,$(findstring noopt,$(DEB_BUILD_OPTIONS)))
  13 CFLAGS += -O0
  14 else
  15 CFLAGS += -O2
  16 endif
  17
  18 build: build-stamp
  19 build-stamp:
  20        dh_testdir
  21
  22        # Add here commands to compile the package.
  23        $(MAKE)
  24        #docbook-to-man debian/gentoo.sgml > gentoo.1
  25
  26        touch build-stamp
  27
  28 clean:
  29        dh_testdir
  30        dh_testroot
  31        rm -f build-stamp
  32
  33        # Add here commands to clean up after the build process.
  34        -$(MAKE) clean
  35
  36        dh_clean
  37
  38 install: build
  39        dh_testdir
  40        dh_testroot
  41        dh_clean -k
  42        dh_installdirs
  43
  44        # Add here commands to install the package into debian/gentoo.
  45        $(MAKE) install DESTDIR=$(CURDIR)/debian/gentoo
  46
  47 # Build architecture-independent files here.
  48 binary-indep: build install
  49 # We have nothing to do by default.
  50
  51 # Build architecture-dependent files here.
  52 binary-arch: build install
  53        dh_testdir
  54        dh_testroot
  55 #      dh_installdebconf
  56        dh_installdocs
  57        dh_installexamples
  58        dh_installmenu
  59 #      dh_installlogrotate
  60 #      dh_installemacsen
  61 #      dh_installpam
  62 #      dh_installmime
  63 #      dh_installinit
  64        dh_installcron
  65        dh_installman
  66        dh_installinfo
  67 #      dh_undocumented
  68        dh_installchangelogs ChangeLog
  69        dh_link
  70        dh_strip
  71        dh_compress
  72        dh_fixperms
  73 #      dh_makeshlibs
  74        dh_installdeb
  75 #      dh_perl
  76        dh_shlibdeps
  77        dh_gencontrol
  78        dh_md5sums
  79        dh_builddeb
  80
  81 binary: binary-indep binary-arch
  82 .PHONY: build clean binary-indep binary-arch binary install
  </example>
  (numery linii zosta³y dodane przeze mnie; w rzeczywistym pliku
  <file>debian/rules</file> wiod±ce bia³e znaki s± tabulatorami)

  <p>Z liniami takimi jak linia nr 1 prawdopodobnie spotka³e¶ siê ju¿
  w skryptach pow³oki albo Perla. Mówi ona systemowi operacyjnemu, ¿e plik
  ten ma byæ przetwarzany przez program `/usr/bin/make'.

  <p>Znaczenie zmiennych DH_*, których u¿yto w liniach 6. i 9. powinno byæ
  zrozumia³e dziêki krótkiemu opisowi. Wiêcej informacji na temat zmiennej
  DH_COMPAT znajdziesz w sekcji "Debhelper compatibility levels" na stronie
  podrêcznika programu <manref name="debhelper" section="1">.

  <p>Linie 11-16 to szablon obs³uguj±cy parametry DEB_BUILD_OPTIONS,
  które opisano w Polityce Debiana (sekcja 10.1 "Binaries"). Po prostu mówi±
  one, czy w binaria maj± byæ wbudowane symbole s³u¿±ce do odpluskwiania
  (ang. debugging) i czy powinny one byæ usuniête przy instalacji. I znów:
  to jest tylko szablon, wskazówka, któr± powinine¶ uwzglêdniæ. Powiniene¶
  sprawdziæ, w jaki sposób autor programu obs³uguje w³±czanie symboli
  odpluskwiaj±cych oraz usuwanie ich po instalacji i zaimplementowaæ to samemu.

  <p>Zwykle mo¿esz nakazaæ kompilatorowi gcc u¿ycie opcji "-g" przy pomocy
  zmiennej CFLAGS. Je¶li tak jest w przypadku Twojego pakietu, przeka¿ warto¶æ
  tej zmiennej przez <em>dodanie</em> ³añcucha <tt>CFLAGS="$(CFLAGS)"</tt> do
  wywo³ania $(MAKE) w regule `build' (zobacz poni¿ej). Je¶li za¶ Twój pakiet
  u¿ywa skryptu konfiguracyjnego autoconfa, to mo¿esz zmodyfikowaæ konfiguracjê
  przez <em>poprzedzenie</em> powy¿szym ³añcuchem wywo³ania skryptu ./configure
  w regule `build'.

  <p>Je¶li chodzi o pozbywanie siê symboli odpluskwiaj±cych, to programy s±
  na ogó³ tak skonfigurowane, ¿e instaluj± siê z nimi i czêsto nie maj± opcji
  umo¿liwiaj±cej zmianê tego stanu. Na szczê¶cie mamy program
  <manref name="dh_strip" section="1">, który wykryje, gdy ustawiona jest
  opcja DEB_BUILD_OPTIONS=nostrip i zakoñczy swe dzia³anie.

  <p>Linie 18-26 opisuj± regu³ê `build' (i jej regu³ê potomn± `build-stamp'),
  która uruchamia program make na oryginalnym pliku Makefile aplikacji,
  aby skompilowaæ program. Je¶li pakiet u¿ywa narzêdzi konfiguruj±cych
  GNU do zbudowania binariów, koniecznie przeczytaj <file>&autotools-dev;</file>.
  O zakomentowanym przyk³adzie docbook-to-man opowiemy dalej w
  rozdziale <ref id="manpage">.

  <p>Regu³a `clean' zawarta w liniach 28-36 czy¶ci wszystkie
  niepotrzebne pliki binarne i automatycznie wygenerowane rzeczy,
  które zosta³y po zbudowaniu pakietu. Regu³a ta musi dzia³aæ przez ca³y czas
  (nawet, gdy drzewo ze ¼ród³ami <em>jest</em> wyczyszczone!), zatem prosimy
  u¿ywaæ opcji wymuszaj±cej (na przyk³ad dla polecenia rm jest ni± opcja `-f')
  lub ignoruj±cej zwracane warto¶ci (b³êdy) poprzez zastosowanie `-' przed
  poleceniem.

  <p>Regu³a `install', która odpowiada za proces instalacji, rozpoczyna siê
  w linii nr 38. Uruchamia ona po prostu regu³ê `install' z pliku Makefile
  programu i instaluje go w katalogu <tt>$(CURDIR)/debian/gentoo</tt> -
  oto dlaczego okre¶lili¶my zmienn± $(DESTDIR) jako katalog bazowy
  instalacji w pliku Makefile programu gentoo.

  <p>Jak t³umaczy komentarz, regu³a `binary-indep', która znajduje siê
  w linii 48., jest u¿ywana do budowania pakietów niezale¿nych od architektury
  procesora. Je¶li nie mamy takiego pakietu, ¿adna akcja nie zostanie
  przedsiêwziêta.

  <p>Nastêpn± regu³± jest `binary-arch' znajduj±ca siê w liniach 52-79.
  Uruchamia ona kilka ma³ych programów narzêdziowych z pakietu debhelper,
  które wykonuj± ró¿ne operacje z plikami pakietu, aby uczyniæ go
  zgodnym z Polityk± Debiana.

  <p>Gdy okre¶li³e¶ architekturê Twojego pakietu jako `Architecture: all',
  bêdziesz musia³ umie¶ciæ w tej regule wszystkie komendy do budowania
  pakietu i pozostawiæ pust± regu³ê `binary-arch'.

  <p>Nazwy programów wchodz±cych w sk³ad pakietu debhelper rozpoczynaj± siê
  od dh_. Reszta jest opisem tego, co dane narzêdzie robi. Mimo, ¿e do¶æ dobrze
  same siê one obja¶niaj±, poni¿ej zamieszczono dodatkowe opisy:

  <list>

  <item><manref name="dh_testdir" section="1"> sprawdza, czy jeste¶ we w³a¶ciwym
      katalogu (tzn. na samej górze katalogu ze ¼ród³ami)
  <item><manref name="dh_testroot" section="1"> sprawdza, czy masz uprawnienia
      administratora systemu, których wymagaj± cele `binary-arch',
      `binary-indep' i `clean'
  <item><manref name="dh_installman" section="1"> kopiuje strony podrêcznika
      systemowego we w³a¶ciwe miejsce w katalogu przeznaczenia. Musisz tylko
      powiedzieæ, gdzie one siê znajduj±, wzglêdem g³ównego katalagu ze
      ¼ród³ami
  <item><manref name="dh_strip" section="1"> usuwa z plików wykonywalnych
      i bibliotek nag³ówki s³u¿±ce do odpluskwiania, aby uczyniæ je
      mniejszymi
  <item><manref name="dh_compress" section="1"> pakuje programem
      <manref name="gzip" section="1"> strony podrêcznika i dokumentacjê
      wiêksz± ni¿ 4 kB
  <item><manref name="dh_installdeb" section="1"> kopiuje pliki zwi±zane
      z pakietem (na przyk³ad skrypty opiekuna) do katalogu
      <file>debian/gentoo/DEBIAN</file>
  <item><manref name="dh_shlibdeps" section="1"> wylicza zale¿no¶ci bibliotek
      i plików wykonywalnych od bibliotek wspó³dzielonych
  <item><manref name="dh_gencontrol" section="1"> instaluje finaln± wersjê
      pliku `control' w katalogu <file>debian/gentoo/DEBIAN</file>
  <item><manref name="dh_md5sums" section="1"> generuje sumy kontrolne MD5 dla
      ka¿dego pliku zawartego w pakiecie
  </list>

  <p>Pe³niejsze informacje na temat dzia³ania ka¿dego ze skryptów dh_* i ich
  parametrów wywo³ania znajdziesz na odpowiednich stronach podrêcznika.
  Oprócz powy¿szych istniej± równie¿ inne u¿yteczne skrypty dh_*,
  które nie zosta³y tu wspomniane. Je¶li s± potrzebne, czytaj dokumentacjê
  do pakietu debhelper.

  <p>W sekcji `binary-arch' powiniene¶ wykomentowaæ lub usun±æ linie z tymi
  skryptami dh_*, których nie chcesz wywo³ywaæ. Dla pakietu gentoo
  wykomentowa³em wywo³anie skryptów examples, cron, init, man i info, gdy¿
  gentoo ich po prostu nie u¿ywa. W linii 68. zamieni³em `ChangeLog'
  na `FIXES', poniewa¿ jest to rzeczywista nazwa autorskiego pliku z
  dziennikiem zmian.

  <p>Dwie ostatnie linie (i pozosta³e nie opisane tutaj) s± mniej lub
  bardziej niezbêdne. Na ich temat mo¿esz poczytaæ na stronie podrêcznika do
  programu make oraz w Polityce Debiana. W tym momencie s± na tyle
  ma³o wa¿ne, ¿e nie bêdziemy ich opisywaæ.

  <!-- -------------------------------------------------------------------------->

  <chapt id="dother">Inne pliki z katalogu debian/

  <p>Jak zobaczysz, w katalogu debian/ znajduj± siê jeszcze ró¿ne inne pliki,
  wiêkszo¶æ z nich koñczy siê przyrostkiem `.ex', oznaczaj±cym, ¿e s± to
  przyk³ady. Przyjrzyj siê im wszystkim. Je¶li chcesz lub musisz u¿yæ
  której¶ z ich funkcjonalno¶ci, to:

  <list>
    <item>zajrzyj do odpowiedniej dokumentacji (wskazówka: podrêcznik Polityki
      Debiana)
    <item>je¶li to konieczne, zmodyfikuj zawarto¶æ plików wed³ug potrzeb
    <item>usuñ z ich nazwy przyrostek `.ex', je¶li taki posiadaj±
    <item>usuñ z ich nazwy przedrostek `ex.', je¶li taki posiadaj±
    <item>zmodyfikuj plik `rules' wed³ug potrzeb
  </list>

  <p>Niektóre z tych plików, najczê¶ciej u¿ywane, s± obja¶nione w poni¿szych
  sekcjach.

  <sect id="readme">Plik `README.Debian'

  <p>W tym pliku powinny byæ udokumentowane dodatkowe szczegó³y lub
  rozbie¿no¶ci pomiêdzy oryginalnym pakietem i Twoj± "zdebianizowan±" wersj±.

  <p>Program dh_make tworzy domy¶lny plik README.Debian, który wygl±da jako¶ tak:

  <p><example>
  gentoo for Debian
  -----------------

  &lt;possible notes regarding this package - if none, delete this file&gt;

   -- Josip Rodin &lt;joy-mg@debian.org&gt;, Wed, 11 Nov 1998 21:02:14 +0100
  </example>

  <p>Poniewa¿ nie musimy niczego umieszczaæ w tym pliku, mo¿emy go skasowaæ.

  <sect id="conffiles">Plik `conffiles.ex'

  <p>Jedn± z najbardziej irytuj±cych rzeczy zwi±zanych z oprogramowaniem jest
  to, ¿e po po¶wiêceniu du¿ej ilo¶ci czasu i wysi³ku na dostosowanie programu,
  jego aktualizacja wszystko "zadeptuje". Debian rozwi±za³ ten problem przez
  znakowanie plików konfiguracyjnych. Zatem je¶li uaktualniasz program do
  nowszej wersji, to zostaniesz zapytany o to, czy chcesz zachowaæ swoj± star±
  konfiguracjê, czy nie.

  <p>Aby to uzyskaæ, musisz wprowadziæ pe³n± ¶cie¿kê do ka¿dego pliku
  konfiguracyjnego (zwykle znajduj± siê w katalogu /etc), jednego w
  ka¿dej linii, w pliku nazwanym <tt/conffiles/. Program gentoo ma jeden
  plik konfiguracyjny, /etc/gentoorc, zatem podamy ¶cie¿kê do
  niego w pliku <tt/conffiles/.

  <p>Je¶li Twój program u¿ywa plików konfiguracyjnych, ale sam zmienia ich
  zawarto¶æ, to najlepiej bêdzie nie umieszczaæ ich w pliku <tt/conffiles/,
  poniewa¿ program dpkg bêdzie za ka¿dym razem prosi³ u¿ytkowników o
  weryfikacjê zmian.

  <p>Je¶li program, który pakujesz, wymaga od ka¿dego u¿ytkownika
  modyfikacji pliku konfiguracyjnego, aby w ogóle zadzia³aæ, to równie¿
  powiniene¶ zrezygnowaæ z umieszczania go w pliku <tt>conffiles</tt>.

  <p>Przyk³adowe pliki konfiguracyjne mo¿esz znale¼æ w `skryptach opiekuna
  pakietu'. Wiêcej szczegó³ów na ich temat zamieszczono w sekcji
  <ref id="maintscripts">.

  <p>Je¶li Twój program nie posiada plików konfiguracyjnych, to mo¿esz
  bez obaw wykasowaæ plik <tt/conffiles/ z katalogu debian/.

  <sect id="crond">Plik `cron.d.ex'

  <p>Je¶li Twój pakiet do prawid³owego dzia³ania wymaga regularnie wykonywanych
  zadañ, to mo¿esz do tego celu wykorzystaæ w³a¶nie plik <tt/cron.d/.

  <p>Zwróæ uwagê, ¿e to nie obejmuje zagadnieñ zwi±zanych z rotacj± plików
  logów. Wiêcej informacji na ten temat znajdziesz na stronach podrêcznika
  <manref name="dh_installlogrotate" section="1"> i <manref name="logrotate"
  section="8">.

  <p>Je¶li nie potrzebujesz tego pliku, usuñ go.

  <sect id="dirs">Plik `dirs'

  <p>Plik ten okre¶la katalogi, które s± potrzebne, ale których normalna
  procedura instalacyjna (make install) nie tworzy.

  <p>Domy¶lnie plik ten wygl±da nastêpuj±co:

  <p><example>
  usr/bin
  usr/sbin
  </example>

  <p>Zwróæ uwagê, i¿ przed nazwami katalogów nie wystêpuj± znaki uko¶ników
  (`/'). Normalnie zmieniliby¶my go w nastêpuj±cy sposób:

  <p><example>
  usr/bin
  usr/man/man1
  </example>

  <p>ale poniewa¿ katalogi te s± tworzone przez Makefile, to nie
  potrzebujemy pliku `dirs' i mo¿emy go usun±æ.

  <sect id="docs">Plik `docs'

  <p>Ten plik okre¶la nazwy plików z dokumentacj±, któr± program dh_installdocs
  zainstaluje w tymczasowym katalogu.

  <p>Domy¶lnie obejmuje to tak¿e pliki istniej±ce ju¿ w katalogu g³ównym ze ¼ród³ami
  programu, takie jak "BUGS", "README*", "TODO" itp.

  <p>Dla programu gentoo do³±czy³em równie¿ inne pliki:

  <p><example>
  BUGS
  CONFIG-CHANGES
  CREDITS
  ONEWS
  README
  README.gtkrc
  TODO
  </example>

  <p>Mo¿emy te¿ usun±æ ten plik i, zamiast podawaæ listê plików, u¿yæ
  ich nazw jako argumentów wej¶ciowych dla programu <tt/dh_installdocs/
  wywo³ywanego w pliku <tt/rules/:

  <p><example>
        dh_installdocs BUGS CONFIG-CHANGES CREDITS ONEWS README \
                       README.gtkrc TODO
  </example>

  <p>Mo¿e siê tak zdarzyæ, ¿e nie bêdziesz mieæ ¿adnego z tych plików w ¼ród³ach
  Twojego pakietu. W takim przypadku mo¿esz bezpiecznie usun±æ plik <tt/docs/.
  Nie usuwaj jednak wywo³ania programu <tt/dh_installdocs/ z pliku <tt/rules/,
  poniewa¿ jest on u¿ywany równie¿ do instalacji pliku <tt/copyright/ i
  innych rzeczy.

  <sect id="emacsen">Plik `emacsen-*.ex'

  <p>Je¶li Twój pakiet zawiera pliki Emacsa, które mog± byæ skompilowane do
  kodu bajtowego w czasie instalacji, to mo¿esz u¿yæ tych plików w³a¶nie w tym
  celu.

  <p>Pliki te s± instalowane w katalogu tymczasowym przez program
  <manref name="dh_installemacsen" section="1">, zatem je¶li chcesz go wywo³aæ,
  nie zapomnij odkomentowaæ odpowiedniej linii w pliku <tt/rules/.

  <p>Je¶li za¶ nie potrzebujesz tych plików, mo¿esz je usun±æ.

  <sect id="initd">Plik `init.d.ex'

  <p>Je¶li Twój pakiet jest demonem, który musi byæ uruchamiany w czasie startu
  systemu, to znaczy, ¿e nie pos³ucha³e¶ moich zaleceñ we wstêpie do tego
  podrêcznika, nieprawda¿? :-)

  <p>Plik ten jest prostym szablonem skryptu umieszczanego w katalogu
  <file>/etc/init.d/</file>, zatem bêdziesz musia³ znacznie go przerobiæ.
  Zostanie on zainstalowany w katalogu tymczasowym przez program
  <manref name="dh_installinit" section="1">.

  <p>Je¶li nie potrzebujesz tego pliku, usuñ go.

  <sect id="manpage">Pliki `manpage.1.ex', `manpage.sgml.ex'

  <p>Twój program(y) powinien mieæ stronê podrêcznika systemowego.
  Je¶li jeszcze jej nie ma, to mo¿esz u¿yæ tych plików jako szablonów.

  <p>Strony podrêcznika s± zwykle napisane w formacie <manref name="nroff"
  section="1">. W formacie tym napisano w³a¶nie przyk³adowy plik
  <tt/manpage.1.ex/. Zobacz stronê podrêcznika programu <manref name="man"
  section="7">, jest tam krótki opis, jak poprawiaæ tego typu pliki.

  <p>Je¶li zamiast formatu nroff wolisz pisaæ dokumenty w formacie SGML,
  to mo¿esz wykorzystaæ szablon <tt/manpage.sgml.ex/. W takim przypadku
  musisz:

  <list>
    <item>zainstalowaæ pakiet <package/docbook-to-man/
    <item>dopisaæ <tt/docbook-to-man/ do linii <tt/Build-Depends/ w pliku
          <tt/control/
    <item>usun±æ znak komentarza przed wywo³aniem programu docbook-to-man
      w regule `build' pliku <tt/rules/
  </list>

  <p>Pamiêtaj o zmianie nazwy pliku na co¶ w stylu <tt/gentoo.sgml/!

  <p>Docelowa nazwa pliku ze stron± podrêcznika systemowego powinna zawieraæ nazwê
  programu, który opisuje, zatem zmieñ j± z "manpage" na "gentoo".
  Nazwa tego pliku zawiera tak¿e przyrostek ".1", który mówi, ¿e jest to
  strona z sekcji poleceñ u¿ytkownika. Upewnij siê, do której sekcji powinna
  nale¿eæ strona Twojego pakietu. Poni¿ej zamieszczono krótk± listê sekcji
  podrêcznika:

  <p><example>
  Sekcja |        Opis          |          Uwagi
     1    Polecenia u¿ytkownika   Wykonywalne komendy lub skrypty.
     2    Wywo³ania systemowe     Funkcje j±dra systemu.
     3    Wywo³ania biblioteczne  Funkcje bibliotek systemowych.
     4    Pliki specjalne         Zwykle umieszczone w katalogu /dev.
     5    Formaty plików          Na przyk³ad format pliku /etc/passwd.
     6    Gry                     Lub inne programy rozrywkowe.
     7    Pakiety makr            Takie jak makra programu man.
     8    Administracja systemem  Programy zwykle uruchamiane tylko przez administratora.
     9    Procedury j±dra         Niestandardowe wywo³ania i procedury wewnêtrzne.
  </example>

  <p>Zatem podrêcznik programu gentoo powinien nazywaæ siê <tt/gentoo.1/.
  Dla programów przeznaczonych dla systemu X11 mo¿esz dodaæ "x" do numeru
  sekcji, na przyk³ad <tt/gentoo.1x/. Poniewa¿ w oryginalnych ¼ród³ach nie by³o
  strony podrêcznika `gentoo.1', napisa³em j± sam, u¿ywaj±c informacji
  znalezionych w przyk³adach i dokumentacji do³±czonej do ¼róde³.

  <sect id="menu">Plik `menu.ex'

  <p>U¿ytkownicy systemu X Window zwykle pos³uguj± siê menad¿erami okien,
  umo¿liwiaj±cymi uruchamianie programów poprzez rozwijalne menu, które mo¿na
  dostosowywaæ do w³asnych potrzeb. Je¶li zainstalowali oni pakiet
  <package/menu/, to zostanie utworzony zestaw menu s³u¿±cy do
  uruchamiania programów w systemie.

  <p>Poni¿ej pokazano plik <tt/menu.ex/, domy¶lnie utworzony przez program
  dh_make:

  <p><example>
  ?package(gentoo):needs="X11|text|vc|wm" section="Apps/see-menu-manual"\
    title="gentoo" command="/usr/bin/gentoo"
  </example>

  <p>Pierwszym polem po znaku dwukropka jest pole "needs", które okre¶la,
  jakiego rodzaju interfejsu wymaga program. Zmieñ je na jedn± z wymienionych
  mo¿liwo¶ci, na przyk³ad "text" lub "X11".

  <p>Nastêpnym polem jest "section", które mówi, w jakim menu i podmenu powinien
  znale¼æ siê wpis z programem gentoo. Aktualn± listê sekcji mo¿na znale¼æ na
  stronie <file>/usr/share/doc/debian-policy/menu-policy.html/ch2.html#s2.1</file>.

  <p>Pole "title" to nazwa programu. Je¶li chcesz, mo¿esz rozpocz±æ
  j± od wielkiej litery. Powinna byæ krótka.

  <p>Wreszcie pole "command" to nazwa polecenia, które uruchamia program.

  <p>Po zmianach wpis do menu wygl±da nastêpuj±co:

  <p><example>
  ?package(gentoo): needs="X11" section="Apps/Tools" title="Gentoo" command="gentoo"
  </example>

  <p>Mo¿esz równie¿ dodaæ inne pola, na przyk³ad "longtitle", "icon",
  "hints" itd. Wiêcej informacji mo¿esz znale¼æ na stronach podrêcznika
  <manref name="menufile" section="5">, <manref name="update-menus"
  section="1"> i w katalogu /usr/share/doc/debian-policy/menu-policy.html/.

  <sect id="watch">Plik `watch.ex'

  <p>Plik ten jest u¿ywany do konfigurowania programów <manref name="uscan"
  section="1"> i <manref name="uupdate" section="1"> (zawartych w pakiecie
  <package/devscripts/). S± one u¿ywane do sprawdzania strony internetowej,
  z której pobra³e¶ ¼ród³a dla swojego pakietu.

  <p>W tym pliku umie¶ci³em:

  <p><example>
# watch control file for uscan
# Site            Directory  Pattern               Version  Script
ftp.obsession.se  /gentoo    gentoo-(.*)\.tar\.gz  debian   uupdate
  </example>

  <p>Wskazówka: po³±cz siê z internetem i spróbuj uruchomiæ program "uscan"
  w katalogu, w którym stworzy³e¶ plik `watch'. I czytaj strony
  podrêczników! :)

  <sect id="doc-base">Plik `ex.package.doc-base'

  <p>Je¶li Twój pakiet ma dokumentacjê w postaci innej ni¿ strony podrêcznika
  i dokumentacja przegl±dana za pomoc± programu "info", to powiniene¶ u¿yæ
  pliku `<package/doc-base/', aby j± zarejestrowaæ. U¿ytkownik bêdzie
  móg³ j± wtedy znale¼æ, na przyk³ad za pomoc± <manref name="dhelp" section="1">,
  <manref name="dwww" section="1"> lub <manref name="doccentral" section="1">.

  <p>Na ogó³ obejmuje to pliki HTML, PS i PDF umieszczone w katalogu
  <file>/usr/share/doc/nazwa_pakietu/</file>.

  <p>Plik <tt>gentoo.doc-base</tt> dla programu gentoo wygl±da nastêpuj±co:

  <p><example>
  Document: gentoo
  Title: Gentoo Manual
  Author: Emil Brink
  Abstract: This manual describes what Gentoo is, and how it can be used.
  Section: Apps/Tools

  Format: HTML
  Index: /usr/share/doc/gentoo/html/index.html
  Files: /usr/share/doc/gentoo/html/*.html
  </example>

  <p>Informacje na temat formatu tego pliku znajdziesz na stronie podrêcznika
  <manref name="install-docs" section="8"> oraz w podrêczniku <package/doc-base/
  (katalog <file>/usr/share/doc/doc-base/doc-base.html/</file>).

  <p>Wiêcej szczegó³ów nt. instalowania dokumentacji w sekcji <ref id="destdir">.

  <sect id="maintscripts">postinst.ex, preinst.ex, postrm.ex, prerm.ex

  <p>Pliki te s± nazywane skryptami opiekuna. Umieszczone s± one w obszarze
  kontrolnym pakietu i uruchamiane przez program <prgn/dpkg/, gdy Twój pakiet
  jest instalowany, uaktualniany do nowszej wersji lub usuwany.

  <p>Na razie powiniene¶ unikaæ rêcznych modyfikacji tych skryptów,
  poniewa¿ czêsto s± one skomplikowane. Wiêcej informacji znajdziesz
  w podrêczniku Polityki Debiana, w rozdziale 6. Zerknij tak¿e na przyk³adowe
  pliki wygenerowane przez program dh_make.

  <!-- -------------------------------------------------------------------------->

  <chapt id="build">Budowanie pakietu

  <p>Teraz ju¿ powinni¶my byæ gotowi do zbudowania pakietu.

  <sect id="completebuild">Ca³kowita przebudowa

  <p>Wejd¼ do katalogu g³ównego programu i wydaj w nim polecenie:

  <p><example>
  dpkg-buildpackage -rfakeroot
  </example>

  <p>Wykona ono wszystko, to znaczy:
  <list>
    <item>wyczy¶ci drzewo ¼róde³ programu (debian/rules clean) u¿ywaj±c programu <prgn/fakeroot/
    <item>zbuduje pakiet ¼ród³owy (dpkg-source -b)
    <item>zbuduje program (debian/rules build)
    <item>zbuduje pakiet binarny (debian/rules binary), u¿ywaj±c programu
      <prgn/fakeroot/
    <item>podpisze ¼ród³owy plik <tt/.dsc/, u¿ywaj±c programu <prgn/gnupg/
    <item>utworzy i podpisze umieszczany w archiwum Debiana plik <tt/.changes/
      przy pomocy programów <prgn/dpkg-genchanges/ i <prgn/gnupg/
  </list>

  <p>Bêdziesz musia³ tylko dwukrotnie wprowadziæ has³o do Twojego prywatnego
  klucza GPG.

  <p>Po zakoñczeniu procesu zobaczysz nastêpuj±ce pliki w katalogu nadrzêdnym
  (<tt>~/gentoo/</tt>):

  <p><list>
  <item><em>gentoo_0.9.12.orig.tar.gz</em>

  <p>To archiwum z oryginalnym kodem ¼ród³owym programu. Jego nazwa zosta³a
  zmieniona w powy¿szy sposób, aby zachowaæ standard Debiana. Zwróæ uwagê,
  ¿e plik ten zosta³ utworzony przy u¿yciu opcji `-f' przez program
  <prgn/dh_make/, gdy na pocz±tku go uruchomili¶my.

  <item><em>gentoo_0.9.12-1.dsc</em>

  <p>To jest streszczenie zawarto¶ci kodu ¼ród³owego. Plik ten jest
  generowany na podstawie pliku `control' i u¿ywany w czasie rozpakowywania
  ¼ród³a przez program <manref name="dpkg-source" section="1">. Jest on
  podpisany cyfrowo, aby inni mogli byæ pewni, ¿e jest naprawdê Twój.

  <item><em>gentoo_0.9.12-1.diff.gz</em>

  <p>Ten plik jest skompresowany i zawiera wszystkie zmiany, których dokona³e¶
  w oryginalnym kodzie ¼ród³owym. Zmiany te s± zapisane w formacie znanym jako
  "unified diff". Plik jest utworzony i u¿ywany przez program
  <manref name="dpkg-source" section="1">. Uwaga: je¶li nie nazwa³e¶
  oryginalnego archiwum ze ¼ród³ami programu w sposób: nazwapakietu_wersja.orig.tar.gz,
  to program <prgn/dpkg-source/ nie wygeneruje poprawnego pliku .diff.gz!

  <p>Gdyby kto¶ jeszcze chcia³ ponownie utworzyæ Twój pakiet zaczynaj±c
  procedurê od pocz±tku, to mo¿e ³atwo to zrobiæ u¿ywaj±c trzech
  powy¿szych plików. Procedura postêpowania w takich przypadkach jest wrêcz
  banalna: po prostu nale¿y gdzie¶ skopiowaæ te trzy pliki i wydaæ komendê
  <tt>dpkg-source -x gentoo_0.9.12-1.dsc</tt>.

  <item><em>gentoo_0.9.12-1_i386.deb</em>

  <p>To kompletny pakiet binarny. Mo¿esz u¿yæ programu <prgn/dpkg/, aby
  zainstalowaæ go lub usun±æ w taki sam sposób, jak ka¿dy inny pakiet.

  <item><em>gentoo_0.9.12-1_i386.changes</em>

  <p>Plik ten opisuje wszystkie zmiany dokonane w obecnej poprawce pakietu.
  U¿ywaj± go programy obs³ugi archiwów FTP Debiana do zainstalowania
  pakietów binarnych i ¼ród³owych. Jest on czê¶ciowo generowany z plików
  `changelog' i .dsc. Plik ten jest podpisany cyfrowo, aby inni
  mogli byæ pewni, ¿e jest naprawdê Twój.

  <p>W czasie, gdy bêdziesz siê zajmowa³ pakietem, zmieni siê pewnie jego
  dzia³anie i dodane zostan± nowe funkcjonalno¶ci. Ludzie pobieraj±cy Twój
  pakiet mog± w tym pliku szybko zobaczyæ, co siê zmieni³o.
  Programy zarz±dzaj±ce archiwum Debiana wy¶l± równie¿ zawarto¶æ tego pliku
  na listê dyskusyjn± debian-devel-changes.
  </list>

  <p>D³ugie ³añcuchy liczb w plikach .dsc i .changes to sumy kontrolne MD5
  wspomnianych plików. Osoby pobieraj±ce Twoje pliki mog± sprawdziæ je
  u¿ywaj±c programu <manref name="md5sum" section="1"> i je¶li sumy nie bêd±
  siê zgadzaæ, bêd± wiedzieæ, ¿e plik jest uszkodzony lub zosta³ przez kogo¶
  zmieniony.

  <sect id="quickrebuild">Szybka przebudowa

  <p>Gdy masz du¿y pakiet, to mo¿esz nie chcieæ budowaæ go od nowa za ka¿dym
  razem, gdy zmienisz jaki¶ szczegó³ w pliku <file>debian/rules</file>.
  Dla celów testowych mo¿esz stworzyæ plik .deb bez przebudowywania
  ¼róde³ programu:

  <p><example>
  fakeroot debian/rules binary
  </example>

  <p>Gdy ju¿ zakoñczy³e¶ szlifowanie Twojego pakietu, pamiêtaj o
  przebudowaniu go zgodnie z powy¿sz±, pe³n± procedur±. Mo¿e Ci siê nie udaæ
  umie¶ciæ go w archiwum Debiana, gdy próbujesz zamie¶ciæ tam pliki .deb
  zbudowane w skrócony sposób.

  <sect id="debuild">Polecenie <prgn>debuild</prgn>

  <p>Mo¿esz zautomatyzowaæ proces budowania pakietu za pomoc± polecenia
  <prgn>debuild</prgn>. Zobacz <manref name="debuild" section="1">.

  <p>Mo¿na skonfigurowaæ dzia³anie programu debuild poprzez pliki
  <file>/etc/devscripts.conf</file> lub <file>~/.devscripts</file>.
  Chcia³bym zasugerowaæ co najmniej:

  <p><example>
  DEBSIGN_KEYID="Your_GPG_keyID"
  DEBUILD_DPKG_BUILDPACKAGE_OPTS="-i -ICVS -I.svn"
  </example>
  W ten sposób mo¿esz budowaæ pakiet zawsze ze swoim kluczem GPG i bez
  niepotrzebnych komponenetów (zw³asza pomocne przy sponsoringu). Przyk³adowo
  czyszczenie ¼róde³ i przebudowa pakietu z konta u¿ytkownika jest tak
  proste:

  <p><example>
  debuild clean
  debuild
  </example>

  <sect id="dpatch">Systemy <prgn>dpatch</prgn> i <prgn>quilt</prgn>

  <p>Proste u¿ycie <prgn>dh_make</prgn> i <prgn>dpkg-buildpackage</prgn>
  spowoduje utworzenie pojedynczego du¿ego pliku <file>diff.gz</file>,
  zawieraj±cego pliki obs³uguj±ce pakiet w katalogu <file>debian/</file>
  i plików ³at do ¼róde³. Taki pakiet jest uci±¿liwy podczas pó¼niejszego
  sprawdzania dla kogo¶, kto powinien zrozumieæ wszystkie wprowadzane
  do ¼róde³ zmiany. Nie jest to zbyt przyjemne
  <footnote>
  Je¶li nie jeste¶ jeszcze Deweloperem Debiana i prosisz swojego sponsora
  o wgranie pakietu po jego sprawdzeniu, powiniene¶ przygotowaæ pakiet
  w sposób mo¿liwie czytelny.
  </footnote>.

  <p>Zaproponowano ró¿ne matody obs³ugiwania ³at i u¿ywa siê ich w pakietach
  Debiana. Systemy <prgn>dpatch</prgn> i <prgn>quilt</prgn> s± najprostszymi z nich.
  Z innych wymienimy dbs, cdbs itd.

  <p>Pakiet, który zosta³ poprawnie zbudowany za pomoc± systemu
  <prgn>dpatch</prgn> lub <prgn>quilt</prgn>, posiada dobrze udokumentowane poprawki w ¼ród³ach
  jako zbiór plików ³at -pl z nag³ówkiem w katalogu <file>debian/patches/</file>
  i niezmienionym drzewem ¼róde³ poza katalogiem <file>debian/</file>.
  Kiedy prosisz sponsora o wgranie Twojego pakietu, tego rodzaju wyra¼ne
  rozdzielenie i udokumentowanie Twoich zmian jest bardzo wa¿ne dla
  sprawnego przejrzenia ich przez sponsora. U¿ycie <prgn>dpatch</prgn>
  oraz <prgn>quilt</prgn>
  jest opisane w podrêcznikach <manref section="1" name="dpatch">,
  <manref section="1" name="dpatch-edit-patch">
  i <manref section="1" name="quilt">.
  Oba programy udostêpniaj± wygodne do umieszczenia w
  <file>debian/rules</file> pliki <file>/usr/share/dpatch/dpatch.make</file> i
  <file>/usr/share/quilt/quilt.make</file>.

  <p>Kiedy kto¶ (w³±czaj±c Ciebie) chce wdro¿yæ poprawki do ¼róde³,
  modyfikacja pakietu jest ca³kiem prosta:

  <list compact>
    <item>Wyedytuj ³atê, tak aby otrzymaæ plik -pl jako poprawkê do ¼róde³.
    <item>W przypadku <prgn>dpatch</prgn> dodaj nag³ówek poleceniem `<tt>dpatch patch-template</tt>'.
    <item>Przenie¶ nag³ówek do katalogu <file>debian/patches</file>.
    <item>Dodaj nazwy plików do pliku <file>debian/patches/00list</file>
	(dla <prgn>dpatch</prgn>) lub <file>debian/patches/series</file>
	(dla <prgn>quilt</prgn>).
  </list>

  <p><prgn>dpatch</prgn> posiada te¿ mo¿liwo¶æ wykonywania poprawek zale¿nych
  od architektury za pomoc± makra CPP.

  <sect id="option-sa">Do³±czanie <file>orig.tar.gz</file> podczas wgrywania

  <p>Kiedy pierwszy raz wgrywasz pakiet do archiwum, powiniene¶ za³±czyæ
  oryginalny plik ¼ród³owy <file>orig.tar.gz</file>. Je¶li wersja pakietu
  nie jest rewizj± <tt>-0</tt> lub <tt>-1</tt>, musisz wykonaæ polecenie
  <prgn>dpkg-buildpackage</prgn> z opcj± "<tt>-sa</tt>". Z drugiej strony
  opcja "<tt>-sd</tt>" wymusi wy³±czenie oryginalnego ¼ród³a
  <file>orig.tar.gz</file>.

  <!-- -------------------------------------------------------------------------->

  <chapt id="checkit">Sprawdzanie pakietu pod k±tem b³êdów

  <sect id="lintians">Pakiety <package>lintian</package> i <package>linda</package>

  <p>Uruchom programy <manref name="lintian" section="1"> i
  <manref name="linda" section="1">, podaj±c jako argument
  swój plik .changes. Programy ten sprawdzaj± pakiet pod k±tem wielu
  b³êdów wystêpuj±cych podczas pakowania. Robi siê to poleceniami:

  <p><example>
  lintian -i gentoo_0.9.12-1_i386.changes
  linda -i gentoo_0.9.12-1_i386.changes
  </example>

  <p>Oczywi¶cie zast±p nazwê pliku .changes nazw± pliku wygenerowanego dla
  Twojego pakietu. Je¶li pojawi± siê informacje o b³êdach (linie rozpoczynaj±ce
  siê od "E:"), to przeczytaj ich obja¶nienie (linie rozpoczynaj±ce siê od
  "N:"), popraw b³êdy i ponownie zbuduj pakiet w sposób opisany w sekcji
  <ref id="completebuild">. Linie, które zaczynaj± siê od "W:", to ostrze¿enia.
  Oczywi¶cie powiniene¶ albo co¶ poprawiæ, albo upewniæ siê, ¿e nie s± wa¿ne
  (i w takim przypadku wymusiæ na Lintianie ich ignorowanie; wiecej szczegó³ów
  znajdziesz w dokumentacji).

  <p>Zwróæ uwagê, ¿e mo¿esz w jednym kroku zbudowaæ pakiet za pomoc± programu
  <prgn>dpkg-buildpackage</prgn> i uruchomiæ programy <prgn/lintian/ i <prgn/linda/
  korzystaj±c z narzêdzia <manref name="debuild" section="1">.

  <sect id="mc">Polecenie <prgn>mc</prgn>

  <p>Mo¿esz rozpakowaæ zawarto¶æ pliku <file>*.deb</file> przy pomocy
  polecenia <manref name="dpkg-deb" section="1">. Mo¿esz te¿ zobaczyæ
  zawarto¶æ utworzonego pakietu Debiana u¿ywaj±c <manref name="debc" section="1">.

  <p>Mo¿na to równie¿ osi±gn±æ w sposób bardziej intuicyjny za pomoc±
  managera plików np. <manref name="mc" section="1">, który pozwala
  przegl±daæ nie tylko zawarto¶æ pliku <file>*.deb</file>, ale równie¿
  pliki <file>*.diff.gz</file> i <file>*.tar.gz</file>.

  <p>Zwróæ przy tym uwagê na zbêdne pliki o zerowej wielko¶ci, zarówno
  binarne, jak i ¼ród³owe. Czêsto nie s± one kasowane w sposób prawid³owy;
  popraw plik rules, tak aby usun±æ tê wadê.

  <p>Porada: `<tt>zgrep ^+++ ../gentoo_0.9.12-1.diff.gz</tt>' poda
  listê Twoich zmian w plikach ¼ród³owych, a `<tt>dpkg-deb
  -c gentoo_0.9.12-1_i386.deb</tt>' lub `<tt>debc
  gentoo_0.9.12-1_i386.changes</tt>' - listê plików w pakiecie
  binarnym.

  <sect id="debdiff">Polecenie <prgn>debdiff</prgn>

  <p>Mo¿esz porównaæ listy plików w dwóch pakietach binarnych Debiana
  za pomoc± polecenia <manref name="debdiff" section="1">. Jest to
  bardzo u¿yteczne do sprawdzenia, ¿e ¿adne pliki nie zosta³y b³êdnie
  przesuniête lub wykasowane, lub te¿ nie zosta³y dokonane inne
  niepo¿±dane zmiany podczas modyfikacji pakietu. Mo¿esz sprawdziæ
  ca³± grupê plików <file>*.deb</file> przez wywo³anie `<tt>debdiff
  old-package.change new-package.change</tt>'.

  <sect id="interdiff">Polecenie <prgn>interdiff</prgn>

  <p>Mo¿esz porównaæ dwa pliki <file>diff.gz</file> za pomoc± polecenia
  <manref name="interdiff" section="1">. Jest to pomocne w celu sprawdzenia,
  czy nie zosta³y przez nieuwagê opiekuna wprowadzone jakie¶ zmiany do
  plików ¼ród³owych podczas modyfikacji pakietów. Uruchom po prostu
  `<tt>interdiff -z old-package.diff.gz new-package.diff.gz</tt>'.

  <sect id="debi">Polecenie <prgn>debi</prgn>

  <p>Zainstaluj pakiet dla przetestowania go, np. za pomoc± polecenia
  <manref name="debi" section="1">, wywo³anego jako root. Spróbuj zainstalowaæ
  i uruchomiæ go na innych maszynach, kontroluj±c, czy w czasie instalacji
  lub dzia³ania nie pojawiaj± siê komunikaty o b³êdach lub ostrze¿enia.

  <sect id="pbuilder">Pakiet <package>pbuilder</package>

  <p>Pakiet <package>pbuilder</package> jest bardzo u¿yteczny w przypadku
  weryfikacji zale¿no¶ci dla programów uruchamianych w tzw. ¶rodowisku
  czystej przestrzeni (chroot). Zapewnia on "czyst±" budowê pakietu ze
  ¼róde³ za pomoc± auto-buildera dla ró¿nych architektur i zapobiega
  powstawaniu szeregu b³êdów FTBFS (Fails To Build From Source), które
  zawsze nale¿± do kategorii RC (release critical - krytyczne dla wydania).
  Zobacz stronê <url id="&buildd-home;"> o debianowym pakiecie auto-builder.

  <p>Najbardziej podstawowym u¿yciem pakietu <package>pbuilder</package>
  jest bezpo¶rednie wywo³anie polecenia <prgn>pbuilder</prgn> jako root.
  Dla przyk³adu spróbuj wywo³aæ poni¿sze polecenia w katalogu, gdzie
  znajduj± siê pliki
  <file>.orig.tar.gz</file>, <file>.diff.gz</file> i <file>.dsc</file>:
  <example>
  root # pbuilder create # za drugim razem: pbuilder update
  root # pbuilder build foo.dsc
  </example>
  Nowozbudowany pakiet znajdzie siê w katalogu
  <file>/var/cache/pbuilder/result/</file>, w³a¶cicielem bêdzie root.

  <p>Polecenie <prgn>pdebuild</prgn> pomaga wykorzystywaæ fukcje
  pakietu <package>pbuilder</package> z konta zwyk³ego u¿ytkownika.
  Z katalogu ¼róde³ pakietu, gdzie w katalogu nadrzêdnym znajduje siê
  plik <file>orig.tar.gz</file>, wykonaj polecenia:
  <example>
  $ sudo pbuilder create # za drugim razem: sudo pbuilder update
  $ pdebuild
  </example>
  Nowozbudowany pakiet znajdzie siê w katalogu
  <file>/var/cache/pbuilder/result/</file>, w³a¶cicielem bêdzie u¿ytkownik (nie-root)
  <footnote>
  W chwili obecnej zalecam dostosowanie systemu przez umo¿liwienie zapisu
  w katalogu <file>/var/cache/pbuilder/result/</file> przez u¿ytkowników
  i dodanie w pliku <file>~/.pbuilderrc</file> lub <file>/etc/pbuilderrc</file>
  wpisu
  <example>
  AUTO_DEBSIGN=yes
  </example>
  Pozwoli to na podpisywanie tworzonych pakietów Twoim kluczem GPG z pliku
  <file>~/.gnupg/</file>. Poniewa¿ pakiet <package>pbuilder</package>
  jest ci±gle rozwijany, sprawd¼ w jego bie¿±cej dokumentacji, w jaki sposób
  powiniene¶ go skonfigurowaæ.
  </footnote>.

  <p>Je¶li chcesz dodaæ nowe ¼ród³o apta, tak aby by³o u¿ywane przez
  pakiet <package>pbuilder</package>, ustaw <tt>OTHERMIRROR</tt> w
  <file>~/.pbuilderrc</file> lub
  <file>/etc/pbuilderrc</file> i wykonaj (dla sarge):
  <example>
  $ sudo pbuilder update --distribution sarge --override-config
  </example>
  U¿ycie <tt>--override-config</tt> jest konieczne do zaktualizowania
  ¼róde³ apt w ¶rodowisku chroot.

  <p>Zobacz <url id="&pbuilder-home;">,
  <manref section="1" name="pdebuild">,
  <manref section="5" name="pbuilderrc"> i
  <manref section="8" name="pbuilder">.

  <!-- -------------------------------------------------------------------------->

  <chapt id="upload">Wgrywanie pakietu

  <p>Gdy ju¿ gruntownie przetestowa³e¶ swój nowy pakiet, jeste¶ gotowy,
  aby wzi±æ udzia³ w procesie przyjmowania do Debiana nowego opiekuna pakietów.
  Jest to opisane na stronie
  <url id="http://www.debian.org/devel/join/newmaint">.

  <sect id="upload-debian">Wgrywanie pakietu do archiwum Debiana

  <p>Gdy ju¿ zosta³e¶ oficjalnym deweloperem, powiniene¶ umie¶ciæ swój
  pakiet w archiwum Debiana. Mo¿esz zrobiæ to rêcznie, ale ³atwiej jest u¿yæ
  specjalnie do tego celu stworzonych narzêdzi, które automatyzuj± ca³y
  proces. Nale¿± do nich takie programy, jak <manref name="dupload"
  section="1"> i <manref name="dput" section="1">. Opiszemy tutaj, w jaki
  sposób pos³ugiwaæ siê programem <prgn/dupload/.

  <p>Pierwsz± rzecz±, któr± powiniene¶ zrobiæ, jest edycja jego pliku
  konfiguracyjnego. Mo¿esz wyedytowaæ zarówno przeznaczony dla ca³ego systemu
  plik <file>/etc/dupload.conf</file>, jak i swój w³asny plik
  <file>~/.dupload.conf</file>, który nadpisuje te rzeczy, które chcesz
  zmieniæ. Umie¶æ w nim co¶ takiego:

  <p><example>
  package config;

  $default_host = "anonymous-ftp-master";

  $cfg{'anonymous-ftp-master'} = {
        fqdn => "ftp-master.debian.org",
        method => "ftp",
        incoming => "/pub/UploadQueue/",
        # files pass on to dinstall on ftp-master which sends emails itself
        # pliki przekazywane do dinstall na ftp-master, które wysy³aj± maile
        dinstall_runs => 1,
  };

  1;
  </example>

  <p>Mo¿esz przeczytaæ stronê podrêcznika <manref name="dupload.conf" section="5">,
  aby zrozumieæ, co oznacza ka¿da z u¿ytych opcji.

  <p>Uwagi wymaga zmienna $default_host -- okre¶la ona, która z kolejek
  s³u¿±cych do umieszczania pakietów jest u¿ywana domy¶lnie. G³ówn± kolejka
  jest "anonymous-ftp-master", ale mo¿liwe jest, ¿e bêdziesz chcia³ u¿yæ innej,
  szybszej. Wiêcej informacji na temat kolejek znajdziesz
  w dokumencie Developers' Reference, w sekcji "Uploading a package",
  która znajduje siê w dokumencie <file>&uploading;</file>.

  <p>Nastêpnie po³±cz siê z internetem i wydaj polecenie:

  <p><example>
  dupload gentoo_0.9.12-1_i386.changes
  </example>

  <p>Program <prgn/dupload/ sprawdzi, czy zgadzaj± siê sumy kontrolne MD5 plików
  z sumami zapisanymi w pliku .changes. Je¶li sumy kontrolne pasuj± do siebie,
  pakiet mo¿e byæ umieszczony w archiwum. Je¶li sumy siê nie zgadzaj±,
  zostaniesz ostrze¿ony, aby móc przebudowaæ pakiet zgodnie z procedur±
  opisan± w rozdziale <ref id="completebuild">.

  <p>Je¶li stwierdzisz jaki¶ problem z wgrywaniem w kolejce
  <url id="&ftp-uploadqueue;">,
  mo¿esz naprawiæ go rêcznie poprzez wgranie podpisanego pliku
  <file>*.commands</file> do <url id="&ftp-uploadqueue;"> za pomoc± programu
  <prgn>ftp</prgn>
  <footnote>
  Zobacz <url id="&ftp-command;">. Mo¿esz te¿ u¿yæ programu
  <prgn>dcut</prgn> z pakietu <package>dput</package>.
  </footnote>.
  Przyk³adowy plik <file>hello.commands</file>:

<example>
-----BEGIN PGP SIGNED MESSAGE-----

Uploader: Roman Hodek &lt;Roman.Hodek@informatik.uni-erlangen.de&gt;
Commands: 
 rm hello_1.0-1_i386.deb
 mv hello_1.0-1.dsx hello_1.0-1.dsc

-----BEGIN PGP SIGNATURE-----
Version: 2.6.3ia

iQCVAwUBNFiQSXVhJ0HiWnvJAQG58AP+IDJVeSWmDvzMUphScg1EK0mvChgnuD7h
BRiVQubXkB2DphLJW5UUSRnjw1iuFcYwH/lFpNpl7XP95LkLX3iFza9qItw4k2/q
tvylZkmIA9jxCyv/YB6zZCbHmbvUnL473eLRoxlnYZd3JFaCZMJ86B0Ph4GFNPAf
Z4jxNrgh7Bc=
=pH94
-----END PGP SIGNATURE-----
</example>
  
  <sect id="upload-private">Wgrywanie do prywatnego archiwum

  <p>Je¶li chcesz utworzyæ swoje prywatne archiwum na stronie
  <tt>URL="http://people.debian.org/~<var>account_name</var>"</tt> jako 
  deweloper, a potem w prosty sposób wywo³ywaæ
  <tt>dupload -t <var>target_name</var></tt>, powiniene¶ dodaæ nastêpuj±ce linie 
  do pliku <file>/etc/dupload.conf</file>:

  <example>
# Developer account
$cfg{'<var>target_name</var>'} = {
        fqdn =&gt; "people.debian.org",
        method =&gt; "scpb",
        incoming =&gt; "/home/<var>account_name</var>/public_html/package/",
        # I do not need to announce
        dinstall_runs =&gt; 1,
};
$cfg{'<var>target_name</var>'}{preupload}{'changes'} = "
        echo 'mkdir -p public_html/package' | ssh people.debian.org  2&gt;/dev/null ; 
        echo 'Package directory created!'";

$cfg{'<var>target_name</var>'}{postupload}{'changes'} = "
        echo 'cd public_html/package ;
        dpkg-scanpackages . /dev/null &gt;Packages || true ;
        dpkg-scansources . /dev/null &gt;Sources || true ;
        gzip -c Packages >Packages.gz ;
        gzip -c Sources &gt;Sources.gz ' | ssh people.debian.org  2&gt;/dev/null ;
        echo 'Package archive created!'";

  </example>

  Tutaj archiwum APT jest budowane poprzez szybkie i nie sprawdzane
  zdalne wywo³anie pow³oki przez SSH. Nadpisywane pliki wymagane przez
  <prgn>dpkg-scanpackages</prgn> i <prgn>dpkg-scansources</prgn>
  s± podstawiane przez <file>/dev/null</file>. Technika ta mo¿e byæ stosowana
  przez nie-deweloperów Debiana do wprowadzania ich pakietów na ich
  osobiste strony internetowe. Mo¿na te¿ u¿ywaæ <prgn>apt-ftparchive</prgn>
  albo innych skryptów do tworzenia archiwów APT.

  <!-- -------------------------------------------------------------------------->

  <chapt id="update">Aktualizacja pakietu

  <sect id="newrevision">Nowa poprawka Debiana

  <p>Powiedzmy, ¿e do Twojego pakietu zosta³ zg³oszony raport o b³êdzie o
  numerze #54321, opisuj±cy problem, który mo¿esz rozwi±zaæ. Aby stworzyæ
  now± poprawkê (revision) pakietu Debiana, musisz wykonaæ nastêpuj±ce
  czynno¶ci:

  <list>

  <item>Oczywi¶cie najpierw popraw b³±d w ¼ród³ach pakietu.

  <item>Dodaj now± poprawkê na pocz±tku pliku `changelog', na przyk³ad za
  pomoc± `<tt>dch -i</tt>` lub wrêcz
  `<tt>dch -v &lt;wersja&gt;-&lt;rewizja&gt;</tt>'
  i za pomoc± ulubionego edytora tekstu wstaw komentarze.
  <p>Porada: w jaki sposób naj³atwiej pobraæ datê w wymaganym formacie?
  U¿yj komendy `<tt>822-date</tt>' lub `<tt>date -R</tt>'.

  <item>Do³±cz krótki opis b³êdu i jego rozwi±zania do pliku `changelog'
  oraz napis: "Closes: #54321". W ten sposób raport o b³êdzie zostanie
  automatycznie "zamkniêty" przez oprogramowanie obs³uguj±ce archiwum
  Debiana w chwili, gdy pakiet zostanie w nim zaakceptowany.

  <item>Powtórz kroki wykonywane w rozdzia³ach <ref id="completebuild">,
  <ref id="checkit"> i <ref id="upload">. Jedyn± ró¿nic± bêdzie to, 
  ¿e nie zostan± wgrane oryginalne ¼ród³a, gdy¿ nie zmieni³y siê i
  znajduj± siê ju¿ w archiwum Debiana.

  </list>

  <sect id="newupstream">Nowe wydanie autorskie (prosto)

  <p>Rozwa¿my teraz trochê inn±, troszkê bardziej skomplikowan± sytuacjê
  - zosta³a wydana nowa, zewnêtrzna wersja programu i oczywi¶cie chcemy
  j± zapakowaæ. Trzeba wykonaæ nastêpuj±ce czynno¶ci:

  <list>

  <item>Pobierz archiwum z nowymi ¼ród³ami (na przyk³ad
  `<file>gentoo-0.9.13.tar.gz</file>') i umie¶æ je w katalogu nadrzêdnym
  do katalogu ze starym drzewem ¼róde³ (dla przyk³adu <file>~/gentoo/</file>).

  <item>Wejd¼ do katalogu ze starymi ¼ród³ami i wykonaj:
  <example>
  uupdate -u gentoo-0.9.13.tar.gz
  </example>
  <p>Oczywi¶cie musisz zast±piæ nazwê pliku nazw± archiwum ze ¼ród³ami Twojego
  programu. Program <manref name="uupdate" section="1"> odpowiednio zmieni
  nazwê tego archiwum, spróbuje na³o¿yæ wszystkie zmiany z Twojego poprzedniego
  pliku <file>.diff.gz</file> i uaktualni plik <file>debian/changelog</file>.

  <item>Zmieñ katalog na `<file>../gentoo-0.9.13</file>', czyli drzewo z nowym
  ¼ród³em pakietu i powtórz to, co robi³e¶ w rozdzia³ach <ref id="completebuild">,
  <ref id="checkit"> i <ref id="upload">.

  </list>
  
  <p>Zauwa¿, ¿e je¶li skonfigurowa³e¶ plik `<file>debian/watch</file>', jak to
  opisano w sekcji <ref id="watch">, to mo¿esz uruchomiæ program <manref name="uscan"
  section="1">, aby automagicznie odszukiwaæ poprawione ¼ród³a, pobieraæ je
  i uruchamiaæ program <prgn>uupdate</prgn>.

  <sect id="newupstream-real">Nowe wydanie autorskie (realistycznie)

  <p>Kiedy przygotowujesz pakiety dla archiwum Debiana, musisz szczegó³owo
  sprawdzaæ rezultaty swoich dzia³añ. Przedstawiam poni¿ej bardziej realistyczny
  przyk³ad takiej procedury.

  <enumlist compact>

  <item>Sprawd¼ zmiany w ¼ród³ach zewnêtrznych

  <list compact>

  <item>Przeczytaj autorskie pliki <file>changelog</file>, <file>NEWS</file>
  i inn± dokumentacjê, która mo¿e siê odnosiæ do nowej wersji.

  <item>Wykonaj `<tt>diff -urN</tt>' pomiêdzy starymi i nowymi ¼ród³ami
  autorskimi, aby zapoznaæ siê z dokonanymi zmianami (a które mog±
  powodowaæ potencjalne b³êdy), miej oczy otwarte na wszystko, co
  wygl±da podejrzanie.

  </list>

  <item>Zaadaptuj stary pakiet do nowej wersji.

  <list compact>

  <item>Rozpakuj archiwum ¼ród³owe i zmieñ nazwê jego g³ównego katalogu na
  <file>&lt;nazwa_pakietu&gt;-&lt;wersja_autora&gt;/</file> i przejd¼
  `<tt>cd</tt>' do tego katalogu.

  <item>Skopiuj archiwum ¼ród³owe w katalogu nadrzêdnym z now± nazw±
  <file>&lt;nazwa_pakietu&gt;_&lt;wersja_autora&gt;.orig.tar.gz</file> .

  <item>Wykonaj takie same czynno¶ci na nowych ¼ród³ach, jakie wykona³e¶
  na starych. S± mo¿liwe nastêpuj±ce sposoby:
  
  <list compact>
  <item>polecenie `<tt>zcat <var>/path/to/</var>&lt;nazwa_pakietu&gt;_&lt;stara_wersja&gt;.diff.gz | patch -p1</tt>'
  <item>polecenie `<prgn>uupdate</prgn>'
  <item>polecenie `<tt>svn merge</tt>', je¶li ¼ród³a s± w repozytorium Subversion lub
  <item>po prostu przekopiuj katalog <file>debian/</file> ze starych ¼róde³,
  je¶li by³y spakowane przy pomocy <package>dpatch</package> lub <package>quilt</package>.
  </list>

  <item>Zachowaj stare wpisy w pliku changelog (wydaje siê oczywiste, ale
  ró¿nie to bywa...)

  <item>Nowa wersja pakietu bêdzie mia³a numer autorski uzupe³niony przez
  <tt>-1</tt> - numer rewizji Debiana, np. `<tt>0.9.13-1</tt>'.

  <item>Dodaj wpis "New upstream release" na pocz±tku pliku
  <file>debian/changelog</file>. Mo¿esz to zrobiæ np. przez wywo³anie
  `<tt>dch -v 0.9.13-1</tt>'.

  <item>Zwiê¼le opisz (po angielsku oczywi¶cie <em>[uwaga t³umacza]</em>) zmiany dokonane
  <em>w</em> nowej wersji autorskiej, które naprawiaj± zg³oszone b³êdy i zamknij
  te zg³oszenia w pliku changelog.

  <item>Zwiê¼le opisz zmiany dokonane przez opiekuna <em>odnosz±ce siê do</em>
  nowej wersji autorskiej, które naprawiaj± zg³oszone b³êdy i zamknij zg³oszenia.

  <item>Je¶li poprawka (patch/merge) nie mo¿e byæ zaaplikowana w sposób bezpo¶redni,
  zbadaj sytuacjê, ¿eby stwierdziæ jaka jest przyczyna powstawania trudno¶ci
  (na podstawie wpisów w plikach <file>.rej</file>). W wiêkszo¶ci przypadków
  problem polega na tym, ¿e poprawka zosta³a uwzglêdniona przez autora
  i nie jest ju¿ potrzebna.

  <item>Aktualizacja do nowej wersji powinna przebiegaæ w sposób nieabsorbuj±cy
  u¿ytkownika (u¿ytkownicy nie powinni zauwa¿aæ tego faktu, poza stwierdzeniem,
  ¿e b³êdy zosta³y poprawione lub dodano nowe funkcje)
  <footnote>
  Proszê przygotowaæ równie¿ prawid³ow± aktualizacjê pliku konfiguracyjnego
  Twojego pakietu za pomoc± dobrze napisanych skryptów <prgn>postinst</prgn>
  itp., tak aby <strong>nie</strong> dzia³y siê rzeczy zaskakuj±ce u¿ytkowników!
  To m. in. jest jednym z czynników, <strong>dla których</strong> ludzie
  wybieraj± Debiana.
  <p>Je¶li rzeczywi¶cie istnieje konieczno¶æ rêcznej interwencji (np.
  konfiguracja dla ró¿nych katalogów domowych o ca³kowicie odmiennej
  strukturze), pomy¶l o domy¶lnym skonfigurawaniu pakietu w sposób
  najbardziej bezpieczny (np. przez wy³±czenie us³ugi) i przygotowaniu
  w³a¶ciwej dokumentacji (pliki <file>README.Debian</file> i
  <file>NEWS.Debian</file>), jako ostateczno¶æ. Nie zajmuj jednak
  u¿ytkownika komunikatami debconfa.
  </footnote>.

  <item>Je¶li z jakiego¶ powodu trzeba dodaæ skasowane wcze¶niej
  pliki szablonów, mo¿esz uruchomiæ program <prgn>dh_make</prgn> w ju¿
  wcze¶niej "zdebianizowanym" katalogu z opcj± <tt>-o</tt>, a nastêpnie
  uwa¿nie je wyedytowaæ.

  <item>Uprzednio istniej±ce zmiany Debiana powinny zostaæ ponownie wprowadzone;
  odrzuæ poprawki, które zosta³y ju¿ zosta³y uwzglêdnione (w ten czy inny sposób)
  przez autora zewnêtrznego, ale pamiêtaj o tych pozosta³ych, a¿ do chwili, kiedy
  naprawdê przestan± byæ potrzebne.

  <item>Je¶li by³y jakie¶ zmiany w systemie buduj±cym (mam nadziejê, ¿e wiesz
  o tym z kroku 1.), popraw plik <file>debian/rules</file> i,
  je¶li to konieczne, zale¿no¶ci w pliku <file>debian/control</file>.

  </list>

  <item>Zbuduj nowy pakiet jak w rozdziale <ref id="debuild"> lub
  <ref id="pbuilder">. U¿ycie pakietu <package>pbuilder</package> jest
  wskazane.

  <item>Sprawd¼, czy nowe pakiety zosta³y zbudowane w sposób prawid³owy.

  <list compact>

  <item>Przeprowad¼ <ref id="checkit">.

  <item>Wykonaj <ref id="upgrading">.

  <item>Sprawd¼ ponownie, czy nie ma poprawionych b³êdów otwartych w
  <url name="Debian Bug Tracking System (BTS)" id="http://www.debian.org/Bugs/">.

  <item>Sprawd¼ zawarto¶æ pliku .changes i upewnij siê, ¿e wgrywasz zmiany
  do odpowiedniej dystrybucji, zosta³y ujête w³a¶ciwe zg³oszenia b³êdów
  w polu Closes:, pola Maintainer: i Changed-By: s± prawid³owe, istnieje
  podpis GPG itp.

  </list>

  <item>Je¶li wykonywa³e¶ jakie¶ zmiany, aby co¶ poprawiæ, wróæ do kroku
  2., a¿ do osi±gniêcia pozytywnego rezultatu.

  <item>Je¶li wgrywanie odbywa siê przez sponsora, odnotuj wszelkie dodatkowe
  opcje wymagane do zbudowania pakietu (np. '<tt>dpkg-buildpackage
  -sa -v ...</tt>') i poinformuj o nich sponsora, tak aby móg³ równie¿
  prawid³owo go zbudowaæ.

  <item>Je¶li sam wykonujesz wgrywanie, przeprowad¼ <ref id="upload">.

  </enumlist>

  <sect id="orig-tar">Plik <file>orig.tar.gz</file>

  <p>Je¶li próbujesz zbudowaæ pakiet tylko z nowego katalogu ¼ród³owego
  z podkatalogiem <file>debian/</file> bez pliku <file>orig.tar.gz</file>
  w katalogu nadrzêdnym, zakoñczy siê to utworzeniem
  pakietu ¼ród³owego, bez powstania pliku <file>diff.gz</file>.
  Taki sposób pakowania jest prawid³owy jedynie dla specyficznych
  pakietów Debiana, które s± bezu¿yteczne w innych dystrybucjach.

  <footnote>
  Niektórzy twierdz±, ¿e nawet dla specyficznych pakietów Debiana jest
  lepsz± praktyk± przechowywanie zawarto¶ci katalogu <file>debian/</file>
  w pliku <file>diff.gz</file>, ni¿ w <file>orig.tar.gz</file>.
  </footnote>

  <p>W celu uzyskania nie-natywnego pakietu ¼ród³owego, który pozwala na
  uzyskanie zarówno pliku <file>orig.tar.gz</file> jak i <file>diff.gz</file>,
  musisz rêcznie skopiowaæ archiwum autorskie do katalogu nadrzêdnego i
  zmieniæ jego nazwê na
  <file>&lt;nazwa_pakietu&gt;_&lt;wersja_autorska&gt;.orig.tar.gz</file>, jak
  zrobi³ to program <prgn>dh_make</prgn> w rozdziale <ref id="dh_make">.

  <sect id="cvs-buildpackage">Polecenie <prgn>cvs-buildpackage</prgn> i jemu podobne

  <p>Rozwa¿ u¿ycie systemu zarz±dzania kodem ¼ród³owym do zarz±dzania plikami
  zmienianymi w czasie pakowania. Jest kilka skryptów do pakowania przystosowanych
  do najbardziej popularnych z nich.
  <list compact>
  <item>CVS
  <list compact>
  <item><package>cvs-buildpackage</package>
  </list>
  <item>Subversion
  <list compact>
  <item><package>svn-buildpackage</package>
  </list>
  <item>Git (git-core)
  <list compact>
  <item><package>git-buildpackage</package>
  </list>
  </list>

  <p>Polecenia te automatyzuj± te¿ pakowanie nowych wydañ autorskich.

  <sect id="upgrading">Weryfikowanie uaktualnienia pakietu do nowszej wersji

  <p>Kiedy ju¿ zbudowa³e¶ now± wersjê pakietu, powiniene¶ wykonaæ nastêpuj±c±
  procedurê, ¿eby upewniæ siê, ¿e aktualizacja pakietu do nowej wersji
  przebiega bezb³êdnie:

  <p><list>
  <item>uaktualnij pakiet z poprzedniej wersji
  <item>powróæ ponownie do poprzedniej wersji (downgrade), a nastêpnie usuñ go
  <item>zainstaluj pakiet jako nowy pakiet
  <item>odinstaluj go i nastêpnie zainstaluj ponownie
  <item>wyczy¶æ (purge) pakiet
  </list>

  <p>Je¶li pakiet zawiera nietrywialne skrypty pre/post/inst/rm, przetestuj
  ¶cie¿ki dzia³ania ka¿dego z nich.

  <p>Miej ¶wiadomo¶æ, ¿e je¶li Twój pakiet by³ poprzednio wydany w Debianie,
  to ludzie czêsto bêd± go uaktualniaæ z wersji, która by³a w ostatnim wydaniu
  Debiana. Pamiêtaj, ¿eby przetestowaæ tak¿e uaktualnianie do nowszej wersji
  z tamtej wersji.

  <!-- -------------------------------------------------------------------------->

  <chapt id="helpme">Gdzie prosiæ o pomoc

  <p>Zanim zdecydujesz siê zadaæ pytanie w jakim¶ publicznym miejscu,
  proszê najpierw zajrzeæ do odpowiedniego podrêcznika. Dokumentacja do
  programów wymienionych w tym dokumencie znajduje siê w
  <file>/usr/share/doc/dpkg</file>,
  <file>/usr/share/doc/debian</file>, <file>&autotools-dev;</file>, 
  <file>/usr/share/doc/package/*</file>, a tak¿e w plikach info i man
  omawianych programów.
  Zobacz te¿ inforamcje na <url id="&nm-home;"> i <url id="&mentors-faq;">.

  <p>Je¶li masz pytanie na temat pakowania, na które nie znalaz³e¶ odpowiedzi
  w powy¿szej dokumentacji, powiniene¶ je zadaæ na li¶cie Mentorów Debiana,
  która dostêpna jest pod adresem <email/debian-mentors@lists.debian.org/.
  Bardziej do¶wiadczeni deweloperzy Debiana chêtnie Ci pomog±, ale przed
  zadaniem pytania przeczytaj dokumentacjê!

  <p>Wiêcej informacji na temat tej listy dyskusyjnej znajdziesz na stronie
  <url id="http://lists.debian.org/debian-mentors/">.

  <p>Kiedy odbierzesz raport o b³êdzie (tak, prawdziwy raport o b³êdzie!),
  to znak, ¿e czas zaznajomiæ siê z <url name="Systemem ¶ledzenia b³êdów
  Debiana (BTS)" id="http://www.debian.org/Bugs/"> i przeczytaæ znajduj±c± siê
  tam dokumentacjê, aby móc sprawnie radziæ sobie z takimi raportami.
  Polecam g³ównie przeczytanie rozdzia³u "Handling Bugs" z dokumentu
  Developers' Reference w <file>&bughandling;</file>.

  <p>Je¶li wci±¿ masz pytania, pytaj na li¶cie Deweloperów Debiana,
  która jest dostêpna pod adresem <email/debian-devel@lists.debian.org/.
  Wiêcej informacji na temat tej listy dyskusyjnej znajdziesz na stronie
  <url id="http://lists.debian.org/debian-devel/">.

  <p>Nawet, gdy wszystko dzia³a dobrze, to czas, ¿eby zacz±æ siê modliæ.
  Dlaczego? Poniewa¿ ju¿ za kilka godzin (lub dni) u¿ytkownicy z ca³ego ¶wiata
  zaczn± u¿ywaæ Twojego pakietu i je¶li pope³ni³e¶ jaki¶ krytyczny b³±d,
  wielu rozgniewanych u¿ytkowników Debiana zasypie Ciê listami...
  To tylko ¿art. :-)

  <p>Zrelaksuj siê i b±d¼ gotowy na raporty o b³êdach, poniewa¿ masz jeszcze sporo
  do zrobienia, zanim Twój pakiet bêdzie w pe³ni zgodny z Polityk±
  Debiana (powtarzam: przeczytaj <em>prawdziw± dokumentacjê</em>,
  aby dowiedzieæ siê wiêcej szczegó³ów). Powodzenia!

  <!-- -------------------------------------------------------------------------->

  <appendix id="pkg-eg">Przyk³ady

  <p>Mamy do zapakowania archiwum autorskie <var>gentoo-1.0.2</var>.tar.gz i
  wgrywamy wszystkie pakiety do <tt><var>nm_target</var></tt>.

  <sect id="pkg-simple">Prosty przyk³ad pakowania

  <p>
  <example>
  $ mkdir -p <var>/path/to</var> # nowy pusty katalog
  $ cd <var>/path/to</var>
  $ tar -xvzf <var>/path/from/gentoo-1.0.2</var>.tar.gz # rozpakowujemy ¼ród³a
  $ cd <var>gentoo-1.0.2</var>
  $ dh_make -e <var>name@domain.dom</var> -f <var>/path/from/gentoo-1.0.2</var>.tar.gz
  ... Odpowiedz na pytania
  ... Popraw drzewo ¼róde³
  ... Je¶li jest to pakiet skryptowy, wpisz "Architecture: all" do debian/control
  ... Nie kasuj ../<var>gentoo_1.0.2</var>.orig.tar.gz
  $ debuild
  ... Nie powinno byæ ostrze¿eñ
  $ cd ..
  $ dupload -t <var>nm_target</var> <var>gentoo_1.0.2-1</var>_i386.changes
  </example>


  <sect id="pkg-dpatch">Przyk³ad z <package>dpatch</package> i <package>pbuilder</package>
  <p>
  <example>
  $ mkdir -p <var>/path/to</var> # nowy pusty katalog
  $ cd <var>/path/to</var>
  $ tar -xvzf <var>/path/from/gentoo-1.0.2</var>.tar.gz
  $ cp -a  <var>gentoo-1.0.2</var> <var>gentoo-1.0.2-orig</var>
  $ cd <var>gentoo-1.0.2</var>
  $ dh_make -e <var>name@domain.dom</var> -f /path/from/<var>gentoo-1.0.2</var>.tar.gz
  ... Odpowiedz na pytania
  </example>

  Tu mamy fragment oryginalnego pliku <file>debian/rules</file>:
  <example>
  configure: configure-stamp
  configure-stamp:
        dh_testdir
        # Add here commands to configure the package.
        touch configure-stamp
  build: build-stamp
  build-stamp: configure-stamp 
        dh_testdir
        # Add here commands to compile the package.
        $(MAKE)
        #docbook-to-man debian/gentoo.sgml > gentoo.1
        touch $@
  clean:
        dh_testdir
        dh_testroot
        rm -f build-stamp configure-stamp
        # Add here commands to clean up after the build process.
        -$(MAKE) clean
        dh_clean 
  </example>
  Za pomoc± edytora zmieñ <file>debian/rules</file> w nastêpuj±cy sposób,
  tak aby u¿ywaæ <package>dpatch</package> oraz dodaj <package>dpatch</package>
  w linii <tt>Build-Depends:</tt> pliku <file>debian/control</file>:
  <example>
  configure: configure-stamp
  configure-stamp: patch
        dh_testdir
        # Add here commands to configure the package.
        touch configure-stamp
  build: build-stamp
  build-stamp: configure-stamp 
        dh_testdir
        # Add here commands to compile the package.
        $(MAKE)
        #docbook-to-man debian/gentoo.sgml > gentoo.1
        touch $@
  clean: clean-patched unpatch
        dh_testdir
        dh_testroot
        rm -f build-stamp configure-stamp
        # Add here commands to clean up after the build process.
        -$(MAKE) clean
        dh_clean 
  patch: patch-stamp
  patch-stamp:
        dpatch apply-all
        dpatch call-all -a=pkg-info >patch-stamp
  unpatch:
        dpatch deapply-all
        rm -rf patch-stamp debian/patched
  </example>

  <p>W ten sposób mo¿esz ju¿ pakowaæ ¼ród³a za pomoc± systemu
  <package>dpatch</package> u¿ywaj±c programu <prgn>dpatch-edit-patch</prgn>.

  <example>
  $ dpatch-edit-patch patch 10_firstpatch
  ... Popraw ¼ród³a edytorem
  $ exit 0
  ... Spróbuj zbudowaæ pakiety przy u¿yciu "debuild -us -uc"
  ... Wyczy¶æ ¼ród³a wywo³uj±c "debuild clean"
  ... Powtarzaj dpatch-edit-patch a¿ do zbudowania pakietów ze ¼róde³
  $ sudo pbuilder update
  $ pdebuild
  $ cd /var/cache/pbuilder/result/
  $ dupload -t <var>nm_target</var> <var>gentoo_1.0.2-1</var>_i386.changes
  </example>

 </book>

</debiandoc>
