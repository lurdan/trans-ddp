#!/usr/bin/make -f
# Uncomment this to turn on verbose mode.
#export DH_VERBOSE=1

DEBIAN_DIR	:= $(CURDIR)/debian
MANUAL		:= maint-guide

# Language which is the base of all files
LANGS_EN	:= en

# Languages which generate DocBook XML files from PO files
LANGS_PO        := ca es fr it ja ru
# ca: 99%
# de: 24%
# es: 97%
# fr: 100%
# it: 100%
# ja: 100%
# ru: 100%
# zn-cn: 33%
# zn-tw:28%

# Override main Makefile to build CJK under sid
# No PDF build for these lunguages
LANGS_NOPDF            :=  

# Language groups
LANGS		:= $(LANGS_EN) $(LANGS_PO)
#######################################################################
prep:
	sed -e '/^Package: maint-guide-/,$$d' <$(DEBIAN_DIR)/control | sponge $(DEBIAN_DIR)/control
	for x in $(LANGS_PO); \
		do sed -e "s/@@@LNG@@@/$$x/g" -e "s/@@@LNGNAME@@@/$$($(DEBIAN_DIR)/language $$x)/g" \
		<$(DEBIAN_DIR)/control-in-body >> $(DEBIAN_DIR)/control; \
	done
	-rm -f $(DEBIAN_DIR)/$(MANUAL)-*.install
	for lang in $(LANGS); \
		do sed -e "s/@@/$$lang/g" < $(DEBIAN_DIR)/all.install-in > $(DEBIAN_DIR)/$(MANUAL)-$$lang.install; \
	done
.PHONY
#######################################################################
%:
	dh  $@

override_dh_auto_build:
	dh_auto_build -- html txt pdf "MANUAL=$(MANUAL)" \
		"LANGS_EN=$(LANGS_EN)" "LANGS_PO=$(LANGS_PO)" "LANGS=$(LANGS)" \
		"LANGS_NOPDF=$(LANGS_NOPDF)"

override_dh_auto_clean:
	dh_auto_clean

