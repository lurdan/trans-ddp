<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN"><HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter">
<LINK REL="STYLESHEET" HREF="appendix-auto.css" CHARSET="ISO-8859-1" TYPE="text/css">
<TITLE> Automating Multiple Installs</TITLE>
</HEAD>
<BODY BGCOLOR="#ffffff">
<OL>
<LI CLASS="Appendix-Letter">
<A NAME="pgfId-1063963"></A>&nbsp;</LI>
</OL>
<DIV>
<H1 CLASS="Title">
<A NAME="pgfId-1073086"></A><A NAME="97699"></A>Automating Multiple Installs</H1>
<P CLASS="Body">
<A NAME="pgfId-1073345"></A>Once you have installed Progeny Debian on a single system, you can automate other installs by creating an automated install floppy. The automated install floppy is inserted in the floppy drive when you start an install.</P>
<P CLASS="Body">
<A NAME="pgfId-1073347"></A>Making the automated install floppy consists of two steps:</P>
<OL>
<LI CLASS="Numbered1">
<A NAME="pgfId-1073103"></A>1	Creating the configuration files.</LI>
<LI CLASS="Numbered">
<A NAME="pgfId-1073111"></A>2	Creating the automated installer floppy.</LI>
</OL>
<DIV>
<H3 CLASS="Heading1">
<A NAME="pgfId-1073110"></A><A NAME="marker-1074655"></A>Creating Configuration Files</H3>
<P CLASS="Body">
<A NAME="pgfId-1073118"></A>The configuration files are created on an existing Progeny Debian system, then copied to the floppy for use during the install.</P>
<P CLASS="Body">
<A NAME="pgfId-1073402"></A>You should know that:</P>
<UL>
<LI CLASS="Bulleted">
<A NAME="pgfId-1074509"></A>&#183;	<EM CLASS="Emphasis">
scsimod</EM>
.lst, <EM CLASS="Emphasis">
netmod.lst, </EM>
and<EM CLASS="Emphasis">
 sources.lst</EM>
 can be blank, but must be in the /conf directory with the other configuration files.</LI>
<LI CLASS="Bulleted">
<A NAME="pgfId-1074500"></A>&#183;	<EM CLASS="Emphasis">
postinst</EM>
 is not required.</LI>
</UL>
<P CLASS="Body">
<A NAME="pgfId-1074553"></A>Place all finished configuration files in a directory named /conf. This directory can be a sub-directory any place on the system. Commands to create the automated install floppy are run from this directory.</P>
<P CLASS="Body">
<A NAME="pgfId-1073399"></A>Examples of configuration files are available in /usr/share/doc/autoinstall/.</P>
<DIV>
<H4 CLASS="Heading2">
<A NAME="pgfId-1073417"></A><A NAME="marker-1074657"></A>Creating the Global Configuration File (global.cfg)</H4>
<P CLASS="Body">
<A NAME="pgfId-1073419"></A>The global.cfg file contains the master information for the automated install. One option is entered per line. When an option requires a value, leave a space between the option and the value.</P>
<TABLE BORDER="1">
<CAPTION>
<H6 CLASS="TableTitle">
<A NAME="pgfId-1073428"></A><A NAME="marker-1074659"></A>Options for the global.cfg File</H6>
</CAPTION>
<TR>
<TH ROWSPAN="1" COLSPAN="1">
<P CLASS="CellHeading">
<A NAME="pgfId-1073432"></A>Option</P>
</TH>
<TH ROWSPAN="1" COLSPAN="1">
<P CLASS="CellHeading">
<A NAME="pgfId-1073434"></A>What It Does</P>
</TH>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1073436"></A>baseurl</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1073438"></A>The <EM CLASS="Heading-Small-Caps">
url</EM>
 for the minimal system's <A NAME="marker-1074729"></A>tar file. </P>
<P CLASS="CellBody">
<A NAME="pgfId-1073469"></A>The <EM CLASS="Heading-Small-Caps">
url</EM>
 can be a <EM CLASS="Heading-Small-Caps">
cd</EM>
 <EM CLASS="Emphasis">
(cdrom:)</EM>
 or a web address <EM CLASS="Emphasis">
(http://).</EM>
</P>
<P CLASS="CellBody">
<A NAME="pgfId-1073470"></A>This option is required.</P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1073440"></A>rootpwd</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1073442"></A>The password hash for the root user.</P>
<P CLASS="CellBody">
<A NAME="pgfId-1073474"></A>This option is required.</P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1073444"></A>nosafe</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1073446"></A>Continues the install, even if a filesystem exists on the target machine.</P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1073448"></A>network</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1073450"></A>Allows the automated installer to configure the network. Possible values are:</P>
<UL>
<LI CLASS="Bulleted">
<A NAME="pgfId-1073483"></A>&#183;	dhcp: Use <EM CLASS="Heading-Small-Caps">
dhcp</EM>
.</LI>
<LI CLASS="Bulleted">
<A NAME="pgfId-1073484"></A>&#183;	netdb: configure using the network.cfg file.</LI>
<LI CLASS="Bulleted">
<A NAME="pgfId-1073485"></A>&#183;	none: do not configure the network.</LI>
</UL>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1073452"></A>cdinst</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1073454"></A>Install using a <EM CLASS="Heading-Small-Caps">
cd</EM>
, instead of a network.</P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1073456"></A>nfscd</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1073458"></A>The path to an <EM CLASS="Heading-Small-Caps">
nfs</EM>
-mounted <EM CLASS="Heading-Small-Caps">
cd</EM>
 image that will be used for the installation.</P>
</TD>
</TR>
</TABLE>
</DIV>
<DIV>
<H4 CLASS="Heading2">
<A NAME="pgfId-1073105"></A><A NAME="marker-1074661"></A>Creating the debconf Configuration File (debconf.cfg)</H4>
<P CLASS="Body">
<A NAME="pgfId-1073120"></A>Make a copy of the debconf database. Type: /<EM CLASS="Emphasis">
usr/sbin/readdebconf </EM>
<EM CLASS="Variables">
/&#126;conf</EM>
<EM CLASS="Emphasis">
/debconf.cfg.</EM>
</P>
</DIV>
<DIV>
<H4 CLASS="Heading2">
<A NAME="pgfId-1073127"></A><A NAME="marker-1074663"></A>Creating the Network Modules File (netmod.lst)</H4>
<P CLASS="Body">
<A NAME="pgfId-1073360"></A>The netmod.lst file lists the <A NAME="marker-1074731"></A><EM CLASS="Heading-Small-Caps">
scsi</EM>
 kernel modules to load. Modules are listed one per line. </P>
<P CLASS="Body">
<A NAME="pgfId-1073361"></A>Look at the example provided. Type: <EM CLASS="Emphasis">
less /usr/share/doc/autoinstall/examples/netmode.lst </EM>
on an existing Progeny Debian System. The file must be configured to fit your hardware.</P>
</DIV>
<DIV>
<H4 CLASS="Heading2">
<A NAME="pgfId-1073128"></A><A NAME="marker-1074665"></A>Creating the <A NAME="marker-1074737"></A>SCSI Module File (scsimod.lst)</H4>
<P CLASS="Body">
<A NAME="pgfId-1073309"></A>The scsimod.lst file lists the <A NAME="marker-1074739"></A><EM CLASS="Heading-Small-Caps">
scsi</EM>
 kernel modules to load. Modules are listed one per line. </P>
<P CLASS="Body">
<A NAME="pgfId-1073316"></A>Look at the example provided. Type: <EM CLASS="Emphasis">
less /usr/share/doc/autoinstall/examples/scsimod.lst </EM>
on an existing Progeny Debian System. The file must be configured to fit your hardware.</P>
</DIV>
<DIV>
<H4 CLASS="Heading2">
<A NAME="pgfId-1073129"></A><A NAME="marker-1074667"></A>Creating the Network Configuration Database (network.cfg)</H4>
<P CLASS="Body">
<A NAME="pgfId-1073356"></A>The network.cfg file describes the network and all machines on it. The file consists of pairs of stanzas.</P>
<P CLASS="Body">
<A NAME="pgfId-1073369"></A>The first stanza in a pair is the global stanza. Global stanzas may be added for any network or routers. Global stanzas contain the following entries, with one characteristic per line:</P>
<OL>
<LI CLASS="Numbered1">
<A NAME="pgfId-1073372"></A>1	gateway</LI>
<LI CLASS="Numbered">
<A NAME="pgfId-1073373"></A>2	network</LI>
<LI CLASS="Numbered">
<A NAME="pgfId-1073374"></A>3	netmask</LI>
<LI CLASS="Numbered">
<A NAME="pgfId-1073375"></A>4	name server</LI>
<LI CLASS="Numbered">
<A NAME="pgfId-1073376"></A>5	broadcast</LI>
<LI CLASS="Numbered">
<A NAME="pgfId-1073377"></A>6	domain name</LI>
</OL>
<P CLASS="Body">
<A NAME="pgfId-1073378"></A>Leave a space after each characteristic, then add the value for characteristic.</P>
<P CLASS="Body">
<A NAME="pgfId-1073422"></A>The second stanza in each pair is a local stanza. It defines local machines attached to the network or to the router. Each line defines a single machine. Each machine is defined by three columns:</P>
<OL>
<LI CLASS="Numbered1">
<A NAME="pgfId-1073385"></A>1	<EM CLASS="Heading-Small-Caps">
mac</EM>
 address (ethernet card <EM CLASS="Heading-Small-Caps">
id</EM>
)</LI>
<LI CLASS="Numbered">
<A NAME="pgfId-1073386"></A>2	<EM CLASS="Heading-Small-Caps">
ip</EM>
 address</LI>
<LI CLASS="Numbered">
<A NAME="pgfId-1073387"></A>3	host name</LI>
</OL>
<P CLASS="Body">
<A NAME="pgfId-1073388"></A>Columns are separated by a single space</P>
<P CLASS="Body">
<A NAME="pgfId-1073425"></A>At the bottom of a local stanza, you can add a default entry. The default entry is used if a machine cannot be otherwise connected to the machine. The default entry uses <EM CLASS="Emphasis">
default</EM>
 for the <EM CLASS="Heading-Small-Caps">
mac</EM>
 address and <EM CLASS="Emphasis">
unassigned</EM>
 for the host name.</P>
</DIV>
<DIV>
<H4 CLASS="Heading2">
<A NAME="pgfId-1073130"></A><A NAME="marker-1074669"></A>Creating the Partitioning Information File (partinfo.cfg)</H4>
<P CLASS="Body">
<A NAME="pgfId-1073167"></A>The partinfo.cfg file describes how the install program should partition each system during an automated install.</P>
<P CLASS="Body">
<A NAME="pgfId-1073168"></A>One line is used for each partition. Each line has the same format:</P>
<P CLASS="Body">
<A NAME="pgfId-1073169"></A><EM CLASS="Variables">
partitiontype filesystem size mountpoint size</EM>
</P>
<P CLASS="Body">
<A NAME="pgfId-1074484"></A>The size is either <EM CLASS="Emphasis">
m</EM>
 (megabytes) or <EM CLASS="Emphasis">
%</EM>
 (percentage of total disk space).</P>
<P CLASS="Body">
<A NAME="pgfId-1073285"></A><EM CLASS="FM-Default-Font">
In most cases, you want at least a root partition and a swap partition.</EM>
<EM CLASS="Variables">
</EM>
</P>
<TABLE BORDER="1">
<CAPTION>
<H6 CLASS="TableTitle">
<A NAME="pgfId-1073175"></A><A NAME="marker-1074671"></A>Entries in partinfo.cfg</H6>
</CAPTION>
<TR>
<TH ROWSPAN="1" COLSPAN="1">
<P CLASS="CellHeading">
<A NAME="pgfId-1073179"></A>Entry</P>
</TH>
<TH ROWSPAN="1" COLSPAN="1">
<P CLASS="CellHeading">
<A NAME="pgfId-1073181"></A>Choices</P>
</TH>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1073183"></A><EM CLASS="Variables">
partition type</EM>
</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<UL>
<LI CLASS="Bulleted">
<A NAME="pgfId-1073185"></A>&#183;	primary.</LI>
<LI CLASS="Bulleted">
<A NAME="pgfId-1073269"></A>&#183;	logical.</LI>
</UL>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1073187"></A><EM CLASS="Variables">
filesystem</EM>
</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<UL>
<LI CLASS="Bulleted">
<A NAME="pgfId-1073189"></A>&#183;	ext2: Linux native.</LI>
<LI CLASS="Bulleted">
<A NAME="pgfId-1073274"></A>&#183;	swap: Linux swap.</LI>
</UL>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1073191"></A><EM CLASS="Variables">
size</EM>
</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1073193"></A>Any size, given in megabytes.</P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1073195"></A><EM CLASS="Variables">
mountpoint</EM>
</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1073197"></A>The file should include at least one partition mounted as root (/).</P>
<P CLASS="CellBody">
<A NAME="pgfId-1073275"></A>A swap file has no mount point, but is entered as <EM CLASS="Emphasis">
swap</EM>
.</P>
</TD>
</TR>
</TABLE>
</DIV>
<DIV>
<H4 CLASS="Heading2">
<A NAME="pgfId-1073131"></A><A NAME="marker-1074677"></A>Creating the Package Selection List (select.cfg)</H4>
<P CLASS="Body">
<A NAME="pgfId-1073287"></A>The select.cfg file lists the packages to install. To create the file, type: <EM CLASS="Emphasis">
dpkg --get-selections</EM>
 &gt; <EM CLASS="Variables">
/&#126;conf</EM>
<EM CLASS="Emphasis">
/select.cfg </EM>
on an existing Progeny Debian System, then edit if desired.</P>
</DIV>
<DIV>
<H4 CLASS="Heading2">
<A NAME="pgfId-1073286"></A><A NAME="marker-1074679"></A>Creating the Post Installation Script (postinst)</H4>
<P CLASS="Body">
<A NAME="pgfId-1073158"></A>The post installation script is a series of commands that are run after installation is complete. The script can be written any language supported by the fully installed system.</P>
<P CLASS="Body">
<A NAME="pgfId-1073159"></A>The post installation script is optional. It is not needed for an automated install.</P>
</DIV>
<DIV>
<H4 CLASS="Heading2">
<A NAME="pgfId-1073132"></A><A NAME="marker-1074681"></A>Creating the Sources List File (sources.lst)</H4>
<P CLASS="Body">
<A NAME="pgfId-1073140"></A>This file is a list of sources for <EM CLASS="Emphasis">
apt</EM>
. It can be copied from any sources list for <EM CLASS="Emphasis">
apt</EM>
. You can create it by:</P>
<UL>
<LI CLASS="Bulleted">
<A NAME="pgfId-1073152"></A>&#183;	Typing <A NAME="marker-1074769"></A><EM CLASS="Emphasis">
cp /etc/apt/sources.lst</EM>
 <EM CLASS="Variables">
/&#126;conf</EM>
<EM CLASS="Emphasis">
/sources.lst.</EM>
</LI>
<LI CLASS="Bulleted">
<A NAME="pgfId-1073153"></A>&#183;	Creating a plain text file called<EM CLASS="Emphasis">
 sources.lst</EM>
 in the target directory with the following line: <EM CLASS="Emphasis">
deb http://archive.progeny.com/progeny progeny main contrib non-free.</EM>
</LI>
</UL>
</DIV>
</DIV>
<DIV>
<H3 CLASS="Heading1">
<A NAME="pgfId-1073108"></A><A NAME="marker-1074683"></A>Creating the Automated Installer Floppy</H3>
<P CLASS="Body">
<A NAME="pgfId-1073109"></A>Before creating the floppy for the automated installer, you must create all configuration files and place them in the /conf directory. Only the postinst file is optional.</P>
<OL>
<LI CLASS="Numbered1">
<A NAME="pgfId-1073498"></A>1	From the /conf directory, type: <EM CLASS="Emphasis">
make-autoinst-initrd</EM>
 <EM CLASS="Variables">
kernel_version</EM>
.</LI>
<P CLASS="Indented">
<A NAME="pgfId-1073499"></A>The kernel version is the version of the kernel that you want to use on the floppy to create the initial <EM CLASS="Heading-Small-Caps">
ram</EM>
 disk that is used to start the system. The kernel must be installed on the system that you are currently using.</P>
<LI CLASS="Numbered">
<A NAME="pgfId-1074650"></A>2	Place a floppy disk in the drive. The drive is mounted automatically in the next step.</LI>
<LI CLASS="Numbered">
<A NAME="pgfId-1073501"></A>3	From the /conf directory, type: <EM CLASS="Emphasis">
make-autoinst-disk</EM>
 <EM CLASS="Variables">
kernel_version</EM>
.</LI>
</OL>
<P CLASS="Note">
<A NAME="pgfId-1073508"></A><DIV>
<IMG SRC="img/appendix-auto-1.png">
</DIV>
Enter the same kernel version as you did in the first step.</P>
<UL>
<P CLASS="Indented">
<A NAME="pgfId-1073514"></A>The automated install floppy is created.</P>
</UL>
</DIV>
<DIV>
<H3 CLASS="Heading1">
<A NAME="pgfId-1073532"></A><A NAME="marker-1074685"></A>Starting an Automated Install</H3>
<OL>
<LI CLASS="Numbered1">
<A NAME="pgfId-1073533"></A>1	Check that you have an install source. The install source can be:</LI>
<LI CLASS="Bulleted">
<A NAME="pgfId-1074521"></A>&#183;	 A <EM CLASS="Heading-Small-Caps">
cd.</EM>
 </LI>
<LI CLASS="Bulleted">
<A NAME="pgfId-1074527"></A>&#183;	A <EM CLASS="Heading-Small-Caps">
cd</EM>
 image available over an <EM CLASS="Heading-Small-Caps">
nfs</EM>
-mounted <EM CLASS="Heading-Small-Caps">
cd</EM>
 image. </LI>
<LI CLASS="Bulleted">
<A NAME="pgfId-1074530"></A>&#183;	An <EM CLASS="Heading-Small-Caps">
url</EM>
. In this case, <EM CLASS="Emphasis">
sources.lst</EM>
 must point to a valid Progeny mirror.</LI>
<P CLASS="Indented">
<A NAME="pgfId-1074531"></A>Whatever the source, it must be specified in the <EM CLASS="Emphasis">
global.cfg</EM>
 file.</P>
<LI CLASS="Numbered">
<A NAME="pgfId-1073535"></A>2	Place the automated install floppy in the floppy drive.</LI>
<LI CLASS="Numbered">
<A NAME="pgfId-1073544"></A>3	Start the machine. The install proceeds, drawing information from the auto-install floppy as needed.</LI>
</OL>
</DIV>
</DIV>
</BODY>
</HTML>
