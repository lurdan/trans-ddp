<!-- Debian System Administration Manual - Time -->

    <chapt id="sysadmin-time">
      <heading>Time</heading>
      <p><email>Tapio.Lehtonen@IKI.FI</email></p>
<p>
Computers have a <strong>clock</strong> to keep time. Usually there is
a hardware clock with battery backup to keep time when the computer is
off. The operating system (for example Linux) runs it's own clock, and
from this clock comes the time shown by commands such as
<prgn>date</prgn> in linux and <prgn>time</prgn> in DOS. </p>

<p>The hardware clock is usually accurate enough, provided the battery
has not run out. If the computer shows way-off time when You turn it
on, it is worth checking if the battery still is usable. </p>

<p>The "software" clock usually has drift, either systematic or
random. This drift means the clock runs too fast or too slow. </p>

<p>To see the time on Debian Linux, use the command
<prgn>date</prgn>. For example
<example>
$ date
Fri Oct 23 04:45:51 EEST 1998
</example></p>

<p>The above command shows day of week, month, day of month, time, time
zone and year. The time zone also shows that Daylight Saving Time is in
use (time zone is EET, the extra S means Saving). </p>

<p>If You have root privileges, You can also change the time with
command <prgn>date</prgn>, see the man page <manref name="date"
section="1">. If You are connected to
the Internet or have other Unix computers on LAN, see section ??? for
easier ways to set time.</p>

<p>example of the confusing time strings???</p>

<p>If You are running X Window, You may have a clock display somewhere
on the screen. If not, the command <prgn>xclock</prgn> probably is
installed and You can get an analog clock (with big hand, little hand, 
an optional seconds hand) or a digital clock (with <prgn>xclock
-digital</prgn>). See the man page <manref name="xclock" section="1">for more info.</p>

      <sect>
	<heading>Setting time, time zones and DST</heading>
        <p>
         When You installed Debian Linux, You set the <strong>Time
Zone</strong>. You can check how You have set the Time Zone by looking
at the file <prgn>/etc/timezone</prgn>. 
<example>
tale@dilbert /usr/doc/timezones
$ cat /etc/timezone
Europe/Helsinki
tale@dilbert /usr/doc/timezones
$ 
</example>
</p>

<p>Setting timezone after installation???</p> <p>Setting TZ EV. </p>
<p>If the time zone is not set or is wrong, root can use the command
<prgn>tzconfig</prgn> to configure it after the operating system is
installed, see man page <manref name="tzconfig" section="8">. 

<p>If You do not have root privileges or want to set for Yourself a
different timezone than the system uses, You can set the environment
variable <prgn>TZ</prgn>. Use the command <prgn>tzselect</prgn> to
show what value to use for TZ. 

<p>The time zone is needed because Unix computers keep time in
<strong>Universal Time</strong> <strong>UTC</strong>, and <strong>local time</strong>
is calculated from this. UTC is local time in London, England. UTC was
previously called Greenwich Mean Time GMT. </p>

<p>UTC has no Daylight Saving Time or other changes, which makes it
easier to syncronize computer to the same time. The UTC is the same
everywhere, so it does not matter if two computers on different time
zones syncronize, if they both use UTC. </p>

<p>If You set Your Debian Linux computer to use local time, You do not
have to worry about time zones but then You also miss out on automatic
DST changes. In this document, it is assumed You set up Your computer
to use UTC. <p>

<p>If the Time Zone is correctly set up, and the time zone
configuration files are reasonably current, the local time shown by
the operating system changes to <strong>Daylight Saving Time</strong>
and back to normal time automatically on the correct dates. If the
time zone files You have are old, there may be problems because DST
start and end dates are not determined by a physical phenomenon, but
are chosen by some institution. Sometimes these dates are changed, for
example European Union changed the end date from last sunday in
september to last sunday in october in 1995. </p>


      </sect>
      <sect>
        <heading>Setting and showing hardware clock</heading>
        <p>
         The command <prgn>hwclock</prgn> (this was not in Debian
before 2.0 ???)
        /<p>
      </sect>
      <sect>
        <heading>Multiboot with operating systems not understanding time zone</heading>
        <p>
         If You have a multiboot configuration, where You have some
other operating system(s) on the same computer, and during boot choose
which one to start, You may get confused about the correct time. If
the other operating systems do not understand Time Zones, they think
UTC is the local time and show the wrong time (unless You live in
London, England or some other place in the same time zone). /<p>

<p>DOS, OS/2 and Windows except NT do not use time zones. If You <em>need</em>
to have the correct local time in these operating systems, You have to
set the clock to local time. Debian Linux can live with this and it works, but if
Your main operating system(s) understand time zones, use them. </p>
      </sect>

      <sect>
        <heading>Syncing time, rdate and NTP</heading>
        <p>
         If You have another Unix computer which You know keeps the
correct time, with root privileges You can set the time with command
<prgn>rdate</prgn>. For example:
<example>
rdate <var>somehost.domain.com</var>
</example>
If You do not have an accurate time source, it is still a good idea to
set all Your computers to the same time, so You can compare <strong>time
stamps</strong> between hosts. </p>

<p>If You are connected to the Internet, You can install an NTP
client, for example <prgn>xntp3</prgn>. This uses the Network Time
Protocol RFC 1305?? to syncronize clocks to a few tens of milliseconds
precision. If You <em>need</em> this kind of precision or better, see also the
section Radio Clocks ???</p>

<p>See the exellent documentation that comes with <prgn>xntp3</prgn>,
in the Debian package <prgn>xntp3-doc</prgn>. It is very thorough and
    thus long, but think reading documents is a waste of time, just
    ask You Internet Service Provider or system administrator for NTP
    server names, or look up the nearest one in "List of Public NTP
    Servers" in http://www.eecis.udel.edu/~mills/ntp/servers.html . If 
    You start using an NTP server, it is usually polite to notify the
    servers administrator of the fact. </p>

<p>Once You know an NTP server, edit the file
      <prgn>/etc/ntp.conf</prgn> to add at least one server
      -line. Here is an example:
<example>
# /etc/ntp.conf, configuration for xntpd

logfile /var/log/xntpd
driftfile /var/lib/ntp/ntp.drift
statsdir /var/log/ntpstats/

statistics loopstats peerstats clockstats
filegen loopstats file loopstats type day enable
filegen peerstats file peerstats type day enable
filegen clockstats file clockstats type day enable

server ntp.somedomain.something
server ntp.something.else
</example></p>

<p>Note, that I changed the actual server name in the above example,
      to prevent all Debian Linux users blindly using that one
      server. Everything else except the server lines were there after 
    <prgn>xntp3</prgn> installation. </p>

      </sect>
      <sect>
        <heading>Setting up an NTP server</heading>
        <p>
         If You have several hosts that You want to syncronize, You
      should not let them all separately syncronize to an outside NTP
      server. This puts a load on the NTP server, and if it is a
      public and free service, the people the may start to dislike
      You. At least ask if it is OK to sync all of You machines
      there. 
        /<p>

<p>A better way is to set up one of Your hosts as NTP server, sync
that to the outside NTP server and the rest of Your hosts to Your own
NTP server. The <prgn>xntp3</prgn> package provides also the server
component, so You just need to configure it. This is not particularly
difficult either, but You should read the documentation and understand
the peer concept and stratum hierarchy. </p>

      </sect>
      <sect>
        <heading>Radio clocks</heading>
        <p>
        If You want better accuracy or can not sync to a NTP server in 
      the public Internet, You can purchase a radio clock. These get
      the time from time servers that use a very accurate clock, and
      broadcast time signals using radio waves. 
        <p>

	<p>There are radio clocks that need a ground based transmitter 
	  near enough to get the signal. If You get one of these, make 
	  sure You can receive the signal on the location where You
	  plan to use it. The transmitters are ground based, so they
	  don't work accross the globe. </p>

	<p>Another kind of radio clock uses a Global Positioning
	  System GPS receiver. GPS satellites circle the globe in low
	  earth orbits, and there should always be at least four above 
	the horizon. They are mainly used for navigation, but the
	  principle they work on is based on sending time signals. For 
	time syncronization it is enough to get the signal from one
	  satellite, but usually it is necessary to install the GPS
	  antenna outdoors to get good reception.</p>

<p>Pointers on radio clock hardware??? </p>
      </sect>

      <sect>
        <heading>Timestamps</heading>
        <p>
         Timestamps in files are in UTC. Can be compared between
separate computers provided clocks are synched. 
        <p>
      </sect>

      <sect>
        <heading>I forgot</heading>
        <p>
      what I was going to write here.
        <p>
      </sect>

    
<!--
??? Cron uses local time   
-->

 </chapt>
      
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:2
sgml-indent-data:t
sgml-parent-document:"system-administrator.sgml chapt sect"
sgml-exposed-tags:nil
sgml-local-catalogs:"/usr/lib/sgml/catalog"
sgml-local-ecat-files:nil
End:
-->