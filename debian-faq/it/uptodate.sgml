<!-- retain these comments for translator revision tracking -->
<!-- Original version: $Revision: 1.24 $ -->
<chapt id="uptodate">Mantenere il proprio sistema Debian aggiornato

<p>Uno degli scopi di Debian &egrave; quello di fornire un coerente percorso
di aggiornamento ed un sicuro processo di aggiornamento. Viene sempre
  fatto tutto il possibile per rendere semplice l'aggiornamento a
nuovi rilasci. Nel caso ci siano note importanti da aggiungere
al processo di aggiornamento, i pacchetti avvisano l'utente e spesso
forniscono una soluzione ad un possibile problema.

<p>Si dovrebbero inoltre leggere le Note di rilascio (Release Notes), documento che descrive i
dettagli degli specifici aggiornamenti. Viene fornito su tutti i CD Debian e disponibile
sul web all'indirizzo <url id="http://www.debian.org/releases/stable/releasenotes">.

<sect id="howtocurrent">Come si pu&ograve; mantenere il proprio sistema Debian aggiornato?

<p>Si pu&ograve; eseguire semplicemente un ftp anonimo ad un archivio Debian,
poi esplorare le directory fino a quando si trova il file desiderato,
scaricarlo e finalmente installarlo usando <tt>dpkg</tt>.
Si noti che <tt>dpkg</tt> installa i file aggiornati al volo,
anche su un sistema in esecuzione. Qualche volta, un
pacchetto revisionato richiede l'installazione di una rinnovata
versione di un altro pacchetto, in questo caso l'installazione
fallisce fino a quando l'altro pacchetto non sar&agrave; installato.

<p>Molte persone trovano questo approccio troppo dispendioso in termini di tempo, dato
che Debian si evolve molto rapidamente: tipicamente, sono caricati ogni settimana
una dozzina o pi&ugrave; di nuovi pacchetti. Questo numero aumenta appena prima
di un nuovo rilascio principale. Per gestire questa valanga, molte persone preferiscono
usare un metodo pi&ugrave; automatico. Sono disponibili diversi pacchetti a questo scopo:

<sect1 id="aptitude-upgrade">aptitude

<p>APT &egrave; un'interfaccia avanzata per il sistema di gestione dei
pacchetti di Debian. Ha un completo sistema di ordinamento delle
installazioni, capacit&agrave; di gestire pi&ugrave; fonti e molte altre funzionalit&agrave;
uniche; si veda la Guida utente in
<tt>/usr/share/doc/apt-doc/guide.html/index.html</tt> (&egrave; necessario
installare il pacchetto <tt>apt-doc</tt>).

<p><prgn/aptitude/ &egrave; il gestore di pacchetti raccomandato per i sistemi
&debian;.  &Egrave; un'interfaccia testuale ad APT che usa la libreria curses e
che pu&ograve; essere usata per eseguire compiti di gestione in modo veloce e semplice.

<p>Prima di poter usare <prgn/aptitude/, &egrave; necessario modificare il file
<tt>/etc/apt/sources.list</tt> per configurarlo. Se si desidera
aggiornare all'ultima versione stabile di Debian, probabilmente si vorr&agrave;
usare una fonte simile a quella seguente:

<example>http://ftp.us.debian.org/debian stable main contrib non-free</example>

<p>Si pu&ograve; sostituire ftp.us.debian.org con il nome di un mirror Debian
pi&ugrave; veloce e pi&ugrave; vicino. Per maggiori informazioni si veda l'elenco dei mirror su
<url id="http://www.debian.org/mirror/list">.

<p>Ulteriori dettagli a questo proposito possono essere trovati nella
pagina di manuale di <manref name="sources.list" section="8">.

<p>Per aggiornare il proprio sistema, eseguire
      <example>aptitude update</example>
seguito da
      <example>aptitude dist-upgrade</example>
Rispondere a tutte le domande eventualmente poste e il sistema sar&agrave; aggiornato.

Si veda anche <ref id="aptitude">.

<sect1 id="apt">apt-get, dselect e apt-cdrom

<p><prgn/apt-get/ &egrave; uno strumento a riga di comando basato su APT per
gestire i pacchetti ed il metodo APT di dselect &egrave; un'interfaccia ad APT
attraverso <prgn/dselect/. Entrambi forniscono un metodo semplice e
sicuro per installare ed aggiornare pacchetti.

<p>Per usare <prgn/apt-get/, installare il pacchetto <package/apt/ e
modificare il file <tt>/etc/apt/sources.list</tt> per configurarlo,
proprio come per <ref id="aptitude-upgrade">.

<p>Poi eseguire
      <example>apt-get update</example>
seguito da
      <example>apt-get dist-upgrade</example>
Rispondere a tutte le domande eventualmente poste e il sistema sar&agrave;
aggiornato. Si veda anche la pagina di manuale di <manref name="apt-get"
section="8">, oltre a <ref id="apt-get">.

<p>Per usare APT con <prgn/dselect/, scegliere il metodo di accesso APT
nella schermata di selezione dei metodi di dselect (opzione 0) e poi
specificare le fonti da usare. Il file di configurazione &egrave;
<file>/etc/apt/sources.list</file>. Si veda anche <ref id="dselect">.

<p>Se si vogliono usare dei CD per installare i pacchetti, si pu&ograve; usare <prgn/apt-cdrom/.
Per dettagli, si veda nelle Note di rilascio (Release Notes) la sezione
sull'impostazione di un aggiornamento da un mirror locale.

<p>Si noti che quando si ottengono e si installano i pacchetti, li si ha ancora
nella gerarchia di directory in /var. Per evitare che la propria
partizione strabordi, ricordarsi di eliminare i file in pi&ugrave;
usando <tt>apt-get clean</tt> e <tt>apt-get autoclean</tt>, oppure di
spostarli in qualche altro posto (consiglio: si usi <package/apt-move/).

<sect1 id="update_aptitude">aptitude


<p><prgn/aptitude/ &egrave; un'interfaccia testuale al sistema di gestione dei
pacchetti di Debian. Permette all'utente di visualizzare l'elenco dei
pacchetti e di eseguire compiti di gestione dei pacchetti come
installazioni, aggiornamenti e rimozioni (si veda <ref id="aptitude">).
Le azioni possono essere effettuate da un'interfaccia visuale o dalla
riga di comando.

<p>Nella riga di comando le azioni sono simili a quelle di APT, perci&ograve;
per aggiornare il proprio sistema eseguire

      <example>aptitude update</example>
seguito da
      <example>aptitude dist-upgrade</example>

<p><prgn/aptitude/ non &egrave; lo strumento raccomandato per aggiornare da un
rilascio precedente. Si leggano le Note di rilascio su <url id="http://www.debian.org/releases/stable/releasenotes">.

<p>Per i dettagli si vedano la pagina di manuale di <manref
name="aptitude" section="8"> e il
    file <file>/usr/share/aptitude/README</file>.


<sect1 id="mirror">mirror

<p>Questo script in Perl, e il suo (opzionale) programma di gestione chiamato
<prgn/mirror-master/, pu&ograve; essere usato per prelevare parti di alberi di directory
specificate dall'utente da uno specifico host via FTP anonimo.

<p><prgn/mirror/ &egrave; particolarmente utile per scaricare grandi
quantit&agrave; di software. Dopo che i file sono stati scaricati da un sito
per la prima volta, viene memorizzato nell'host locale un file
chiamato <tt>.mirrorinfo</tt>. <prgn/mirror/ tiene automaticamente
traccia dei cambiamenti al file system remoto, paragonando questo file
ad un file simile sul sistema remoto e scarica solo i file cambiati.

<p>Il programma <prgn/mirror/ &egrave; generalmente utile per aggiornare copie locali
di alberi di directory remoti. I file prelevati non devono
necessariamente essere file Debian. (Dato che <prgn/mirror/ &egrave; uno script
in Perl, pu&ograve; anche essere eseguito su sistemi non Unix.)  Sebbene il
programma <prgn/mirror/ fornisca meccanismi per escludere nomi di file
che corrispondono a stringhe definite dall'utente, questo programma &egrave;
pi&ugrave; utile quando l'obiettivo &egrave; scaricare interi alberi di directory,
piuttosto che pacchetti selezionati.

<!-- Should we recommend GNU wget here, too? -->

<sect1 id="dpkg-mountable">dpkg-mountable

<p>dpkg-mountable aggiunge un metodo di accesso chiamato "mountable"
alla lista di dselect, che permette di installare da qualsiasi filesystem
specificato in /etc/fstab. Per esempio, l'archivio potrebbe essere una
normale partizione di un hard disk o un server NFS che vengono, se
necessario, montati e smontati automaticamente.

<p>Possiede anche alcune caratteristiche aggiuntive non presenti
nei metodi standard di dselect, come la possibilit&agrave; di un albero
locale di file (sia parallelo alla distribuzione principale sia
totalmente separato), e il recupero dei soli pacchetti richiesti, piuttosto
di una scansione ricorsiva delle directory dispendiosa in termini di tempo,
cos&igrave; come la registrazione di tutte le azioni di dpkg nel metodo di installazione.

<sect id="upgradesingle">&Egrave; necessario entrare in modalit&agrave; singolo-utente per aggiornare un pacchetto?

<p>No. I pacchetti possono essere aggiornati al volo, anche su sistemi in esecuzione.
Debian ha un programma <tt>start-stop-daemon</tt> che viene invocato per fermare e
poi riavviare i processi in esecuzione, se necessario, durante
l'aggiornamento di un pacchetto.

<sect id="savedebs">&Egrave; necessario tenere tutti questi file di archivio .deb sul disco?

<p>No. Se i file sono stati scaricati nel proprio disco, possono essere
  rimossi dal sistema dopo l'installazione dei pacchetti; lo si pu&ograve; fare
  ad esempio eseguendo <tt>aptitude clean</tt>.

<sect id="keepingalog">Come si pu&ograve; tenere un registro dei pacchetti che
  sono stati aggiunti al sistema? Vorrei sapere quali aggiornamenti e
  rimozioni di pacchetti sono stati fatti!

<p>Passare l'opzione <tt>--log</tt> a <prgn/dpkg/ fa s&igrave; che <prgn/dpkg/
registri i cambiamenti di stato, gli aggiornamenti e le azioni. Registra
sia l'invocazione di <prgn/dpkg/ (ad esempio

<example>
2005-12-30 18:10:33 install hello 1.3.18 2.1.1-4
</example>

<p>) sia il risultato (ad esempio

<example>
2005-12-30 18:10:35 status installed hello 2.1.1-4
</example>

<p>)  Se si desidera tenere un registro di tutte le proprie invocazioni
di <prgn/dpkg/ (anche quelle fatte attraverso frontend come
<prgn/aptitude/), si pu&ograve; aggiungere

<example>
log /var/log/dpkg.log
</example>

<p>al proprio <file>/etc/dpkg/dpkg.cfg</file>. Assicurarsi che il file
di registro creato venga periodicamente ruotato. Se si usa
<prgn/logrotate/, questo pu&ograve; essere fatto creando un file
<file>/etc/logrotate.d/dpkg</file> che contenga

<example>
/var/log/dpkg {
  missingok
  notifempty
}
</example>

<p>Si possono trovare ulteriori dettagli sul registro di <prgn/dpkg/
nella pagina di manuale <manref name="dpkg" section="1">.

<p><prgn/aptitude/ tiene un registro delle installazioni, rimozioni e
degli aggiornamenti di pacchetti che intende effettuare in
<file>/var/log/aptitude</file>. Si noti che in questo file non sono
registrati i <em>risultati</em> di queste azioni.

<p>Un altro modo di registrare le proprie azioni &egrave; di eseguire la
propria sessione all'interno del programma <manref name="script"
section="1">.

<sect id="autoupdate">&Egrave; possibile aggiornare automaticamente il sistema?
 
<p>S&igrave;. Si pu&ograve; usare <prgn>cron-apt</prgn>; questo strumento aggiorna il
sistema ad intervalli regolari usando un compito cron. In modo
predefinito aggiorna solamente l'elenco dei pacchetti e scarica i nuovi
pacchetti senza installarli.
 
<p>Nota bene: l'aggiornamento automatico di pacchetti <strong/NON/ &egrave;
raccomandato nei sistemi <em>testing</em> o <em>unstable</em> dato che
potrebbe portare a comportamenti inattesi e rimuovere pacchetti senza
preavviso.

<sect id="aptproxy">Se si hanno svariate macchine come &egrave; possibile
scaricare gli aggiornamenti una volta sola?
 
<p>Se si ha pi&ugrave; di una macchina Debian nella propria rete, &egrave; utile usare
<prgn>apt-proxy</prgn> per mantenere aggiornati tutti i propri sistemi Debian.
 
<p><prgn>apt-proxy</prgn> riduce i requisiti in termini di banda per i
mirror Debian, riducendo la frequenza degli aggiornamenti dei file
Packages, Releases e Sources dal backend e scaricando ogni file una
singola volta, indipendentemente dalle effettive richieste per esso al
proxy. <prgn>apt-proxy</prgn> genera automaticamente un mirror HTTP
Debian in base alle richieste che passano per il proxy.

<p>Per maggiori dettagli si veda la pagina web di apt-proxy all'indirizzo <url
id="http://apt-proxy.sourceforge.net/">.

<p>Naturalmente si possono ottenere gli stessi benefici se si sta gi&agrave;
usando un proxy standard con cache e se tutti i propri sistemi sono
configurati per farne uso.

