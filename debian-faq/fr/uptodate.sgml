<!-- Subversion revision of original English document "5034" -->

<chapt id="uptodate">Garder son système Debian à jour

<p>L'un des buts de Debian est de fournir un chemin de mise à jour compatible
et un processus de mise à jour sûr. Nous faisons toujours de notre mieux pour
que la mise à jour des nouvelles versions soit une procédure douce. Dans
certain cas, il peut y avoir des avertissements importants lors du processus de
mise à jour, l'utilisateur en sera alerté et souvent une solution à un possible
problème sera fournie.

<p>Vous pouvez aussi lire les notes de publication, qui décrivent en détail les 
spécificités de la mise à jour, présentes sur tous les CD-ROM de Debian et
disponibles sur le site web à l'adresse  
<url id="http://www.debian.org/releases/stable/releasenotes">.


<sect id="howtocurrent">Comment puis-je garder mon système à jour&nbsp;?

<p>On pourrait simplement ouvrir une session FTP anonyme vers une archive
Debian, parcourir les répertoires jusqu'à ce qu'on trouve le fichier désiré, le
récupérer et enfin l'installer en utilisant <tt>dpkg</tt>. Notez que dpkg
installera les fichiers mis à jour à leur place, même sur un système en marche.
Parfois, la mise à jour d'un paquet aura besoin de l'installation d'une
nouvelle version d'un autre paquet, auquel cas l'installation échouera si
l'autre paquet n'est pas installé.

<p>Beaucoup de gens trouvent cette approche trop gourmande en temps, car Debian
évolue très rapidement&nbsp;; typiquement, une douzaine ou plus de nouveaux
paquets sont téléchargés chaque semaine. Ce nombre est encore plus grand avant
la sortie d'une version majeure. Pour gérer cette avalanche, beaucoup de gens
préfèrent utiliser une méthode automatique. Plusieurs outils de gestion des
paquets sont disponibles dans ce but&nbsp;:

<sect1 id="aptitude-upgrade">aptitude

<p>APT est une interface avancée pour le système de gestion des paquets
Debian. Il fournit les fonctionnalités d'ordonnancement d'installation
complet, de possibilités de sources multiples et plusieurs autres
fonctionnalités uniques, voir le guide de l'utilisateur
<tt>/usr/share/doc/apt-doc/guide.html/index.html</tt> (vous pouvez aussi installer
le paquet <tt>apt-doc</tt>).
<p><prgn/aptitude/ est le gestionnaire de paquets recommandé pour les systèmes
&debian;. C'est une interface en mode texte à APT qui utilise la bibliothèque
curses et peut être utilisé pour améliorer la gestion des tâches de façon
rapide et facile.
<p>Avant de pouvoir utiliser <prgn/aptitude/, vous devrez éditer le fichier
<tt>/etc/apt/sources.list</tt> pour le configurer. Si vous souhaitez mettre à
jour votre système vers la dernière version stable de Debian, vous voudrez
probablement utiliser une ligne comme celle-là&nbsp;:

<example>http://ftp.us.debian.org/debian stable main contrib non-free</example>

<p>Vous pouvez remplacer ftp.us.debian.org avec le nom d'un miroir Debian plus
proche de chez vous et plus rapide. Voir la liste des miroirs à l'adresse 
<url id="http://www.debian.org/mirror/list"> pour plus d'informations.

<p>Vous trouverez plus d'informations en lisant la pages de manuel
<manref name="sources.list" section="8">.

<p>Pour mettre à jour votre système, exécutez
       <example>aptitude update</example>
suivi de
       <example>aptitude dist-upgrade</example>
Répondez à toutes les questions qui vous seront posées et votre système sera mis à jour.

Voir aussi <ref id="aptitude">.
  	 
<sect1 id="apt">apt-get, dselect et apt-cdrom
  	 
<p><prgn/apt-get/ est un outil en ligne de commandes basé sur APT pour gérer
les paquets et la méthode APT dselect est une interface pour APT par
<prgn/dselect/. Les deux sont un moyen simple et sûr d'installer et de mettre à
jour des paquets.

<p>Pour utiliser <prgn/apt-get/, installez le paquet <package/apt/, et éditez
le fichier <tt>/etc/apt/sources.list</tt> pour le configurer, tout comme pour
<ref id="aptitude-upgrade">.

<p>Exécutez
      <example>apt-get update</example>
suivi de
      <example>apt-get dist-upgrade</example>
Répondez à toutes les questions qui vous seront posées et votre système sera mis à jour.
Vous trouverez plus d'informations en lisant la pages de manuel
<manref name="apt-get" section="8"> et aussi <ref id="apt-get">.

<p>Pour utiliser APT avec <prgn/dselect/, choisissez la méthode d'accès par APT
dans l'écran de sélection de méthode de dselect (option 0) et indiquez les sources
devant être utilisées. Le fichier de configuration est <file>/etc/apt/sources.list</file>.
Vous pouvez également consulter <ref id="dselect">.

<p>Si vous souhaitez utiliser les CD-ROM pour installer les paquets, vous 
pouvez utiliser le programme <prgn/apt-cdrom/. Pour plus de détails, veuillez-vous
reporter aux notes de publication, paragraphe «&nbsp;Ajouter des sources Internet à apt&nbsp;».

<p>Veuillez noter que quand vous installez un paquet, les archives sont conservées dans 
un sous-répertoire de /var. Pour ne pas saturer votre partition, vous devriez supprimer
les archives en utilisant <tt>apt-get clean</tt> et <tt>apt-get autoclean</tt> ou les 
déplacer à un autre endroit (conseil&nbsp;: utiliser <package/apt-move/).

<sect1 id="update_aptitude">aptitude

<p><prgn/aptitude/ est une interface en mode texte pour le système de paquets
Debian. Elle permet à l'utilisateur de voir la liste des paquets et d'effectuer
des tâches de gestion des paquets telles que l'installation, la mise à jour ou
la suppression de paquets (consultez <ref id="aptitude">).
Les actions peuvent être effectuées à partir d'une interface visuelle ou en
ligne de commandes.

<p>En ligne de commandes, les actions sont similaires à celles de APT&nbsp;; pour
mettre à jour votre système, exécutez
     <example>aptitude update</example>
suivi de 
     <example>aptitude dist-upgrade</example>

<p>Pour effectuer une mise à jour depuis une version précédente,
<prgn/aptitude/ est l'outil recommandé. Vous pouvez lire les notes de
publication à <url id="http://www.debian.org/releases/stable/releasenotes">.

<p>Vous trouverez plus d'informations en lisant la pages de manuel
<manref name="sources.list" section="8"> et le fichier <file>/usr/share/aptitude/README</file>.

<sect1 id="mirror">mirror

<p>Ce script Perl et son programme (optionel) de gestion nommé <prgn/mirror-master/,
peuvent être employés pour rechercher des parties indiquées par l'utilisateur d'une
arborescence de répertoire sur un serveur particulier <em>via</em> un FTP anonyme.

<p><prgn/Mirror/ est particulièrement utile pour télécharger un grand nombre
de logiciels. Après le premier téléchargement, un fichier nommé <tt>.mirrorinfo</tt>
est conservé sur l'ordinateur local. Les changements du système de fichiers distant
sont détectés automatiquement par <prgn/mirror/, qui compare le fichier local avec 
un fichier semblable sur le système distant et télécharge seulement les fichiers 
modifiés.

<p>Le programme <prgn/mirror/ est généralement utile pour mettre à jour les
copies locales des arborescences de répertoire distant. Les fichiers cherchés
n'ont pas besoin d'être des fichiers Debian. (Depuis que le programmme
<prgn/mirror/ a été porté en Perl, il peut aussi être exécuté sur des systèmes
non-Unix). Bien que le programme <prgn/mirror/ fournisse des mécanismes pour
exclure des fichiers dont les noms correspondent à des chaînes indiquées par
l'utilisateur, ce programme est plus utile quand son objectif est de
télécharger des arborescences entières, plutôt que des paquets choisis.

<!-- Should we recommend GNU wget here, too? -->

<sect1 id="dpkg-mountable">dpkg-mountable

<p>Dpkg-mountable ajoute une méthode d'accès nommée «&nbsp;mountable&nbsp;» à la liste de dselect, 
qui vous permet d'installer depuis tout système de fichiers indiqué dans /etc/fstab.
Par exemple, l'archive peut être sur un disque dur local ou sur un serveur NFS
qui sera automatiquement monté et démonté si nécessaire.

<p>Il a aussi quelques fonctionnalités supplémentaires que l'on ne trouve pas
avec les méthodes standards de dselect, telle que la disposition dans une
arborescence locale de fichier (soit en parallèle de la distribution principale
soit totalement séparée), et en obtenant seulement les paquets qui sont exigés,
plutôt qu'en effectuant un long balayage récursif de répertoires et également
la journalisation de toutes les actions de dpkg dans la méthode d'installation.

<sect id="upgradesingle">Faut-il être dans le mode mono-utilisateur pour mettre 
		à jour un paquet&nbsp;?

<p>Non. Les paquets peuvent être mis à jour en mode multi-utilisateur, même quand le système
est en fonctionement. Il y a sur les systèmes Debian le programme <tt>start-stop-daemon</tt>
qui permet d'arrêter et de redémarrer les processus en cours d'exécution si cela est nécessaire
pendant la mise à jour du paquet.

<sect id="savedebs">Faut-il garder toutes les achives .deb sur le disque&nbsp;?

<p>Non. Si vous avez téléchargé les fichiers sur votre disque, alors après 
avoir installé les paquets vous pouvez les supprimer de votre système, par
exemple en exécutant <tt>aptitude clean</tt>.

<sect id="keepingalog">Comment puis-je garder un journal des paquets que j'ai ajoutés 
au système ? J'aimerais savoir quand et quelles mises à jour et
suppressions de paquets ont eu lieu !

<p>Passer l'option <tt>--log</tt> à <prgn/dpkg/ active le journal des mises à
jour et suppression de <prgn/dpkg/. Cela enregistre à la fois l'appel de <prgn/dpkg/-invokation (e.g.
<example>
2005-12-30 18:10:33 install hello 1.3.18 2.1.1-4
</example>
  	 
<p>) et les résultats (par exemple
  	 
<example>
2005-12-30 18:10:35 status installed hello 2.1.1-4
</example>

<p>)  Si vous aimeriez enregistrer tous vos appels à <prgn/dpkg/ (même ceux
effectués en utilisant une interface telle que <prgn/aptitude/), vous pouvez
ajouter

<example>
log /var/log/dpkg.log
</example>
  	 
<p>dans votre <file>/etc/dpkg/dpkg.cfg</file>. Soyez sûr que votre fichier de
journal sera recyclé périodiquement. Si vous utilisez <prgn/logrotate/, cela
peut être réalisé en créant un fichier <file>/etc/logrotate.d/dpkg</file> qui
contient

  	 
<example>
/var/log/dpkg {
  missingok
  notifempty
}
</example>
<p>Vous trouverez plus de détails sur la journalisation de <prgn/dpkg/ dans la
page de manuel de <manref name="dpkg" section="1">.

<p><prgn/aptitude/ enregistre les installations, les suppressions et les mises
à jour de paquets qu'il s'apprête à effectuer dans le fichier
<file>/var/log/aptitude</file>. Notez que les <em>résultats</em> de ces
actions ne sont pas enregistrés dans ce fichier !

<p>Une autre façon d'enregistrer vos actions est d'exécuter votre session de
gestion de paquets dans le programme <manref name="script" section="1">.

<sect id="autoupdate">Puis-je mettre à jour automatiquement le système ?
  	 
 <p>Oui. Vous pouvez utiliser <prgn>cron-apt</prgn> ; cet outil met à jour le
 système à intervalle régulier en utilisant un cron. Par défaut, il met juste à
 jour la liste des paquets et télécharge les nouveaux paquets mais ne les
 installe pas.
  	 
<p>Note : La mise à jour automatique des paquets n'est <strong/PAS/
recommandée sur les systèmes <em>testing</em> ou <em>unstable</em>, car cela
peut apporter un comportement inattendu ou supprimer des paquets sans le
notifier.

<sect id="aptproxy">J'ai plusieurs machines : comment puis-je télécharger
les mises à jour seulement une fois ?

<p>Si vous avez plus d'une machine Debian dans votre réseau, il est utile d'utiliser 
<prgn>apt-proxy</prgn> pour garder tous vos systèmes Debian à jour.

<p><prgn>apt-proxy</prgn> réduit les besoins de bande passante des miroirs Debian
en diminuant la fréquence de mises à jour du fichier de paquets, publications et sources 
à partir de l'utilisateur et ainsi récupérer une seule fois chaque fichier, indépendamment
de la requête actuelle, à partir du proxy. <prgn>apt-proxy</prgn> construit automatiquement
un miroir HTTP Debian basé sur les requêtes qui passent par le proxy.

<p>Pour plus de détails, consultez le site web d'apt-proxy à l'adresse <url
id="http://apt-proxy.sourceforge.net/">
    
<p>Évidemment, vous pouvez profiter des mêmes améliorations avec un proxy
standard pour lequel tous vos systèmes sont configurés.
