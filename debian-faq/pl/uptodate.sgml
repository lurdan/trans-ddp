<chapt id="uptodate">Aktualizowanie systemu Debian

<p>Celem Debiana jest udostêpnianie spójnych sposobów uaktualnieñ
oraz bezpiecznego procesu unowocze¶niania wersji. Robimy wszystko,
co w naszej mocy, aby zapewniæ ³agodny system uaktualniania.

Je¶li podczas aktualizacji pakietu u¿ytkownik musi zostaæ o czym¶
poinformowany, zostanie to uczynione, a czêsto tak¿e zostanie
poinstruowany w jaki sposób rozwi±zaæ ewentualne problemy.

<p>Nale¿y czytaæ notatki do wydañ (Release Notes), które opisuj±
szczegó³y uaktualnieñ i które s± dostêpne na wszystkich p³ytach CD
Debiana oraz pod adresem:
<url id="http://www.debian.org/releases/stable/releasenotes">.

<sect id="libc5to6upgrade">Jak mogê uaktualniæ mojego Debiana 1.3.1 (lub wcze¶niejszego),
opartego na libc5, do wersji 2.0 (lub pó¼niejszej), opartej na libc6?

<p>Istnieje kilka dróg takiego uaktualnienia:
<list>
  <item>
	U¿ywaj±c prostego skryptu pow³oki nazwanego <tt>autoup.sh</tt>,
	który uaktualnia najwa¿niejsze pakiety. Po tym jak skoñczy on swoj±
	pracê, mo¿esz u¿yæ programu <prgn>dselect</prgn> do masowej
	instalacji wymaganych pakietów. Jest to rekomendowana, aczkolwiek
	nie jedyna metoda.

	<p>Obecnie najnowsze wydanie skryptu <tt>autoup.sh</tt> mo¿e byæ
	znalezione w nastêpuj±cych miejscach:
    <list>
      <item><url id="http://www.debian.org/releases/2.0/autoup/">
      <item><url id="http://www.taz.net.au/autoup/">
      <item><url id="http://debian.vicnet.net.au/autoup/">
    </list>

  <item>
	Pod±¿aj±c za radami z dokumentu:
	<url name="Debian libc5 to libc6 Mini-HOWTO"
		 id="http://debian.vicnet.net.au/autoup/HOWTO/libc5-libc6-Mini-HOWTO.html">
	uaktualniaæ najwa¿niejsze pakiety rêcznie. Skrypt <tt>autoup.sh</tt> bazuje na tym w³a¶nie
	Mini-HOWTO, wiêc ta metoda dzia³a mniej wiêcej tak, jak u¿ycie <tt>autoup.sh</tt>.

  <item>
	U¿ywaj±c opartego na libc5 programu <tt>apt</tt>. APT oznacza A Package Tool
	i pewnego dnia zast±pi wys³u¿ony program <prgn>dselect</prgn>. Obecnie
	<prgn>apt</prgn> dzia³a z linii poleceñ lub jako jedna z metod dostêpu
	<prgn>dselect</prgn>a. Wersjê bazuj±c± na libc5 znajdziesz w katalogu
	<tt>dists/slink/main/upgrade-older-i386</tt> w archiwum Debiana.

<item>
	U¿ywaj±c programu <prgn>dselect</prgn> bez uaktualniania
	wcze¶niej ¿adnych pakietów rêcznie. Stanowczo NIE polecamy tej metody
	je¶li mo¿esz jej unikn±æ, poniewa¿ <prgn>dselect</prgn> nie instaluje
	pakietów w optymalnej kolejno¶ci. APT dzia³a o wiele lepiej i jest bezpieczniejszy.
    <!-- This should probably work if dpkg's max-error-before-stop internal
    variable is increased. Question: Will it be increased some day? -->
</list>

<!--
This paragraph is obsolete, but I will keep it here as a reminder in
case libc6-based dpkg happen to be some better than the one in Debian
1.3.1: Note that the version of <tt>dpkg</tt> in this directory has the
a.out binary format.  The versions of <tt>dpkg</tt> in the development and
stable trees have the ELF format.
-->

<sect id="howtocurrent">Jak mogê utrzymaæ ci±gle aktualn± wersjê Debiana?


<p>Mo¿na po prostu po³±czyæ siê anonimowo przez FTP z serwerem zawieraj±cym 
archiwum Debiana, uwa¿nie przyjrzeæ siê katalogom, znale¼æ po¿±dane pliki, 
pobraæ je i zainstalowaæ z u¿yciem <tt>dpkg</tt>. 
<tt>dpkg</tt> instaluje uaktualnienia na ¿ywo, nawet na pracuj±cym 
systemie. Czasami poprawione pakiety wymagaj± instalacji innych, 
równie¿ poprawnionych wersji pakietów powi±zanych i wtedy instalacja 
siê nie uda, póki owe pakiety nie zostan± zainstalowane.

<p>Wielu u¿ytkowników uzna takie podej¶cie za zbyt czasoch³onne,
zw³aszcza ¿e Debian rozwija siê szybko i typowo oko³o tuzin lub wiêcej
pakietów jest uaktualnianych tygodniowo. Ta ilo¶æ jest o wiele wiêksza przed
wydaniem kolejnej g³ównej wersji. Aby poradziæ sobie z tak± lawin±,
u¿ytkownicy zazwyczaj wol± u¿ywaæ bardziej zautomatyzowanych metod.

<p>Oto kilka metod automatyzacji:

<sect1 id="apt">APT

<p>APT to zaawansowany interfejs do systemu pakietów Debiana.
apt-get to oparte o liniê poleceñ narzêdzie do obs³ugi pakietów,
a metoda APT dselecta to interfejs do APT z programu <prgn>dselect</prgn>.
Obydwa z nich udostêpniaj± prostszy i bezpieczniejszy sposób instalacji
oraz uaktualniania pakietów.

<p>APT potrafi ustalaæ kolejno¶æ instalacji, pobieraæ dane z wielu ¼róde³
jak równie¿ wiele innych, unikalnych rzeczy, o których mo¿esz przeczytaæ
w <tt>/usr/share/doc/apt/guide.html/index.html</tt>.

<p>Zainstaluj pakiet <package>apt</package> i zmodyfikuj
plik <tt>/etc/apt/sources.list</tt>. Je¶li chcesz u¿ywaæ jako
¼ród³a pakietów najnowszej, stabilnej wersji Debiana, mo¿esz
u¿yæ np.:

<example>http://http.us.debian.org/debian stable main contrib non-free</example>

<p>Mo¿esz równie¿ zast±piæ http.us.debian.org nazw± szybszego serwera lustrzanego
dostêpnego z Twojej lokalizacji. Listê serwerów znajdziesz tutaj:
<url id="http://www.debian.org/misc/README.mirrors">.

<p>Wiêcej informacji na ten temat znajdziesz w podrêczniku systemowym:
<manref name="apt-get" section="8"> oraz <manref name="sources.list" section="8">
a tak¿e w przewodniku <tt>/usr/share/doc/apt/guide.html/index.html</tt>.

<p>Uruchom:
      <example>apt-get update</example>
a nastêpnie:
      <example>apt-get dist-upgrade</example>
Odpowiedz na wszystkie ewentualne pytania, zadane przez system i Twój Debian
zostanie uaktualniony.

<p>Aby u¿ywaæ systemu APT z programem <prgn>dselect</prgn>,
wybierz metodê dostêpu APT w g³ównym ekranie programu <prgn>dselect</prgn>
(opcja 0) i okre¶l ¼ród³a pakietów, jakie maj± byæ u¿ywane. Plik konfiguracyjny
to <file>/etc/apt/sources.list</file>, a jego format opisany jest na stronach
podrêcznika systemowego: <manref name="sources.list" section="5">.

<p>Je¶li chcesz wykorzystaæ p³yty CD do instalacji pakietów,
mo¿esz u¿yæ programu <prgn>apt-cdrom</prgn>. Szczegó³y znajdziesz
w notatkach z wydañ (Release Notes) w sekcji ,,Uaktualnienia z
lokalnych serwerów lustrzanych'' ("Setting up for an upgrade from
a local mirror").

<p>Pamiêtaj, ¿e po pobraniu i zainstalowaniu pakietów s± one nadal
przechowywane w hierarchii katalogu /var. Aby nie dopu¶ciæ do zape³nienia
partycji, usuwaj zbêdne pliki przy u¿yciu poleceñ <tt>apt-get clean</tt>
i <tt>apt-get autoclean</tt> lub przeno¶ je w inne miejsce (np. programem
<package>apt-move</package>).

<sect1 id="dpkg-ftp">dpkg-ftp

<p>Jest to starsza metoda wykorzystywana przez program <prgn>dselect</prgn>.
Mo¿e zostaæ wywo³ana z <prgn>dselect</prgn>a, przez co pozwala na pobranie 
plików oraz ich zainstalowanie w jednym kroku
Aby tego dokonaæ, wybierz metodê <tt>ftp</tt> dostêpu do ¼ród³a pakietów
w programie <prgn>dselect</prgn> (opcja 0) i okre¶l nazwê odleg³ej maszyny
oraz katalog. <prgn>dpkg-ftp</prgn> automatycznie pobierze pliki, które
s± wybrane (w tej lub poprzednich sesjach <prgn>dselect</prgn>a).

<p>Zauwa¿, ¿e w przeciwieñstwie do programu
<prgn>mirror</prgn>, <prgn>dpkg-ftp</prgn> nie pobiera wszystkiego z
serwera, a jedynie tylko te pliki, które zosta³y zaznaczone (podczas
uruchomienia <prgn>dpkg-ftp</prgn>) i które wymagaj± uaktualnienia.

<p><prgn>dpkg-ftp</prgn> jest nieco przestarza³y. Nale¿y raczej u¿ywaæ
systemu APT z odno¶nikami do ¼róde³ na FTP (ftp://) w pliku
<file>sources.list</file>).

<sect1 id="mirror">mirror

<p>Ten skrypt napisany w Perlu oraz jego (opcjonalny) dodatek
o nazwie <prgn>mirror-master</prgn> mog± byæ u¿ywane do pobrania
okre¶lonej czê¶ci drzewa katalogów z wybranego serwera poprzez
anonimowy dostêp do FTP.

<p><prgn>mirror</prgn> jest szczególnie u¿yteczny do pobierania
du¿ych zbiorów oprogramowania. Po pierwszym za³adowaniu plików,
na lokalnym komputerze powstaje plik <tt>.mirrorinfo</tt>. Zmiany
w odleg³ym systemie plików s± ¶ledzone automatycznie przez
<prgn>mirror</prgn>, który porównuje ten plik z analogicznym po
stronie odleg³ego systemu i pobiera tylko zmienione elementy.

<p>Program <prgn>mirror</prgn> jest zazwyczaj u¿ywany do uaktualniania
lokalnej kopii umieszczonego na odleg³ym systemie drzewa katalogów.
Pobierane pliki nie musz± byæ plikami Debiana. (Poniewa¿ <prgn>mirror</prgn>
jest skryptem Perla, mo¿e byæ uruchamiany równie¿ na nieuniksowych
systemach).
Chocia¿ <prgn>mirror</prgn> udostêpnia mechanizmy pozwalaj±ce na
wy³±czenie plików, których nazwy pasuj± do okre¶lonych wzorców,
to jednak program jest najbardziej u¿yteczny, gdy jego celem jest pobieranie
ca³ych fragmentów drzewa katalogów, a nie wybranych pakietów.

<!-- Should we recommend GNU wget here, too? -->

<sect1 id="dpkg-mountable">dpkg-mountable

<p>dpkg-mountable dodaje now± metodê dostêpu do listy dselecta - tzw.
`mountable'. Pozwala ona na instalacjê pakietów z dowolnego systemu plików
podanego w /etc/fstab. Mo¿e to byæ na przyk³ad zwyk³a partycja na dysku lub
serwerze NFS, która w razie potrzeby zostanie automatycznie zamontowana i
odmontowana.

<p>Obs³uguje tak¿e parê rzeczy niedostêpnych w zwyk³ym <prgn>dselect</prgn>,
takich jak obs³uga lokalnych sytemów katalogów (zarówno równoleg³ych do
g³ównego, dystrybucyjnego drzewa, jak i dla zupe³nie oddzielnych),
¶ci±ganie jedynie tych pakietów, które s± wymagane, zamiast czasoch³onnego,
rekurencyjnego przeszukiwania katalogów, jak równie¿ rejestrowanie
wszystkich czynno¶ci wykonanych przez <prgn>dpkg</prgn>  w fazie
instalacji.

<sect id="upgradesingle">Czy muszê przechodziæ w tryb pojedynczego
        u¿ytkownika, by móc zaktualizowaæ pakiety?

<p>Nie. Pakiety mog± byæ uaktualniane nawet w trakcie normalnej
pracy systemu. Debian zawiera program <tt>start-stop-daemon</tt>,
który jest wykonywany w celu zatrzymania, a pó¼niej ponownego
uruchomienia dzia³aj±cych procesów, je¶li to konieczne, podczas
uaktualniania pakietu.

<sect id="savedebs">Czy muszê trzymaæ te wszystkie pliki .deb
	na swoim dysku?

<p>Nie. Je¶li masz na dysku pobrane pliki (takie, które nie
s± koniecznie potrzebne - zobacz opis dpkg-ftp powy¿ej), to po
zainstalowaniu pakietów, mo¿esz usun±æ te pliki z systemu.

<sect id="keepingalog">Jak mogê otrzymaæ zapiski z czynno¶ci dodawania
	pakietów do systemu?

<p><prgn>dpkg</prgn> notuje jakie pakiety by³y rozpakowywane, konfigurowane,
usuwane, dodawane lub przeczyszczane, jednak¿e nie przechowuje (obecnie)
informacji o dzia³aniach u¿ytkownika na terminalu podczas operacji
na pakiecie.

<p>Najlepszym obej¶ciem tego problemu jest uruchomienie
<prgn>dpkg</prgn>/<prgn>dselect</prgn>/<prgn>apt-get</prgn>/cokolwiek
wewn±trz sesji programu <manref name="script" section="1">.
