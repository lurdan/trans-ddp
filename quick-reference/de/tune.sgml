<!-- CVS revision of this document "$Revision: 1.21 $"  -->
<!-- CVS revision of original english document "1.113"  -->
<!-- This file is part of the german Version of the debian reference -->
<!-- Document is available at qref.sourceforge.net -->
<!-- Übersetzung 11/2002 Stefan Schroeder, stefan@fkp.uni-hannover.de -->

<chapt id="tune">Tunen eines &debian;-Systems
<p>
Dieses Kapitel beschreibt nur die Grundlagen der Systemkonfiguration mittels
textbasierter Schnittstellen. Sinnvolles Vorwissen liefert
<ref id="install">.
<p>
Für diejenigen Leser, die besonders Wert auf die Sicherheit ihres Systems
legen, sollte das <url id="&securing-debian-howto;"
name="Securing Debian Manual"> Pflichtlektüre sein. Dieses Dokument findet
sich auch im Paket <package>&p-securing-debian-howto;</package>.

<sect id="init-hints">Hinweise zur System-Inititalisierung
<p>
Der Abschnitt <ref id="init"> beschreibt die Grundlagen der &debian;
init-Skriptdateien.

<sect1 id="init-defaults">Anpassen der Init-Skripte
<p>
Die Debian-Distribution verwendet das sys-V System für die Init-Skripte.
Da alle Dateien unterhalb von <file>/etc/init.d/*</file> als
Konfigurationsdateien angesehen werden, können sie vom Systemadministrator
beliebig verändert werden. Dennoch ist der empfohlene Ansatz, die Dateien in
<file>/etc/default/*</file> anzupassen.
<p>
Die Datei <file>/etc/init.d/rcS</file> dient z.B. zum Einstellen von
Vorgaben, die beim Systemstart aktiviert werden sollen. Hier können Programme
wie <prgn>motd</prgn> oder <prgn>sulogin</prgn> konfiguriert bzw. gestartet
werden.

<sect1 id="syslogd">Anpassen der System-Protokollierung
<p>
Die Art und Weise der System-Protokollierung kann in der Konfigurationsdatei
des <file>syslogd</file> in <file>/etc/syslog.conf</file> bestimmt werden.
Das <package>colorize</package> Paket kann die Ausgaben dieses Daemons nach
belieben färben, um die Übersicht zu erhöhen. Vergleichen Sie <manref
name="syslogd" section="8"> und <manref name="syslog.conf" section="5">.
</sect1>

<sect1 id="hdtune">Hardware-Optimierung
<p>
Einige Optimierungen der Hardware überlässt &debian; dem Systemadministrator.
<list>
<item><package>hdparm</package>
      <list compact>
      <item>Optimierung des Festplattenzugriffs. Sehr effektiv.
      <item>Aber auch gefährlich. Die Handbuchseite <manref name="hdparm"
            section="8"> sollte auf jeden Fall zuvor gelesen werden.
      <item><tt>hdparm -tT <var>/dev/hda</var></tt> testet die
            Geschwindigkeit der Festplatte.
      <item><tt>hdparm -q -c3 -d1 -u1 -m16 <var>/dev/hda</var></tt> aktiviert
            einige der Optimierungen einer IDE-Festplatte (Dies kann
            gefährlich sein, nicht einfach übernehmen!)
      </list>

<item><package>setcd</package>
      <list compact>
      <item>Optimierung des Zugriffs auf CD-Geräte.
      <item><tt>setcd -x <var>2</var></tt> verringert die Geschwindigkeit auf
            <var>2</var>x.
      <item>Vergleichen Sie <manref name="setcd" section="1">.
      </list>

<item><package>setserial</package>
      <list compact>
      <item>Dieses Paket enthält eine Sammlung von Programmen zur Einstellung
            der seriellen Schnittstelle.
      </list>

<item><package>scsitools</package>
      <list compact>
      <item>Dieses Paket enthält eine Sammlung von Programmen zur Einstellung
            der SCSI-Schnittstelle.
      </list>

<item><package>memtest86</package>
      <list compact>
      <item>Dieses Paket enthält eine Sammlung von Programmen zum Testen des
            Speichers.
      </list>

<item><package>hwtools</package>
      <list compact>
      <item>Dieses Paket enthält eine Sammlung von Programmen, die den
            Low-Level-Zugriff auf Einstellungen der Hardware ermöglichen:
            <list compact>
            <item><prgn>irqtune</prgn>: Ändert die IRQ-Priorität von Geräten,
                  um höhere Prioritäten und schnelleren Zugriff zu
                  ermöglichen (z.B. für serielle Ports, Modems). Eine
                  Beschleunigung um den Faktor 3 ist bei seriellen Ports und
                  Modems möglich.
            <item><prgn>scanport</prgn>: Durchsucht den I/O-Adressraum von
                  0x100 bis 0x3ff auf der Suche nach Geräten am ISA-Bus.
            <item><prgn>inb</prgn>: Ein kleines Programm das den IO-Port
                  ausliest und den Inhalt in hexadezimaler und binärer
                  Darstellung ausgibt.
            </list>
      </list>

<item><package>schedutils</package>
      <list compact>
      <item>Linux Scheduler-Werkzeuge. (Der Scheduler verwaltet die
            Zeitscheibe, mit der Prozesse Rechenzeit zugewiesen bekommen.)
      <item><prgn>taskset</prgn>, <prgn>irqset</prgn>, <prgn>lsrt</prgn> und
            <prgn>rt</prgn> sind in diesem Paket enthalten.
      <item>Zusammen mit den schon beschriebenen <prgn>nice</prgn> und
            <prgn>renice</prgn> Programmen (die aber nicht enthalten sind),
            können die Scheduler-Parameter bis ins Detail verwaltet werden.
      </list>
</list>
<p>
Das Mounten eines Dateisystems mit der noatime Option ist auch sehr effektiv
zur Beschleunigung von Lesezugriffen auf Dateien. Vergleichen Sie <manref
 name="fstab" section="5"> und <manref name="mount" section="8">.
<p>
Bestimmte Hardware kann direkt durch den Linux Kernel und das proc
Dateisystem getunt werden. Vergleichen Sie <ref id="proc-sys">.
<p>
Es gibt viele hardwarespezifische Konfigurationshilfsmittel in Debian. Viele
von diesen beziehen sich auf Laptops. Einige interessante in Debian
verfügbare Pakete sind:
<list compact>
<item><package>tpconfig</package> - ein Programm zur Konfiguration von
      Touchpads
<item><package>apmd</package> - Programme für Advanced Power Management (APM)
<item><package>acpi</package> - zeigt Informationen zu ACPI Geräten an
<item><package>acpid</package> - Hilfsmittel zur Verwendung von ACPI
<item><package>lphdisk</package> - bereitet eine Hibernation-Partition für
      Phoenix NoteBIOS vor
<item><package>sleepd</package> - lässt ein Notebook während Inaktivität
      schlafen
<item><package>noflushd</package> - erlaubt es inaktiven Festplatten
      herunterzufahren
<item><package>big-cursor</package> - größerer Mauscursor für X
<item><package>acme</package> - Aktiviert die "Multimedia Tasten" von Laptops
<item><package>tpctl</package> - Konfigurationstools für IBM ThinkPad
      Hardware
<item><package>mwavem</package> - Unterstützung von Mwave/ACP Modems
<item><package>toshset</package> - erlaubt Zugriff auf die meisten
      Hardwareschnittstellen eines Toshiba Laptops
<item><package>toshutils</package> - Hilfsmittel für Toshiba Laptops
<item><package>sjog</package> - Programm zum Zugriff auf das "Jog Dial"
      (Drehrad) in Sony Vaio Laptops
<item><package>spicctrl</package> - Programm für das Sony Vaio zum Einstellen
      der Helligkeit des LCD
</list>
ACPI ist ein moderneres Protokoll für das Power-Management als APM.
<p>
Einige dieser Pakete erfordern spezielle Kernel-Module. Diese sind in der
Regel bereits in den neuesten Kernelquellen enthalten. Bei Problemen kann es
notwendig sein, selbst den neuesten Patch in den Kernel einzuspielen.

<sect>Zugriffskontrolle

<sect1 id="loginctrl">Zugriffskontrolle mit PAM und login
<p>
PAM (Pluggable Authentication Modules) erlaubt die Kontrolle von Logins.
<example>
/etc/pam.d/*             # PAM Konfiguration
/etc/pam.d/login         # PAM Konfiguration des Logins
/etc/security/*          # PAM Modulparameter
/etc/securetty           # Konfiguration des root-Login auf der Konsole
/etc/login.defs          # generelle Logins
</example>
<p>
Falls wirklich (auf eigene Gefahr) ein Login an der Konsole ohne Passwort
möglich sein soll, kann die Datei <file>/etc/pam.d/login</file> wie folgt
geändert werden:
<example>
#auth       required   pam_unix.so nullok
auth       required   pam_permit.so
</example>
Ähnlich funktioniert das auch mit <prgn>xdm</prgn>, <prgn>gdm</prgn>, ...,
um sich ohne Passwort an der X-Konsole anzumelden.
<p>
Andererseits kann <package>cracklib2</package> installiert werden und
<file>/etc/pam.d/passwd</file> wie folgt angepasst werden, um einen guten
Passwortschutz zu erhalten.
<example>
password required       pam_cracklib.so retry=3 minlen=6 difok=3
</example>
Ein einmaliges Nutzen eines Login Passworts zur Zugangsaktivierung kann auch
hilfreich sein. Dafür muss das <prgn>passwd</prgn> Kommando mit der Option
<tt>-e</tt> verwendet werden. Vergleichen Sie
<manref name="passwd" section="1">.
<p>
Die maximale Anzahl an Prozessen kann mit <tt>ulimit -u 1000</tt> in der
Bash-Shell gesetzt werden oder auch in der Datei
<file>/etc/security/limits.conf</file> mit PAM. Andere Parameter, wie z.B.
<tt>core</tt> können so ebenfalls gesetzt werden. Die Anfangseinstellung von
<prgn>PATH</prgn> kann in <file>/etc/login.defs</file> festgelegt werden,
bevor die Shell Skripte startet.
<p>
Die Dokumentation von PAM befindet sich im Paket
<package>libpam-doc</package>. Das Buch <em>Linux-PAM System Administrator's
Guide</em> behandelt PAM, die verfügbaren Module, usw. Die Dokumentation
enthält auch <em>The Linux-PAM Application Developers' Guide</em> und
<em>The Linux-PAM Module Writers' Guide</em>.
</sect1>

<sect1 id="wheel">"Warum GNU <prgn>su</prgn> nicht die <tt>wheel</tt> Gruppe
                  unterstützt"
<p>
Dieser Satz entstammt dem Ende der alten <tt>info su</tt> Seite von Richard
M. Stallman. Man sollte sich aber nicht verwirren lassen. Die aktuelle
<prgn>su</prgn> Version in &debian; benutzt PAM. Somit kann der Gebrauch von
<prgn>su</prgn> leicht auf eine beliebige Gruppe eingeschränkt werden. Dazu
dient das Modul <prgn>pam_wheel.so</prgn>, welches in
<file>/etc/pam.d/su</file> konfiguriert wird. Im folgenden Beispiel wird die
<tt>adm</tt> Gruppe äquivalent zu der BSD Gruppe <tt>wheel</tt> eingerichtet
und erlaubt den Gruppenmitgliedern den Gebrauch des <prgn>su</prgn> Kommandos
ohne Passwort.
<example>
# anti-RMS Konfiguration in /etc/pam.d/su
auth       required   pam_wheel.so group=adm

# wheel Mitglieder die su ohne Passwort verwenden können
auth       sufficient pam_wheel.so trust group=adm
</example>

<sect1>Bedeutung verschiedener Gruppen
<p>
Interessante Gruppen sind:
<list compact>
<item>Die <tt>root</tt> Gruppe entspricht der Standard wheel Gruppe für
      <prgn>su</prgn>, wenn <prgn>pam_wheel.so</prgn> ohne das
      <tt>group=</tt> Argument verwendet wird.
<item>Die <tt>adm</tt> Gruppe darf Log-Dateien lesen.
<item>Die <tt>cdrom</tt> Gruppe darf auf das CD-ROM-Laufwerk zugreifen.
<item>Die <tt>floppy</tt> Gruppe darf auf das Diskettenlaufwerk zugreifen.
<item>Die <tt>audio</tt> Gruppe darf auf ein vorhandenes Audiogerät
      zugreifen.
<item>Die <tt>src</tt> Gruppe darf auf Quelltexte unterhalb von
      <file>/usr/src</file> zugreifen. Mit dieser Gruppe verwaltet man den
      Zugriff auf Quelltexte.
<item>Die <tt>staff</tt> Gruppe ist gedacht für Hilfsadministratoren. Sie
      sollen Dateien in <file>/usr/local</file> ablegen und Verzeichnisse in
      <file>/home</file> erzeugen dürfen.
</list>
<p>
Eine vollständige Liste bietet der "FAQ"-Abschnitt in
<url id="&securing-debian-howto;" name="Securing Debian Manual">, dieses
Dokument befindet sich im <package>&p-securing-debian-howto;</package> Paket
in Woody. Auch das neue <package>&p-base-passwd;</package> (>3.4.6) enthält
eine maßgebliche Liste: <file>&f-users-and-groups;</file>.

<sect1 id="sudo"><prgn>sudo</prgn> &ndash; eine sicherere Arbeitsumgebung
<p>
Ich verwende <prgn>sudo</prgn> hauptsächlich als Selbstschutz.
<prgn>sudo</prgn> ist die etwas sicherere Alternative zur Verwendung des
Administrator-Accounts.
<p>
<prgn>sudo</prgn> wird wie üblich installiert und mittels der Datei
<file><url id="&examples;" name="/etc/sudoers"></file> konfiguriert.
Überprüfen Sie auch die Merkmale der <tt>sudo</tt> Gruppe in
<file>&dochome;sudo/OPTIONS</file>.
<p>
Diese Beispielkonfiguration verwendet eine Gruppe "staff", welche es den
Mitgliedern erlaubt, beliebige Befehle mit root-Rechten mittels
<prgn>sudo</prgn> auszuführen. Des Weiteren wird dieses Recht einer Gruppe
"src" mit Einschränkungen auf bestimmte Befehle gegeben.
<p>
Der Vorteil von <prgn>sudo</prgn> ist, dass nur ein normales Benutzerpasswort
zum Einloggen benötigt wird. Die Aktivitäten eines <prgn>sudo</prgn>
Benutzers werden aufgezeichnet. Dies ermöglicht es, einige Aufgaben an
Hilfsadministratoren zu delegieren. Zum Beispiel:
<example>
$ sudo chown -R <var>ich</var>:<var>meineGruppe</var> .
</example>
<p>
Selbstverständlich kann jeder der das Administratorpasswortes kennt (wie es
bei den meisten Heimanwendern der Fall ist) auch auf andere Weise
root-Kommandos absetzen:
<example>
$ su -c "shutdown -h now"
Password:
</example>
(Mit <prgn>sudo</prgn> können feiner abgestufte Sicherheitsbarrieren
eingebaut werden. Ich hätte dies tun können. Da aber nur ich Zugriff auf
meinen Rechner habe, hielt ich das nicht für nötig.)
<p>
Ein anderes Programm mit ähnlicher Funktionalität ist im
<package>super</package> Paket zu finden.
</sect1>

<sect1 id="tcpd">Zugriffskontrolle auf Daemonen
<p>
Der Internet-<em>Superserver</em> <prgn>inetd</prgn> wird beim Systemboot
aus <file>/etc/rc2.d/S20inetd</file> (für das Runlevel 2) gestartet; dies
wiederum ist ein symbolischer Link auf <file>/etc/init.d/inetd</file>. Durch
die Verwaltung verschiedener Dienste/Daemonen in diesem einen Daemon wird die
Systemlast verringert.
<p>
Wenn eine Anfrage via Netzwerk an den Rechner gestellt wird, sieht der Daemon
in der Datei <file>/etc/protocols</file> und <file>/etc/services</file> nach,
welches Protokoll und welcher Service nachgefragt werden.
Bei einem normalen Internetservice schaut <prgn>inetd</prgn> dann in
<file>/etc/inetd.conf</file> nach oder bei Sun-RPC-Anfragen in
<file>/etc/rpc.conf</file>.
<p>
Die Sicherheit des Systems kann durch die Abschaltung nicht gebrauchter
Services in <file>/etc/inetd.conf</file> immens gesteigert werden.
Sun-RPC-Services werden gebraucht, wenn NFS oder andere RPB-basierte
Protokolle verwendet werden.
<p>
Für einige Daemonen wird der gewünschte Server nicht direkt gestartet.
Stattdessen wird der <prgn>tcpd</prgn> TCP/IP-Daemon-Wrapper mit dem
gewünschten Server als Argument aus <file>/etc/inetd.conf</file> aufgerufen.
In diesem Fall wird der Server von <prgn>tcpd</prgn> erst nach Log-Einträgen
und Sicherheitsüberprüfungen gestartet (<file>/etc/hosts.deny</file> und
<file>/etc/hosts.allow</file> werden ausgewertet).
<p>
Falls beim entfernten Zugriff in einem &debian;-System Probleme auftreten,
kann eine Ursache der Eintrag: "ALL: PARANOID" in
<file>/etc/hosts.deny</file> sein, der dann auskommentiert werden muss.
<p>
Details dazu liefern:
<manref name="inetd" section="8">,
<manref name="inetd.conf" section="5">,
<manref name="protocols" section="5">,
<manref name="services" section="5">,
<manref name="tcpd" section="8">,
<manref name="hosts_access" section="5"> und
<manref name="hosts_options" section="5">.
<p>
Weitere Informationen zu Sun-RPC liefern:
<manref name="rpcinfo" section="8">,
<manref name="portmap" section="8"> und
<file>&f-portmap;</file>.

<sect1 id="ldap">LDAP &ndash; Leichtgewichtiges Verzeichniszugangsprotokoll
<p>
Literatur zu LDAP (Lightweight Directory Access Protocol):
<list compact>
<item><url id="&openldaphome;" name="OpenLDAP">
<item>OpenLDAP Admin Guide im <package>openldap-guide</package> Paket
<item>LDP: <url id="&ldap-linux-howto;" name="LDAP Linux HOWTO">
<item>LDP: <url id="&ldap-implementation-howto;" name="LDAP Implementation
      HOWTO">
<item><url id="&ldap-use1;" name="OpenLDAP, ausführliche Nutzungsberichte">
<item><url id="&ldap-use2;" name="Open LDAP mit Courier IMAP und Postfix">
</list>
</sect>

<sect id="cdrw">CD-Brenner
<p>
CD-Brenner mit ATAPI/IDE-Schnittstelle sind in der letzten Zeit populär
geworden, da sie gut geeignet für Archivierungs- und Backupzwecke kleiner
Datenmengen (&lt; 640 MB) sind. Das wichtigste Dokument zu diesem Thema ist
das <url id="&cd-writing-howto;" name="CD-Writing-HOWTO">.

<sect1>Einführung
<p>
Der Abbruch des Datenstroms zum CD-Brenner während des Brennvorgangs wird
unweigerlich dazu führen, dass der Rohling unbrauchbar wird. Deshalb sollte
der Puffer-Speicher so groß wie möglich sein. Wenn Geld keine Rolle spielt,
sollte man lieber einen SCSI-Brenner kaufen, hat man eine Wahl bzgl. des
Bussystems, sollte man den Brenner unbedingt über den PCI-Bus (z.B. auf dem
Motherboard), statt den ISA-Bus (wie bei der SB16) anschließen.
<p>
Ist ein CD-Brenner am IDE-Bus angeschlossen, wird der IDE-SCSI Treiber
anstatt eines gewöhnlichen IDE CD-Treibers für Linux 2.2 und 2.4 Kernel
verwendet. Auch der allgemeine SCSI-Treiber muss aktiviert sein. Es gibt zwei
Möglichkeiten, wenn man einen Kernel, wie er mit modernen Distributionen
(März 2001) ausgeliefert wird, hat:
</sect1>

<sect1>Ansatz 1: Module + <prgn>lilo</prgn>
<p>
Die folgende Zeile muss in der Datei <file>/etc/lilo.conf</file> hinzugefügt
werden, wenn ein Standard-Debian-Kernel verwendet wird.  Falls dort schon
Einträge vorhanden sind, können diese mit Leerzeichen getrennt werden.
<example>
append="hd<var>x</var>=ide-scsi ignore=hd<var>x</var>"
</example>
Der Anschlussname eines CD-Brenners, der durch den IDE-SCSI-Treiber
angesprochen wird, ergibt sich dabei wie folgt: In <tt>hd<var>x</var></tt>
ist <var>x</var> zu ersetzen gemäß:
<example>
hda          für den Master am ersten IDE-Anschluss
hdb          für den Slave am ersten IDE-Anschluss
hdc          für den Master am zweiten IDE-Anschluss
hdd          für den Slave am zweiten IDE-Anschluss
hde ... hdh  für ein Laufwerk an einem externen oder ATA66/100
             IDE-Anschluss.
</example>
Die neue Lilo-Konfiguration wird mit root-Rechten aktiviert durch:
<example>
# lilo
# shutdown -h now
</example>
</sect1>

<sect1>Ansatz 2: Neukompilieren des Kernels
<p>
Debian benutzt <prgn>make-kpkg</prgn> um einen Kernel zu erstellen. Die
Option <tt>--append_to_version</tt> ist beim Erzeugen mehrerer Kernel
sinnvoll. Siehe dazu <ref id="kernel">.
<p>
Nach Eingabe von <tt>make menuconfig</tt> geht man wie folgt vor:
<list>
<item>bzImage
<item>der IDE-CD-Treiber sollte entfernt werden
<item>ide-scsi und sg sollten angewählt werden (mindestens als Modul)
</list>
</sect1>

<sect1>Weitere Schritte nach der Konfiguration
<p>
Die Kernel-Unterstützung für den CD-Brenner kann während des Boot-Prozesses
aktiviert werden durch:
<example>
# echo ide-scsi &gt;&gt;/etc/modules
# echo sg       &gt;&gt;/etc/modules
# cd /dev; ln -sf scd0 cdrom
</example>
Manuelle Aktivierung geschieht durch:
<example>
# modprobe ide-scsi
# modprobe sg
</example>
Nach dem Neustart kann die Installation geprüft werden durch
<example>
$ dmesg|less
# apt-get install cdrecord
# cdrecord -scanbus
</example>
<p>
[Von Warren Dodge] Manchmal gibt es Konflikte zwischen den <tt>ide-scsi</tt>-
und <tt>ide-cd</tt>-Treibern, wenn für beide Treiber Geräte installiert sind.
Durch die folgende Zeile, die zu der Datei <file>/etc/modutils/aliases</file>
hinzugefügt werden soll, kann das Problem beseitigt werden. Vor dem Neustart
ist noch ein Lauf von <prgn>update-modules</prgn> nötig.
<example>
pre-install      ide-scsi      modprobe ide-cd
</example>
Durch diese Zeile wird der IDE-Treiber vor <tt>ide-scsi</tt> geladen. Der
IDE-Treiber <tt>ide-cd</tt> übernimmt die Kontrolle über die ATAPI-CD-ROM
Geräte &ndash; über alle die nicht ignoriert werden sollen. Die anderen
bisher ignorierten Geräte übernimmt dann das <tt>ide-scsi</tt>-Modul.
</sect1>

<sect1>Bootfähiges CD-Image
<p>
Um eine bootfähige CD-Image <tt>cd-image.raw</tt> mit den Dateien unterhalb
vom <file>Zielverzeichnis</file> zu erzeugen, geht man wie folgt vor: Man
legt eine bootfähige Diskette in das erste Diskettenlaufwerk ein und erzeugt
davon ein Image:
<example>
# dd if=<var>/dev/fd0</var> <var>Zielverzeichnis/boot.img</var>
# mkisofs -r -V <var>volume_id</var> -b <var>boot.img</var> -c <var>bootcatalog</var> -J -T \
          -o <var>cd-image.raw</var> <var>Zielverzeichnis/</var>
</example>
Die <tt>-t</tt> Option erzeugt die Übersetzungstabelle für lange Dateinamen,
<tt>-b</tt> und <tt>-c</tt> steht für bootfähig.
<p>
Tatsächlich kann sogar eine bootfähige CD mit DOS erstellt werden. Wenn die
Datei <file><var>boot.img</var></file> im obigen Beispiel eine
DOS-Boot-Diskette beinhaltet, dann wird die CD gestartet, als ob diese
Diskette im Diskettenlaufwerk stecken würde. Vielleicht möchte ja mal jemand
das mit Freedos probieren.
<p>
Das CD-Image kann man mounten mit:
<example>
# mount -t iso9660 -o ro,loop <var>cd-image.raw</var> /cdrom
# cd /cdrom
# mc
# umount /cdrom
</example>
</sect1>

<sect1>Brennen mit dem CD-Brenner (R, RW):
<p>
Ein erster Test mit einem Double-Speed-Laufwerk sieht so aus (dabei wird
keine CD gebrannt, sondern nur simuliert):
<example>
# nice --10 cdrecord -dummy speed=2 dev=0,0 <var>disk.img</var>
</example>
Falls dies erfolgreich ist, kann die CD-R gebrannt werden:
<example>
# nice --10 cdrecord -v -eject speed=2 dev=0,0 <var>disk.img</var>
</example>
Eine wiederbeschreibbare CD-RW muss zudem erst gelöscht werden:
<example>
# nice --10 cdrecord -v -eject blank=fast speed=2 dev=0,0 <var>disk.img</var>
</example>
Manche CD-RW-Laufwerke funktionieren besser mit:
<example>
# nice --10 cdrecord -v blank=all speed=2 dev=0,0 <var>disk.img</var>
</example>
gefolgt von:
<example>
# nice --10 cdrecord -v -eject speed=2 dev=0,0 <var>disk.img</var>
</example>
Diese getrennten Schritte sollen SCSI-Timeouts während des Löschens
vorbeugen, die den Brenn-Prozess stören oder sogar unterbrechen können. Der
<prgn>nice</prgn>-Wert kann noch der Systemlast angepasst werden.
</sect1>

<sect1>Eine Abbilddatei (Image) einer CD erzeugen
<p>
Manche CD-R oder auch kommerzielle CD's haben defekte Sektoren, die eine
Kopie mit <prgn>dd</prgn> verhindern (die Windows 98 CD ist ein Beispiel).
Das <prgn>cdrecord</prgn> Paket beinhaltet den <prgn>readcd</prgn> Befehl,
der dann verwendet werden kann, um CD-Images zu erzeugen. Bei einer Daten-CD
ist die Vorgehensweise wie folgt: Die CD wird gemountet, <prgn>mount</prgn>
zeigt dann die Anzahl der Blöcke an (1 Block=1024 Bytes). Teilt man diese
Zahl durch 2, so erhält man die Anzahl der CD-Blöcke, die 2048 Bytes groß
sind. <prgn>readcd</prgn> liest also die CD z.B. mit folgenden Parametern:
<example>
# readcd dev=<var>Ziel</var>,<var>lun</var>,<var>scsibusnr</var> # wähle Funktion 11
</example>
Hier sind alle 3 Kommandozeilenparameter meistens 0. Gewöhnlich ist die
Anzahl der Sektoren, die von <prgn>readcd</prgn> zurückgegeben wird, zu hoch!
Dann sollte man die Sektorzahl, die man aus dem <prgn>mount</prgn> Befehl
gewonnen hat, verwenden.
<p>
Es sollte bemerkt werden, dass die Verwendung von <prgn>dd</prgn> einige
Probleme bei CD-ROMs hat. Der erste Lauf von <prgn>dd</prgn> kann eine
Fehlermeldung erzeugen und ein kürzeres Image mit unvollständigem Ende
zur Folge haben. Der zweite Lauf von <prgn>dd</prgn> kann zu einem größeren
Image mit am Ende angehangenen falschen Daten führen. Dies ist bei einigen
Systemen möglich, wenn die Größe des Images nicht angegeben wird. Nur der
zweite <prgn>dd</prgn> Aufruf mit der korrekten Größe ohne vorherigen
CD-Auswurf nach der Fehlermeldung scheint diese Probleme zu umgehen. Wenn die
von <prgn>df</prgn> bestimmte Größe des Images z.B. <tt>46301184</tt> Blöcke
ist, muss das folgende Kommando zweimal angewandt werden, um ein korrektes
Image zu erhalten (dies ist eine rein empirische Information):
<example>
# dd if=/dev/cdrom of=cd.img bs=2048 count=$((46301184/2))
</example>
</sect1>

<sect1>Debian-CD-Images
<p>
Um aktuelle Informationen zu &debian;-CD's zu erhalten, sollte die
<url id="&debian-cd;" name="Debian-CD Seite"> besucht werden.
<p>
Wenn man eine schnelle Internet-Verbindung hat, kann man auch eine
Netz-Installation durchführen:
<list compact>
<item>hierzu die <url id="&debian-floppyinst;" name="Disketten-Images">
<item>und ein <url id="&debian-netinst;" name="minimales bootbares CD-Image">.
</list>
<p>
Wenn man keine schnelle Internet-Verbindung hat, kann man auch einfach ein
Komplettpaket von einem der bekannten <url id="&debian-venders;"
name="CD Distributoren"> kaufen.
<p>
Bandbreite sollte nie verschwendet werden, deswegen sollte man die Wahl des
Installationsmechanismus ruhig besonnen überlegen.
<p>
Ein bemerkenswertes Projekt ist <url id="&knoppix;"
name="KNOPPIX &ndash; Linux Live-Dateisystem auf CD">. Diese CD bootet ein
vollständiges &debian;-System völlig ohne Installation.

<!-- old document section
$ export CVSROOT=anonymous@cvs.debian.org:/cvs/debian-boot
$ cvs co debian-cd
</example>
Following is a summary of CD image creation.
<example>
# apt-get install debian-cd
# cd /etc/debian-cd
# vim CONF.sh
$ . CONF.sh
$ make distclean
$ make status
$ make list COMPLETE=1 SIZELIMIT1=555000000 SRCSIZELIMIT=665000000
$ make official_images
 or if you want only binary images :
$ make bin-official_images
-->
</sect1>

<sect1>Sicherheitskopien auf CD-R
<p>
Um grundlegende Konfigurations- und Datendateien auf CD zu sichern, kann das
"backup" Skript <url id="&examples;" name="backup"> verwendet werden. Siehe
dazu auch <ref id="archiving"> und <ref id="diff-backup">.
</sect1>

<sect1>Eine Musik-CD kopieren
<p>
Noch nicht ausreichend getestet ist folgendes:
<example>
# apt-get install cdrecord cdparanoia
# cdparanoia -s -B
# cdrecord dev=0,0,0 speed=2 -v -dao -eject defpregap=1 -audio *.wav
</example>
oder
<example>
# apt-get install cdrdao # disk at once
# cdrdao read-cd --device /dev/cdrom --paranoia-mode 3 my_cd # CD auslesen
# cdrdao write --device /dev/cdrom --speed 8 my_cd    # auf neue CD schreiben
</example>
<prgn>cdrdao</prgn> erzeugt eine echte Kopie (ohne Sprünge, etc.).
</sect1>
</sect>

<sect id="x">Das X-Window Paket
<p>
Die graphische Arbeitsumgebung X wird von <url id="&xfree86home;"
name="Xfree86"> bereitgestellt. Derzeit sind zwei Hauptvarianten bei &debian;
in Benutzung: Version 3.x und 4.x.
<p>
<taglist>
<tag><ref id="xsrvr">
<item>dies ist das Programm, das auf dem lokalen Monitor die X-Fenster und
      die Oberfläche zeichnet und die Tastatureingaben und Mausbewegungen
      auswertet.<tag><ref id="xclnt">
<item>dies ist ein Programm, das (lokal auf einem eventuell fernen Rechner)
      per X-Window-Protokoll Applikationen laufen lässt.
</taglist>
Diese Definition kehrt den gewöhnlichen Gebrauch der Begriffe Client und
Server um. Eine Erklärung hierfür liefert: <manref name="X" section="7">, das
LDP <url id="&xwindowuser-howto;" name="XWindow-User-HOWTO"> und die <url
id="&remote-xapps-howto;" name="Remote X Apps mini-HOWTO">.
<p>
Es gibt verschiedene Wege, um X-basierte Programme, die lokal angezeigt werden
sollen ("X-Server seitig"), auf einem fremden Rechner (einem "X-Client") zu
starten.

<list>
<item><prgn>xhost</prgn>
      <list compact>
      <item>Host-List Mechanismus (sehr unsicher)
      <item>nicht-verschlüsseltes Protokoll (kann abgehört werden).
      <item>Diese Variante sollte möglichst nicht gewählt werden.
      <item>Siehe <ref id="xhost"> und <manref name="xhost" section="1x">.
      </list>
<item><prgn>xauth</prgn>
      <list compact>
      <item>Der MIT magic cookie-Mechanismus (unsicher, aber besser als
            <prgn>xhost</prgn>).
      <item>nicht-verschlüsseltes Protokoll (kann auch abgehört werden).
      <item>nur für lokal begrenzte Benutzung (weniger rechenintensiv als
            <prgn>ssh -X</prgn>).
      <item>Siehe <ref id="ss-xsu"> und <manref name="xauth" section="1x">.
      </list>
<item><prgn>xdm</prgn>, <prgn>wdm</prgn>, <prgn>gdm</prgn>, <prgn>kdm</prgn>,
      ...
      <list compact>
      <item>MIT magic cookie-Mechanismus (unsicher wie <prgn>xauth</prgn>).
      <item>Siehe <manref name="xdm" section="1x"> und <manref
            name="Xsecurity" section="7"> für die Erklärung der Grundlagen
            der X-Zugriffskontrolle
      <item>Siehe <manref name="wdm" section="1x">, <manref name="gdm"
            section="8">, und <manref name="kdm.options" section="5"> für
            weitere Informationen.
      <item>Siehe <ref id="sys-v"> um das graphische Login mit
            <prgn>xdm</prgn> abzuschalten, ohne das Paket zu deinstallieren.
      </list>
<item><strong><prgn>ssh -X</prgn></strong>
      <list compact>
      <item>Port-Weiterleitung mittels secure shell
            (<strong>sicher</strong>).
      <item>verschlüsselt (Ressourcenverschwendung bei lokaler Anwendung)
      <item>nur für ferne Verbindung oder in unsicheren Netzen verwenden.
      <item>Siehe <ref id="xssh">.
      </list>
</list>

Alle Netzzugänge zum X-System (außer <prgn>SSH</prgn>) erfordern TCP/IP
Verbindungen. Siehe <ref id="xtcp">.

<sect1 id="x-system">X-System Pakete
<p>
Es gibt einige Metapakete, um die Installation von X zu vereinfachen.
<taglist>
<tag><package>x-window-system-core</package>
<item>Dieses Metapaket stellt die grundlegenden Komponenten des
      X-Window-Systems für eine Workstation bereit. Es beinhaltet
      Bibliotheken, einen X-Server (genauer das Paket
      <package>xserver-xfree86</package>), eine Reihe von Schriften und
      einige X-Client-Programme und Werkzeuge.

<tag><package>x-window-system</package>
<item>Dieses Metapaket beinhaltet alle X-Window Komponenten, so wie sie vom
      XFree86-Projekt bereitgestellt wurden. Hinzu kommen einige
      Hilfsprogramme. Es hängt von <package>x-window-system-core</package>,
      <package>twm</package> und <package>xdm</package> ab. Das bedeutet,
      diese Abhängigkeiten werden automatisch aufgelöst und diese Pakete
      müssen nicht manuell zur Installation ausgewählt werden.

<tag><package>xserver-common-v3</package>
<item>In diesem Paket befinden sich die Dateien und Programme für das alte
      XFree86 Version 3.X (X3)

<tag><package>xserver-*</package>
<item>Zusätzliche X3-Server Pakete zur Unterstützung von Hardware, die aus
      irgendwelchen Gründen nicht von XFree86 4.X unterstützt werden. Einige
      alte ATI mach64-Grafikkarten fallen darunter; einige andere
      Grafikkarten hängen sich mit der XFree Version in der &debian;-Version
      woody auf, etc. (Alle Serverpakete findet man durch <tt>apt-cache
      search xserver-|less</tt>. Alle diese X3-Server hängen vom Paket
      <package>xserver-common-v3</package> ab.)
</taglist>
<p>
In den meisten Fällen allerdings sollte das Paket
<package>x-window-system</package> installiert werden. (Möchte man keinen
grafischen Login, sollte das Paket <package>xdm</package> entfernt werden.
Eine genaue Beschreibung dieses Vorganges findet sich im Kapitel
<ref id="no-x-start">.)

<sect1 id="hdetect-x">Hardware-Erkennung für X
<p>
Um eine automatische Hardware-Erkennung durchzuführen, braucht man folgende
Pakete, die vor der X-Installation vorhanden sein sollten:
<list>
<item><package>discover</package> &ndash; Hardwareerkennungssystem.
<item><package>mdetect</package> &ndash; Maus-Erkennung.
<item><package>read-edid</package> &ndash; Informations-Werkzeug für VESA PnP
      Monitore.
</list>

<sect1 id="xsrvr">X-Server
<p>
Siehe <manref name="XFree86" section="1x"> für weitere Informationen zum
X-Server.
<p>
Der X-Server kann direkt von der Konsole gestartet werden:
<example>
$ startx -- :&lt;display&gt; <var>vtXX</var>
z.B.:
$ startx -- :1 vt8 -bpp 16
... startet auf vt8 am Rechner  localhost:1 mit 16 bpp-Farbmodus.
</example>
Argumente nach dem <tt>--</tt> werden an den X-Server weitergeleitet.
<p>
Wenn eine <file>~/.xserverrc</file> Konfigurationsdatei verwendet wird, um
das Starten des X-Servers genauer im Griff zu haben, muss darauf geachtet
werden, dass der Server auch explizit mit <tt>exec</tt> gestartet wird, sonst
werden Start und Beenden des Servers sehr langwierig:
<example>
#!/bin/sh
exec /usr/bin/X11/X -dpi 100 -nolisten tcp
</example>

<sect2 id="config-x4">Konfiguration des X4-Servers
<p>
Um den X4-Server zu konfigurieren kann <prgn>dpkg</prgn> benutzt werden.
<example>
# dpkg-reconfigure --priority=low xserver-common
# dpkg-reconfigure --priority=low xserver-xfree86
</example>
Es wird eine  <file>/etc/X11/XF86Config-4</file> Datei erzeugt, die mit dem
Skript <prgn>dexconf</prgn> modifiziert werden kann.

<sect2 id="config-x3">Konfiguration des X3-Servers
<p>
Um den X3-Server zu konfigurieren kann auch <prgn>dpkg</prgn> benutzt werden.
<example>
# dpkg-reconfigure --priority=low xserver-common-v3
# dpkg-reconfigure --priority=low xserver-mach64
</example>
Die Konfigurationsdatei von X3 heißt <file>/etc/X11/XF86Config</file> und
wird mit <prgn>xf86config-v3</prgn> bearbeitet.

<sect2 id="manual-config-x">Manuelle Konfiguration von X4
<p>
Um Benutzer spezifische Einstellungen vorzunehmen, darf nicht der Text
verändert werden, der von debconf erstellt wurde, also ist der Bereich
zwischen dem BEGIN und dem END tabu.
<!-- FIXME for X3 -->
<example>
### BEGIN DEBCONF SECTION
[snip]
### END DEBCONF SECTION
</example>
<p>
Statt dessen können die Anpassungen vor dem BEGIN eingetragen werden, wie in
dem folgenden Beispiel:
<example>
Section "Device"
  Identifier        "Custom Device"
  Driver            "ati"
  Option            "NoAccel"
EndSection

Section "Screen"
  Identifier  "Custom Screen"
  Device      "Custom Device"
  Monitor     "Generic Monitor"
  DefaultDepth 24
  Subsection "Display"
    Depth       8
    Modes       "1280x960" "1152x864" "1024x768" "800x600" "640x480"
  EndSubsection
  Subsection "Display"
    Depth       16
    Modes       "1280x960" "1152x864" "1024x768" "800x600" "640x480"
  EndSubsection
  Subsection "Display"
    Depth       24
    Modes       "1280x960" "1152x864" "1024x768" "800x600" "640x480"
  EndSubsection
EndSection

Section "ServerLayout"
    Identifier        "Custom"
    Screen            "Custom Screen"
    InputDevice       "Generic Keyboard" "CoreKeyboard"
    InputDevice       "Configured Mouse" "CorePointer"
EndSection
</example>

<sect1 id="xclnt">X-Client Programme
<p>
Die meisten X-Programme können einfach von der Kommandozeile aus gestartet
werden:
<example>
client $ xterm -geometry 80x24+30+200 -fn 6x10 -display <var>hostname</var>:0 &amp;
</example>
Die hier angeführten Parameter bedeuten:
<list>
<item><tt>-geometry <var>BREITE</var>x<var>HÖHE</var>+<var>X-OFFSET</var>+<var>Y-OFFSET</var></tt>:
      anfängliche Größe und Lage des neuen Fensters.

<item><tt>-fn <var>FONTNAME</var></tt>: die Schrift, die im Fenster verwendet
      wird. <tt><var>FONTNAME</var></tt> kann sein:
      <list compact>
      <item>a14: Normale Größe
      <item>a24: Große Größe
      <item>... (Weitere Fonts können mit <tt>xlsfont</tt> ermittelt werden.)
      </list>
<item><tt>-display <var>displayname</var></tt>: der Name des X-Servers, der
      verwendet wird. <tt><var>displayname</var></tt> kann sein:
      <list compact>
      <item><tt><var>hostname</var>:<var>D.S</var></tt> bedeutet Anzeige
            <tt><var>S</var></tt> auf dem Bildschirm <tt><var>D</var></tt>
            auf dem Rechner <tt><var>hostname</var></tt>; der X-Server für
            dieses Display liegt auf dem TCP-Port 6000+D.
      <item><tt><var>host</var>/unix:<var>D.S</var></tt> bedeutet Anzeige
            <tt><var>S</var></tt> auf dem Bildschirm <var>D</var> auf dem
            Rechner <tt><var>host</var></tt>; der X-Server für diese Anzeige
            lauscht auf dem Unix-Domain-Socket <file>/tmp/.X11-unix/XD</file>
            (so ist es nur auf dem Rechner <tt><var>host</var></tt>
            erreichbar).
      <item><tt><var>:D.S</var></tt> bedeutet das gleiche wie
            <tt><var>host</var>/unix:<var>D.S</var></tt>, wobei
            <tt><var>host</var></tt> der Name des lokalen Rechners ist.
      </list>
</list>
<p>
Der Standard <tt><var>displayname</var></tt> für die X-Client-Programme kann
mit der DISPLAY Umgebungsvariablen gesetzt werden. Bevor man nun ein
X-Programm startet kann die Umgebungsvariable z.B. wie folgt gesetzt werden:
<example>
$ export DISPLAY=:0
        # Die Standardeinstellung
$ export DISPLAY=<var>hostname.fulldomain.name</var>:0.2
$ export DISPLAY=localhost:0
</example>

Der Start kann in der Datei <file>~/.xinitrc</file> konfiguriert werden. Zum
Beispiel:
<example>
xrdb -load $HOME/.Xresources
xsetroot -solid gray &amp;
xclock -g 50x50-0+0 -bw 0 &amp;
xload -g 50x50-50+0 -bw 0 &amp;
xterm -g 80x24+0+0 &amp;
xterm -g 80x24+0-0 &amp;
twm
</example>
Wie in  <ref id="custom-x"> beschrieben, haben diese Einstellungen Vorrang
vor denen von Xsession, welches bei <prgn>startx</prgn> verwendet wird. Diese
Methode sollte nicht verwendet werden.
</sect1>

<sect1 id="x-session">X-Session
<p>
Eine X-Session kann auf folgende Weisen gestartet werden:
<list compact>
<item><prgn>startx</prgn>: ein Skript, das <prgn>initx</prgn> und so den
      X-Server und Client auf der Konsole startet. Wenn die Datei
      <file>~/.xinitrc</file> nicht existiert, wird
      <file>/etc/X11/Xsession</file> via <file>/etc/X11/xinit/xinitrc</file>
      ausgeführt.
<item><prgn>xdm</prgn>, <prgn>gdm</prgn>, <prgn>kdm</prgn> oder
      <prgn>wdm</prgn>: Dies sind Daemonprogramme, die den Login von einer
      bereits gestarteten graphischen Oberfläche ermöglichen.
      <file>/etc/X11/Xsession</file>: direktes Starten.
</list>
Die Konsole erhält man mittels <ref id="no-x-start">.

<sect2 id="custom-x">Angepasste X-Sitzung
<p>
Im Endeffekt ist der Start durch  <file>/etc/X11/Xsession</file> nur eine
Kombination von
<file>/etc/X11/Xsession.d/50xfree86-common_determine-startup</file> und
<file>/etc/X11/Xsession.d/99xfree86-common_start</file>.
<p>
Die Ausführung von <file>/etc/X11/Xsession</file> wird beeinflusst durch
<file>/etc/X11/Xsession.options</file> und ist im Wesentlichen bestimmt für
die Ausführung des ersten Programms, das in folgenden Skripten durch 'exec'
ausgeführt wird:
<enumlist compact>
<item><file>~/.xsession</file> oder <file>~/.Xsession</file>, wenn vorhanden.
<item><file>/usr/bin/x-session-manager</file>, wenn vorhanden.
<item><file>/usr/bin/x-window-manager</file>, wenn vorhanden.
<item><file>/usr/bin/x-terminal-emulator</file>, wenn vorhanden.
</enumlist>
<p>
Was nun genau gestartet wird, hängt von den Einstellungen des
&debian;-Alternativen-Systems ab, wie es in <ref id="alternatives"> erklärt
wird. Zum Beispiel:
<example>
# update-alternatives --config x-session-manager
... oder
# update-alternatives --config x-window-manager
</example>

Um einen anderen X-Window-Manager einzustellen als die Voreinstellung und
dennoch KDE oder Gnome als Sitzungsmanager beizubehalten, muss die Datei
<file>/etc/X11/Xsession.d/50xfree86-common_determine-startup</file> durch die
im zweiten Fehlerreport (siehe <url id="&bug-xfree;">) ersetzt werden. (Ich
hoffe, dass dies bald mit aufgeführt wird.) Dann kann die Datei
<file>/etc/X11/Xsession.options</file> wie folgt geändert werden, um den
X-Sitzungsmanager zu umgehen:
<example>
# /etc/X11/Xsession.options
#
# configuration options for /etc/X11/Xsession
# See Xsession.options(5) for an explanation of the available options.
# Default enabled
allow-failsafe
allow-user-resources
allow-user-xsession
use-ssh-agent
# Default disabled (enable them by uncommenting)
do-not-use-x-session-manager
#do-not-use-x-window-manager
</example>
<p>
Ohne die gezeigten Veränderungen sind die Pakete
<package>gnome-session</package> und <package>kdebase</package> dafür
zuständig, einen X-Sitzungsmanager bereitzustellen. Das Entfernen dieser
beiden Pakete ermöglicht die Einstellung eines beliebigen X-Window-Managers.
<p>
Wenn die Datei <file>/etc/X11/Xsession.options</file> eine Zeile wie
<tt>allow-user-xsession</tt> (ohne führende Zeichen) enthält, kann der
Benutzer die Datei <file>~/.xsession</file> oder <file>~/.Xsession</file>
für eine beliebige benutzerseitige Erweiterung der Datei
<file>/etc/X11/Xsession</file> verwendet werden.
<p>
Der letzte Befehl in  <file>~/.xsession</file> sollte die Form
<tt>exec <var>some-window/session-manager</var></tt> haben, um den
Window-Manager zu starten.
<p>
Ein gutes Beispiel für eine <file>~/.xsession</file> Datei findet sich hier:
<file>&f-xsession;</file>.
<p>
Ich benutze dies, um den Window-Manager, Bildschirmzugang und die Sprache für
jeden Benutzer einzeln zu setzen. Siehe <ref id="s-w-manager">,
<ref id="ss-xsu"> und <ref id="x-cjk">.
<p>
Benutzerspezifische X-Einstellungen können in <file>~/.Xresources</file>
gespeichert werden, wohingegen sich systemweite Einstellungen in
<file>/etc/X11/Xresources/*</file> befinden. Siehe
<manref name="xrdb" section="1x">.
<p>
Benutzerspezifische Tastaturbelegungen und Maustastenbelegungen können in
<file>~/.xmodmaprc</file> definiert werden. Siehe <manref name="xmodmap"
section="1x">.

<sect2 id="s-w-manager">Start eines gewählten X-Sitzungs-/Window-Managers
<p>

Eine benutzergewählte Sitzungs-/Window-Manager-Konfiguration kann also gemäß
<ref id="custom-x"> in <file>~/.xsession</file> durch das Ändern der letzten
Zeile eingestellt werden. (Ich mag blackbox wegen dessen Geschwindigkeit und
Einfachheit):

<list>
<item>Voreinstellung -- X-Sitzungsmanager.
      <list compact>
      <item>Vergleichen Sie <ref id="alternatives">.
      <item><tt>exec /usr/bin/x-session-manager</tt>
      </list>

<item>Voreinstellung -- X-Window-Manager.
      <list compact>
      <item>Vergleichen Sie <ref id="alternatives">.
      <item><tt>exec /usr/bin/x-window-manager</tt>
      </list>

<item>GNOME-Sitzungsmanager. (mächtiges Paket)
      <list compact>
      <item>Installieren Sie das Paket: <package>gnome-session</package>
      <item><tt>exec /usr/bin/gnome-session</tt>
      </list>

<item>KDE-Sitzungsmanager. (ebenso mächtiges Paket)
      <list compact>
      <item>Installieren Sie das Paket: <package>kdebase</package> (oder
            <package>kdebase3</package> für KDE3)
      <item><tt>exec /usr/bin/kde2</tt>
      </list>

<item>Blackbox-Window-Manager. (leichtgewichtiges Paket).
      <list compact>
      <item>Installieren Sie das Paket: <package>blackbox</package>
      <item><tt>exec /usr/bin/blackbox</tt>
      </list>

<item>IceWM-Window-Manager. (ebenso leichtgewichtig)
      <list compact>
      <item>Installiere das Paket: <package>icewm</package>
      <item><tt>exec /usr/bin/X11/icewm</tt>
      </list>

<item>FVWM2-Window-Manager.
      <list compact>
      <item>Installieren Sie das Paket: <package>fvwm</package>
      <item><tt>exec /usr/bin/fvwm2</tt>
      </list>

<item>Windowmaker-Window-Manager.
      <list compact>
      <item>Installieren Sie das Paket: <package>wmaker</package>
      <item><tt>exec /usr/bin/wmaker</tt>
      </list>

<item>Enlightenment-Window-Manager (überladen).
      <list compact>
      <item>Installieren Sie das Paket: <package>enlightenment</package>
      <item><tt>exec /usr/bin/enlightenment</tt>
      </list>

</list>
Siehe <url id="&windomanagerhome;" name="X-Window-Manager">.


<sect2 id="kde-gnome">KDE/GNOME-Umgebung konfigurieren
<p>
Um eine komplette KDE/Gnome-Umgebung einzurichten empfiehlt sich die
Installation der folgenden Metapakete:
<list>
<item>KDE: installiert das <package>kde</package> Paket
<item>GNOME: installiert das <package>gnome</package> Paket
</list>
Es sollte ein Installationswerkzeug gewählt werden, das die
Installationsempfehlungen (<tt>recommends</tt>) des Paketes auflösen kann;
dies sind u.a. <prgn>dselect</prgn> und <prgn>aptitude</prgn>. Sie sind
menügesteuert und können auch durch die automatische Abhängigkeitserfassung
die Installation im Vergleich zu <prgn>apt-get</prgn> beschleunigen und
erleichtern.
<p>
Wer nur ein Konsolen-Login benötigt, sollte die Login-Manager
<package>kdm</package>, <package>gdm</package>, <package>wdm</package> oder
auch <package>xdm</package> nicht installieren (d.h. wieder markieren zur
<var>nicht</var>-Installation), die bei einer Installation von X schnell
automatisch mit ausgewählt werden. Erklärung hierzu in <ref id="no-x-start">.
<p>
Wenn Gnome anstelle von KDE als Sitzungsmanager gewünscht wird, muss dies der
<prgn>x-session-manager</prgn>, wie in <ref id="alternatives"> beschrieben,
geändert werden.

<sect1 id="xtcp">TCP/IP-Verbindungen mit X
<p>
Da X-TCP/IP-Verbindungen nicht verschlüsselt werden, besteht bei
Fernverbindungen die Gefahr des Abgehörtwerdens. Aus diesem Grund ist in
&debian; die Standardeinstellung so gewählt, dass TCP/IP-Socket deaktiviert
ist. Eine TCP/IP-Verbindung auch zur Übertragung von graphischen Elementen
kann aber sicher mit <prgn>ssh</prgn> erzeugt werden. Siehe dazu
<ref id="xssh">.
<p>
Die Methode, die hier im folgenden beschrieben wird, ist also nur in
Umgebungen zu empfehlen, die als sicher charakterisiert werden können, wie
z.B. ein hinter einer gut gewarteten Firewall agierendes Intranet oder ein
kleines Heimnetzwerk. Mit dem folgenden Befehl kann die momentane
X-Server-Einstellung bzgl. TCP/IP herausgefunden werden:
<example>
# find /etc/X11 -type f -print0 | xargs -0 grep nolisten
/etc/X11/xinit/xserverrc:exec /usr/bin/X11/X -dpi 100 -nolisten tcp
</example>
Entfernen von <tt>-nolisten</tt> stellt das Lauschen auf dem X-Server wieder
ein.
</sect1>

<sect1 id="xhost">X-Fernverbindungen mit <prgn>xhost</prgn>
<p>
<prgn>xhost</prgn> erlaubt Zugriff auf den X-Server basierend auf dem Namen
des Rechners. Dies ist sehr unsicher. Das folgende Beispiel unterdrückt den
Test der Rechnernamen und erlaubt so Verbindungen von jedem Rechner aus,
falls TCP/IP-Socket ebenfalls aktiviert sind. (Siehe auch <ref id="xtcp">):
<example>
$ xhost +
</example>
Das Testen der Rechnernamen kann wieder aktiviert werden mit:
<example>
$ xhost -
</example>
<p>
<prgn>xhost</prgn> kann keine Unterscheidung auf Benutzerebene vornehmen.
Des Weiteren können Rechnernamen natürlich gefälscht werden.
<p>
Diese Methode sollte nicht verwendet werden, wenn man sich in einer
ungesicherten Netzumgebung befindet &ndash; dies betrifft auch
Wählverbindungen mittels PPP. Siehe <manref name="xhost" section="1x">.
</sect1>

<sect1 id="xssh">X-Fernverbindungen mit <prgn>ssh</prgn>
<p>
Die Verwendung von <prgn>ssh</prgn> ermöglicht die sichere Übertragung von
Daten von einem lokalen X-Server zu einem Applikations-Server.
<list>
<item>Setze auf dem entfernten Rechner in der Datei
      <file>/etc/ssh/sshd_config</file> die Einträge <tt>X11Forwarding</tt>
      und <tt>AllowTcpForwarding</tt> auf <tt>yes</tt>.
<item>Starte den X-Server auf dem lokalen Rechner.
<item>Öffne ein <prgn>xterm</prgn> auf dem lokalen Rechner.
<item>Starte <prgn>ssh</prgn> um eine Verbindung zu dem entfernten Rechner
      aufzubauen.
      <example>
localname @ localhost $ ssh -q -X -l loginname remotehost.domain
Password:
...
      </example>
<item>Starte eine X-basierte Applikation auf dem entfernten Rechner.
      <example>
loginname @ remotehost $ gimp &
      </example>
</list>
Diese Methode erlaubt es, die graphische Ausgabe eines X-Clients anzuzeigen,
als liefe er über den lokalen Unix-Domain-Socket.
</sect1>

<sect1 id="xtermfaq"><prgn>xterm</prgn>
<p>
Alles was mit <prgn>xterm</prgn> zu tun hat, findet man hier:
<url id="&xtermfaq;">.
</sect1>

<sect1 id="xresources">X-Ressourcen Datenbank
<p>
Viele ältere X-Programme, wie z.B. xterm, verwenden die X-Ressourcen, um ihr
Erscheinungsbild zu konfigurieren. Die Datei <file>~/.Xresources</file> wird
verwendet um derartige Daten benutzerabhängig zu speichern. Die Datei wird
automatisch während des Logins an die systemweiten Einstellungen angehängt.
<p>
Es folgen einige nützliche Einstellungen, die man in
<file>~/.Xresources</file> vornehmen kann.
<example>
! Die Schrift in den Terminals vergrößern:
XTerm*font: 9x15

! Scrollbalken anzeigen
XTerm*scrollBar: true

! Puffergröße einstellen
XTerm*saveLines: 1000
</example>
Diese Einstellungen können auch sofort aktiviert werden durch:
<example>
xrdb -merge ~/.Xresources
</example>

<sect1 id="ss-xsu">Administratorrechte unter X
<p>
Wenn ein graphisches Programm mit root-Rechten gestartet werden muss, müssen
einige Vorkehrungen getroffen werden. Keinesfalls sollte man als Superuser
einen X-Server starten, wegen der beträchtlichen Sicherheitsrisiken.
<p>
Man startet den X-Server als gewöhnlicher Benutzer und öffnet ein
<prgn>xterm</prgn> Fenster. Dann folgen:
<example>
$ XAUTHORITY=$HOME/.Xauthority
$ export XAUTHORITY
$ su root
Password:*****
# printtool &
</example>
Wenn man diesen Trick verwendet und sich mit <prgn>su</prgn> als ein
Nicht-root-Benutzer anmeldet, muss darauf geachtet werden, dass die Datei
<file>~/.Xauthority</file> für diesen speziellen Benutzer Gruppen-lesbar ist.
<p>

<!-- this section moved up -->
Um diesen Vorgang zu automatisieren, kann der betreffende Benutzer eine Datei
<file>~/.xsession</file> anlegen, die folgende Zeilen enthält.
<example>
# So funktioniert X auch wenn su benutzt wurde.
if [ -z "$XAUTHORITY" ]; then
        XAUTHORITY=$HOME/.Xauthority
        export XAUTHORITY
fi
unset XSTARTUP
# Wenn ein besonderer Window/Sitzungsmanager gewünscht wird
# kann der hier eingestellt werden.
#XSTARTUP=/usr/bin/blackbox
# This start x-window/session-manager program
if [ -z "$XSTARTUP" ]; then
  if [ -x /usr/bin/x-session-manager ]; then
    XSTARTUP=x-session-manager
  elif [ -x /usr/bin/x-window-manager ]; then
    XSTARTUP=x-window-manager
  elif [ -x /usr/bin/x-terminal-emulator ]; then
    XSTARTUP=x-terminal-emulator
  fi
fi
# Ausführung des Window/Sitzungsmanagers.
exec $XSTARTUP
</example>
Nun kann <prgn>su</prgn> (nicht <tt>su -</tt>) in einem <prgn>xterm</prgn>
Fenster vom Benutzer gestartet werden. Auch graphische Programme, die von der
Shell mit Superuser-Rechten gestartet wurden, können nun angezeigt werden.
Dieser Trick funktioniert nur solange, wie die übliche
<file>/etc/X11/Xsession</file> ausgeführt wird. Wenn der Benutzer eine eigene
Datei <file>~/.xinit</file> oder <file>~/.xsession</file> Datei anlegt, muss
die oben erwähnte Umgebungsvariable <tt>XAUTHORITY</tt> an diese Skripte
angepasst werden.

<p>Alternativ, kann das Paket <package>sudo</package> verwendet werden, um
diese Sequenz abzuarbeiten.
<example>
$ sudo xterm
... oder
$ sudo -H -s
</example>
Hier muss die  <file>/root/.bashrc</file> folgendes enthalten:
<example>
if [ $SUDO_USER ]; then
    sudo -H -u $SUDO_USER xauth extract - $DISPLAY | xauth merge -
fi
</example>
Dies funktioniert auch, wenn das Home-Verzeichnis des Benutzers mit NFS
gemountet wird, da root die Datei <file>.Xauthority</file> nicht lesen muss.
<p>

There are also several specialized packages for this purpose:
<package>kdesu</package>, <package>gksu</package>, <package>gksudo</package>,
<package>gnome-sudo</package>, and <package>xsu</package>.  Some other
methods can be used to achieve similar results: creating a symlink from
<file>/root/.Xauthority</file> to the user's corresponding one; use of the
script <url id="&suxhome;" name="sux">; or putting "<tt>xauth merge
~<var>USER_RUNNING_X</var>/.Xauthority</tt>" in the root initialization
script.
<p>
See more on the <url id="&deb-dev-su;" name="debian-devel mailing list">.
</sect1>

<sect1 id="xfs-tt">TrueType-Schriften unter X
<p>
Der Standard-X-Font-Server <prgn>xfs</prgn> in Free86-4 kommt problemlos mit
TrueType Schriften zurecht. Wenn man XFree86-3 verwendet, braucht man
zusätzlich den Font-Server <prgn>xfs-xtt</prgn>.
<p>
Wenn man selbst Programme kompiliert, muss man darauf achten, diese gegen
libXft oder libfreetype zu linken. Wenn man nur die Pakete aus der
Distribution verwendet, gibt es weiter nichts zu beachten.
<p>
Zu den neuen Schriften müssen die Dateien <file>fonts.{scale,dir}</file>
erzeugt werden, da diese nötige Verwaltungsinformationen für den X-Server
bereitstellen.
<p>
Da <strong>freie</strong> Schriften oft eingeschränkt sind, kann das
Installieren von Shareware- oder kommerziellen TrueType-Schriften eine
Alternative sein. Um diesen Schritt zu vereinfachen, gibt es einige Pakete:
<list compact>
<item><package>ttf-commercial</package>
<item><package>msttcorefonts (>1.1.0)</package> (Dieses Paket funktioniert in
      Woody seit August 2002 nicht mehr, da Microsoft die von dem Paket
      geladenen Schriften vom Server entfernt hat.)
</list>
Man muss schon eine gute Auswahl an Schriften haben, um das besonders frei
gestaltete System mit kommerziellen Schriften zu 'verunreinigen'.

<sect1 id="ss-browser">Web-Browser (graphische)
<p>
Es gibt eine Handvoll graphischer Web-Browser in &debian;
<list compact>
<item><package>mozilla</package> Der Mozilla-Browser (neu)
<item><package>galeon</package> Mozilla-basierter Browser mit Gnome
      Benutzeroberfläche (neu)
<item><package>konqueror</package> KDE-Browser
<item><package>dillo</package> GTK-Browser
<item><package>amaya-gtk</package> W3C-Referenz-Browser
<item><package>amaya-lesstif</package> W3C-Referenz-Browser
<item><package>netscape-...</package> (viele, alt)
<item><package>communicator-...</package> (viele, alt)
<item>...
</list>
Die Version des <package>mozilla</package> muss zu der
<package>galeon</package> Version passen, da zweiteres die
Gecko-HTML-Rendering-Engine des ersteren verwendet.
<p>
Plugins für die Browser wie <package>mozilla</package> und
<package>galeon</package> können installiert werden, indem man einfach die
"<tt>*.so</tt>" in das entsprechende Plugin-Verzeichnis kopiert (dies findet
man z.B. mit <tt>locate libnullplugin</tt>).
<p>
Erhältliche Plugins:
<list compact>
<item>Java Plugin: Download des "J2SE" von <url id="&javasunhome;">.
<item>Flash Plugin: Download des "Macromedia Flash Player 5" von
      <url id="&flashhome;">.
<item><package>freewrl</package>: VRML-Browser und Netscape-Plugin
<item>...
</list>
</sect1>

<!-- CJK and X moved to bottom with different name to locale section -->

</sect>

<sect id="ssh">SSH
<p>
SSH (Secure SHell) ist ein sicheres Werkzeug, um Verbindungen über das
Internet herzustellen. Eine freie Version von SSH namens OpenSSH ist als
<package>openssh</package> Paket in &debian; enthalten.

<sect1 id="ssh-basics">Grundlagen
<p>
Zunächst müssen der OpenSSH-Server und -Client installiert werden.
<example>
# apt-get update && apt-get install ssh
</example>
In <file>/etc/apt/sources.list</file> muss ein non-US-Eintrag vorhanden sein
und es darf keine Datei <file>/etc/ssh/sshd_not_to_be_run</file> bestehen.
<p>
SSH beherrscht zwei Arten von Authentisierungsprotokollen:
<list>
<item>SSH-Protokoll Version 1:
      <list compact>
      <item>In &debian;-Potato wird nur die Version 1 unterstützt.
      <item>Diese Version unterstützt:
            <list compact>
            <item>RSAAuthentication: RSA Identitäts-Schlüssel basierte
                  Benutzererkennung
            <item>RhostsAuthentication: Auf .rhosts basierende
                  Rechnererkennung (unsicher, daher nicht aktiviert.)
            <item>RhostsRSAAuthentication: Authentisierung mit
                  <file>.rhosts</file> kombiniert mit RSA Host-Schlüssel
                  (auch deaktiviert)
            <item>ChallengeResponseAuthentication: RSA Challenge-Response
                  Authentisierung
            <item>PasswordAuthentication: Passwortbasierte Authentisierung
            </list>
      </list>
<item>SSH Protokoll Version 2:
      <list compact>
      <item>Alle Versionen seit Woody verwenden bevorzugt diese Version.
      <item>Diese Version unterstützt:
            <list compact>
            <item>PubkeyAuthentication: Public-Key basierte Authentisierung
            <item>HostbasedAuthentication: <file>.rhosts</file> oder
                  <file>/etc/hosts.equiv</file> Authentisierung kombiniert
                  mit Public-Key Rechner Authentisierung (disabled)
            <item>ChallengeResponseAuthentication: challenge-response
                  Authentisierung
            <item>PasswordAuthentication: Passwort basierte Authentisierung
            </list>
      </list>
</list>

<p>
Die unterschiedlichen unterstützten Protokolle müssen beachtet werden, wenn
man von oder nach Woody migriert, da man sonst vielleicht keine
SSH-Verbindungen mehr zu den gewohnten Rechnern aufbauen kann.
<p>
Siehe dazu auch <file>/usr/share/doc/ssh/README.Debian.gz</file>,
<manref name="ssh" section="1">,
<manref name="sshd" section="8">,
<manref name="ssh-agent" section="1"> und
<manref name="ssh-keygen" section="1"> für Details.

<p>
Die wichtigsten Konfigurationsdateien für SSH sind:

<list>

<item><file>/etc/ssh/ssh_config</file>: SSH-Client Voreinstellungen. Siehe
      <manref name="ssh" section="1">. Wichtige Einträge sind:

      <list compact>
      <item><tt>Host</tt>: Beschränkt die folgenden Restriktionen auf diesen
            Rechner bzw. dieses Rechnermuster (bis zum nächsten
            'Host'-Eintrag).
      <item><tt>Protocol</tt>: Spezifiziert die Version des SSH-Protokolls.
            Die Voreinstellung ist "2,1".
      <item><tt>PreferredAuthentications</tt>: Spezifiziert die Methode mit
            der SSH2 authentisieren soll. Die Voreinstellung ist
            "hostbased,publickey,keyboard-interactive,password".
      <item><tt>ForwardX11</tt>: Diese Option ist per Voreinstellung
            abgeschaltet. Sie kann über die Kommandozeilenoption
            "<tt>-X</tt>" überstimmt werden, so dass auch graphische Ausgaben
            übertragen werden dürfen.
      </list>

<item><file>/etc/ssh/sshd_config</file>: Voreinstellungen des SSH-Servers.
      Siehe <manref name="sshd" section="8">. Wichtige Einträge sind:

      <list compact>
      <item><tt>ListenAddress</tt>: Spezifiziert die lokalen Adressen, auf
            denen <prgn>sshd</prgn> lauscht. Hier sind mehrere möglich.
      <item><tt>AllowTcpForwarding</tt>: Voreinstellung: aus
      <item><tt>X11Forwarding</tt>: Voreinstellung: aus.
      </list>

<item><file>$HOME/.ssh/authorized_keys</file>: In dieser Datei liegt die
      Liste der voreingestellten öffentlichen Schlüssel ('public keys'), mit
      denen Clients sich mit dem System verbunden haben. Siehe
      <manref name="ssh-keygen" section="1">.

<item><file>$HOME/.ssh/identity</file>: Siehe <manref name="ssh-add"
      section="1"> und <manref name="ssh-agent" section="1">.
</list>

<p>
Mit folgendem Kommando kann man eine <prgn>ssh</prgn>-Verbindung aufbauen:
<example>
$ ssh username@hostname.domain.ext
$ ssh -1 username@hostname.domain.ext # SSH version 1 erzwungen
</example>
<prgn>ssh</prgn> ersetzt so auf sichere und praktische Weise
<prgn>telnet</prgn>.

</sect1>

<sect1 id="ssh-forward">Port-Umleitung &ndash; für das Tunneln mit SMTP/POP3
<p>
Um eine Weiterleitung ('pipe') einzurichten, die den Port 25 eines entfernten
Servers (<var>remote-server</var>) auf den Port 4025 lokal und den Port 110
des entfernten Servers auf den Port 4110 auf dem lokalen Rechner
einzurichten, kann <prgn>ssh</prgn> folgendermaßen benutzt werden:
<example>
# ssh -q -L 4025:remote-server:25 4110:remote-server:110 \
           benutzername@remote-server
</example>

Auf diese Weise können sichere SMTP/POP3-Übertragungen realisiert werden.

Man setze die Option <tt>AllowTcpForwarding</tt> auf <tt>yes</tt> in der
Datei <file>/etc/ssh/sshd_config</file> auf dem entfernten Rechner.
</sect1>

<sect1 id="ssh-rsa">Mit weniger Passwörter agieren
<p>
Man kann die sich immer wiederholende Eingabe von Passwörtern umgehen, wenn
man auf das RSAAuthentication (SSH1 Protokoll)-Verfahren, bzw.
PubkeyAuthentication (SSH2 Protokoll)-Verfahren zurückgreift.
<p>
Auf dem entfernten System wird dazu in der Konfigurationsdatei
<file>/etc/ssh/sshd_config</file> "RSAAuthentication yes" bzw.
"PubkeyAuthentication yes" gesetzt.

<p>
Dann werden Schlüssel lokal erzeugt und der dazugehörige öffentliche
Schlüssel auf dem entfernten System hinterlegt.
<example>
$ ssh-keygen          # RSAAuthentication: RSA1 Schlüssel für SSH1
$ cat .ssh/identity.pub | ssh benutzer1@remote \
        "cat - &gt;&gt;.ssh/authorized_keys"
...
$ ssh-keygen -t rsa   # PubkeyAuthentication: RSA Schlüssel für SSH2
$ cat .ssh/id_rsa.pub | ssh benutzer1@remote \
        "cat - &gt;&gt;.ssh/authorized_keys"
...
$ ssh-keygen -t dsa   # PubkeyAuthentication: DSA Schlüssel für SSH2
$ cat .ssh/id_dsa.pub | ssh benutzer1@remote \
        "cat - &gt;&gt;.ssh/authorized_keys"
</example>
Später kann das Passwort mit "<tt>ssh-keygen -p</tt>" neu gesetzt werden.
Bei Problemen können vermehrt Statusinformationen ausgegeben werden mit:
"<tt>ssh -v</tt>".
<p>
In der Datei <file>authorized_keys</file> können zu einem beliebigen Rechner
Optionen hinzugefügt werden, um dort z.B. Kommandos auszuführen. Siehe
<manref name="sshd" section="8"> für weitere Details.
<p>
SSH2 verfügt über <tt>HostbasedAuthentication</tt>. Damit dies funktioniert,
muss auf dem Server in der Datei <file>/etc/ssh/sshd_config</file>
<tt>HostbasedAuthentication</tt> auf <tt>yes</tt> gesetzt werden, desgleichen
in <file>/etc/ssh/ssh_config</file> oder <file>$HOME/.ssh/config</file> auf
dem Client.
</sect1>

<sect1 id="ssh-client">Weitere SSH-Client-Programme
<p>
Es gibt einige freie SSH-Client-Programme auf nicht-Unix-artigen Plattformen.
<taglist>
<tag>Windows
<item><url id="&puttyhome;" name="puTTY"> (GPL)
<tag>Windows (cygwin)
<item>SSH in <url id="&cygwinhome;" name="cygwin"> (GPL)
<tag>Macintosh Classic
<item><url id="&macsshhome;" name="macSSH"> (GPL) [Mac OS X beinhaltet
      OpenSSH; es wird gestartet mit <tt>ssh</tt> im Terminal]
</taglist>
Siehe auch <url id="&sfdochome;" name="SourceForge.net, site documentation">,
"6. CVS Instructions".

<sect1 id="ssh-agent">SSH-Agent
<p>
<!-- XXX FIXME XXX ssh-agent can be improved -->
Der öffentliche Schlüssel kann einfach in der Datei
<file>~/.ssh/authorized_keys</file> hinterlegt werden, worauf er von ssh
anerkannt wird.
<example>
$ ssh-agent
$ # die Ausgabe in der Shell einfügen
$ ssh-add .ssh/identity
$ # oder ssh-add .ssh/id_dsa oder wie auch immer der private Schlüssel heißt
$ scp <var>remote.host.with.public.key</var>
</example>
Weitere Informationen liefern <manref name="ssh-agent" section="1"> und
<manref name="ssh-add" section="1">.
</sect1>

<sect1 id="ssh-trouble">Problemlösungen
<p>
Wenn Probleme bei der Benutzung von <prgn>ssh</prgn> auftreten, sollte man
zuerst einmal die Berechtigungen der Konfigurationsdateien mittels der
<prgn>ssh</prgn> Option <tt>-v</tt> prüfen.
<p>
Wenn man root-Rechte hat, kann mit <tt>-P</tt> die Benutzung der Ports
1&ndash;1023 unterbunden werden, welche bei Firewalls Schwierigkeiten
bereiten.
<p>
Wenn <prgn>ssh</prgn>-Verbindungen, die ursprünglich funktionierten plötzlich
nicht gestartet werden können, hat der Systemadministrator wahrscheinlich die
Datei <prgn>host_key</prgn> geändert. Nachdem man sich vergewissert hat, dass
dies der Fall ist und es sich nicht um den Versuch handelt, eine Verbindung
zu einem gehackten Rechner zu etablieren, kann einfach die zu dem
Remote-Rechner gehörige <prgn>host_key</prgn> Zeile in der Datei
<file>$HOME/.ssh/known_hosts</file> gelöscht werden. Bei der nächsten
Verbindungsaufnahme wird die Zeile neu generiert.
</sect1>

</sect>

<sect id="mail">E-Mail Programme
<p>
Die E-Mail Konfiguration eines Systems zerfällt in drei Kategorien:
<list>
<item>Mail-Transfer-Agenten (mail transfer agent, MTA): <prgn>exim</prgn>
<item>Mail-Hilfsprogramme: <prgn>procmail</prgn>, <prgn>fetchmail</prgn>,
      <prgn>mail</prgn>, ...
<item>Mail-Benutzer-Agenten (mail user agent, MUA): <prgn>mutt</prgn>
</list>

<sect1>E-Mail Transport/Transfer Agenten (Exim)
<p>
Literatur:
<list compact>
<item><package>exim-doc</package> und <package>exim-doc-html</package> Pakete
<item><url id="&eximhome;">
</list>
<p>
Wenn <prgn>exim</prgn> als MTA eingesetzt wird, müssen die folgenden Dateien
angepasst werden:
<example>
/etc/exim/exim.conf     "eximconfig" bearbeitet diese Datei
/etc/inetd.conf         durch Auskommentieren von smtp läuft exim als Daemon
/etc/email-addresses    Add spoofed source address lists
Die Filter können mittels exim -brw, -bf, -bF, -bV, ...  getestet werden.
</example>

<sect2>Ein Fangnetz für nicht existierende E-Mail-Adressen (Exim)
<p>
In der Datei <file>/etc/exim/exim.conf</file> (Woody oder später), kann am
Ende des Abschnittes DIRECTORS (gleich nach localuser: director) ein Ausdruck
eingefügt werden, der auf alle E-Mail-Adressen passt, die vorher nicht
aufgelöst werden konnten (nach Miquel van Smoorenburg):
<example>
catchall:
  driver = smartuser
    new_address = webmaster@mydomain.com
</example>
<p>
Wer eine komplexere Anordnung von virtuellen Domänen angelegt hat, wird an
das Ende der Datei <file>/etc/exim/exim.conf</file> einen Eintrag wie folgt
vornehmen: (von mir, nicht sehr ausführlich getestet):
<example>
*@yourdomain.com ${lookup{$1}lsearch*{/etc/email-addresses} \
        {$value}fail} T
</example>
Dazu benötigt man einen "*" Eintrag in der Datei
<file>/etc/email-addresses</file>.
</sect2>

<sect2>Selektive Adressen-Umschreibung für ausgehende E-Mail (Exim)
<p>
<!-- Derrick 'dman' Hudson dman@dman.ddts.net -->
Mit <prgn>exim</prgn> kann auch die From: Zeile der ausgehenden E-Mails
manipuliert werden. Auch dies kann in der <prgn>exim</prgn>
Konfigurationsdatei <file>/etc/exim/exim.conf</file> erledigt werden:
<example>
*@host1.something.dyndns.org \
  "${if eq {${lookup{$1}lsearch{/etc/passwd}{1}{0}}} {1}  \
   {$0}{$1@somethig.dyndns.org}}"  frFs
</example>
Dies schreibt alle Adressen um, die auf den Ausdruck
<tt>*@host1.something.dyndns.org</tt> passen.
<enumlist>
<item>Zuerst wird in <file>/etc/password</file> nachgesehen, ob der Ausdruck
      $1 auf einen lokalen Benutzer zutrifft.
<item>Wenn dies der Fall ist, wird daraus das, was es vorher schon war ($0).
<item>Wenn es den Benutzer lokal nicht gibt, wird der Domänenanteil ersetzt.
</enumlist>

<sect1>Mail-Hilfsprogramme (Fetchmail)
<p>
<prgn>fetchmail</prgn> wird im Daemon-Modus gestartet und ist für die
Abholung von E-Mail von POP3-Accounts von einem ISP zuständig, um die Mails
dann in das lokale E-Mail-System einzufügen. Die Konfiguration geschieht über
die Dateien:
<example>
/etc/init.d/fetchmail
/etc/rc?.d/???fetchmail startet update-rc.d fetchmail Default Priorität 30
/etc/fetchmailrc        Konfigurationsdatei (chown 600, Besitzer ist fetchmail)
</example>
<p>
In der alten &debian;-Version Potato war das Starten von fetchmail aus
<prgn>init.d</prgn> heraus noch schwierig. Dies ist mit Woody behoben.
Beispiele sind außerdem zu finden in den Dateien
<file>/etc/init.d/fetchmail</file> und <file>/etc/fetchmailrc</file> unter
der Adresse <url id="&examples;" name="example scripts">.
<p>
Wenn im E-Mail-Kopf ^M Zeichen vorkommen, sollte "stripcr" in den Optionen der
Datei <file>$HOME/.fetchmailrc</file> hinzugefügt werden:
<example>
options fetchall no keep stripcr
</example>
</sect1>

<sect1>Mail-Hilfsprogramme (Procmail)
<p>
<prgn>procmail</prgn> ist ein Programm zur lokalen Mail-Zustellung und kann
auch als Filter verwendet werden. Die Datei <file>$HOME/.procmailrc</file>
wird für jeden Benutzer benötigt. Beispiel:
<url id="&examples;" name="_procmailrc">
</sect1>

<sect1>E-Mail-Programme (Mail user agent) am Beispiel Mutt
<p>
Ein beliebtes E-Mail-Programm für die Konsole ist <prgn>mutt</prgn> in
Kombination mit <prgn>vim</prgn>. Einstellungen liegen in
<file>~/.muttrc</file>; z.B.

<example>
# diese Einstellungen modifizieren
# das Verhalten des Editors.
set editor="vim -c 'set tw=72 et ft=mail'"
#
# header weeding taken from the manual (Sven's Draconian header weeding)
#
ignore *
unignore from: date subject to cc
unignore user-agent x-mailer
hdr_order from subject to cc date user-agent x-mailer
auto_view application/msword
...
</example>
<p>
Um HTML-E-Mail oder MS-Word-Dokumente als Text anzeigen zu können, muss
<prgn>antiword</prgn> installiert sein und folgende Zeilen an entweder
<file>/etc/mailcap</file> (global) oder <file>$HOME/.mailcap</file> (per
User) angehängt werden.
<example>
text/html; lynx -force_html &percnt;s; needsterminal;
application/msword; /usr/bin/antiword '&percnt;s'; copiousoutput;
description="Microsoft Word Text"; nametemplate=&percnt;s.doc
</example>

</sect1>

</sect>

<sect id="l10n">Lokalisation und Sprachen
<p>
&debian; ist eine internationale Distribution, die eine wachsende Anzahl an
Sprachen und regionaler Besonderheiten berücksichtigt. Die folgenden
Abschnitte zeigen, in welcher Form &debian; dies bewerkstelligt und an
welchen Stellen eine Lokalisierung eingestellt werden kann. Dies betrifft in
erster Linie Ein- und Ausgaben in der jeweiligen Muttersprache, Daten,
numerische und finanzielle Formate, die von System zu System unterschiedlich
sein können.

<sect1 id="languages">Grundlagen
<p>
Es folgen die wichtigsten Anpassungen für die Lokalisierung.

<sect2 id="keyboard">Tastatur
<p>
&debian; stellt Tastaturbelegungen für nahezu zwei Dutzend Tastaturvarianten
bereit. In Woody, können diese eingestellt werden mit:

<list compact>
<item><tt>dpkg-reconfigure --priority=low console-data # Konsole</tt>
<item><tt>dpkg-reconfigure --priority=low xserver-xfree86   # X4</tt>
<item><tt>dpkg-reconfigure --priority=low xserver-common-v3 # X3</tt>
</list>
</sect2>

<sect2 id="data-stream">Daten
<p>
Die große Mehrheit an &debian;-Software unterstützt den Umgang mit
nicht-US-ASCII-Zeichen durch die LC_CTYPE Umgebungsvariable, welche den
<strong>locale</strong>-Mechanismus der glibc konfiguriert.
<list compact>
<item>8-bit clean: praktisch alle Programme
<item>andere lateinische Buchstaben (z.B. ISO-8859-1 oder ISO-8859-2):
      viele Programme
<item>multi-byte Sprachen wie Chinesisch, Japanisch oder Koreanisch:
      viele neue Programm
</list>
</sect2>

<sect2 id="display">Anzeige
<p>
X-Windows kann jede Zeichen-Kodierung anzeigen, inklusive UTF-8 und
unterstützt viele Schrifttechnologien. Die Unterstützung reicht über
8-bit-Schriften über 16-bit-Schriften für Chinesisch, Japanisch oder
Koreanisch. Multi-byte-Zeichen werden über den XIM-Mechanismus unterstützt.
Siehe <ref id="x-cjk">.
<p>
Japanischer EUC-Kode kann auch (mit dem Paket <package>kon2</package>) auf
der (S)VGA-Konsole angezeigt werden. Eine neue Möglichkeit, welche die
FB-Konsole verwendet ist <package>jfbterm</package>. In diesen Umgebungen
muss allerdings die Applikation selbst die Unterstützung dieser Sprachen
mitbringen. <package>egg</package> ist ein Paket für Emacs und
<package>jvim</package> ein japanisiertes Vim.
</sect2>

<sect2 id="translation">Übersetzungen
<p>
Viele Text-Nachrichten und Dokumente für das &debian;-System liegen übersetzt
vor, z.B. Fehlermeldungen, Standardausgaben, Menüs und Handbuchseiten. Derzeit
gibt es Projekte zur Übersetzung in: Deutsch, Spanisch, Finnisch,
Französisch, Ungarisch, Italienisch, Japanisch, Koreanisch und Polnisch.
Hierzu muss natürlich das entsprechende Paket in der Form
<tt>manpages-<var>LANG</var></tt> installiert sein. (<var>LANG</var> ist hier
ein eindeutiger Sprachkennzeichner gemäß den zweibuchstabigen
ISO-Länderkodes.) Um herauszufinden, welche Pakete zur Auswahl stehen, kann
<tt>apt-cache search manpages-|less</tt> verwendet werden.
<p>
Um eine NLS Handbuchseite anzuzeigen, muss die Umgebungsvariable LC_MESSAGES
gesetzt sein. Um z.B. deutsche Handbuchseiten zu sehen, muss
<tt>LC_MESSAGES=de</tt> gesetzt sein. Das <prgn>man</prgn> Programm wird die
Handbuchseite dann in <file>/usr/share/man/de/</file> suchen.
</sect2>
</sect1>

<sect1 id="locales">Lokalisierung mit locale
<p>
&debian; unterstützt die <strong>locale</strong> Technologie. Locale ist ein
System zur Ausgabe von Zeichen, Daten und Zeiten und Währungseinheiten
entsprechend lokaler Gegebenheiten.

Es verwendet Umgebungsvariablen, um die Region festzustellen. Wenn z.B.
englische und deutsche locale Pakete installiert sind, werden die
Fehlermeldungen mehrsprachig.
<example>
$ LANG="en_US" cat foo
cat: foo: No such file or directory
$ LANG="de_DE" cat foo
cat: foo: Datei oder Verzeichnis nicht gefunden
</example>
Diese Funktionalität wird von der glibc bereitgestellt.
(<prgn>localeconf</prgn> erlaubt eine komfortable Konfiguration der
locale-Einstellungen.) Siehe auch <manref name="locale" section="7">.

<sect1 id="activate-locales">Aktivierung der Lokalisierung
<p>
&debian; hat nicht alle verschiedenen Sprachen einkompiliert. Die Datei
<file>/usr/lib/locale</file> zeigt, welche Sprachen sofort verfügbar sind
(neben der Standardeinstellung "C"). Wenn die benötigte Sprache fehlt, gibt
es zwei Möglichkeiten:
<list compact>
<item>Hinzufügen der gewünschten Locale zu <file>/etc/locale.gen</file>,
      anschließend <prgn>locale-gen</prgn> starten, um die Locale zu
      erzeugen. Siehe dazu <manref name="locale-gen" section="8"> und die
      Handbuchseiten im "SEE ALSO"-Abschnitt dieser Handbuchseite.
<item>Starte <tt>dpkg-reconfigure locales</tt>, um das
      <package>locales</package> Paket neu zu konfigurieren. Auch bei
      Neuinstallation des Paketes <package>locales</package> wird das
      Konfigurationstool gestartet, so dass alle Einstellungen vorgenommen
      werden können.
</list>

<sect1 id="env-locale">Eine Locale aktivieren
<p>
Die folgenden Umgebungsvariablen werden ausgewertet, um die lokalen Formate
zu berücksichtigen.
<enumlist>
<item>LANGUAGE: Diese Umgebungsvariable enthält eine durch Doppelpunkte
      separierte Liste von Sprachen (mit absteigender Priorität). Sie wird nur
      verwendet, wenn die POSIX-locale nicht "C" ist [in Woody; in Potato hat
      LANGUAGE immer Priorität vor POSIX]. (GNU-Erweiterung)
<item>LC_ALL: Wenn dieser Eintrag nicht leer ist, wird er für alle Kategorien
      verwendet. (POSIX.1) Voreinstellung ist "" (null).
<item>LC_*: Wenn dieser Eintrag nicht leer ist, wird er für die entsprechende
      Kategorie gesetzt. (POSIX.1). Voreinstellung "C".
      <p>
      Mögliche LC_*-Variablen sind:
      <list compact>
      <item>LC_CTYPE: Buchstaben-Klassifikation und Groß-/Kleinumschaltung.
      <item>LC_COLLATE: Collation-Reihenfolge. (???)
      <item>LC_TIME: Datum- und Zeit-Format.
      <item>LC_NUMERIC: Zahlenformat.
      <item>LC_MONETARY: Geld-Format.
      <item>LC_MESSAGES: Format der Meldungen und Diagnostik-Anzeigen, auch
            für interaktive Eingaben.
      <item>LC_PAPER: Papier-Format.
      <item>LC_NAME: Namen-Format.
      <item>LC_ADDRESS: Adressen-Format und Orts-Information.
      <item>LC_TELEPHONE: Telefonnummer-Format.
      <item>LC_MEASUREMENT: Maßeinheiten (Metrisch oder andere).
      <item>LC_IDENTIFICATION: Metadaten über die locale-Einstellung.
      </list>
<item>LANG: Wenn diese nicht leer ist und LC_ALL nicht definiert ist, wird
      dieser Wert für alle bis dahin nicht definierten Variablen gesetzt.
      (POSIX.1) Voreinstellung "C".
</enumlist>
Einige Programme ignorieren allerdings diese Variablen. In der Regel haben
diese Programme ein eigenes Sprachen-Management (z.B. Netscape Navigator 4).
<p>
Das <prgn>locale</prgn>-Programm kann die aktiven locale-Einstellungen sowie
andere installierte locale anzeigen. Siehe <manref name="locale"
section="1">. (NOTIZ: <tt>locale -a</tt> zeigt alle locales an, die das
System kennt; das bedeutet <em>nicht</em>, dass sie verwendbar sind (weil
unübersetzt). <ref id="activate-locales">.)

<sect1 id="ISO-locale">ISO 8601 Datum-Format-locale
<p>
Die Unterstützung für die Darstellung des internationalen Datums wird durch
die locale <tt>en_DK</tt> &ndash; <strong>Englisch in Dänemark</strong>
&ndash; in Form des ISO 8601-Standards (<tt>yyyy-mm-dd</tt>) geleistet.
Dies scheint aber nur für die Konsole mit <prgn>ls</prgn> zu funktionieren.

<!-- beyond locale moved to below -->

<sect1 id="iso-8859-1">Beispiel für die USA (ISO-8859-1)
<p>
Zu der Datei <file>~/.bash_profile</file> folgendes hinzufügen:
<example>
LC_CTYPE=en_US.ISO-8859-1
export LC_CTYPE
</example>

<sect1 id="france">Beispiel für Frankreich mit Euro-Symbol (ISO-8859-15)
<p>
Zu der Datei <file>~/.bash_profile</file> folgendes hinzufügen:
<example>
LANG=fr_FR@euro
export LANG
LC_CTYPE=fr_FR@euro
export LC_CTYPE
</example>
<p>
Die Tastatur kann auf das deutsche "QWERTZ" umgestellt werden wie beschrieben
in <ref id="keyboard">. Die deutschen Handbuchseiten befinden sich im Paket
<package>manpages-de</package>. Die rechte Alt-Taste heißt in Europa Alt-Gr.
Durch Drücken dieser Taste können diverse Sonderzeichen erreicht werden. So
erzeugt z.B. AltGr-E das Euro-Symbol.
<p>
Die meisten westeuropäischen Sprachen können wie beschrieben eingestellt
werden.
<p>
Siehe <url id="&debian-euro-support;" name="Debian Euro HOWTO"> für die
Konfiguration des Euro-Symbols. Das Paket XXX für weitere Details zur Nutzung
deutscher Anpassungen.

<sect1 id="x-cjk">Beispiel für ein zweisprachiges System (japanisches EUC und
                  ISO-8859-1)
<p>
In diesem Beispiel wird ein System aufgesetzt, das japanisch und englisch
unterstützt. Die Umgebungsvariable für die japanische Sprache heißt in diesem
Fall ja_JP.eucJP (japanisches EUC für traditionelle japanische Unix
Umgebung). Die Unterstützung betrifft X mit gleichzeitig englischen Ausgaben
und Datumsangaben nach ISO-Standard. Hinzu kommt Englisch als primäre Sprache
der Text-Konsole mit der Umgebungseinstellung en_US.ISO-8859-1 (ASCII mit
zusätzlichen Akzenten).
<list>

<item>zuerst wird eine japanische Lokale ja_JP.eucJP erzeugt, wie beschrieben
      in <ref id="l10n">.

<item>es wird ein Kana-nach-Kanji-Konverter und ein Wörterbuch installiert:
      <list compact>
      <item><package>canna</package> &ndash; Lokaler Server (NEC
            free-license) oder
      <item><package>freewnn-jserver</package> &ndash; Netzwerk-basierter
            erweiterbarer Server (Public Domain)
      </list>

<item>Installation einer Eingabemethode für Japanisch:
      <list compact>
      <item><package>kinput2-canna</package> &ndash; für X oder
      <item><package>kinput2-canna-wnn</package> &ndash; für X und
      <item><package>egg</package> &ndash; funktioniert mit Emacsen, optional
            auch im Konsole-Modus
      </list>

<item>Japanisch-kompatibles Terminal:
      <list compact>
      <item><package>kterm</package> &ndash; X (klassisch),
      <item><package>mlterm</package> &ndash; X (sehr nett, verschiedene
            Schriftgrößen) und
      </list>

<item>füge japanische Schriften hinzu.

<item>Konfiguriere X wie beschrieben in <ref id="custom-x">. Eine an den
Benutzer angepasste X-Umgebung kann in Abhängigkeit der Start-Methode von X
eingestellt werden. (<prgn>startx</prgn>, <prgn>xdm</prgn>, ...)

<item>Letztlich wird eine <file>~/.xsession</file> Datei erzeugt, in der die
      Einstellungen vorgenommen werden:

      <example>
#!/bin/sh
# This makes X work when I su to root.
if [ -z "$XAUTHORITY" ]; then
        XAUTHORITY=$HOME/.Xauthority
        export XAUTHORITY
fi

# Japanische locale als Default, C locale als Backup
LANG=ja_JP.eucJP
export LANG
# In der Konsole wollen wir en_US.ISO-8859-1
LC_CTYPE=ja_JP.eucJP
export LC_CTYPE
# menu-Nachrichten in Englisch und ASCII :-)
LC_MESSAGES=C
export LC_MESSAGES
# aktiviere Eingabe-Methode
kinput2 &
XMODIFIERS=@im=kinput2
export XMODIFIERS
# blackbox ist ein guter Window-Manager (lightweight)
exec /usr/bin/blackbox
      </example>

<item>wir fügen folgende Zeilen zu <file>~/.bash_profile</file> hinzu:
      <example>
LC_CTYPE=en_US.ISO-8859-1
export LC_CTYPE
# Für ISO yyyy-mm-dd Datumsanzeige kommt dem japanischen mehr entgegen
LC_TIME=en_DK.ISO-8859-1
export LC_TIME
      </example>

<item>folgende Zeilen können, falls mutt als Mail-Programm verwendet wird,
      zu <file>~/.muttrc</file> hinzugefügt werden:
      <example>
# UTF-8 Unterstützung ist in Japan bei EMACS nicht üblich
# 7 bit Kodierung mittels iso-2022-jp ist einfacher
# Default Reihenfolge = us-ascii --&gt; iso-8859-1 --&gt; utf-8
#set send_charset="us-ascii:iso-8859-1:utf-8"
#set allow_8bit=yes
set send_charset="us-ascii:iso-8859-1:iso-2022-jp"
set allow_8bit=no
      </example>

<item>aktiviere XIM <prgn>kinput2</prgn> für X-Applikationen
      <list compact>
      <item>füge <tt>*inputMethod: kinput2</tt> der .Xresources Datei hinzu:
            <file>~/.Xresources</file> (teilweise automatisch in Debian)
      <item>Einige Programme erlauben sogar die Änderung der Kodierung
            während der Laufzeit (<prgn>mlterm</prgn> kann diese dynamisch
            mit <strong>Strg-Mausknopf-3</strong> ändern.
      </list>
<item>Nun wird X gestartet: <tt>startx</tt> oder durch einen Displaymanager
      (xdm, gdm, kdm, wdm, ...)
<item>In X wird ein japanisch-fähiges Programm gestartet: VIM6, (x)emacs21,
      mc-4.5, mutt-1.4, ... (Emacs ist populär. Aber ich verwende es nicht.)
<item>"<strong>Shift+Space</strong>" schaltet die japanische Unterstützung
      ein und aus.
</list>
Sieh auch die <url id="&suse-cjk;" name="SuSE Seiten für CJK">.

<sect1 id="x-utf-8">Beispiel für UTF-8 in X
<p>
In Zukunft wird Unicode alle Schriftprobleme lösen. Siehe
<url id="&unicode-howto;" name="Das Unicode HOWTO">.

<sect1 id="fb-utf-8">Beispiel für UTF-8 in der FB-Konsole
<p>
Die UTF-8 Unterstützung in der Konsole wird vom Paket
<package>bterm</package> bereitgestellt. Der
<package>debian-installer</package> verwendet dies.

<sect1 id="beyond-locale">Über locale hinaus
<p>
Wenn eine größere Anpassung an eine Sprache gewünscht wird, sollte man
zunächst nachsehen, ob <prgn>tasksel</prgn> oder <prgn>aptitude</prgn>
bereits eine Option für die betreffende Sprache hat.

So kann eine Paketsammlung geladen werden, die bereits Dateien für die
nationale Anpassung enthält, was auch für mehrsprachige Systeme Sinn macht.
Wenn bei einem System mit feinjustierter Sprachunterstützung Paketkonflikte
auftreten, sollte zunächst die Ursache genau festgestellt werden, damit die
Spracheinstellungen nicht verloren gehen. Eventuell muss
<prgn>update-alternative</prgn> verwendet werden, um den vorherigen Status
wieder her zu stellen.
<p>
Die meisten größeren Programme nutzen bereits die glibc 2.2 und sind
größtenteils internationalisiert. Aus diesem Grund sind lokalisierte
Versionen eines speziellen Programms wie z.B. VIM überflüssig. So wird die
Funktionalität von <prgn>jvim</prgn> für VIM von <prgn>vim</prgn> ab Version
6.0 in X automatisch bereitgestellt. Tatsächlich ist die Unterstützung noch
etwas holprig. Da <prgn>jvim</prgn> die japanische Unterstützung eingebaut
hat, sollte man sich das Programm zumindest doch einmal ansehen.
<p>
Es kann sein, dass Programme über die <tt>locale</tt> Konfiguration hinaus
angepasst werden müssen. Das <package>language-env</package> Paket und dessen
Kommando <prgn>set-language-env</prgn> erleichtern diesen Schritt.
<p>
Siehe auch die Internationalisierungsdokumente unter <url id="&intro-i18n;"
name="Einführung in i18n">. Es richtet sich an Entwickler und
Systemadministratoren.
</sect1>

</sect>
</chapt>

