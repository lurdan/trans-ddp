<!-- CVS revision of this document "$Revision: 1.2 $"  -->
<chapt id="woody">Woody transition

<![%FIXME[<p>===Proof reading (final) by dsew: DONE ===]]>

<p>
<sect>Transition preparation
<p>
Network upgrade to "testing" ("Woody") can be done as follows (run the script
<url id="http://qref.sourceforge.net/quick/examples/go-woody" name="go-woody">
to do this in one command):
<example>
# cd /etc/apt
# cp -f sources.list sources.old 
# :&gt;sources.list  
# cd /
# apt-setup noprobe 
 ... select http or ftp
# cd /etc/apt
# grep -e "^deb " sources.list             &gt;sources.deb
# grep -e "^deb-" sources.list             &gt;sources.src
# sed -e "s/^d/#d/" /usr/share/doc/apt/examples/sources.list &gt;sources.list
# sed -e "s/stable/testing/"  sources.deb &gt;&gt;sources.list
# apt-get update
# apt-get install apt apt-utils
# cat &gt;preferences &lt;&lt;EOF
&gt; Package: *
&gt; Pin: release a=testing
&gt; Pin-Priority: 700
&gt; 
&gt; Package: *
&gt; Pin: release a=unstable
&gt; Pin-Priority: 70
&gt;
&gt; EOF
# sed -e "s/stable/unstable/" sources.deb &gt;&gt;sources.list
# sed -e "s/stable/unstable/" sources.src | \
&gt; sed -e "s/^deb-/#deb-/"                 &gt;&gt;sources.list
</example>
A guideline for <file>/etc/apt/preferences</file> (see <manref
name="apt_preferences" section="5">):
<example>
track stable:            change  Pin-Priority of testing  to  80
track testing:           keep as is (install unstable packages with apt-get
                           by adding "/unstable" after the package name)
track testing(unstable): change  Pin-Priority of unstable to 600
track unstable(testing): change  Pin-Priority of unstable to 800
</example>
A guideline for the choice of Pin-Priority is to move from top to bottom 
in the above table, beginning at the top immediately after a distribution
release and moving to the bottom as the time approaches for a freeze for the
next release.
<p>
Make sure to set up <prgn>apt</prgn> to use a proxy, if necessary, by
setting the <tt>http_proxy</tt> environment 
variable or set the http value in <file>/etc/apt/apt.conf</file>.
<p>
The procedure described in this section only upgrades <prgn>apt</prgn> and a minimum set of
packages to avoid dependency-related problems.
</sect>

<sect>Upgrade to Woody
<p>
After the above preparation:
<example>
# apt-get update                     # always do this before upgrade
 ... to upgrade whole system with "suggests" selections 
# apt-get -u dist-upgrade
 ... to upgrade and stay with current dselect settings (new, better)
# apt-get -u dselect-upgrade         # use dselect setup result
</example>
</sect>

<sect>Woody configuration
<p>
(This may not be needed as Woody improves.)
<p>
For a freshly installed Woody system, edit <file>/etc/apt/sources.list</file>,
<file>/etc/apt/apt.conf</file>, and <file>/etc/apt/preferences</file> 
to achieve the same structure as described in the above sections.
</sect>

<sect id="spy">Optimized <file>sources.list</file>
<p>
Optimize <file>sources.list</file> by testing each site for latency and bandwidth.
<example>
# apt-get install apt-spy
# cd /etc/apt ; mv sources.list sources.list.org
# apt-spy -d testing -l sources.apt
</example>
</sect>

</chapt>
