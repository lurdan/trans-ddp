<!-- CVS revision of this document "$Revision: 1.35 $"  -->
<chapt id="woody">Upgrading a distribution to <tt>stable</tt>, <tt>testing</tt>, or <tt>unstable</tt>

<![%f-ref;[
<p>
Official release notes for upgrading are located at
<url id="&stable-release;">
and
<url id="&testing-release;"> (work in progress).

<p>
Upgrading a system to the
<tt>stable</tt>, <tt>testing</tt>, or <tt>unstable</tt>
distribution may require several steps
which must be in the following order:

<list>
 <item> Upgrade to Woody (if your system is older than Woody)
 <item> Upgrade to <tt>stable</tt>
 <item> Upgrade to <tt>testing</tt>
 <item> Upgrade to <tt>unstable</tt>
</list> 

Debian does not support upgrades that skip intermediate releases.

]]>


<sect id="woody-transition">Upgrading from Potato to Woody
<p>
This procedure is described separately because Potato's APT
did not have all the features described in the current
<manref name="apt_preferences" section="5"> manpage.
<p>
After including only Woody sources in
<file>/etc/apt/sources.list</file>,
upgrade APT and required core packages to Woody versions
by doing the following:
<example>
# apt-get update
# apt-get install libc6 perl libdb2 debconf
# apt-get install apt apt-utils dselect dpkg
</example>
Then upgrade the rest of the system to Woody.
<example>
# apt-get upgrade
# apt-get dist-upgrade
</example>


<sect id="testing-transition">Preparing for upgrade
<p>
You can upgrade from one distribution to another one
by fetching packages over the network.
This can be done as follows.
<p>
Get a clean list of repositories for <tt>stable</tt>:
<example>
# cd /etc/apt
# cp -f sources.list sources.list.old
# :&gt;sources.list  
# apt-setup noprobe 
</example>
If you want to upgrade to <tt>testing</tt> then
add <tt>testing</tt> sources to this new list.
If you want to upgrade to <tt>unstable</tt> then also
add <tt>unstable</tt> sources.
<example>
# cd /etc/apt
# grep -e "^deb " sources.list &gt;srcs
# :&gt;sources.list  
# cp -f srcs sources.list
# sed -e "s/stable/testing/" srcs &gt;&gt;sources.list
# sed -e "s/stable/unstable/" srcs &gt;&gt;sources.list
# apt-get update
# apt-get install apt apt-utils
</example>

See <ref id="apt-install"> for the art of tuning 
<file>/etc/apt/sources.list</file> and <file>/etc/apt/preferences</file>.
</sect>

<sect id="upgrade-system">Upgrading
<p>
After properly setting up <file>/etc/apt/sources.list</file> and
<file>/etc/apt/preferences</file> as described above
you can begin the upgrade.
<p>
Note that tracking the <tt>testing</tt> distribution of &debian;
can have the side effect of delaying the installation of packages
containing security fixes, since such packages are uploaded
to <tt>unstable</tt> and only later migrate to <tt>testing</tt>.
<p>
See <ref id="package"> for the basics, and see 
<ref id="apt-trouble"> if you encounter problems.

<sect1>Using <prgn>dselect</prgn>
<p>
If a system has many packages which include <tt>-dev</tt> packages, etc., 
the following method using <prgn>dselect</prgn> is recommended for 
fine-grained package control.
<example>
# dselect update  # always do this before upgrade
# dselect select  # select additional packages
</example>
All your current packages will be selected when <prgn>dselect</prgn>
starts.  <prgn>dselect</prgn> may prompt you with additional packages
based on <tt>Depends</tt>, <tt>Suggests</tt>, and <tt>Recommends</tt>.
If you do not want to add any packages, just type <tt>Q</tt>
to exit <prgn>dselect</prgn> again.
<example>
# dselect install
</example>
You will have to answer some package configuration questions during
this part of the process, so have your notes ready and allow some 
time for this part.  See <ref id="dselect">.
<p>
Use <prgn>dselect</prgn>. <strong>It always works :)</strong>

<![%f-ref;[
<sect1>Using <prgn>apt-get</prgn>
<p>
<example>
# apt-get update
# apt-get -t stable upgrade
# apt-get -t stable dist-upgrade
# apt-get -t testing upgrade
# apt-get -t testing dist-upgrade
# apt-get -t unstable upgrade
# apt-get -t unstable dist-upgrade
</example>
Once your system has reached Sarge it is advisable to use
<prgn>aptitude</prgn> instead of <prgn>apt-get</prgn>.
(<prgn>aptitude</prgn> accepts many of the options
that <prgn>apt-get</prgn> accepts,
including those above.)
<p>
To upgrade and stay with current <prgn>dselect</prgn> settings:
<example>
# apt-get dselect-upgrade
</example>
<p>
See <ref id="depends">.
]]>
</sect>


</chapt>

