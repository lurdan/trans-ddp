<!-- CVS revision of this document "$Revision: 1.6 $"  -->
<!-- CVS revision of original english document "1.35"  -->
<chapt id="woody">Atualizando uma distribuição para a testing

<![%f-ref;[
<p>
As notas de lançamento oficiais para atualização estão localizadas em
<url id="&stable-release;">
e
<url id="&testing-release;"> (trabalho em progresso).

<p>
O processo para atualizar o sistema para os sabores
<tt>testing/unstable</tt> é:
<list>
 <item> atualizar o sistema APT para a versão Woody se seu sistema for
 Potato, já que o APT do Potato não tinha as características descritas
 em <manref name="apt_preferences" section="5"> do Woody.
 <item> modificar seus arquivos <file>/etc/apt/sources.list</file> e
 <file>/etc/apt/preferences</file>, para incluir referências à seção
 testing dos repositórios que você usa. Se você desejar, pode adicionar
 referências para a seção "unstable" também.
 <item> atualizar suas listas de pacotes, e instalar quaisquer pacotes
 que agora são atualizáveis.
</list>
]]>


<sect id="woody-transition">Transição do APT para a versão Woody
<p>
Atualização pela rede do sistema APT e de alguns pacotes principais para
a versão Woody pode ser feita como a seguir depois de incluir a fonte
<tt>stable</tt> no arquivo <file>/etc/apt/sources.list</file> se você
ainda usar o Potato.
<example>
# apt-get update
# apt-get install libc6 perl libdb2 debconf
# apt-get install apt apt-utils dselect dpkg
</example>


<sect id="testing-transition">Preparação para a transição ("stable" para
"testing")
<p>
Seguir o sabor <tt>testing</tt> do &debian; tem o efeito colateral de
obter atualizações de segurança muito lentamente. Então fique alerta.
<p>
Atualização pela rede para "testing" pode ser feita como explicado a
seguir (execute o script 
<url id="&examples;" name="go-woody"> para fazer isso em um comando):
<p>
Esvazie o arquivo <file>sources.list</file> existente
<example>
# cd /etc/apt
# cp -f sources.list sources.old 
# :&gt;sources.list  
</example>
<p>
Obtenha uma lista limpa de repositórios, para "stable"
<example>
# cd /
# apt-setup noprobe 
 ... selecione repositórios, acessados com métodos http ou ftp
</example>
Adicione a seção "testing" a essa nova lista.
As linhas <tt>deb-src</tt> são comentadas.
<example>
# cd /etc/apt
# grep -e "^deb " sources.list  &gt;sources.deb
# grep -e "^deb-" sources.list  &gt;sources.src
# sed -e "s/stable/testing/"  sources.deb \
     &gt;&gt;sources.list
# sed -e "s/stable/testing/" sources.src | \
     sed -e "s/^deb-/#deb-/"  &gt;&gt;sources.list

# apt-get update
# apt-get install apt apt-utils
# cat &gt;preferences &lt;&lt;EOF
 Package: *
 Pin: release a=testing
 Pin-Priority: 600
 
 Package: *
 Pin: release a=unstable
 Pin-Priority: 50

 EOF
</example>
Opcionalmente, adicione a seção "unstable" dos repositórios.
<example>
# sed -e "s/stable/unstable/" sources.deb \
     &gt;&gt;sources.list
# sed -e "s/stable/unstable/" sources.src | \
     sed -e "s/^deb-/#deb-/"  &gt;&gt;sources.list
</example>
Veja <ref id="apt-install"> para conhecer a arte do ajuste do
<file>/etc/apt/sources.list</file> e do
<file>/etc/apt/preferences</file>.
<p>
Agora você pode usar atualizar lista de pacotes e atualizar pacotes,
usando métodos descritos na próxima seção.
</sect>

<sect id="upgrade-system">Atualizar o sistema &debian;
<p>
Depois de configurar os arquivos <file>/etc/apt/sources.list</file> e
<file>/etc/apt/preferences</file> apropriadamente, o sistema pode ser
atualizado para <tt>testing</tt>. Consulte <ref id="package"> para
saber o básico, e veja <ref id="apt-trouble"> se encontrar problemas.

<sect1>Melhor prática de atualização usando o <prgn>dselect</prgn>
<p>
Se um sistema tem muitos pacotes que incluem pacotes <tt>-dev</tt>,
etc., recomenda-se o método a seguir usando o <prgn>dselect</prgn> para
um controle de pacotes mais refinado. 
<example>
# dselect update  # sempre faça isso antes de atualizar
# dselect select  # selecione pacotes adicionais
</example>
Todos os seus pacotes atuais serão selecionados quando o
<prgn>dselect</prgn> iniciar. O <prgn>dselect</prgn> pode oferecer-lhe a
opção de instalar pacotes adicionais, baseado em <tt>depends</tt>,
<tt>suggests</tt>, e <tt>recomends</tt>. Se você não quiser adicionar
nenhum pacote, simplesmente pressione <tt>Q</tt> para sair do
<prgn>dselect</prgn> novamente.
<example>
# dselect install
</example>
Você precisará responder algumas questões de configuração de pacotes
durante essa parte do processo, então mantenha suas notas prontas e
reserve algum tempo a essa parte. Consulte <ref id="dselect">.
<p>
Use o <prgn>dselect</prgn>. <strong>Ele sempre funciona :)</strong>

<![%f-ref;[
<sect1>Prática ruim de atualização com o <prgn>apt-get</prgn>
<p>
<strong>O uso do <prgn>apt-get</prgn> descrito abaixo é muito comum, mas
<em>não</em> é recomendado para atualizações de sistema.</strong>
]]>

Se você precisar atualizar sem o <prgn>dselect</prgn> depois do Woody,
considere usar o <prgn>aptitude</prgn> e outras opções.

<![%f-ref;[
<p>
Se um sistema não tem muitos pacotes ou o repositório do &debian; não teve
grandes alterações, o método a seguir deve ser suficiente (algumas
vezes). 
<example>
# apt-get update # sempre faça isso antes de atualizar
 ... para atualizar o sistema com seleções "depends": 
# apt-get upgrade                 # sempre faça isso antes de atualizar
 ... para atualizar o sistema todo com seleções "depends" : 
# apt-get -u dist-upgrade
 ... ou para atualizar e manter com as seleções atuais do dselect (novo,
 melhor): 
# apt-get -u dselect-upgrade      # usa o resultado do ajuste do dselect
</example>
<p>
Uma vez que esse método de atualização usa o <prgn>apt-get</prgn>, sua
gestão de <em>recommends</em> e <em>suggests</em> é limitada. 
Veja <ref id="depends">.
]]>
</sect>


</chapt>

