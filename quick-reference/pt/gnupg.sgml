<!-- CVS revision of this document "$Revision: 1.3 $"  -->
<!-- CVS revision of original english document "1.16"  -->

<chapt id="gnupg">GnuPG

<p>
Referências:
<list compact>
<item><manref name="gpg" section="1">. 
<item><file>&dochome;gnupg/README.gz</file>
<item><em>GNU privacy handbook</em> em 
 <file>&dochome;gnupg-doc/GNU_Privacy_Handbook/</file> 
 (instale <package>gnupg-doc</package>)
</list>

<sect>Instalando GnuPG
<p>
<example>
# gpg --gen-key                   # gera uma nova chave
# gpg --gen-revoke <var>my_user_ID</var>     # gera uma chave de revogação para <var>my_user_ID</var>
# host -l pgp.net | grep www|less # lista servidores de chaves pgp
</example>
Por ora, bons servidores de chave são:
<example>
keyserver wwwkeys.eu.pgp.net
keyserver wwwkeys.pgp.net
</example>
Deve-se ter cuidado aqui:  <strong>não crie mais do que duas subchaves 
</strong>. Se você fizer isto, os servidores de chaves em pgp.net
<strong>corromperão</strong> a sua chave. Use o novo
<package>gnupg</package> (>1.2.1-2) para lidar com essas subchaves
corrompidas. Consulte <url id="&gpg-subkeys;">.
<p>
E também apenas um servidor de chaves pode ser especificado em
<file>$HOME/.gnupg/options</file>.
<p>
Infelizmente, os servidores abaixo não funcionam mais:
<example>
keyserver search.keyserver.net
keyserver pgp.ai.mit.edu
</example>

</sect>

<sect>Usando GnuPG
<p>
Lidando com arquivos:
<example>
$ gpg  [opções]  <var>comando  [args]</var>
$ gpg {--armor|-a} {--sign|-s} <var>arquivo</var> # assina arquivo em um <var>arquivo</var>.asc texto
$ gpg --clearsign <var>arquivo</var>              # assina textualmente a mensagem
$ gpg --clearsign --not-dash-escaped <var>arq_corr</var>  # assina textualmente o arquivo de correções
$ gpg --verify <var>arquivo</var>                 # verifica o <var>arquivo</var> assinado textualmente
$ gpg -o <var>arquivo.sig</var> {-b|--detach-sig} <var>arquivo</var> # cria uma assinatura destacada
$ gpg --verify <var>arquivo.sig</var> <var>arquivo</var>     # verifica <var>arquivo</var> com <var>arquivo.sig</var>
$ gpg -o <var>arq_cript</var> {--recipient|-r} <var>nome</var> {--encrypt|-e} <var>arquivo</var>
        # criptografia com a chave pública para nome
$ gpg -o <var>arq_cript</var> {--symmetric|-c} <var>arquivo</var> # criptografia simétrica
$ gpg -o <var>arquivo</var> --decrypt arq_cript   # descriptografia
</example>
</sect>

<sect>Gerenciando GnuPG
<p>
Gerenciamento das chaves:
<example>
$ gpg --edit-key <var>ID_usr</var>               # interativo; para ajuda, "help"
$ gpg -o <var>arquivo</var> --exports            # exporta todas as chaves para <var>arquivo</var> 
$ gpg --imports <var>arquivo</var>               # importa todas as chaves a partir de <var>arquivo</var>
$ gpg --send-keys <var>ID_usr</var>              # envia a chave de <var>ID_usr</var> para o servidor de chaves
$ gpg --recv-keys <var>ID_usr</var>              # recebe a chave de <var>ID_usr</var> a partir do servidor de chaves
$ gpg --list-keys <var>ID_usr</var>              # lista as chaves de <var>ID_usr</var>
$ gpg --list-sigs <var>ID_usr</var>              # lista assinatura de <var>ID_usr</var>
$ gpg --check-sigs <var>ID_usr</var>             # confere assinatura de <var>ID_usr</var>
$ gpg --fingerprint <var>ID_usr</var>            # confere impressão digital de <var>ID_usr</var>
$ gpg --list-sigs | grep '^sig' | grep '[User id not found]' \
  | awk '{print $2}' | sort -u | xargs gpg --recv-keys # lista chaves desconhecidas
  # atualiza chaves para todas assinaturas desconhecidas.
</example>
Códigos de confiabilidade:
<example>
-         Nenhum proprietário confiável associado / ainda não calculado.
e         Cálculo de confiabilidade falhou.
q         Informação insuficiente para cálculo.
n         Nunca confie nesta chave.
m         Marginalmente confiável.
f         Totalmente confiável.
u         Ultimamente confiável.
</example>
O que se segue enviará minha chave "<var>A8061F32</var>" para múltiplos
servidores de chaves:
<example>
$ for xx in us es cz de dk uk ch net.uk earth.net.uk; \
$ do gpg --keyserver wwwkeys.$xx.pgp.net  --send-keys <var>A8061F32</var>; done
</example>
</sect>

<sect>Usando GnuPG com aplicações
<p>
<sect1>Usando GnuPG com Mutt
<p>
Adicione o seguinte ao <file>~/.muttrc</file> para evitar que um GnuPG
lento inicie automaticamente, permitindo que seja usado teclando 
`<tt>S</tt>' no índice de menu.
<example>
macro index S ":toggle pgp_verify_sig\n"
set pgp_verify_sig=no
</example>

<sect1 id="vimgpg">Usando GnuPG com o Vim
<p>
Adicione o conteúdo de <file>vimgpg</file> obtido a partir do 
<url id="&examples;"name="subdiretório de exemplos"> ao <file>~/.vimrc</file>
para rodar GnuPG transparentemente.

</chapt>
