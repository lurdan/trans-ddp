<!-- CVS revision of this document "$Revision: 1.2 $"  -->
<!-- CVS revision of original english document "1.37"  -->
<chapt id="woody">Обновление до дистрибутива <tt>testing</tt>

<![%f-ref;[
<p>
Официальный документ по обновлению размещается по адресам 
<url id="&stable-release;">
и 
<url id="&testing-release;"> (в разработке).

<p>
Процесс обновления системы до дистрибутива <tt>testing/unstable</tt> следующий:
<list>
 <item>если Ваша система - Potato, то нужно обновить систему APT до woody-версии, 
       так как версия системы APT в Potato не имеет всех возможностей, описанных
       на man-странице <manref name="apt_preferences" section="5">.
 <item>измените Ваши файлы <file>/etc/apt/sources.list</file> и <file>/etc/apt/preferences</file>
 таким образом, чтобы они содержали ссылки на секцию "testing" репозитария, который Вы используете.
 Если Вы хотите, можно также добавить ссылки и на секцию "unstable".
 <item>обновите Ваши списки пакетов и установите все пакеты, которые можно обновить.
</list> 
]]>

<sect id="woody-transition">Перевод системы APT к ее Woody-версии
<p>
Если Вы все еще работаете в Potato, то возможно следующее обновление по сети
системы APT и некоторых важных пакетов после включения в файл <file>/etc/apt/sources.list</file>
ссылок на дистрибутив <tt>stable</tt>:
<example>
# apt-get update
# apt-get install libc6 perl libdb2 debconf
# apt-get install apt apt-utils dselect dpkg
</example>

<sect id="testing-transition">Подготовка обновления (от <tt>stable</tt> к <tt>testing</tt>)
<p>
Перед использованием &debian;-дистрибутива <tt>testing</tt> нужно знать, 
что заплатки безопасности выходят для него очень медленно. 
<p>
Обновление по сети до <tt>testing</tt> может быть выполнено следующим образом
(или можно запустить скрипт <url id="&examples;" name="go-woody">):
<p>
Очистите существующий файл <file>sources.list</file>:
<example>
# cd /etc/apt
# cp -f sources.list sources.old 
# :&gt;sources.list  
</example>
<p>
Получите чистый список репозитариев для <tt>stable</tt>:
<example>
# cd /
# apt-setup noprobe 
    ... выберите репозитарии, доступные по HTTP или FTP
</example>
Добавьте секцию <tt>testing</tt> к новому списку.
Закоментируйте строки с <tt>deb-src</tt>.
<example>
# cd /etc/apt
# grep -e "^deb " sources.list  &gt;sources.deb
# grep -e "^deb-" sources.list  &gt;sources.src
# sed -e "s/stable/testing/"  sources.deb \
     &gt;&gt;sources.list
# sed -e "s/stable/testing/" sources.src | \
     sed -e "s/^deb-/#deb-/"  &gt;&gt;sources.list

# apt-get update
# apt-get install apt apt-utils
# cat &gt;preferences &lt;&lt;EOF
 Package: *
 Pin: release a=testing
 Pin-Priority: 600
 
 Package: *
 Pin: release a=unstable
 Pin-Priority: 50

 EOF
</example>
Опционально, добавьте секцию "unstable".
<example>
# sed -e "s/stable/unstable/" sources.deb \
     &gt;&gt;sources.list
# sed -e "s/stable/unstable/" sources.src | \
     sed -e "s/^deb-/#deb-/"  &gt;&gt;sources.list
</example>
Искусство настройки файлов <file>/etc/apt/sources.list</file> и 
<file>/etc/apt/preferences</file> можно постичь, изучив раздел <ref id="apt-install">.
<p>
Теперь Вы готовы к обновлению, сделав это одним из методов следующей секции.
</sect>

<sect id="upgrade-system">Обновление системы &debian;
<p>
После соответствующей установки файлов <file>/etc/apt/sources.list</file> 
и <file>/etc/apt/preferences</file> система может быть обновлена 
до <tt>testing</tt>. Обращайтесь за базовыми знаниями к разделу <ref id="package">
и к разделу <ref id="apt-trouble">, если возникли трудности. 

<sect1>Самый лучший способ обновления, использующий программу <prgn>dselect</prgn>
<p>
Если в системе множество пакетов вида <tt>-dev</tt> и пр., рекомендуется следующий способ
обновления для точного управления пакетами, использующий <prgn>dselect</prgn>:
<example>
# dselect update  # всегда выполняется перед обновлением
# dselect select  # выберите дополнительные пакеты
</example>
При запуске <prgn>dselect</prgn> выбираются все Ваши текущие пакеты.
Программа <prgn>dselect</prgn> может предложить Вам установить
дополнительные пакеты, основываясь на зависимостях <tt>depends</tt>,
<tt>suggests</tt> и <tt>recommends</tt> пакетов. Если Вы не желаете
добавлять никакие пакеты, просто нажмите <tt>Q</tt> для выхода
<prgn>dselect</prgn>. 
<example>
# dselect install
</example>
На этой стадии процесса Вам нужно будет ответить на некоторые вопросы,
касаемые конфигурации пакетов, поэтому подготовьте Ваши записи и 
затратьте на это некоторое количество времени. Смотрите <ref id="dselect">.

<p>
Используйте программу <prgn>dselect</prgn>. <strong>Она всегда работает :)</strong>

<![%f-ref;[
<sect1>Устаревший способ обновления через <prgn>apt-get</prgn>
<p>
<strong>Использование <prgn>apt-get</prgn>, описанное ниже, широко распространено,
но <em>не</em> рекомендуется для обновления системы.</strong>
]]>
Если Вам нужно обновиться без использования <prgn>dselect</prgn>
в системах новее Woody, рассмотрите программу <prgn>aptitude</prgn> 
и прочие.
<![%f-ref;[
<p>
Если система не имеет много пакетов или архив &debian;
не сильно изменился, следующего может быть достаточно (иногда):
<example>
# apt-get update # всегда делается перед обновлением
 ... для обновления системы на основе зависимостей "depends": 
# apt-get upgrade                     # затем всегда делаем это 
 ... для обновления в целом системы на основе информации о "depends"-зависимостях: 
# apt-get -u dist-upgrade
 ... или обновиться и придерживаться текущего выбора в dselect (новый и лучший способ):
# apt-get -u dselect-upgrade         # используем результат выбора в dselect 
</example>
<p>
Так как этот способ обновления использует программу <prgn>apt-get</prgn>,
то обработка зависимостей <em>recommends</em> и <em>suggests</em> ограничена. 
Смотрите <ref id="depends">.
]]>
</sect>



</chapt>

