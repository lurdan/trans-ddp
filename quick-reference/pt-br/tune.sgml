<!-- CVS revision of this document "$Revision: 1.4 $"  -->
<!-- CVS revision of original english document "1.156"  -->

<chapt id="tune"> Ajustando um sistema &debian;
<p>
Este capítulo descreve apenas o básico da configuração do sistema através da
interface baseada em linha de comando. Antes de ler este capítulo, você deve
ler <ref id="install">.
<p>
Se você está preocupado com a segurança então deve ler o <url
id="&securing-debian-howto;"  name="Securing Debian Manual">, que vem no
pacote <package>&p-securing-debian-howto;</package>. 

<sect id="init-hints">Inicialização do sistema
<p>
O &debian; usa o sistema de script de init System V.
Veja <ref id="init"> para uma introdução.

<sect1 id="init-defaults">Personalizando os scripts init
<p>
A maneira mais fácil de controlar o comportamento de um script init é
alterando atribuições de variáveis de ambiente no arquivo nomeado como no
script init no diretório <file>/etc/default</file>.
<footnote>
Os arquivos em <file>/etc/default/</file> contêm <strong>apenas</strong>
atribuições de variáveis de ambiente.
Cada arquivo é usado como fonte pelo script init a ele correspondente de
forma que essas atribuições cancelam quaisquer definições de variáveis no
próprio script init.
A escolha do nome do diretório é <url id="&etc-defaults;" name="peculiar">
ao &debian;. É, grosseiramente, o equivalente do diretório
<file>/etc/sysconfig</file> encontrado no RedHat e outras distribuições.
</footnote>
Por exemplo, <file>/etc/default/hotplug</file> pode ser usado controlar como
<file>/etc/init.d/hotplug</file> funciona.
O arquivo <file>/etc/default/rcS</file> pode ser usado para personalizar
padrões de tempo de inicialização para <prgn>motd</prgn>,
<prgn>sulogin</prgn>, etc.
<p>
Se você não puder obter o comportamento desejado mudando essas variáveis,
então você pode modificar os próprios scripts init: eles são todos arquivos
de configuração.

<sect1 id="syslogd">Personalizando o log do sistema
<p>
O log do sistema pode ser configurado usando <file>/etc/syslog.conf</file>.
Verifique o pacote <package>colorize</package> se quiser um programa para
colorir os arquivos de log do sistema.
Veja também <manref name="syslogd" section="8"> e 
<manref name="syslog.conf" section="5">.
</sect1>

<sect1 id="hdtune">Otimizando o hardware
<p>
Há umas poucas configurações de otimização do hardware que o &debian; deixa
aos cuidados do administrador do sistema.
<list>
<item><package>hdparm</package>
 <list compact>
<item>Otimização de acesso ao disco rígido. Muito eficiente.
<item>Perigoso. Você precisa ler <manref name="hdparm" section="8"> primeiro.
<item><tt>hdparm -tT <var>/dev/hda</var></tt> para testar a velocidade de
  acesso ao disco.
<item><tt>hdparm -q -c3 -d1 -u1 -m16 <var>/dev/hda</var></tt> para aumentar
  a velocidade de um moderno sistema IDE. (Isso pode ser perigoso.)
 </list>

<item><package>setcd</package>
 <list compact>
<item>Otimização de acesso a unidade de compact disc.
<item><tt>setcd -x <var>2</var></tt> para diminuir para velocidade
  <var>2</var> x.
<item>Consulte <manref name="setcd" section="1">.
</list>

<item><package>setserial</package>
 <list compact>
<item>Conjunto de ferramentas para gerenciamento de portas seriais.
 </list>

<item><package>scsitools</package>
 <list compact>
<item>Conjunto de ferramentas para gerenciamento de hardware SCSI.
 </list>

<item><package>memtest86</package>
 <list compact>
<item>Conjunto de ferramentas para gerenciamento de hardware de memória.
 </list>

<item><package>hwtools</package>
 <list compact>
<item>Conjunto de ferramentas para gerenciamento de hardware em baixo nível.
  <list compact>
   <item><prgn>irqtune</prgn>: muda a prioridade IRQ de dispositivos para
   permitir que dispositivos que precisem de alta prioridade e serviço
   rápido (por exemplo, portas seriais, modems) tenham a prioridade
   necessária. É possível aumentar a velocidade através de serial/modem em
   3x.

   <item><prgn>scanport</prgn>: varre o espaço de I/O a partir de 0x100 até
   0x3ff procurando por dispositivos ISA instalados. 
   <item><prgn>inb</prgn>: um pequeno e rápido hack que lê uma porta de I/O
   e devolve o valor em hexadecimal e binário.
  </list>

 </list>

<item><package>schedutils</package>
 <list compact>
<item>Utilidades de escalonamento do Linux.
<item>Estão incluídos <prgn>taskset</prgn>, <prgn>irqset</prgn>,
  <prgn>lsrt</prgn>, e <prgn>rt</prgn>.
<item>Junto com <prgn>nice</prgn> e <prgn>renice</prgn> 
 (não incluídos), eles permitem total controle dos parâmetros de
 escalonamento de processos. 
 </list>
</list>
<p>
Montar um sistema de arquivos com opção <tt>noatime</tt> também é muito
eficaz para aumentar a velocidade de acesso ao arquivo. Consulte <manref
name="fstab" section="5"> e <manref name="mount" section="8">.
<p>
Alguns hardwares podem ser ajustados diretamente pelo kernel Linux
através do sistema de arquivos proc. Veja <ref id="proc-sys">.
<p>
Há muitos utilitários de configuração de hardware específicos. Muitos
deles se destinam a necessidades específicas do PC laptop. Eis alguns
pacotes interessantes disponíveis no Debian:
<list compact>
<item><package>tpconfig</package> - Um programa para configurar
 dispositivos touchpad
<item><package>apmd</package> - Utilitários para Gerenciamento Avançado
 de Energia (APM)
<item><package>acpi</package> - Exibe informações sobre dispositivos
 ACPI
<item><package>acpid</package> - Utilitários para usar ACPI
<item><package>lphdisk</package> - prepara partição de hibernação para
 Phoenix NoteBIOS
<item><package>sleepd</package> - põe um laptop para dormir durante
 inatividade
<item><package>noflushd</package> - permite que discos rígidos ociosos
 diminuam o giro
<item><package>big-cursor</package> - cursores de mouse maiores para o X
<item><package>acme</package> - Habilita os "botões multimídia"
 encontrados em laptops
<item><package>tpctl</package> - ferramentas de configuração de hardware
 do IBM ThinkPad
<item><package>mwavem</package> - suporte a modem Mwave/ACP
<item><package>toshset</package> - acessa muito da interface de hardware
do laptop Toshiba
<item><package>toshutils</package> - utilitários de laptop Toshiba
<item><package>sjog</package> - um programa para usar o "Jog Dial" (roda
 de avanço) em laptops Sony Vaio
<item><package>spicctrl</package> - programa controlador do Sony Vaio
para ajustar o brilho da luz de fundo do LCD
</list>
Aqui, o ACPI é uma estrutura para o sistema de gerenciamento de energia
mais nova que o APM.
<p>
Alguns desses pacotes necessitam de módulos especiais do kernel. Eles já
são inclusos na última fonte do kernel em muitos casos. Se tiver
problemas, você pode precisar aplicar o último patch para o kernel você
mesmo.

<sect>Restringindo o acesso

<sect1 id="loginctrl">Restringindo logins com PAM
<p>
PAM (Pluggable Authentication Modules) permite a você controlar como os
usuários efetuam login.  
<example>
/etc/pam.d/*             # arquivos de controle de PAM
/etc/pam.d/login         # arquivo de controle de PAM para login
/etc/security/*          # parâmetros de módulo PAM
/etc/securetty           # controla login de root pelo console (login)
/etc/login.defs          # controla as definições para login (login)
</example>
<p>
Modifique o conteúdo de <file>/etc/pam.d/login</file> como a seguir, se você
quiser terminais de console inseguros mas sem senha sob seu próprio risco.
<example>
#auth       required   pam_unix.so nullok
auth       required   pam_permit.so
</example>
Pode-se aplicar truques similares para o <prgn>xdm</prgn>, <prgn>gdm</prgn>,
... , para console X sem senha.
<p>
Por outro lado, instale <package>cracklib2</package> e modifique  
<file>/etc/pam.d/passwd</file> como a seguir, se você desejar garantir uma
boa segurança de senhas.
<example>
password required       pam_cracklib.so retry=3 minlen=6 difok=3
</example>
Uma senha de login para uma única vez, para ativação de conta, também pode
ajudar. Para isso, use o comando passwd com a opção <tt>-e</tt> <manref
name="passwd" section="1">.  
<p>
O número máximo de processos pode ser configurado com <tt>ulimit -u
1000</tt> em um shell Bash ou com definições em
<file>/etc/security/limits.conf</file> de PAM.   Outros parâmetros como 
<tt>core</tt> podem ser configurados de maneira similar. O valor inicial de
<prgn>PATH</prgn> pode ser ajustado em <file>/etc/login.defs</file> antes do
script de início do shell.
<p>
A documentação para PAM está no pacote <package>libpam-doc</package>. O <em>Guia
dos Administradores de Sistema para Linux-PAM</em> cobre a configuração de PAM,
quais módulos estão disponíveis, etc. A documentação também inclui <em>O Guia
dos Desenvolvedores de Aplicação para Linux-PAM</em> e <em>O Guia dos Escritores de
Módulos Linux-PAM</em>.
</sect1>

<sect1 id="wheel">"Por que o GNU <prgn>su</prgn> não suporta o grupo
<tt>wheel</tt>" 
<p>
Essa é a famosa frase do final da velha página <tt>info su</tt> de 
Richard M.  Stallman. Não se preocupe: o <prgn>su</prgn> atual no &debian;
usa PAM, então pode-se restringir a habilidade de usar o <prgn>su</prgn> para
qualquer grupo usando <prgn>pam_wheel.so</prgn> em
<file>/etc/pam.d/su</file>. O seguinte configurará o grupo <tt>adm</tt> em
um sistema &debian; como um equivalente do grupo <tt>wheel</tt> do BSD e
permitirá <prgn>su</prgn> sem uma senha para seus membros.
<example>
# configuração anti-RMS em /etc/pam.d/su
auth       required   pam_wheel.so group=adm

# Membros Wheel capazes de usar su sem uma senha
auth       sufficient pam_wheel.so trust group=adm
</example>

<sect1>Propósitos de grupos padrões
<p>
Alguns grupos interessantes:
<list compact>
<item>O grupo <tt>root</tt> é o grupo wheel padrão para o <prgn>su</prgn> 
 se <prgn>pam_wheel.so</prgn> for usado sem o argumento <tt>group=</tt>. 
<item>O grupo <tt>adm</tt> pode ler arquivos de log. 
<item>O grupo <tt>cdrom</tt> pode ser usado localmente para dar acesso
 a uma unidade de CD-ROM a um conjunto de usuários.
<item>O grupo <tt>floppy</tt> pode ser usado localmente para dar
 acesso a uma unidade de disquetes a um conjunto de usuários.
<item>O grupo <tt>audio</tt> pode ser usado localmente para dar acesso
 a um dispositivo de audio a um conjunto de usuários.
<item>O grupo <tt>src</tt> é dono do código fonte, incluindo arquivos
 em <file>/usr/src</file>. Ele pode ser usado localmente para dar
 a um usuário a capacidade de gerenciar o código fonte do sistema.
<item>A participação no grupo <tt>staff</tt> é útil para
 administradores de sistema do tipo helpdesk ou junior, dando-lhes a
 capacidade de fazer coisas em <file>/usr/local</file> e criar
 diretórios em <file>/home</file>.
</list>
<p>
Para uma lista completa, veja a seção "FAQ" no <url
id="&securing-debian-howto;" name="Securing Debian Manual">, que
também pode ser encontrado como o pacote
<package>&p-securing-debian-howto;</package> no Woody. Além disso, o
novo <package>&p-base-passwd;</package> (>3.4.6) contém uma lista
oficial: <file>&f-users-and-groups;</file>.

<sect1 id="sudo">Trabalhando de forma mais segura &ndash; <prgn>sudo</prgn>
<p>
Meu uso do <prgn>sudo</prgn> é na maior parte uma proteção contra minha
própria estupidez. Pessoalmente, eu acho que usar o <prgn>sudo</prgn> é uma
alternativa melhor que sempre usar o sistema como root.
<p>
Instale o <prgn>sudo</prgn> e ative-o configurando as opções em 
<file><url id="&examples;" name="/etc/sudoers"></file>.  Verifique também o
recurso do grupo <tt>sudo</tt> em
<file>&dochome;sudo/OPTIONS</file>. 
<p>
A configuração de exemplo disponibiliza aos membros do grupo "staff" o
acesso a qualquer comando executado como root sob o <prgn>sudo</prgn> e
também dá aos membros de "src" o acesso a executar comandos
selecionados como root sob o <prgn>sudo</prgn>.
<p>
A vantagem do <prgn>sudo</prgn> é que ele requer apenas a senha de um
usuário ordinário para efetuar o login, e a atividade é monitorada.  Essa é
uma bela maneira de dar alguma autoridade a um administrador junior.
Por exemplo:
<example>
$ sudo chown -R <var>myself</var>:<var>mygrp</var> .
</example>
<p>
É claro que se você sabe a senha de root (como muitos usuários
domésticos sabem), qualquer comando pode ser executado como root a
partir de uma conta de usuário:
<example>
$ su -c "shutdown -h now"
Password:
</example>
(Eu sei que deveria diminuir os privilégios <prgn>sudo</prgn> das
contas admin. Mas como esse é meu servidor caseiro, ainda não me
preocupei como isso.)
<p>
Se quiser um programa diferente que permita que usuários ordinários
executem comandos com privilégios de root, veja o pacote 
<package>super</package>. 
</sect1>
    
<sect1 id="tcpd">Restringindo acesso a serviços
<p>
O <em>super-servidor</em> de Internet, <prgn>inetd</prgn>, é iniciado
na inicialização por <file>/etc/rc2.d/S20inetd</file> (para
RUNLEVEL=2), que é um link simbólico para <file>/etc/init.d/inetd</file>. 
Essencialmente, o <prgn>inetd</prgn> permite a execução de um daemon
para a chamada de vários outros, reduzindo a carga no sistema.
<p>
Sempre que um pedido de um serviço chega, seu protocolo e serviço são
identificados procurando-os nas bases de dados em
<file>/etc/protocols</file> e  <file>/etc/services</file>.  O
<prgn>inetd</prgn> então procura um serviço de Internet normal na base
de dados de <file>/etc/inetd.conf</file> , ou um serviço baseado em
Sun-RPC em <file>/etc/rpc.conf</file>.
<p>
Para segurança do sistema, não esqueça de desabilitar serviços sem
uso em  <file>/etc/inetd.conf</file>.
Os serviços Sun-RPC precisam ser ativados para NFS e outros programas
baseados em  RPC.
<p>
Algumas vezes, o <prgn>inetd</prgn> não inicia um servidor desejado
diretamente, mas inicia o programa daemon wrapper de TCP/IP
<prgn>tcpd</prgn> com o nome do servidor desejado como seu argumento
em <file>/etc/inetd.conf</file>.   
Nesse caso, o <prgn>tcpd</prgn> executa o programa servidor apropriado
depois de registrar o pedido e fazer algumas verificações adicionais
usando <file>/etc/hosts.deny</file> e <file>/etc/hosts.allow</file>.
<p>
Se você tiver problemas com acesso remoto em um sistema &debian; recente, 
comente "ALL: PARANOID" em <file>/etc/hosts.deny</file> se ele existir.
<p>
Para mais detalhes, veja <manref name="inetd" section="8">,  
<manref name="inetd.conf" section="5">, 
<manref name="protocols" section="5">,  
<manref name="services" section="5">,  
<manref name="tcpd" section="8">,  
<manref name="hosts_access" section="5">, e
<manref name="hosts_options" section="5">. 
<p>
Para mais informação sobre Sun-RPC, veja
<manref name="rpcinfo" section="8"> , 
<manref name="portmap" section="8">, e
<file>&f-portmap;</file>.

<sect1 id="ldap">Centralizando a autenticação &ndash; LDAP
<p>
Use Lightweight Directory Access Protocol (LDAP)(Protocolo de
Acesso a Diretório Leve)
Referências:
<list compact>
<item><url id="&openldaphome;" name="OpenLDAP">
<item>Guia do Administrador OpenLDAP no pacote <package>openldap-guide</package> 
<item>LDP: <url id="&ldap-linux-howto;" name="LDAP Linux HOWTO">
<item>LDP: <url id="&ldap-implementation-howto;" name="LDAP Implementation HOWTO">
<item><url id="&ldap-use1;" name="OpenLDAP, relatos de uso extensivo">
<item><url id="&ldap-use2;" name="Open LDAP com Courier IMAP e Postfix">
</list>
</sect>


<sect id="cdrw">Gravadores de CD
<p>
Os gravadores de CD com interfaces ATAPI/IDE recentemente se tornaram
uma opção muito popular.  É uma boa mídia para backup do sistema e
arquivamentos para o usuário doméstico que precise de capacidade &lt;
640 MB.  Para informação de maior autoridade, veja o 
<url id="&cd-writing-howto;" name="CD-Writing-HOWTO"> do LDP.

<sect1>Introdução
<p>
Primeiro, qualquer interrupção dos dados enviados para o gravador de
CDs causará danos irrecuperáveis ao CD. Obtenha um gravador de CD com
o maior buffer possível. Se dinheiro não for problema, não se aborreça
com um ATAPI/IDE, simplesmente pegue uma versão SCSI. Se você tiver
escolha sobre em qual interface IDE conectar, use a que estiver no
barramento PCI (isto é, na placa mãe) ao invés de uma no barramento
ISA (uma placa SB16, etc.).
<p>
Quando um gravador de CDs está conectado à IDE, precisa usar o driver 
IDE-SCSI ao invés de um driver de CD IDE ordinário para kernels Linux
2.2 e 2.4. Além disso, o
driver SCSI genérico precisa ser ativado. Há duas possíveis maneiras de se
fazer isso, considerando um kernel distribuído com distribuições atuais
(como de março de 2001).
</sect1>

<sect1>Alternativa 1: módulos + <prgn>lilo</prgn>
<p>
Se você estiver usando um kernel do Debian, adicione a seguinte linha ao
<file>/etc/lilo.conf</file> . Se forem usadas várias opções, liste-as
separadas por espaços: 
<example>
append="hd<var>x</var>=ide-scsi ignore=hd<var>x</var>"
</example>
Aqui a localização do gravador de CDs, que é acessado através do driver
ide-scsi, é indicada por <tt>hd<var>x</var></tt>, onde <var>x</var> representa um dos
seguintes: 
<example>
hda          para o mestre na primeira porta IDE
hdb          para o escravo na primeira porta IDE
hdc          para o mestre na segunda porta IDE
hdd          para o escravo na segunda porta IDE
hde ... hdh  para uma unidade em uma porta IDE externa ou porta IDE ATA66/100
</example>
Digite os seguintes comandos como root para ativar depois de acabar toda a
configuração: 
<example>
# lilo
# shutdown -h now
</example>
</sect1>


<sect1>Alternativa 2: recompilar o kernel
<p>
O Debian usa o <prgn>make-kpkg</prgn> para criar um kernel.  Use o novo
<tt>--append_to_version</tt> com o <prgn>make-kpkg</prgn> para criar várias imagens de
kernel.
Veja <ref id="kernel">.
<p>
Use a seguinte configuração através do  <tt>make menuconfig</tt>:
<list>
<item>bzImage
<item>Exclua o driver para CD IDE (não é necessário, mas isso simplifica)
<item>Compile ide-scsi e sg diretamente no kernel, ou como módulos
</list>
</sect1>

<sect1>Passos posteriores à configuração
<p>
O suporte do kernel para o gravador de CDs pode ser ativado durante a
inicialização com o seguinte:
<example>
# echo ide-scsi &gt;&gt;/etc/modules
# echo sg       &gt;&gt;/etc/modules
# cd /dev; ln -sf scd0 cdrom
</example>
A ativação manual pode ser feita com:
<example>
# modprobe ide-scsi
# modprobe sg
</example>
Depois de reinicializar, você pode verificar a instalação com:
<example>
$ dmesg|less
# apt-get install cdrecord
# cdrecord -scanbus
</example>
<p>
[Por Warren Dodge] Algumas vezes podem ocorrer conflitos entre
<tt>ide-scsi</tt> e <tt>ide-cd</tt> se houver CD-ROM e CD-R/RW no sistema.
Tente adicionar a seguinte linha ao seu <file>/etc/modutils/aliases</file>,
executando <prgn>update-modules</prgn>, e reinicialize.
<example>
pre-install      ide-scsi      modprobe ide-cd
</example>
Isso faz com que o driver IDE seja carregado antes do <tt>ide-scsi</tt>. O
driver IDE <tt>ide-cd</tt> toma o controle do ATAPI CD-ROM &mdash;
qualquer coisa que não lhe tenha sido dito para
<strong>ignorar</strong>. Isso deixa apenas os dispositivos ignorados para
o <tt>ide-scsi</tt> controlar.  
</sect1>

<sect1>Arquivo imagem de CD (inicializável)
<p>
Para criar um CD-ROM de arquivos sob um <file>diretório-alvo/</file> como
<file>cd-image.raw</file>
(inicializável, formato Joliet TRANS.TBL habilitado; se não inicializável,
retire as opções <tt>-b</tt> e <tt>-c</tt>), insira um disco de
inicialização na unidade de disquetes  e
<example>
# dd if=<var>/dev/fd0</var> <var>diretório-alvo/boot.img</var> 
# mkisofs -r -V <var>volume_id</var> -b <var>boot.img</var> -c <var>bootcatalog</var> -J -T \
        -o <var>cd-image.raw</var> <var>diretório-alvo/</var>
</example>
<p>
Um hack divertido é fazer um CD-ROM de DOS inicializável. Se um disquete de
inicialização ordinário de DOS estiver no <file><var>boot.img</var></file>
acima,  o CD-ROM inicializará como se um disquete de DOS estivesse na
primeira unidade de disquetes (A:).  Fazer isso com freeDOS pode ser mais
interessante. 
<p>
Esse arquivo de imagem de CD pode ser inspecionado montando-o no dispositivo
loop. 
<example>
# mount -t iso9660 -o ro,loop <var>cd-image.raw</var> /cdrom
# cd /cdrom
# mc
# umount /cdrom
</example>
</sect1>

<sect1>Gravar CDs (R, RW):
<p>
Primeiro teste com (considerando velocidade dupla)
<example>
# nice --10 cdrecord -dummy speed=2 dev=0,0 <var>disk.img</var>
</example>
Então se for tudo bem, grave no CD-R com
<example>
# nice --10 cdrecord -v -eject speed=2 dev=0,0 <var>disk.img</var>
</example>
Ou grave em um disco CD-RW com
<example>
# nice --10 cdrecord -v -eject blank=fast speed=2 dev=0,0 <var>disk.img</var>
</example>
Algumas unidades de CD-RW funcionam melhor com
<example>
# nice --10 cdrecord -v blank=all speed=2 dev=0,0 <var>disk.img</var>
</example>
seguido de
<example>
# nice --10 cdrecord -v -eject speed=2 dev=0,0 <var>disk.img</var>
</example>
São necessários esses dois passos para prevenir que timeouts de SCSI durante o
apagamento interfiram no passo da gravação. O valor do argumento para o  
<prgn>nice</prgn> pode necessitar de alguns ajustes.
</sect1>

<sect1>Fazer um arquivo imagem de um CD
<p>
Alguns CD-Rs e CDs comerciais têm setores ruins no fim que tornam
impossível sua cópia através do <prgn>dd</prgn> (o CD do Windows 98 é um
deles).  O pacote <package>cdrecord</package> vem com o comando
<prgn>readcd</prgn>.  Use-o para copiar o conteúdo de qualquer CD para um
arquivo imagem. Se for um disco de dados, monte-o e execute <prgn>df</prgn>
para ver seu tamanho real.  Divida o número mostrado em blocos (1 bloco =
1024 bytes) por 2 para obter o número de setores do CD real (1 setor = 2048
bytes).  Execute o <prgn>readcd</prgn> com opções e use essa imagem de disco
para gravar o  CD-R/RW.
<example>
# readcd dev=<var>target</var>,<var>lun</var>,<var>scsibusno</var> # selecione função 11
</example> 
Aqui, ajuste os 3 parâmetros para 0 para muitos
casos. Geralmente o número de setores dados pelo <prgn>readcd</prgn> é
excessivo! Use o número acima a partir de um mount real para melhores
resultados.
<p>
Deve-se notar que o uso do <prgn>dd</prgn> tem alguns problemas se usado no
CD-ROM. A primeira execução do comando <prgn>dd</prgn> pode causar uma
mensagem de erro e pode resultar em uma imagem de disco mais curta com a
perda do final. A segunda execução do comando <prgn>dd</prgn> pode resultar
em uma imagem de disco maior com lixo anexo ao final em alguns sistemas se o
tamanho do dado não for especificado. Somente a segunda execução do
comando <prgn>dd</prgn> com o tamanho de dado correto especificado sem
ejetar o CD depois de mensagem de erro parece evitar esses problemas. Se o
tamanho da imagem mostrado pelo <prgn>df</prgn> for <tt>46301184</tt>
blocos, use o seguinte comando duas vezes para obter a imagem correta (esta
é minha informação empírica):
<example>
# dd if=/dev/cdrom of=cd.img bs=2048 count=$((46301184/2))
</example>
</sect1>

<sect1>Imagens de CD do Debian
<p>
Para obter as últimas informações sobre os CDs do &debian; CDs, visite a
<url id="&debian-cd;" name="página do Debian CD">. 
<p>
Se você tiver uma conexão rápida com a Internet, considere instalar pela
rede usando:
<list compact>
<item>algumas  <url id="&debian-floppyinst;" name="imagens de disquete">.
<item>uma <url id="&debian-netinst;" name="imagem de CD inicializável mínimo">.
</list>
<p>
Se você não tiver uma conexão rápida com a Internet, pense em comprar os CDs
de <url id="&debian-venders;" name="vendedores de CD">.
<p>
Por favor, não jogue fora largura de banda baixando imagens de CD padrão a
menos que seja um testador de imagem de CD (mesmo com o novo método jigdo).
<p>
Uma imagem de CD notável  é o <url id="&knoppix;" 
name="KNOPPIX - Live Linux Filesystem On CD">. 
Esse CD inicializa em um sistema &debian; funcional sem instalar-se no
disco rígido.

<!-- old document section
$ export CVSROOT=anonymous@cvs.debian.org:/cvs/debian-boot
$ cvs co debian-cd
</example>
Following is a summary of CD image creation. 
<example>
# apt-get install debian-cd
# cd /etc/debian-cd
# vim CONF.sh
$ . CONF.sh
$ make distclean
$ make status
$ make list COMPLETE=1 SIZELIMIT1=555000000 SRCSIZELIMIT=665000000
$ make official_images
 or if you want only binary images :
$ make bin-official_images
-->
</sect1>

<sect1>Fazer cópia de segurança do sistema em CD-R
<p>
Para arquivos de configuração chaves e arquivos de dados para o CD-R, use o
script de backup de exemplo <file><url id="examples/" name="backup"></file>. 
Veja também <ref id="archiving"> e <ref id="diff-backup">.
</sect1>

<sect1>Copiar um CD de músicas para CD-R
<p>
Não testado por mim:
<example>
# apt-get install cdrecord cdparanoia
# cdparanoia -s -B
# cdrecord dev=0,0,0 speed=2 -v -dao -eject defpregap=1 -audio *.wav
</example>
ou,
<example>
# apt-get install cdrdao #disk at once
# cdrdao read-cd --device /dev/cdrom --paranoia-mode 3 my_cd # lê o cd
# cdrdao write --device /dev/cdrom --speed 8 my_cd    # grava um CD novo
</example>
O <prgn>cdrdao</prgn> faz uma cópia real (sem intervalos, etc...).
</sect1>
</sect>

<sect id="x">X
<p>
O Sistema X Window é provido pelo <url id="&xfree86home;" name="XFree86">.
Há duas versões principais do servidor X disponíveis no sistema &debian;: 
XFree86 Versão 3.3 (XF3) e XFree86 Versão séries 4.x (XF4), ambas baseadas
em especificações X11R6 pelo <url id="&xorghome;" name="X.Org">.
<p>
Para informações básicas do X, refira-se a <manref name="X" section="7">, ao <url
id="&xwindowuser-howto;" name="XWindow-User-HOWTO"> do LDP, e ao <url
id="&remote-xapps-howto;" name="Mini-HOWTO de Aplicações remotas no X">.
Para um guia de usuário específico do &debian;, leia o arquivo
<file>&f-x-deb-faq;</file> fornecido no pacote
<package>xfree86-common</package>. Esse contém uma revisão interessante
e de autoridade sobre os problemas de mapeamento de teclado, feita por
Branden Robinson.
<p>
<taglist>
<tag><ref id="xsrvr">
<item>um programa em um sistema local que mostra uma janela X e/ou desktop
em um monitor do usuário (CRT, LCD) e aceita entradas de teclado e mouse.
<tag><ref id="xclnt">
<item>um programa em um sistema (local ou remoto) que executa uma aplicação
compatível com X.
</taglist>
Isso reverte o uso ordinário de "servidor" e "cliente" em outros
contextos.
<p>
Há várias maneiras de se fazer o "servidor X" (lado do display) aceitar
conexões remotas de um "cliente X" (lado da aplicação):

<list>
<item>Método <prgn>xhost</prgn>
<list compact>
<item>o mecanismo de listagem de host (muito inseguro).
<item>protocolo não encriptado (sujeito ao "eavesdropping attack").
<item>Não use isso, se possível.
<item>Veja <ref id="xhost"> e <manref name="xhost" section="1x">.
</list>
<item>Método <prgn>xauth</prgn>
<list compact>
<item>o mecanismo de cookie mágico do MIT (inseguro, mas melhor que o
  <prgn>xhost</prgn>).
<item>protocolo não encriptado (sujeito ao "eavesdropping attack").
<item>use isso apenas para conexão local já que ele usa a CPU de forma
  menos intensa que <prgn>ssh -X</prgn>.
<item>Veja <ref id="ss-xsu"> e <manref name="xauth" section="1x">.
</list>
<item>Métodos <prgn>xdm</prgn>, <prgn>wdm</prgn>, <prgn>gdm</prgn>, 
 <prgn>kdm</prgn>, ... 
<list compact>
<item>o mecanismo de cookie mágico do MIT (inseguro como o <prgn>xauth</prgn>).
<item>Veja <manref name="xdm" section="1x"> e 
 <manref name="Xsecurity" section="7"> para informações básicas sobre
o controle de acesso ao display do X.
<item>Veja <manref name="wdm" section="1x">, <manref name="gdm" section="8">, 
 e <manref name="kdm.options" section="5"> para mais informações, 
 se esses estiverem instalados.
<item>Veja <ref id="sys-v"> para saber como desabilitar o <prgn>xdm</prgn>  
para ter um console Linux depois da inicialização sem ter que excluir
o pacote <prgn>xdm</prgn>.
</list>
<item>Método <strong><prgn>ssh -X</prgn></strong>
<list compact>
<item>mecanismo de redirecionamento através de shell seguro (<strong>seguro</strong>).
<item>protocolo encriptado (um desperdício de recursos se usado localmente).
<item>use isso para conexões remotas.
<item>Veja <ref id="xssh">.
</list>
</list>
Todos os métodos de conexão remota, exceto o <prgn>ssh</prgn>,
requerem conexão TCP/IP habilitada no servidor X. Veja <ref id="xtcp">.

<sect1 id="x-system">Pacotes do X
<p>
Existem alguns (meta)pacotes disponibilizados para facilitar a
instalação do sistema X no Woody.
<taglist>
<tag><package>x-window-system-core</package>
<item>
Este metapacote provê os componentes essenciais para uma estação de
trabalho executando o Sistema X Window. Ele provê as bibliotecas X, um
servidor X  (<package>xserver-xfree86</package>), um conjunto de fontes,
e um grupo de clientes X básicos e utilidades.

<tag><package>x-window-system</package> 
<item>
Este metapacote provê praticamente todos os componentes do Sistema X
Window  desenvolvidos pelo Projeto XFree86, assim como um conjunto
de programas acessórios historicamente populares. (Notavelmete, ele
depende dos pacotes <package>x-window-system-core</package>,
<package>twm</package>, e <package>xdm</package>, isto é, não é
preciso instalar o <package>x-window-system-core</package> se você
instalar esse.)

<tag><package>xserver-common-v3</package> 
<item>
Arquivos e utilidades comuns aos servidores X XFree86 3.x (XF3)

<tag><package>xserver-*</package> 
<item>
Pacotes de servidores XF3 adicionais para suportar hardware não suportado
pelo novo servidor XF4 (<package>xserver-xfree86</package>) por qualquer
razão que seja. Algumas antigas placas ATI mach64 não são suportadas no XF4,
outras placas travam na versão XF4 do Woody, etc. (Para saber os pacotes
disponíveis, use <tt>apt-cache search xserver-|less</tt>. Todos os
servidores XF3 dependem do pacote <package>xserver-common-v3</package>.)
</taglist>
<p>
Em muitos casos, o pacote a instalar é o <package>x-window-system</package>.
(Se você quiser login pelo console, desabilite o <package>xdm</package>
como descrito em <ref id="no-x-start">.)

<sect1 id="hdetect-x">Detecção de hardware para o X
<p>
Para habilitar detecção de hardware durante o estágio de configuração
do X, instale os seguintes pacotes antes de instalar o sistema X:
<list>
<item><package>discover</package> &mdash; sistema de identificação de hardware.
<item><package>mdetect</package> &mdash; ferramenta de autodetecção do
  mouse.
<item><package>read-edid</package> &mdash; ferramenta para obtenção de
informação para monitores VESA PnP.
</list>

<sect1 id="xsrvr">O servidor X
<p>
Veja <manref name="XFree86" section="1x"> para obter informações sobre o
servidor X.
<p>
Para chamar o servidor X a partir de um console local:
<example>
$ startx -- :&lt;display&gt; <var>vtXX</var>
por exemplo:
$ startx -- :1 vt8 -bpp 16
... inicia no vt8 conectado a localhost:1 com modo 16 bpp
</example>
Os argumentos dados depois de <tt>--</tt> são para o servidor X.
<p>
Note que, ao usar um script <file>~/.xserverrc</file> para
personalizar a inicialização do servidor X, certifique-se de fazer
<tt>exec</tt> para o servidor X real. Se não fizer isso, o servidor X
pode demorar a iniciar e sair. Por exemplo:
<example>
#!/bin/sh
exec /usr/bin/X11/X -dpi 100 -nolisten tcp
</example>

<sect2 id="config-x4">Configurando o servidor X (versão 4)
<p>
Para (re-)configurar um servidor XF4,
<example>
# dpkg-reconfigure --priority=low xserver-common
# dpkg-reconfigure --priority=low xserver-xfree86
</example>
gerará o arquivo <file>/etc/X11/XF86Config-4</file>  
e configurará o X usando o script <prgn>dexconf</prgn>.

<sect2 id="config-x3">Configurando o servidor X (versão 3)
<p>
Para (re-)configurar um servidor XF3, por exemplo, para ATI mach64,
<example>
# dpkg-reconfigure --priority=low xserver-common-v3
# dpkg-reconfigure --priority=low xserver-mach64
</example>
gerará o arquivo <file>/etc/X11/XF86Config</file>  
e configurará o X usando o script <prgn>xf86config-v3</prgn>.

<sect2 id="manual-config-x">Configurando o servidor X manualmente
<p>
No Woody, para adicionar personalizações do usuário ao arquivo
<file>/etc/X11/XF86Config-4</file>, <strong>não edite o arquivo
de configuração entre o texto</strong>:
<!-- FIXME for XF3 -->
<example>
### BEGIN DEBCONF SECTION
[snip]
### END DEBCONF SECTION
</example>
<p>
Ao invés disso, <strong>adicione as personalizações antes do
texto</strong>.  Por exemplo, para usar um dispositivo de vídeo
personalizado,  adicione alguma coisa  modificando o seguinte texto no
<em>início</em> do arquivo:
<example>
Section "Device"
  Identifier        "Custom Device"
  Driver            "ati"
  Option            "NoAccel"
EndSection

Section "Screen"
  Identifier  "Custom Screen"
  Device      "Custom Device"
  Monitor     "Generic Monitor"
  DefaultDepth 24
  Subsection "Display"
    Depth       8
    Modes       "1280x960" "1152x864" "1024x768" "800x600" "640x480"
  EndSubsection
  Subsection "Display"
    Depth       16
    Modes       "1280x960" "1152x864" "1024x768" "800x600" "640x480"
  EndSubsection
  Subsection "Display"
    Depth       24
    Modes       "1280x960" "1152x864" "1024x768" "800x600" "640x480"
  EndSubsection
EndSection

Section "ServerLayout"
    Identifier        "Custom"
    Screen            "Custom Screen"
    InputDevice       "Generic Keyboard" "CoreKeyboard"
    InputDevice       "Configured Mouse" "CorePointer"
EndSection
</example>
<p>
No Sarge (<tt>testing</tt> no momento em que escrevo), se você quiser manter
as personalizações do usuário no arquivo <file>/etc/X11/XF86Config</file> ao
atualizar, execute os seguintes comandos como root:
<example>
 # cp /etc/X11/XF86Config-4 /etc/X11/XF86Config-4.custom
 # md5sum /etc/X11/XF86Config-4 &gt; /var/lib/xfree86/XF86Config-4.md5sum
 # dpkg-reconfigure xserver-xfree86
</example> 
Para obter <strong>fontes menos feias</strong>, você precisa editar
o <file>/etc/X11/XF86Config-4</file> como descrito em <ref id="xfs-tt">.
<!--
<p>
No XF3, para obter <strong>fontes menos feias</strong>, você precisa editar
a ordem de <tt>FontPath</tt> em <file>/etc/X11/XF86Config</file> 
adicionando <tt>:unscaled</tt> como a seguir.
<example>
FontPath        "/usr/X11R6/lib/X11/fonts/misc:unscaled"
FontPath        "/usr/X11R6/lib/X11/fonts/100dpi:unscaled"
FontPath        "/usr/X11R6/lib/X11/fonts/75dpi:unscaled"
FontPath        "/usr/X11R6/lib/X11/fonts/Type1"
FontPath        "/usr/X11R6/lib/X11/fonts/Speedo"
FontPath        "/usr/X11R6/lib/X11/fonts/misc"
FontPath        "/usr/X11R6/lib/X11/fonts/100dpi"
FontPath        "/usr/X11R6/lib/X11/fonts/75dpi"
</example>
<p>
Se você usa xfs para servir fontes via um Unix Domain Socket, você também
deve editar a entrada <tt>catalogue</tt> do arquivo
<file>/etc/X11/fs/config</file> assim:
<example>
catalogue = /usr/X11R6/lib/X11/fonts/misc:unscaled,
            /usr/X11R6/lib/X11/fonts/100dpi:unscaled,
            /usr/X11R6/lib/X11/fonts/75dpi:unscaled,
            /usr/X11R6/lib/X11/fonts/Type1,
            /usr/X11R6/lib/X11/fonts/Speedo,
            /usr/X11R6/lib/X11/fonts/misc,
            /usr/X11R6/lib/X11/fonts/100dpi,
            /usr/X11R6/lib/X11/fonts/75dpi,
</example>
<p>
Esses truques <tt>:unscaled</tt> ficaram obsoletos no novo XF4 e não são
mais necessários.
-->
<!-- per /usr/share/doc/xfree86-common/README.fonts.gz in 4.2.1 -->
<p>
Por favor, verifique também as outras partes de sua configuração do X.
Ajustes ruins de monitor podem ser uma dor de cabeça até pior que fontes
ruins, então certifique-se de que sua taxa de atualização é tão alta quanto
seu monitor pode suportar (85 Hz é ótimo, 75 Hz está bom, 60 Hz é
horrível.).

<sect1 id="xclnt">Clientes X
<p>
Muitos programas clientes X podem ser iniciados com um comando como esse:
<example>
cliente $ xterm -geometry 80x24+30+200 -fn 6x10 -display <var>nomemáquina</var>:0 &amp;
</example>
Aqui, os argumentos opcionais da linha de comando significam:
<list>
<item><tt>-geometry
<var>LARGURA</var>x<var>ALTURA</var>+<var>DESL_X</var>+<var>DESL_Y</var></tt>:  
o tamanho inicial e a posição da janela.

<item><tt>-fn <var>NOMEFONTE</var></tt>: a fonte a usar para exibir texto.
 <tt><var>NOMEFONTE</var></tt> pode ser:
<list compact>
<item>a14: Fonte de tamanho normal
<item>a24: Fonte de tamanho grande
<item>... (verifique as fontes disponíveis com <tt>xlsfont</tt>.)
</list>
<item><tt>-display <var>nomedisplay</var></tt>: o nome do servidor X a
 usar. 
 <tt><var>nomedisplay</var></tt> pode ser:
<list compact>
<item><tt><var>nomemáquina</var>:<var>D.T</var></tt> significa tela
 <tt><var>T</var></tt> no display <tt><var>D</var></tt> da máquina
 <tt><var>nomemáquina</var></tt>; o servidor X para esse display está
 escutando na porta TCP 6000+D.

<item><tt><var>máquina</var>/unix:<var>D.T</var></tt> significa tela
  <tt><var>T</var></tt> no display <var>D</var> da máquina
  <tt><var>máquina</var></tt>; o servidor X para esse display está escutando
  o UNIX domain socket <file>/tmp/.X11-unix/XD</file> (então ele só é
  acessível pela <tt><var>máquina</var></tt>).

<item><tt><var>:D.T</var></tt> é equivalente ao 
<tt><var>máquina</var>/unix:<var>D.T</var></tt>, onde
<tt><var>máquina</var></tt> é o nome da máquina local.
</list>
</list>
<p>
O <tt><var>nomedisplay</var></tt> padrão para o programa cliente X (lado da
aplicação) pode ser definido pela variável de ambiente DISPLAY. Por exemplo,
antes de executar um programa cliente X, a execução de um dos seguintes
comandos faz isso:
<example>
$ export DISPLAY=:0 
        # O padrão, máquina local usando a primeira tela do X
$ export DISPLAY=<var>nomemaquina.dominio.nome</var>:0.2
$ export DISPLAY=localhost:0
</example>
Sua inicialização pode ser personalizada em <file>~/.xinitrc</file>.  Por exemplo:
<example>
xrdb -load $HOME/.Xresources
xsetroot -solid gray &amp;
xclock -g 50x50-0+0 -bw 0 &amp;
xload -g 50x50-50+0 -bw 0 &amp;
xterm -g 80x24+0+0 &amp;
xterm -g 80x24+0-0 &amp;
twm
</example>
Como descrito em <ref id="custom-x">, isso substitui tudo que a execução
normal de Xsession faz ao iniciar a partir de <prgn>startx</prgn>.
Use o <file>~/.xsession</file> ao invés disso e use essa alternativa apenas
como último recurso.
Veja <manref name="xsetroot" section="1x">, 
<manref name="xset" section="1x"> e <ref id="xresources">.
</sect1>

<sect1 id="x-session">Sessões X
<p>
Uma sessão X (servidor X + cliente X) pode ser iniciada por:
<list compact>
<item><prgn>startx</prgn>: comando de script para <prgn>xinit</prgn>
      para iniciar o servidor e o cliente X a partir do console de
      caracteres do Linux. Se o arquivo <file>~/.xinitrc</file> não existir,
      <file>/etc/X11/Xsession</file> é executado através de
      <file>/etc/X11/xinit/xinitrc</file>. 
<item><prgn>xdm</prgn>, <prgn>gdm</prgn>, <prgn>kdm</prgn>, ou
      <prgn>wdm</prgn>: Daemons gerenciadores de display X para iniciar o
      servidor e o cliente X, e para controlar o login a partir de uma tela GUI.  
      <file>/etc/X11/Xsession</file> é executado diretamente.
</list>
 O console pode ser disponibilizado como em <ref id="no-x-start">.

<sect2 id="custom-x">Sessões X personalizadas
<p>
O script de inicialização padrão <file>/etc/X11/Xsession</file> é
efetivamente uma combinação de 
<file>/etc/X11/Xsession.d/50xfree86-common_determine-startup</file> e
<file>/etc/X11/Xsession.d/99xfree86-common_start</file>.
<p>
A execução de  <file>/etc/X11/Xsession</file> é um pouco afetada por  
<file>/etc/X11/Xsession.options</file> e é essencialmente uma execução de um
programa que foi encontrado primeiro na seguinte ordem com o comando 
<prgn>exec</prgn> :
<enumlist compact>
<item><file>~/.xsession</file> ou <file>~/.Xsession</file>, se for definido.
<item><file>/usr/bin/x-session-manager</file>, se for definido.
<item><file>/usr/bin/x-window-manager</file>, se for definido.
<item><file>/usr/bin/x-terminal-emulator</file>, se for definido.
</enumlist>
<p>
O significado exato desses comandos é determinado pelo sistema de
alternativas do &debian; descrito em <ref id="alternatives">.
Por exemplo:
<example>
# update-alternatives --config x-session-manager
... ou
# update-alternatives --config x-window-manager
</example>
Para tornar qualquer gerenciador de janelas do X como padrão enquanto se
mantém os gerenciadores de sessão do GNOME e KDE instalados, substitua o
<file>/etc/X11/Xsession.d/50xfree86-common_determine-startup</file>
com o anexo no segundo relatório de bug em  
<url id="&bug-xfree;"> (Eu espero que ele seja incluído logo.)
e edite o <file>/etc/X11/Xsession.options</file> como a seguir para
desabilitar  o gerenciador de sessão X:
<example>
# /etc/X11/Xsession.options
#
# opções de configuração para /etc/X11/Xsession
# Veja Xsession.options(5) para uma explicação das opções disponíveis.
# Padrão habilitado
allow-failsafe
allow-user-resources
allow-user-xsession
use-ssh-agent
# Padrão desabilitado (habilite-os descomentando)
do-not-use-x-session-manager
#do-not-use-x-window-manager
</example>
<p>
Sem a modificação no sistema mencionada acima,
<package>gnome-session</package> e <package>kdebase</package> são 
os pacotes contendo esses gerenciadores de sessão X. Sua remoção permite que o
gerenciador de janelas X seja um padrão. (Yack, alguma idéia melhor?)
<p>
Em um sistema onde <file>/etc/X11/Xsession.options</file> contém uma linha
<tt>allow-user-xsession</tt> sem caracteres precedendo,
qualquer usuário que defina um <file>~/.xsession</file> ou <file>~/.Xsession</file>
poderá personalizar a ação de <file>/etc/X11/Xsession</file>.
<p>
O último comando no arquivo <file>~/.xsession</file> deve usar a forma  
<tt>exec <var>algum-gerenciador-de-janelas/sessão</var></tt> para iniciar
seu gerenciador de janelas/sessão X.
<p>
Um bom exemplo de um script <file>~/.xsession</file> é dado em 
<file>&f-xsession;</file>.
<p>
Eu uso isso para definir o gerenciador de janelas acesso à tela e idioma de
suporte para cada conta de usuário. Veja <ref id="s-w-manager">, <ref id="ss-xsu">, e
<ref id="x-cjk">.
<p>
Se você desejar ter vários programas clientes X iniciados automaticamente,
veja os exemplos <ref id="xclnt"> e invoque-os a partir do arquivo
<file>~/.xsession</file> ao invés do arquivo <file>~/.xinitrc</file>.
<p>
Recursos X específicos do usuário podem ser definidos em
<file>~/.Xresources</file>.  Veja <ref id="xresources">.
<p>
Mapas de teclado e funções dos botões do apontador personalizados para o
usuário no X também podem ser especificados no script de inicialização do
usuário.  Veja <ref id="xmodmap">. 

<sect2 id="s-w-manager">Iniciando uma sessão X para um usuário
<p>
Seguindo o princípio descrito em  <ref id="custom-x">,
um gerenciador de sessão/janelas X específico do usuário pode ser ativado
instalando o pacote indicado e definindo o conteúdo no final do arquivo  
<file>~/.xsession</file> como a seguir.
(Eu gosto do <package>blackbox</package>/<package>fluxbox</package> por
seu estilo simples e pela alta velocidade.):

<list>
<item>gerenciador de sessão X padrão 
<list compact>
<item>Veja <ref id="alternatives">
<item><tt>exec /usr/bin/x-session-manager</tt>
</list>
<item>gerenciador de janelas X padrão 
<list compact>
<item>Veja <ref id="alternatives">
<item><tt>exec /usr/bin/x-window-manager</tt>
</list>

<item>Gerenciador de sessão do GNOME (pesado)
<list compact>
<item>Instalar pacote: <package>gnome-session</package>
<item><tt>exec /usr/bin/gnome-session</tt>
</list>

<item>Gerenciador de sessão do KDE (pesado)
<list compact>
<item>Instalar pacote: <package>kdebase</package> (ou 
<package>kdebase3</package> para KDE3)
<item><tt>exec /usr/bin/kde2</tt>
</list>

<item>Gerenciador de janelas Blackbox (leve, simples)
<list compact>
<item>Instalar pacote: <package>blackbox</package>
<item><tt>exec /usr/bin/blackbox</tt>
</list>

<item>Gerenciador de janelas Fluxbox (leve, novo blackbox)
<list compact>
<item>Instalar pacote: <package>fluxbox</package>
<item><tt>exec /usr/bin/fluxbox</tt>
</list>

<item>Gerenciador de janelas Xfce (parecido com Mac OS-X, SUN CDE)
<list compact>
<item>Instalar pacote: <package>xfce</package>
<item><tt>exec /usr/bin/xfwm</tt>
</list>

<item>Gerenciador de janelas IceWM (leve, alternativa ao GNOME)
<list compact>
<item>Instalar pacote: <package>icewm</package>
<item><tt>exec /usr/bin/X11/icewm</tt>
</list>

<item>Gerenciador de janelas virtual FVWM2 (leve, parecido com Win95)
<list compact>
<item>Instalar pacote: <package>fvwm</package>
<item><tt>exec /usr/bin/fvwm2</tt>
</list>

<item>Gerenciador de janelas Windowmaker (algo parecido com NeXT)
<list compact>
<item>Instalar pacote: <package>wmaker</package>
<item><tt>exec /usr/bin/wmaker</tt>
</list>

<item>Gerenciador de janelas Enlightenment (pesado).
<list compact>
<item>Instalar pacote: <package>enlightenment</package>
<item><tt>exec /usr/bin/enlightenment</tt>
</list>

</list>
Veja <url id="&windomanagerhome;" name="Gerenciadores de Janela para o X">.


<sect2 id="kde-gnome">Configurando KDE e GNOME
<p>
Para configurar um ambiente KDE ou GNOME completo, os seguintes metapacotes 
são úteis:
<list compact>
<item>KDE: instale o pacote <package>kde</package> 
<item>GNOME: instale o pacote <package>gnome</package> 
</list>
A instalação desses pacotes com ferramentas que manipulam <tt>recommends</tt>,
como o <prgn>dselect</prgn> e o <prgn>aptitudes</prgn>, lhe dá melhores
opções de software que simplesmente instalá-los com o 
<prgn>apt-get</prgn>.
<p>
Se você quiser login de console, certifique-se de desabilitar gerenciadores
de sessão como <package>kdm</package>, <package>gdm</package>, e 
<package>wdm</package>, que podem ser inseridos pelas dependências, como
descrito em  <ref id="no-x-start">.
<p>
Se você quiser ter o GNOME como padrão do sistema sobre o KDE, não esqueça
de configurar  <prgn>x-session-manager</prgn> como em <ref id="alternatives">.

<sect1 id="xtcp">Usando o X sobre TCP/IP
<p>
Devido a conexão com soquete TCP/IP remota sem encriptação ser sujeita a um 
"eavesdropping attack", a configuração padrão para o X em versões recentes
do &debian; desabilita o soquete TCP/IP.  Pense em usar o <prgn>ssh</prgn> 
para uma conexão remota do X (veja <ref id="xssh">). 
<p>
O método descrito aqui não é encorajado a menos que se esteja em um ambiente
muito seguro atrás de um bom sistema de firewall com apenas usuários
conhecidos presentes. Use o seguinte comando para verificar a configuração
atual de seu servidor X para o soquete TCP/IP:
<example>
# find /etc/X11 -type f -print0 | xargs -0 grep nolisten
/etc/X11/xinit/xserverrc:exec /usr/bin/X11/X -dpi 100 -nolisten tcp
</example>
Remova <tt>-nolisten</tt> para restaurar escuta TCP/IP no servidor X.
</sect1>
 
<sect1 id="xhost">Conectando a um servidor X remoto &ndash; <prgn>xhost</prgn>
<p>
O <prgn>xhost</prgn> permite acesso baseado em nomes de máquinas. Isso é
muito inseguro. O seguinte desabilitará a verificação de máquina e permitirá
conexões de qualquer lugar se uma conexão com soquete TCP/IP for permitida
(veja <ref id="xtcp">): 
<example>
$ xhost +
</example>
Você pode reabilitar a verificação de máquina com:
<example>
$ xhost -
</example>
<p>
O <prgn>xhost</prgn> não distingue entre diferentes usuários na máquina
remota.  Além disso, nomes de máquinas  (endereços) podem ser falsificados. 
<p>
Esses método precisa ser evitado mesmo com o critério de máquina mais
restritivo se você estiver em uma rede não confiável (por exemplo com uma
conexão de acesso discado PPP à Internet).  Veja <manref name="xhost" section="1x">.
</sect1>

<sect1 id="xssh">Conectando a um servidor X remoto &ndash; <prgn>ssh</prgn>
<p>
O uso de  <prgn>ssh</prgn> permite uma conexão segura a partir de um
servidor  X local para um servidor de aplicações remoto.  
<list>
<item>Defina as entradas <tt>X11Forwarding</tt> e <tt>AllowTcpForwarding</tt> 
para <tt>yes</tt> no <file>/etc/ssh/sshd_config</file> da máquina
remota, se você quiser evitar as opções de linha de comando
correspondentes.
<item>Inicie o servidor X na máquina local.
<item>Abra um <prgn>xterm</prgn> na máquina local.
<item>Execute o <prgn>ssh</prgn> para estabelecer uma conexão com o sistema remoto.  
<example>
nomelocal @ maquinalocal $ ssh -q -X -l nomelogin maquinaremota.dominio
Password:
.....
</example>
<item>Execute os comandos da aplicação X no sistema remoto.
<example>
nomelogin @ maquinaremota $ gimp &
</example>
</list>
Esse método permite a exibição da saída de um cliente X remoto como se ele
estivesse conectado localmente através de um soquete de domínio UNIX local.
</sect1>

<sect1 id="xtermfaq">O emulador de terminal X &ndash; <prgn>xterm</prgn>
<p>
Aprenda tudo sobre o <prgn>xterm</prgn> em <url id="&xtermfaq;">.
</sect1>

<sect1 id="xresources">Recursos do X
<p>
Muitos programas X antigos, como o <prgn>xterm</prgn>, usam a base de dados de recursos
do X para configurar sua aparência.  O arquivo <file>~/.Xresources</file> é usado
para armazenar as especificações dos recursos do usuário.  Esse arquivo é
carregado automaticamente nos recursos padrões do X ao fazer o login. Os
padrões gerais do sistema para os recursos do X são armazenados em
<file>/etc/X11/Xresources/*</file> e os padrões de aplicações deles são
armazenados em <file>/etc/X11/app-defaults/*</file>. Use esses ajustes como
pontos de partida.
<p>
Aqui estão algumas configurações úteis para adicionar ao seu arquivo
<file>~/.Xresources</file> :
<example>
! Define a fonte para uma mais legível 9x15
XTerm*font: 9x15

! Exibe uma barra de rolagem
XTerm*scrollBar: true

! Define o tamanho do buffer para 1000 linhas
XTerm*saveLines: 1000

! Tela grande do kterm
KTerm*VT100*fontList: -*-fixed-medium-r-normal--24-*,\
 -*-gothic-medium-r-normal--24-*,\
 -*-mincho-medium-r-normal--24-*
</example>
Para fazer com que essas configurações tenham efeito imediato, carregue-as
na base de dados com o comando:
<example>
xrdb -merge ~/.Xresources
</example>
Veja <manref name="xrdb" section="1x">.

<sect1 id="xmodmap">Mapas de teclado e funções de botões do apontador no X
<p>
O programa <prgn>xmodmap</prgn> é usado para editar e exibir o mapa
modificador do teclado e a tabela de mapa do teclado que são usados pelas
aplicações clientes para converter códigos de tecla de eventos em símbolos
de tecla no X.
<example>
$ xmodmap -pm 
 ... exibe o mapa modificador atual
$ xmodmap -pk | pager
 ... exibe a tabela do mapa atual
$ xmodmap -e "pointer = 3 2 1" # define mouse para a mão esquerda
$ xmodmap ~/.xmodmaprc # configura o teclado como em ~/.xmodmaprc
</example>
Ele geralmente é executado a partir do script de inicialização de sessão do
usuário, <file>~/.xsession</file>.
<!--
Mapas de teclado personalizados pelo usuário e funções de botões do
apontador no X podem ser especificados no arquivo <file>~/.xmodmaprc</file>.
-->
<p>
Para obter o <tt>código de tecla</tt> (keycode), execute <prgn>xev</prgn> no X e
pressione teclas. Para obter o significado do <tt>símbolo de tecla</tt>
(keysym), procure na definição MACRO no arquivo
<file>/usr/include/X11/keysymdef.h</file>. Todas as expressões
<tt>#define</tt> nesse arquivo são nomeadas como <tt>XK_</tt> antecedendo os
nomes de <tt>símbolo de tecla</tt>.
<p>
Veja <manref name="xmodmap" section="1x">.

<sect1 id="ss-xsu">Obtendo root no X
<p>
Se um programa GUI precisar ser executado com privilégios de root, use os
seguintes procedimentos para exibir a saída do programa em um servidor X do
usuário. 
<strong>Nunca inicie um servidor X diretamente da conta  root</strong> para
evitar  possíveis riscos de segurança.
<p>
Inicie o servidor X como um usuário normal e abra um console <prgn>xterm</prgn>.
Então:
<example>
$ XAUTHORITY=$HOME/.Xauthority
$ export XAUTHORITY
$ su root
Password:*****
# printtool &
</example>
Ao usar esse truque para  <prgn>su</prgn> para um usuário não root, 
assegure-se de que <file>~/.Xauthority</file> pode ser lido por grupo para
esse usuário não root.
<p>

<!-- this section moved up -->

Para automatizar essa seqüência de comandos, crie um arquivo 
<file>~/.xsession</file> a partir da conta do usuário, contendo as seguintes
linhas:
<example>
# Isso faz o X funcionar quando uso su para conta root.
if [ -z "$XAUTHORITY" ]; then
        XAUTHORITY=$HOME/.Xauthority
        export XAUTHORITY
fi
unset XSTARTUP
# Se for desejado um gerenciador de janelas/sessão específico, descomente
# a linha seguinte e edite-a para preencher suas necessidades.
#XSTARTUP=/usr/bin/blackbox
# Isso inicia programa gerenciador de sessão/janela x
if [ -z "$XSTARTUP" ]; then
  if [ -x /usr/bin/x-session-manager ]; then
    XSTARTUP=x-session-manager
  elif [ -x /usr/bin/x-window-manager ]; then
    XSTARTUP=x-window-manager
  elif [ -x /usr/bin/x-terminal-emulator ]; then
    XSTARTUP=x-terminal-emulator
  fi
fi
# executa gerenciador de janela/sessão X auto selecionado
exec $XSTARTUP
</example>
Então execute <prgn>su</prgn> (não <tt>su -</tt>) em uma janela
<prgn>xterm</prgn> do usuário.  Agora programas GUI iniciados a
partir desse <prgn>xterm</prgn> podem exibir saída na janela desse usuário
enquanto é executado com privilégio de root.  Esse truque funciona sempre
que  o <file>/etc/X11/Xsession</file> padrão é executado.  Se um usuário
definir sua personalização usando  <file>~/.xinit</file>
ou <file>~/.xsession</file>, a variável de ambiente <tt>XAUTHORITY</tt>
acima  mencionada também precisa ser definida similarmente naqueles scripts.

<p>Alternativamente, o <package>sudo</package> pode ser usado para automatizar
a seqüência de comando:
<example>
$ sudo xterm
... ou
$ sudo -H -s
</example>
Aqui <file>/root/.bashrc</file> deve conter:
<example>
if [ $SUDO_USER ]; then
    sudo -H -u $SUDO_USER xauth extract - $DISPLAY | xauth merge -
fi
</example>
Isso funciona bem mesmo com o diretório home do usuário em uma montagem NFS,
porque root não lê o arquivo <file>.Xauthority</file>.
<p>
Há também vários pacotes especializados para esse propósito:
<package>kdesu</package>, <package>gksu</package>, <package>gksudo</package>,
<package>gnome-sudo</package>, e <package>xsu</package>.  Alguns outros
métodos podem ser usados para se obter resultados similares: criar um link
simbólico a partir de <file>/root/.Xauthority</file> para o do usuário
correspondente; uso do script <url id="&suxhome;" name="sux">; ou colocar "<tt>xauth merge
~<var>USER_RUNNING_X</var>/.Xauthority</tt>" no script de inicialização root.
<p>
Veja mais na <url id="&deb-dev-su;" name="lista de mensagens debian-devel">.
</sect1>

<sect1 id="xfs-tt">Fontes TrueType no X
<p>
O <prgn>xfs</prgn> padrão do XFree86-4 funciona bem com fontes TrueType.
Se você estiver usando o XFree86-3, precisa instalar um servidor de
fontes de terceiros como o <prgn>xfs-xtt</prgn>.
<p>
Você só precisa ter certeza de que as aplicações com as quais quer usar
as fontes TrueType foram ligadas usando libXft ou libfreetype (provavelmente
você nem precisa preocupar-se com isso se estiver usando .debs
pré-compilados).
<p>
Primeiro configure a estrutura de suporte a fontes:
<list compact>
<item>Instale os pacotes <package>x-ttcidfont-conf</package> e
<package>defoma</package>. Isso automatiza a geração de arquivos
<file>fonts.scale</file> e <file>fonts.dir</file>.
<example>
# apt-get install x-ttcidfont-conf
</example>
<item>Edite o arquivo <file>/etc/X11/XF86Config-4</file> em <tt>Section
"Files"</tt> assim:
<example>
Section "Files"
    FontPath  "/var/lib/defoma/x-ttcidfont-conf.d/dirs/TrueType"
    FontPath  "/usr/share/fonts/truetype"
    FontPath  "/usr/lib/X11/fonts/CID"
    FontPath  "/usr/lib/X11/fonts/Speedo"
    FontPath  "/usr/lib/X11/fonts/misc"
    FontPath  "/usr/lib/X11/fonts/cyrillic"
    FontPath  "/usr/lib/X11/fonts/100dpi:unscaled"
    FontPath  "/usr/lib/X11/fonts/75dpi:unscaled"
    FontPath  "/usr/lib/X11/fonts/Type1"
EndSection
</example>
A primeira linha ajustará o XFree86 para usar quaisquer fontes TrueType que
você instalar a partir de pacotes &debian;.
A entrada de fonte Type1 é movida para baixo já que o XFree86 faz um
trabalho um tanto podbre de renderização de fontes Type1.
O truque de <tt>:unscaled</tt> para fontes bitmap não deve mais ser
necessário para o novo XF4 mas eu incluí aqui só por segurança.
<!-- per /usr/share/doc/xfree86-common/README.fonts.gz in 4.2.1 -->
<p>
Para preservar as alterações manuais feitas no arquivo
<file>/etc/X11/XF86Config-4</file>, siga as instruções em <ref
id="manual-config-x">.
</list>
<p>
Então instale pacotes de fontes DFSG:
<list compact>
<item>Fontes TrueType ocidentais:
<list compact>
<item><package>ttf-bitstream-vera</package>: Um conjunto de fontes TrueType
de alta qualidade criadas pela Bitstream, Inc.
<footnote>
Apesar disso não estar disponível no Woody, você pode instalar a partir do
Sarge.
</footnote>
<item><package>ttf-freefont</package>: Um conjunto de fontes TrueType livres
de alta qualidade cobrindo o conjunto de caracteres UCS.
<item><package>ttf-thryomanes</package>: Uma fonte TrueType Unicode cobrindo
Latin, Grego, Cirílico e IPA.
</list>
<item>Fontes asiáticas:
<list compact>
<item><package>tfm-arphic-bsmi00lp</package>: Fonte TrueType Arphic Chinês
"AR PL Mingti2L Big5" dado métrico fonte TeX
<item><package>tfm-arphic-bkai00mp</package>: Fonte TrueType Arphic Chinês
"AR PL KaitiM Big5" dado métrico fonte TeX
<item><package>tfm-arphic-gbsn00lp</package>: Fonte TrueType Arphic Chinês
"AR PL SungtiL GB" dado métrico fonte TeX
<item><package>tfm-arphic-gkai00mp</package>:  Fonte TrueType Arphic Chinês
"AR PL KaitiM GB" dado métrico fonte TeX
<item><package>ttf-baekmuk</package>: Séries de fontes TrueType Baekmuk Coreano
<item><package>hbf-jfs56</package>: Fonte bitmap Jianti Fangsong 56x56
Chinês (GB2312) para CJK
<item><package>hbf-cns40-b5</package>: Fonte bitmap Fanti Song 40x40 Chinês
(Big5) para CJK
<item><package>hbf-kanji48</package>: Fonte bitmap Kanji 48x48 Japonês
(JIS X-0208) para CJK
</list>
</list>
<!-- Need to watch Japanese font issue -->
<p>
Já que fontes <strong>Livres</strong> são algumas vezes limitadas, a
instalação ou compartilhamento de algumas fontes comerciais TrueType é uma
opção  para usuários  &debian;. Para facilitar esse processo para o usuário,
alguns pacotes de conveniência foram criados:
<list compact>
<item><package>ttf-commercial</package>
<item><package>msttcorefonts (>1.1.0)</package> 
<footnote>
O pacote do Woody não funciona desde 8/2002 devido a mudanças na página web
da Microsoft. Ao invés disso, use a versão do Sarge mesmo no Woody.
</footnote>
</list>
Você terá uma seleção realmente boa de fontes TrueType sob o custo de contaminar
seu sistema <strong>Livre</strong> com fontes não-Livres.
<p>
Todas esses pacotes de fontes no &debian; devem funcionar sem nenhum esforço
e aparecer disponíveis para todos os programas X que usam o sistema de
fontes "principal" regular. Isso inclui coisas como Xterm, Emacs e muitas
outras aplicações não-KDE e não-Gnome.
<p>
Agora, execute o <prgn>xfontsel</prgn> e selecione quaisquer fontes TrueType
no menu fndry, você deve ser capaz de ver muitas entradas não acinzentadas
no menu "fmly".
<p>
Para o KDE2.2 e GNOME1.4 (com libgdkxft0, que é um hack para fazer o GTK 1.2
renderizar fontes com anti-alias), você precisa configurar Xft1, também.
Xft1 está altamente desatualizado, e basicamente só é usado pelo GNOME1.4 e
KDE2.2. Edite o arquivo <file>/etc/X11/XftConfig</file> e adicione uma linha
como 
<example>
    dir "/var/lib/defoma/x-ttcidfont-conf.d/dirs/TrueType"
</example>
<p>
antes das outras linhas dir.
<footnote>
Eu não tenho mais nada de xft1 em minha máquina, então não tenho certeza se
você precisa reiniciar o X ou não antes de que isso tenha efeito. Pelo que
me lembro "xftcache" atualizaria o cache de Xft1, mas seria bom se alguém
pudesse confirmar isso para mim.
</footnote>
Para o GNOME2 e KDE3 (pós edição do Sarge), você precisa configurar o
<package>fontconfig</package> que o Xft2 usa para encontrar fontes.
<footnote>
<package>Fontconfig</package> <strong>não</strong> existe no Woody.
</footnote>
Você não deve precisar instalar nada extra para isso, já que todos os
pacotes que usam <package>fontconfig</package> já irão Depender dele
(indiretamente).
<p>
Primeiro, veja em <file>/etc/fonts/fonts.conf</file>. Deve haver uma linha
como a abaixo. Se não houver, abra o <file>/etc/fonts/local.conf</file> e
adicione essa
<example>
    &lt;dir&gt;/var/lib/defoma/x-ttcidfont-conf.d/dirs/TrueType&lt;/dir&gt;
</example>
logo abaixo da linha &lt;fontconfig&gt;.
<p>
O <package>Fontconfig</package> deve pegá-las imediatamente, e "fc-list"
deve listar suas novas fontes. Outro recurso elegante do
<package>fontconfig</package> é que você pode simplesmente colocar fontes em
<file>~./fonts/</file> e todos os seus programas que usam
<package>fontconfig</package> terão acesso a elas imediatamente.
<p>
Se você instalar manualmente um novo conjunto de fontes TrueType enquanto
estiver no X sem usar pacote &debian;, execute
<example>
# xset fp rehash
</example>
para fazer com que o XFree86 olhe os conteúdos daquele diretório novamente e
pegue as novas.

<sect1 id="ss-browser">Navegadores Web no X
<p>
Há alguns pacotes de navegadores Web com capacidades de exibição gráfica
desde a versão Woody:
<list compact>
<item><package>mozilla</package> O navegador Mozilla  (novo)
<item><package>galeon</package> Navegador baseado no Mozilla com uma
interface de usuário para o Gnome (novo)
<item><package>konqueror</package> Navegador KDE 
<item><package>dillo</package> Navegador GTK
<item><package>amaya-gtk</package> Navegador de referência W3C 
<item><package>amaya-lesstif</package> Navegador de referência W3C 
<item><package>netscape-...</package> (muito, antigo)
<item><package>communicator-...</package> (muito, antigo)
<item>...
</list>
A versão do <package>mozilla</package> precisa combinar com a versão 
que o <package>galeon</package> requer.  Apesar deles diferirem na interface
para o usuário, esses dois programas compartilham o mecanismo de
processamento HTML Gecko.
<p>
Os plug-ins para navegadores como <package>mozilla</package> e
<package>galeon</package> podem ser habilitados instalando os "<tt>*.so</tt>" 
manualmente no diretório de plug-in e reiniciando os navegadores.
<p>
Recursos plug-in:
<list compact>
<item>Plug-in Java: instale o binário "J2SE" de <url id="&javasunhome;">.
<item>Flash plug-in: instale o binário "Macromedia Flash Player 5" de
 <url id="&flashhome;">.
<item><package>freewrl</package>: navegador VRML  e plug-in Netscape
<item>...
</list>
</sect1>

<!-- CJK and X moved to bottom with different name to locale section -->

</sect>

<sect id="ssh">SSH
<p>
O SSH (Secure SHell) é a maneira segura de conectar através da  Internet.
Uma versão livre de  SSH chamada OpenSSH está disponível como o pacote
<package>ssh</package> no  &debian;.

<sect1 id="ssh-basics">Básico do SSH
<p>
Primeiro instale o servidor e o cliente OpenSSH.
<example>
# apt-get update && apt-get install ssh
</example>
É necessária a entrada non-US no arquivo <file>/etc/apt/source.list</file> .
O arquivo <file>/etc/ssh/sshd_not_to_be_run</file> não pode estar presente se 
desejar-se executar o servidor OpenSSH.
<p>
O SSH tem dois protocolos de autenticação:
<list>
<item>protocolo SSH versão 1: 
 <list compact>
<item>a versão Potato suporta apenas esse protocolo.
<item>métodos de autenticação disponíveis:
  <list compact>
<item>RSAAuthentication: autenticação de usuário baseado em chave de
 identidade RSA
<item>RhostsAuthentication: autenticação de máquina baseado em .rhosts 
 (inseguro, desabilitado)
<item>RhostsRSAAuthentication: autenticação .rhosts combinada com 
 chave de máquina RSA  (desabilitado)
<item>ChallengeResponseAuthentication: autenticação pergunta-resposta RSA
<item>PasswordAuthentication: autenticação baseada em senha
  </list>
 </list>
<item>protocolo SSH versão 2: 
 <list compact>
<item>versões pós-Woody usam esse como o protocolo primário.
<item>métodos de autenticação disponíveis:
  <list compact>
<item>PubkeyAuthentication: autenticação de usuário baseado em chave pública
<item>HostbasedAuthentication: autenticação <file>.rhosts</file> ou
 <file>/etc/hosts.equiv</file> combinado com autenticação de chave pública
 de máquina cliente (desabilitado)
<item>ChallengeResponseAuthentication: autenticação pergunta-resposta
<item>PasswordAuthentication: autenticação baseada em senha
  </list>
 </list>
</list>

<p>
Tenha cuidado com essas diferenças se você estiver migrando para o Woody ou
estiver usando um sistema não-&debian;.  
<p>
Veja <file>/usr/share/doc/ssh/README.Debian.gz</file>,
<manref name="ssh" section="1">, 
<manref name="sshd" section="8">,
<manref name="ssh-agent" section="1">, e
<manref name="ssh-keygen" section="1"> para detalhes.

<p>
Os arquivos de configuração chaves são os seguintes:

<list>

<item><file>/etc/ssh/ssh_config</file>: padrões do cliente SSH.
 Veja <manref name="ssh" section="1">.  As entradas notáveis são:

 <list compact>
<item><tt>Host</tt>: Limita as declarações seguintes 
  (até a próxima palavra-chave Host) para serem apenas para aquelas máquinas
  que combinam com um dos padrões dados depois da palavra-chave.
<item><tt>Protocol</tt>: Especifica as versões de protocolo SSH.  
 O padrão é  "2,1".
<item><tt>PreferredAuthentications</tt>: Especifica o método de autenticação
  do cliente SSH2.  O padrão é "hostbased,publickey,keyboard-interactive,password".
<item><tt>PasswordAuthentication</tt>: Se você quiser efetuar login com uma
senha, precisa certificar-se de que isso não está ajustado para
<tt>no</tt>.
<item><tt>ForwardX11</tt>: O padrão é desabilitado.  Isso pode ser
  substituído pela opção de linha de comando "<tt>-X</tt>".
 </list>

<item><file>/etc/ssh/sshd_config</file>: Padrões do servidor SSH.
 Veja <manref name="sshd" section="8">.  As entradas notáveis são:

 <list compact>
<item><tt>ListenAddress</tt>: Especifica os endereços locais em que o 
 <prgn>sshd</prgn> deve escutar. São permitidas múltiplas opções.
<item><tt>AllowTcpForwarding</tt>: O padrão é desabilitado.  
<item><tt>X11Forwarding</tt>: O padrão é desabilitado.  
 </list>

<item><file>$HOME/.ssh/authorized_keys</file>: as listas das chaves públicas
padrões que os clientes usam para conectar a essa conta nessa máquina.
Veja <manref name="ssh-keygen" section="1">.

<item><file>$HOME/.ssh/identity</file>: 
Veja <manref name="ssh-add" section="1">
e <manref name="ssh-agent" section="1">.
</list>

<p>
O seguinte iniciará uma conexão <prgn>ssh</prgn> a partir de um cliente.
<example>
$ ssh nomeusuario@nomemaquina.dominio.ext
$ ssh -1 nomeusuario@nomemaquina.dominio.ext # Força SSH versão 1
$ ssh -1 -o RSAAuthentication=no -l nomeusuario foo.host
    # força senha em SSH1
$ ssh -o PreferredAuthentications=password -l nomeusuario foo.host
    # força senha em SSH2
</example>
Para o usuário, o <prgn>ssh</prgn> funciona como um <prgn>telnet</prgn> mais
esperto e mais seguro (não vai explodir com ^]).

</sect1>

<sect1 id="ssh-forward">Redirecionamento de porta para tunelamento SMTP/POP3
<p>
Para estabelecer um pipe para conectar à porta 25 de um
<var>servidor-remoto</var> a partir da porta 4025 do sistema local, e para a
porta 110 do <var>servidor-remoto</var> a partir da porta 4110 do sistema local
através do <prgn>ssh</prgn>, execute na máquina local:
<example>
# ssh -q -L 4025:servidor-remoto:25 4110:servidor-remoto:110 \
           nomeusuario@servidor-remoto
</example>
Essa é uma forma segura de fazer conexões com servidores  SMTP/POP3 através
da Internet. Ajuste a entrada <tt>AllowTcpForwarding</tt> para <tt>yes</tt> no 
arquivo <file>/etc/ssh/sshd_config</file> da máquina remota.
</sect1>

<sect1 id="ssh-rsa">Conectando com menos senhas &ndash; RSA
<p>
Pode-se evitar de ter que lembrar de uma senha para cada sistema remoto
usando RSAAuthentication (protocolo SSH1) ou PubkeyAuthentication (protocolo
SSH2).  
<p>
No sistema remoto, defina as respectivas entradas, 
"RSAAuthentication yes" ou "PubkeyAuthentication yes", em 
<file>/etc/ssh/sshd_config</file>.
<p>
Então gere chaves de autenticação localmente e instale a chave pública
no sistema remoto:
<example>
$ ssh-keygen          # RSAAuthentication: chave RSA1 para SSH1
$ cat .ssh/identify   | ssh usuario1@remoto \
        "cat - &gt;&gt;.ssh/authorized_keys"
...
$ ssh-keygen -t rsa   # PubkeyAuthentication: chave RSA para SSH2
$ cat .ssh/id_rsa.pub | ssh usuario1@remoto \
        "cat - &gt;&gt;.ssh/authorized_keys"
...
$ ssh-keygen -t dsa   # PubkeyAuthentication: chave DSA para SSH2
$ cat .ssh/id_dsa.pub | ssh usuario1@remoto \
        "cat - &gt;&gt;.ssh/authorized_keys"
</example>
Pode-se mudar a frase-senha mais tarde com  "<tt>ssh-keygen -p</tt>".
Não esqueça de verificar as configurações testando a conexão.  Em caso de
qualquer problema, use "<tt>ssh -v</tt>".
<p>
Você pode adicionar opções para as entradas em <prgn>authorized_keys</prgn>
para limitar as máquinas e executar comandos específicos. Veja <manref
name="sshd" section="8"> para obter mais detalhes.
<p>
Note que SSH2 tem <tt>HostbasedAuthentication</tt>. Para isso funcionar, 
você precisa ajustar as configurações de <tt>HostbasedAuthentication</tt> para
<tt>yes</tt> em ambos os <file>/etc/ssh/sshd_config</file> na máquina
servidor e <file>/etc/ssh/ssh_config</file> ou
<file>$HOME/.ssh/config</file> na máquina cliente. 
</sect1>

<sect1 id="ssh-client">Lidando com clientes SSH estranhos
<p>
Há alguns clientes SSH livres disponíveis para plataformas não semelhantes
ao Unix.
<taglist>
<tag>Windows
<item><url id="&puttyhome;" name="puTTY"> (GPL)
<tag>Windows (cygwin)
<item>SSH em <url id="&cygwinhome;" name="cygwin"> (GPL)
<tag>Macintosh Classic
<item><url id="&macsshhome;" name="macSSH"> (GPL) [Note que o Mac OS X
  inclui OpenSSH; use <tt>ssh</tt> na aplicação Terminal]
</taglist>
Veja também <url id="&sfdochome;" name="SourceForge.net, documentação do site">, 
"6. CVS Instructions".

<sect1 id="ssh-agent">Configurando o <prgn>ssh-agent</prgn>
<p>
É mais seguro proteger sua chave de autenticação SSH com uma frase
senha. Se isso não foi configurado, use <tt>ssh-keygen -p</tt> para
configurar.
<p>
Coloque sua chave pública (por exemplo, <file>~/.ssh/id_rsa.pub</file>)
no <file>~/.ssh/authorized_keys</file> em um host remoto usando conexão
baseada em senha como descrito em <ref id="ssh-rsa">.
<example>
$ ssh-agent bash # ou ao invés, execute o programa zsh/tcsh/pdksh.
$ ssh-add ~/.ssh/id_rsa
Enter passphrase for /home/osamu/.ssh/id_rsa:
Identity added: /home/osamu/.ssh/id_rsa (/home/osamu/.ssh/id_rsa)
$ scp <var>foo</var> <var>usuario@host.remoto:foo</var>
 ... nenhuma frase senha necessária a partir daqui :-)
$^D
 ... terminando sessão ssh-agent
</example>
Para o servidor X, scripts de inicialização normais do &debian; executam
<prgn>ssh-agent</prgn> como processo pai. Então você só precisa executar
<prgn>ssh-add</prgn> um vez.
<p>
Para mais detalhes, leia <manref name="ssh-agent" section="1"> e
<manref name="ssh-add" section="1">.
</sect1>

<sect1 id="ssh-trouble">Resolução de problemas de SSH
<p>
Se você tiver problemas, verifique as permissões de arquivos de configuração e
execute <prgn>ssh</prgn> com a opção "<tt>-v</tt>".
<p>
Use a opção "<tt>-P</tt>" se você for root e tiver problemas com um firewall;
isso evita o uso das portas 1&ndash;1023 do servidor.
<p>
Se as conexões <prgn>ssh</prgn> para um sistema remoto pararem subitamente de
funcionar,  isso pode ser resultado de manutenção pelo administrador do sistema,
normalmente uma mudança na <prgn>host_key</prgn> durante a manutenção do
sistema.   Depois de certificar-se de que é esse o caso e que ninguém está
tentando simular o sistema remoto com algum hack esperto, pode-se conseguir
uma conexão novamente removendo a entrada <prgn>host_key</prgn> de 
<file>$HOME/.ssh/known_hosts</file> na máquina local.
</sect1>

</sect>

<sect id="mail">Correio
<p>
A configuração de correio se divide em três categorias:
<list>
<item>mail transfer agent (MTA) (agente de transferência de mensagens):
 <prgn>exim</prgn>, <prgn>postfix</prgn>, <prgn>sendmail</prgn>,
 <prgn>qmail</prgn>, <prgn>ssmtp</prgn>, <prgn>nullmailer</prgn>, ...
<item>utilitários de correio: <prgn>procmail</prgn>, <prgn>fetchmail</prgn>,
<prgn>mailx</prgn>, ...
<item>mail user agent (MUA) (agente de correio de usuário):
 <prgn>mutt</prgn>, <prgn>emacs</prgn>+<prgn>gnus</prgn>, ...
</list>

<sect1 id="mta">Agentes de transporte de correio (MTAs)
<p>
Se quiser um MTA completo, use o <package>exim</package>. Referências:
<list compact>
<item>pacotes <package>exim-doc</package> e <package>exim-doc-html</package>
<item><url id="&eximhome;">
</list>
O único MTA alternativo razoável é o <package>postfix</package>, se você se
preocupa com a segurança. O <package>sendmail</package> e o
<package>qmail</package> estão disponíveis como pacotes &debian; mas não são
recomendados.
<p>
Se você não precisar da capacidade de relay de um MTA como no caso de um
sistema satélite como um PC laptop, você pode considerar usar um desses
pacotes leves:
<list compact>
<item><prgn>ssmtp</prgn>: precisa de conexão SMTP e tem capacidade de alias, ou
<item><prgn>nullmailer</prgn>: pode enviar mas não tem capacidade de alias
</list>
Nesse momento, acho que o <prgn>exim</prgn> é o mais adequado mesmo para
minha estação de trabalho pessoal, que é um PC laptop.
<p>
Você pode precisar remover o <prgn>exim</prgn> para a instalação de um
desses pacotes conflitantes:
<example>
# dpkg -P --force-depends exim
# apt-get install nullmailer         # ou ssmtp
</example> 

<sect2 id="exim-start">Smarthost
<p>
Se você está executando o <prgn>exim</prgn> em um sistema que está conectado
através dos serviços voltados ao consumidor, por favor, certifique-se de
enviar suas mensagens de saída através de um smarthost oferecido por seu ISP
ou alguns outros.
<footnote>
Você precisa seguir essa regra para quaisquer hosts em serviços de conexão
discada, DSL, cabo, ou LAN através de algum roteador de banda larga. Mesmo
se seu sistema doméstico tiver um IP fixo a partir de seu provedor (ISP),
ainda é uma boa idéia seguir essa regra. Muitas estações de trabalho e
servidores domésticos caem nessa categoria.
</footnote>
Há algumas boas razões:
<list compact>
<item> para garantir novas tentativas do SMTP já que o smarthost de seu
provedor geralmente tem uma conexão mais confiável.
<item>para evitar envio de mensagens diretamente a partir de um
<strong>endereço IP dinâmico</strong> que serão muitas vezes bloqueados por
listas de spam dial-up.
<item>para salvar sua largura de banda local para enviar mensagens com
múltiplos destinatários.
</list>
<p>
As únicas exceções concebíveis são:
<list compact>
<item>a solução de emergência para um problema no serviço de SMTP do seu
provedor.
<item>um experimento para propósitos educacionais.
<item>seu sistema se tornando um servidor profissional.
</list>

<sect2 id="exim-base">Configuração básica do Exim
<p>
Para usar o <prgn>exim</prgn> como seu MTA, configure o seguinte:
<example>
/etc/exim/exim.conf     "eximconfig" para criar e editar
/etc/inetd.conf         comente smtp para executar o exim como daemon
/etc/email-addresses    Adicione listas de endereços fontes falsos
verifique filtros usando exim -brw, -bf, -bF, -bV, ... etc.
</example>

<sect2 id="addr-catchall">Definindo um pega-tudo (catchall) para endereços de email
inexistentes sob o Exim
<p>
No <file>/etc/exim/exim.conf</file> (Woody ou posterior),
na parte DIRECTORS, adicione no fim (depois do direcionador localuser:)
um direcionador pega-tudo que seleciona  todos os endereços que o direcionador
anterior não puder resolver (por Miquel van Smoorenburg):
<example>
catchall:
  driver = smartuser
    new_address = <var>webmaster@meudominio.com</var>
</example>
<p>
Se desejar ter uma receita mais detalhada para cada domínio virtual, etc,
adicione o seguinte no fim de <file>/etc/exim/exim.conf</file> 
(por mim, não foi bem testado):
<example>
*@seudominio.com ${lookup{$1}lsearch*{/etc/email-addresses} \
        {$value}fail} T
</example>
Então tenha uma entrada "*" em <file>/etc/email-addresses</file>.
</sect2>

<sect2 id="addr-rewrite">Configurando reescrita seletiva de endereço para mensagens de saída
sob o Exim
<p>
<!-- Derrick 'dman' Hudson dman@dman.ddts.net -->
Pode-se fazer a reescrita seletiva de endereços para mensagens de saída para
produzir cabeçalhos "From:" apropriados para o <prgn>exim</prgn> configurando 
próximo do fim de <file>/etc/exim/exim.conf</file>:
<example>
*@maquina1.algumacoisa.dnsdinam.org \
  "${if eq {${lookup{$1}lsearch{/etc/passwd}{1}{0}}} {1}  \
   {$0}{$1@algumacoisa.dnsdinam.org}}"  frFs
</example>
Isso reescreve todos os endereços combinando com <tt>*@maquina1.algumacoisa.dnsdinam.org</tt>.
<enumlist>
<item>Procura-se através de <file>/etc/password</file> para ver se a parte local ($1)
   é um usuário local ou não.
<item>Se for um usuário local, o endereço é reescrito como a mesma coisa que era
   na primeira posição ($0).
<item>Se não for um usuário local, é reescrito a parte do domínio.
</enumlist>

<sect2 id="smtp-aauth">Configurando autenticação SMTP sob o Exim
<p>
Alguns serviços SMTP como yahoo.com requerem autenticação SMTP. Configure o
arquivo <file>/etc/exim/exim.conf</file> como a seguir:
<example>
remote_smtp:
  driver = smtp
  authenticate_hosts = smtp.mail.yahoo.com
...

smarthost:
  driver = domainlist
  transport = remote_smtp
  route_list = "* smtp.mail.yahoo.com bydns_a"
...

plain:
  driver = plaintext
  public_name = PLAIN
  client_send = "^cmatheson3^this_is_my_password"
</example>
Não esqueça das aspas na última linha.

<sect1 id="fetchmail">Baixando mensagens &ndash; Fetchmail
<p>
O <prgn>fetchmail</prgn> é executado em modo daemon para baixar as mensagens de
uma conta POP3 com um ISP para o sistema de correio local. Configure:
<example>
/etc/init.d/fetchmail   
/etc/rc?.d/???fetchmail executa update-rc.d fetchmail com prioridade padrão 30
/etc/fetchmailrc        arquivo de configuração (chown 600, de propriedade de fetchmail)
</example>
<p>
As informações sobre como iniciar o <prgn>fetchmail</prgn> como um daemon a partir do
script <prgn>init.d</prgn> para o Potato são confusas (no Woody isso foi
resolvido). Veja os arquivos de exemplo <file>/etc/init.d/fetchmail</file> e
<file>/etc/fetchmailrc</file> nos <url id="&examples;" name="scripts de exemplo">.
<p>
Se seus cabeçalhos das mensagens estiverem contaminados com ^M devido ao
servidor de correio de seu ISP, adicione "stripcr" às suas opções em
<file>$HOME/.fetchmailrc</file>: 
<example>
options fetchall no keep stripcr
</example>
</sect1>

<sect1 id="procmail">Processando mensagens &ndash; Procmail
<p>
O <prgn>procmail</prgn> é um programa de entrega de correio local e de filtro. É
necessário criar <file>$HOME/.procmailrc</file> para cada conta que
usá-lo. Exemplo: 
<url id="&examples;" name="_procmailrc">
</sect1>

<sect1 id="mutt">Lendo mensagens &ndash; Mutt
<p>
Use o <prgn>mutt</prgn> como o agente de correio do usuário (MUA) combinado
com o <prgn>vim</prgn>.
Personalize com <file>~/.muttrc</file>; por exemplo:

<example>
# usar modo visual e "gq" para reformatar citações
set editor="vim -c 'set tw=72 et ft=mail'"
#
# supressão de cabeçalho tomada do manual (Sven's Draconian header weeding)
#
ignore *
unignore from: date subject to cc
unignore user-agent x-mailer
hdr_order from subject to cc date user-agent x-mailer
auto_view application/msword
....
</example>
<p>
Adicione o seguinte ao <file>/etc/mailcap</file> ou
<file>$HOME/.mailcap</file> para exibir mensagens em HTML e anexos MS Word em
seguida: 
<example>
text/html; lynx -force_html &percnt;s; needsterminal;
application/msword; /usr/bin/antiword '&percnt;s'; copiousoutput;
description="Microsoft Word Text"; nametemplate=&percnt;s.doc
</example>

</sect1>

</sect>

<sect id="l10n">Localização
<p>
O &debian; é internationalizado, oferecendo suporte a um número crescente de
idiomas e convenções de uso locais. A próxima subseção lista algumas das formas
de diversidade que o &debian; suporta atualmente, e as subseções seguintes
discutem a <strong>localização</strong>, o processo de personalização de seu
ambiente de trabalho para permitir entrada e saída atuais de seu(s) idioma(s)
escolhido(s) e convenções para datas, formatos numéricos e monetários, e outros
aspectos de um sistema que variam de acordo com sua região.

<sect1 id="languages">Básico da localização
<p>
Há vários detalhes para a personalização da localização e suporte a idioma
nativo.


<sect2 id="keyboard">Localizando o teclado
<p>
O &debian; é distribuído com mapas de teclado para aproximadamente duas dúzias
de teclados.  No Woody, reconfigure o teclado com:

<list compact>
<item><tt>dpkg-reconfigure --priority=low console-data # console</tt>
<item><tt>dpkg-reconfigure --priority=low xserver-xfree86   # XF4</tt>
<item><tt>dpkg-reconfigure --priority=low xserver-common-v3 # XF3</tt>
</list>
</sect2>

<sect2 id="data-stream">Localizando arquivos de dados
<p>
A grande maioria dos pacotes de software do Debian suporta manipulação de
caracteres não-US-ASCII através da variável de ambiente LC_CTYPE oferecida
pela tecnologia <strong>locale</strong> na glibc. 
   
    <list compact>
    <item>8-bit limpo: praticamente todos os programas
    <item>outros conjuntos de caracteres Latinos  (por exemplo ISO-8859-1 ou
      ISO-8859-2): a maioria dos programas
    <item>idiomas multi-byte como Chinês, Japonês, ou Coreano:
                  muitas aplicações novas
    </list>
</sect2>

<sect2 id="display">Localizando a exibição
<p>
O X pode exibir qualquer codificação, incluindo UTF-8, e suporta todas as
fontes.  A lista inclui não apenas todas as fontes de 8 bits mas também
fontes de 16 bits tais como Chinês, Japonês, ou Coreano. O método de entrada
de caracter multi-byte é suportado pelo mecanismo <ref id="x-input">.   Veja
<ref id="x-cjk"> e <ref id="x-utf-8">.
<p>
A exibição código Japonês EUC também é disponível em console gráfico (S)VGA
através do pacote <package>kon2</package>.  Há um novo display Japonês
alternativo, <package>jfbterm</package> que usa um console frame-buffer, também.
Nesses ambientes de console, o método de entrada Japonês precisa ser fornecido
pela aplicação. Use o pacote <package>egg</package> para o Emacs e use o pacote
<package>jvim</package> "japonesado" para o ambiente Vim.
<p>
A instalação de fontes não Unicode no X ajudará na exibição de documentos
com qualquer codificação no X. Então não se preocupe muito com a codificação
das fontes.
</sect2>

<sect2 id="translation">Localizando mensagens e documentação
<p>
Existem traduções para muitas mensagens e documentos que são exibidos no sistema
    &debian;, tais como mensagens de erro, saída de programa padrão,
    menus, e páginas de manual. Atualmente, existe suporte para páginas de
    manual em Alemão, Espanhol, Finlandês, Francês, Húngaro, Italiano,
    Japonês, Coreano, Polonês, Português, Chinês e Russo através dos pacotes
    <tt>manpages-<var>LANG</var></tt> (onde <var>LANG</var> é uma lista
    separada por vírgulas de códigos de país ISO de duas letras.  Use
    <tt>apt-cache search manpages-|less</tt> para obter uma lista das
    páginas de manual Unix disponíveis.) 
    <p>
    Para acessar uma página de manual NLS, o usuário precisa definir a variável
    de ambiente LC_MESSAGES para o valor apropriado. Por exemplo, no caso das
    páginas de manual da língua italiana, LC_MESSAGES precisa ser configurada
    para <tt>it</tt>.  O programa <prgn/man/ então procurará por páginas de
    manual italianas sob <file>/usr/share/man/it/</file>.
</sect2>
</sect1>

<sect1 id="locales">Locales
<p>
O Debian suporta a tecnologia <strong>locale</strong>.  Locale é um mecanismo
que permite que um programa forneça saída apropriada e funcionalidade de acordo
com as convenções locais como conjunto de caracteres, formato de data e hora,
símbolo da moeda, e outros. Ele usa variáveis de ambiente para determinar o
comportamento apropriado. Por exemplo, considerando que você tenha ambos os
locales Inglês Americano e Alemão instalados em seu sistema, as mensagens de
erro de muitos programas podem ser multi-idiomas:
<example>
$ LANG="en_US" cat foo
cat: foo: No such file or directory
$ LANG="de_DE" cat foo
cat: foo: Datei oder Verzeichnis nicht gefunden
</example>
A Glibc oferece suporte a essa funcionalidade como uma biblioteca. Veja
<manref name="locale" section="7">.

<sect1 id="base-locale">Introdução a locales
<p>
A descrição completa de locale consiste de 3 partes: <tt>xx_YY.ZZZZ</tt>.
<list compact>
<item><strong><tt>xx</tt></strong>: códigos de idioma ISO 639 (minúsculas)
<item><strong><tt>YY</tt></strong>: códigos de país ISO 3166 (maiúsculas)
<item><strong><tt>ZZZZ</tt></strong>: codeset, i.e., conjunto de caracteres
ou identificador de codificação.
</list>
<p>
Para códigos de idiomas e códigos de países, veja a descrição pertinente no
<tt>info gettext</tt>.
<p>
Por favor, note que essa parte de codeset pode ser normalizada internamente
para obter compatibilidade sobre plataformas removendo todos os <tt>-</tt> e
convertendo todos os caracteres para minúsculas. Codesets típicos são:
<list compact>
  <item><strong>UTF-8</strong>: Unicode para todas as regiões, normalmente
       em 1-3 Octetos (novo padrão de facto)
  <item><strong>ISO-8859-1</strong>: Europa ocidental (padrão de facto
       antigo)
  <item><strong>ISO-8859-2</strong>: Europe oriental (Bósnio, Croata, Tcheco,
       Húngaro, Polonês, Romeno, Sérvio, Eslovaco,  Eslovênio)
  <item><strong>ISO-8859-3</strong>: Maltês
  <item><strong>ISO-8859-5</strong>: Macedônio, Sérvio
  <item><strong>ISO-8859-6</strong>: Árabe
  <item><strong>ISO-8859-7</strong>: Grego
  <item><strong>ISO-8859-8</strong>: Hebreu
  <item><strong>ISO-8859-9</strong>: Turco
  <item><strong>ISO-8859-11</strong>: Thai (=TIS-620)
  <item><strong>ISO-8859-13</strong>: Letão, Lituano, Maori
  <item><strong>ISO-8859-14</strong>: Galês (Welsh)
  <item><strong>ISO-8859-15</strong>: Europe ocidental com euro
  <item><strong>KOI8-R</strong>: Russo
  <item><strong>KOI8-U</strong>: Ucraniano
  <item><strong>CP1250</strong>: Tcheco, Húngaro, Polonês (original do MS Windows)
  <item><strong>CP1251</strong>: Búlgaro, Bielorrusso (original do MS Windows)
  <item><strong>eucJP</strong>: Japonês estilo Unix (=ujis)
  <item><strong>eucKR</strong>: Coreano estilo Unix 
  <item><strong>GB2312</strong>: Chinês Simplificado estilo Unix (=GB,
       =eucCN) para zh_CN
  <item><strong>Big5</strong>: Chinês Tradicional para  zh_TW
  <item><strong>sjis</strong>: Japonês estilo Microsoft (Shift-JIS) 
</list>
Sobre o significado de jargões básicos de sistema de codificação:
<list compact>
<item><strong>ASCII</strong>: 7 bits (0-0x7f)
<item><strong>ISO-8859-?</strong>: 8 bits (0-0xff)
<item><strong>ISO-10646-1</strong>: Conjunto de Caracteres Universal (UCS) (31 bits, 0-0x7fffffff)
<item><strong>UCS-2</strong>: Primeiros 16 bit do UCS como 2 Octetos seguidos (Unicode: 0-0xffff)
<item><strong>UCS-4</strong>: UCS como 4 Octetos seguidos (UCS: 0-0x7fffffff)
<item><strong>UTF-8</strong>: UCS codificado em 1-6 Octetos (normalmente em 3 Octetos)
<item><strong>ISO-2022</strong>: 7 bits (0-0xff) com a seqüência de escape.
ISO-2022-JP é a codificação mais popular para o e-mail japonês.
<item><strong>EUC</strong>: combinação 8 bits + 16 bits (0-0xff), estilo Unix
<item><strong>Shift-JIS</strong>: combinação 8 bits + 16 bits (0-0xff),
estilo Microsoft.
</list>
ISO-8859-?, EUC, ISO-10646-1, UCS-2, UCS-4, e UTF-8 compartilham o mesmo
código com ASCII para os caracteres de 7 bit. EUC ou Shift-JIS usam
caracteres de bit alto (0x80-0xff) para indicar que parte da codificação é
16 bit. UTF-8 também usa caracteres de bit alto (0x80-0xff) para indicar
bytes de seqüência de caracter de não 7 bit e essa é a forma mais
inteligente de um sistema de codificação lidar com caracteres não-ASCII.
<p>
Por favor, note a diferença de ordem de byte da implementação Unicode:
<list compact>
<item><strong>UCS-2, UCS-4 padrões</strong>: big endian
<item><strong>UCS-2, UCS-4 Microsoft</strong>: little endian para ix86
(dependente de máquina)
</list>
Para mais detalhes veja <url id="&intro-i18n;" name="Introdução a i18n">.

<sect1 id="activate-locales">Ativando suporte a locale
<p>
O &debian; <strong>não</strong> vem com todos os locales disponíveis
pré-compilados. Verifique <file>/usr/lib/locale</file> para ver quais 
locales (além do padrão "C") estão compilados para seu sistema. Se o que você
precisar não estiver presente, você tem duas opções:
<list compact>
 <item>Editar o <file>/etc/locale.gen</file> para adicionar o locale desejado, e
   então executar <prgn>locale-gen</prgn> como root para compilá-lo. Veja <manref
   name="locale-gen" section="8"> e páginas de manual listadas em sua seção "SEE
   ALSO".
 <item>Executar <tt>dpkg-reconfigure locales</tt> para reconfigurar o pacote
   <package>locales</package> . Ou se ele ainda não estiver instalado, instalar
   <package>locales</package> chamará a interface debconf para permitir-lhe
   a escolha dos locales necessários e compilar a base de dados.
 <!--  XXX FIXME XXX 
 <item>Run <prgn>localedef</prgn> manually from user account to compile 
   the locale database and use it by setting 
   <tt>LOC_PATH</tt> 
   environment variable.  For example for <tt>en_GB.UTF-8</tt>:
   <example>
$ localedef -v -c -i en_GB -f UTF-8 <var>somewhere/</var>en_GB.UTF-8
$ export LOC_PATH=<var>somewhere/</var>
   </example>
 -->
</list>

<sect1 id="env-locale">Ativando um locale específico
<p>
As seguintes variáveis de ambiente são avaliadas nessa ordem para fornecer
valores particulares de locale para os programas:
<enumlist>
<item>LANGUAGE: Essa variável de ambiente consiste de uma lista de nomes de
      locale em ordem de prioridade. Usada somente se o locale  POSIX
      estiver definido para um valor diferente de "C" [no Woody; na versão
      Potato sempre tinha prioridade sobre o locale POSIX]. (extensão GNU)
<item>LC_ALL: Se  for não nula, o valor é usado para todas as categorias de
      locale. (POSIX.1) Geralmente "" (null).
<item>LC_*: Se for não nula, seu valor é usado para a categoria correspondente
      (POSIX.1).  Geralmente "C". 
<p>
      As variáveis LC_*  são:
 <list compact>
<item>LC_CTYPE: Classificação de caracteres e conversão maiúsculas/minúsculas.
<item>LC_COLLATE: Ordem de comparação.
<item>LC_TIME: Formatos de data e hora.
<item>LC_NUMERIC: Formatos numéricos não monetários.
<item>LC_MONETARY: Formatos monetários.
<item>LC_MESSAGES: Formatos de mensagens informativas e de diagnóstico e
  respostas interativas.
<item>LC_PAPER: Tamanho de papel.
<item>LC_NAME: Formatos de nome.
<item>LC_ADDRESS: Formatos de endereço e informação de localização.
<item>LC_TELEPHONE: Formatos de número de telefone.
<item>LC_MEASUREMENT: Unidades de medidas (Métricas ou Outras).
<item>LC_IDENTIFICATION: Metadado sobre informação de locale.
 </list>
<item>LANG:   Se for não nula e LC_ALL for indefinida, o valor é usado para
      todas as categorias LC_* de locale com valores indefinidos. (POSIX.1)
      Geralmente é "C".
</enumlist>
Note que algumas aplicações (por exemplo, Netscape 4) ignoram configurações
LC_*. 
<p>
O programa <prgn>locale</prgn> pode exibir as configurações ativas de locale e
os locales disponíveis; veja <manref name="locale" section="1">. (NOTA: <tt>locale
-a</tt> lista todos os locales que seu sistema conhece; isso <em>não</em>
significa que todos eles estão compilados!  Veja <ref id="activate-locales">.)


<sect1 id="ISO-locale">Locale de formato de data ISO 8601
<p>
O suporte de locale para o padrão internacional de data de <tt>yyyy-mm-dd</tt>
(formato de data ISO 8601) é fornecido pelo locale chamado <tt>en_DK</tt>, 
"Inglês na Dinamarca", o que é um pouco de brincadeira :-)
Isso parece funcionar apenas em tela de console para o <prgn>ls</prgn>.

<!-- beyond locale moved to below -->

<sect1 id="iso-8859-1">Exemplo para os Estados Unidos (ISO-8859-1)
<p>
Adicione as seguintes linhas ao <file>~/.bash_profile</file>:
<example>
LC_CTYPE=en_US.ISO-8859-1
export LC_CTYPE
</example>

<sect1 id="france">Exemplo para a França com o sinal de Euro (ISO-8859-15)
<p>
Adicione as seguintes linhas ao <file>~/.bash_profile</file>:
<example>
LANG=fr_FR@euro
export LANG
LC_CTYPE=fr_FR@euro
export LC_CTYPE
</example>
<p>
Configure o teclado para o "AZERTY" Francês como descrito em  <ref id="keyboard">;
adicione as páginas de manual em francês instalando <package>manpages-fr</package>.
A tecla Alt-direito nos Estados Unidos é chamada  Alt-Gr na Europa.
Pressioná-lo junto com algumas teclas cria vários caracteres acentuados e
caracteres especiais. Por exemplo, Alt-Gr+E cria um sinal de Euro.
<p>
Muitas línguas da Europa ocidental podem ser configuradas similarmente.
<p>
Veja o <url id="&debian-euro-support;" name="Debian Euro HOWTO"> para  
adicionar suporte para a nova moeda Euro e 
<url id="&debian-fr-howto;" name="Utiliser et configurer Debian pour le français"> 
para mais detalhes em francês.

<sect1 id="x-cjk">Exemplo para um sistema X window multi-idiomas
<p>
Vamos configurar um sistema X window multi-idioma que suporta
simultaneamente japonês, inglês, alemão e francês com as codificações EUC, 
UTF-8 e ISO-8859-1  em diferentes consoles.
<p>
Eu mostrarei a você uma personalização usando o sistema de menus do &debian;.
Veja os detalhes do sistema de menus do &debian; em <url id="&f-menu;">. Também
criarei um atalho para o navegador web <prgn>mozilla</prgn> nesse exemplo.
 <footnote>
Nesse exemplo, são desenvolvidos 2 desvios de bugs para a versão do
<prgn>blackbox</prgn> em 2003. Eu uso <tt>sh -c</tt> em  comando. Além disso a
entrada <file>~/.menu/*</file> não é usada mas ao invés disso foi usada
<file>/etc/menu/*</file> que requer root.
 </footnote>
<list>

 <item>adicione um suporte para o locale ja_JP.eucJP Japonês e os outros locales
  requeridos usando o método descrito em <ref id="l10n">. (para todos)

 <item>instale o sistema de conversão Kana-para-Kanji e dicionário (para
 japonês):
  <list compact>
  <item><package>canna</package> &ndash; Servidor local (licença "cerveja
   grátis" (free-beer)), ou
  <item><package>freewnn-jserver</package> &ndash; Servidor extensível por rede 
   (Domínio Público)
  </list>

 <item>instale o sistema de método de entrada Japonês (para japonês):
  <list compact>
  <item><package>kinput2-canna</package> &ndash; para o X, ou
  <item><package>kinput2-canna-wnn</package> &ndash; para o X, e
  <item><package>egg</package> &ndash; funciona diretamente com Emacsen mesmo 
    em console (opcional)
  </list>

 <item>Instale terminais compatíveis (para todos):
  <list compact>
  <item><package>xterm</package> &ndash; X (para ISO-8859-1 and UTF-8),
  <item><package>kterm</package> &ndash; X (para Japonês EUC), e
  <item><package>mlterm</package> &ndash; X (multi-idioma).
  </list>

 <item>adicione todos os pacotes de fontes requeridos. (para todos)
 
 <item>crie um <file>~/.xsession</file> que defina um ambiente X específico do
 usuário como descrito em <ref id="custom-x"> (para todos): 

<example>
#!/bin/sh
# Isso faz o X funcionar quando uso su para root.
if [ -z "$XAUTHORITY" ]; then
        XAUTHORITY=$HOME/.Xauthority
        export XAUTHORITY
fi

# Definir ambiente específico através do sistema de menus debian.
# Redefinir locale
unset LC_CTYPE LC_NUMERIC LC_TIME LC_COLLATE LC_MONETARY LC_MESSAGES 
unset LC_PAPER LC_NAME LC_ADDRESS LC_TELEPHONE LC_MEASUREMENT 
unset LC_IDENTIFICATION LC_ALL LANG LANGUAGE PAGER
# ajustar padrão de locale no X
LANG=C
# exportar locale
export LC_CTYPE LC_NUMERIC LC_TIME LC_COLLATE LC_MONETARY LC_MESSAGES 
export LC_PAPER LC_NAME LC_ADDRESS LC_TELEPHONE LC_MEASUREMENT 
export LC_IDENTIFICATION LC_ALL LANG LANGUAGE PAGER
###
# activar método de entrada para japonês com kinput2
kinput2 &        
XMODIFIERS="@im=kinput2"
export XMODIFIERS
# Sobre o gerenciador de janelas blackbox (leve)
exec blackbox
#exec xfwm
#exec wmaker
</example>

 <item>ajuste o locale em <file>~/.bash_profile</file> para consoles Linux (para
 todos).

 <item>remova todos os ajustes de locale em <file>~/.bashrc</file>, se existiram
 (para todos).

 <item>crie alguns arquivos em <file>/etc/menu/</file> (para todos).
 <list compact>
 <item><file>/etc/menu/xterm-local</file>: (adicione novas entradas ao menu)
 <footnote>
Use um nome de arquivo que não conflite com quaisquer nomes de pacotes.
 </footnote>
<example>
?package(xterm):\
 needs=x11\
 section=XShells\
 longtitle="XTerm: emulador de terminal (en_US.ISO-8859-1)"\
 title="XTerm (en_US.ISO-8859-1)"\
 command="sh -c 'LC_ALL=en_US.ISO-8859-1 xterm'"
?package(xterm):\
 needs=x11\
 section=XShells\
 longtitle="XTerm: emulador de terminal (de_DE.ISO-8859-1)"\
 title="XTerm (de_DE.ISO-8859-1)"\
 command="sh -c 'LC_ALL=de_DE.ISO-8859-1 xterm -T xterm-de'"
?package(xterm):\
 needs=x11\
 section=XShells\
 longtitle="XTerm: emulador de terminal para o X com suporte Unicode (Japonês)"\
 title="UXTerm (ja_JP.UTF-8)"\
 command="sh -c 'LC_ALL=ja_JP.UTF-8 uxterm'"
</example>
 <item><file>/etc/menu/kterm</file>: (sobrepõe o padrão do sistema)
 <footnote>
Use um nome de arquivo que sobrepõe (overwrap) o nome do pacote.
 </footnote>
<example>
?package(kterm):\
 needs="x11"\
 section="XShells"\
 command="sh -c 'LC_ALL=ja_JP.eucJP PAGER=w3m /usr/X11R6/bin/kterm -xim'" \
 title="Kanji Terminal"
?package(kterm):\
 needs="x11"\
 section="XShells"\
 command="sh -c 'LANG=ja_JP.eucJP \
          LC_MESSAGES=en_US.ISO-8859-1 PAGER=w3m /usr/X11R6/bin/kterm -xim'" \
 title="Terminal Kanji (bilíngüe)"
</example>
 <item> <file>/etc/menu/mozilla-local</file>: (adicionar um novo atalho)
 <footnote>
 A barra em <tt>section="/"</tt> habilita entrada no menu inicial, e o espaço no
 começo em <tt>title=" Navegador Mozilla"</tt> habilita entrada no topo da
 lista.
 </footnote>
<example>
?package(mozilla-browser):needs="x11" section="/" \
        title=" Navegador Mozilla" command="mozilla-1.5" hints="Navegadores Web" \
        icon=/usr/share/pixmaps/mozilla.xpm
</example>
 <item>execute <prgn>update-menus</prgn> a partir da conta root.
 </list>
 <item>adicione as seguintes linhas ao arquivo <file>~/.muttrc</file> (para
 japonês):
<example>
# Suporte a UTF-8 não é popular no ambiente EMACS japonês
# codificação de 7-bit iso-2022-jp é mais fácil para todos.
# ordem de codificação padrão = us-ascii --&gt; iso-8859-1 --&gt; iso-2022-jp
set send_charset="us-ascii:iso-8859-1:iso-2022-jp"
set allow_8bit=no
</example>
 <item>ative XIM <prgn>kinput2</prgn> para aplicações X (para japonês)
  <list compact>
  <item>adicione <tt>*inputMethod: kinput2</tt> e <tt>KTerm*VT100*OpenIm:
  true</tt> em seu arquivo de recursos  X, <file>~/.Xresources</file>  (parece
  que o Debian cuida disso automaticamente de alguma forma).
  <item>Algumas aplicações (como <prgn>mlterm</prgn>) também permitem que você 
  configure <tt>*inputMethod:</tt> e outras informações dinamicamente durante a
  execução (pressione <strong>Ctrl-BotãoMouse-3</strong> no <prgn>mlterm</prgn>).
  </list>
 <item>inicie o X digitando <tt>startx</tt> ou a partir de um dos
 gerenciadores de display (<prgn>xdm</prgn>, <prgn>gdm</prgn>,
 <prgn>kdm</prgn>, <prgn>wdm</prgn>, ...) (para todos).
 <item>inicie uma aplicação compatível com japonês como  
  Vim 6, (x)emacs21, mc-4.5, mutt-1.4, ... no <prgn>kterm</prgn> (para japonês).
  (Emacs parece ser a plataforma mais popular, apesar de eu não usá-lo.)
 <item>pressione <strong>Shift+Espaço</strong> para alternar entre modo de
  entrada de caracter japonês ligado e desligado (para japonês).
 <item>leia a página de manual localizada iniciando o comando em um console
 localizado (para todos).
</list>
Para outros suportes a idioma CJK, veja as seções seguintes e as <url
id="&suse-cjk;" name="páginas da SuSE para CJK">. 

<sect1 id="x-input">Métodos de entrada X alternativos
<!--  I need feed back from Chinese and Korean people for here -->
<p>
Há muitos pacotes de suporte de métodos de entrada do X alternativos
disponíveis:
<example>
Idioma     LC_CTYPE     serv. XIM  XMODIFIERS              Tecla início
Japonês    ja_JP*       kinput2    "@im=kinput2"           Shift-Espaço
Coreano    ko_KR*       ami        "@im=Ami"               Shift-Espaço
Chinês(T)  zh_TW.Big5   xcin       "@im=xcin-zh_TW.big5"   Ctrl-Espaço
Chinês(S)  zh_CN.GB2312 xcin       "@im=xcin-zh_CN.GB2312" Ctrl-Espaço
</example>
<p>
O método de entrada japonês <prgn>kinput2</prgn> é oferecido pelos pacotes
como <package>kinput2-canna-wnn</package>, <package>kinput2-canna</package>,
e <package>kinput2-wnn</package>. O japonês precisa de um servidor de
dicionário tal como <package>canna</package> e
<package>freewn-jserver</package> para ser prático. 

<!--
<p>
Korean and Chinese may also use dictionary server such as 
<package>freewnn-kserver</package> and
<package>freewnn-cserver</package> too.
-->

<sect1 id="x-term">Emuladores de terminal no X
<p>
Há muitos consoles que suportam codificações de 8 bits simples quando os
pacotes de fonte pertinentes são instalados:
<list compact>
  <item><package>xterm</package> &ndash; O emulador de terminal X
  <item><package>gnome-terminal</package> &ndash; <package>xterm</package>
   para o Gnome
  <item><package>konsole</package> &ndash; <package>xterm</package> para o
   KDE
  <item><package>rxvt</package> &ndash; terminal VT102 (mais leve)
  <item><package>aterm</package> &ndash; terminal VT102 para o WM Afterstep
  <item><package>eterm</package> &ndash; terminal VT102 para o WM
   Enlightenment
  <item><package>wterm</package> &ndash; terminal VT102 para o WM
   WindowMaker
</list>
<p>
Os suportes de codificação multi-byte dos consoles X são fornecidos pelo
<package>xterm</package> através da codificação UTF-8 (<ref id="x-utf-8">).
Outros suportes de codificação tradicionais estão em progresso (em 2003).
Os seguintes pacotes oferecem suportes a codificações tradicionais:
<list compact>
  <item><package>aterm-ml</package> &ndash; Multi-idioma
  <item><package>kterm</package> &ndash; Multi-idioma (Japonês, ...)
  <item><package>rxvt-ml</package> &ndash; Multi-idioma
  <item><package>wterm-ml</package> &ndash; Multi-idioma 
  <item><package>cxterm-big5</package> &ndash; Chinês (Trad., Big5)
  <item><package>cxterm-gb</package> &ndash; Chinês (Simp., GB)
  <item><package>cxterm-ks</package> &ndash; Chinês (KS)
  <item><package>cxterm-jis</package> &ndash; Japonês
  <item><package>hanterm-classic</package> &ndash; Coreano (Hangul)
  <item><package>hanterm-xf</package> &ndash; Coreano (Hangul)
  <item><package>hztty</package> &ndash; Chinês (GB, Big5, zW/HZ)
</list>
Para o <prgn>kterm</prgn> (e possivelmente outros), você pode desejar ativar XIM
através do menu depois da ação do mouse Ctrl-click-botão_do_meio.
 
<sect1 id="x-utf-8">Exemplo para UTF-8 no X
<p>
O suporte a UTF-8 para o emulador de terminal X é fornecido pelo programa
<prgn>uxterm</prgn> no pacote <package>xterm</package> para o XFree86 4.x.
Ele habilita suporte para todos os idiomas. Ele é um wrapper sobre o
programa <manref name="xterm" section="1"> que invoca esse último com a
classe de recursos X "UXterm" definida.
<p>
Por exemplo, para habilitar uma bela exibição grande de caracteres de inglês, russo,
japonês, chinês e coreano, adicione o seguinte ao seu arquivo
<file>~/.Xresources</file> depois de instalar todas as fontes pertinentes:
<example>
! definindo fonte grande
UXTerm*font: -misc-fixed-medium-r-normal-*-18-120-100-100-c-90-iso10646-1
! Usar XIM para Japonês
*inputMethod: kinput2
</example>
Então execute <tt>xrdb -merge ~/.Xresources</tt> para atualizar os recursos
X como descrito em <ref id="xresources">.
<p>
Entretanto, muitos dos pacotes de programas de console populares como o
<package>vim</package>, <package>mutt</package>, e <package>emacs</package>
tornaram-se compatíveis com UTF-8 recentemente (Woody-Sarge). Programa como
o <package>mc</package> ainda não é compatível com UTF-8 mas é simplesmente
8 bits limpos. Se você está editando com a parte de 7 bit ASCII de um
arquivo de codificação desconhecida ou mista, é mais seguro usar o editor de
8 bits limpos sem locale.
<p>
Veja <url id="&unicode-howto;" name="The Unicode HOWTO">.

<sect1 id="fb-utf-8">Exemplo para UTF-8 em  um console framebuffer
<p>
O suporte UTF-8 em um console FB é fornecido pelo <package>bterm</package>
e é usado no <prgn>debian-installer</prgn>.

<sect1 id="beyond-locale">Além dos locales
<p>
Quando você estiver configurando o sistema para um <strong>ambiente de idioma
nativo</strong> pela primeira vez, por favor, pense em usar o
<prgn>tasksel</prgn> ou o <prgn>aptitude</prgn> para determinar quais pacotes
são selecionados ao escolher a tarefa de ambiente de idioma correspondente. É
útil fazer escolha de pacote mesmo para a configuração multi-idioma.  Se você
encontrar algum conflito de dependência de pacote durante a instalação de seu
sistema configurado cuidadosamente,  evite instalar qualquer software que
conflite com o sistema existente. Você pode ter que usar o
<prgn>update-alternative</prgn> para obter o estado original novamente para
alguns comandos, já que um recém instalado pode ter uma prioridade mais alta que
os já existentes.
<p>
Os maiores e mais novos programas estão usando a glibc 2.2 e muitas vezes são
internacionalizados.  Então uma versão especialmente localizada como o
<prgn>jvim</prgn> para o Vim não deve ser necessária já que sua funcionalidade é 
oferecida pela versão 6.0 do <prgn>vim</prgn> no X.  Na verdade, ainda está um 
pouco grosseiro.  Já que o <prgn>jvim</prgn> tem uma versão compilada com
suporte de método de entrada japonês direto (<prgn>canna</prgn>) mesmo no
console e resolve muitos outros problemas específicos do Japonês de forma
madura, você pode ainda querê-lo :-) 
<p>
Os programas podem precisar ter configuração além do <tt>locale</tt> 
para se ter um ambiente de trabalho confortável.  O pacote
<package>language-env</package> e seu comando <prgn>set-language-env</prgn>
facilita enormemente esse processo.
<p>
Veja também o documento de internacionalização, <url id="&intro-i18n;" 
name="Introdução a i18n">. Ele é dedicado aos desenvolvedores mas também é útil
para os administradores de sistema.
</sect1>

</sect>
</chapt>

