<!-- CVS revision of this document "# Revision is not used here.#"  -->
<!-- CVS revision of original english document "1.80"  -->

<chapt id="install">Wskazówki dotyczące instalacji Debiana

<p>
Oficjalna dokumentacja znajduje się na
<url id="&stable-info;">, i
<url id="&stable-install;">.
<p>
Natomiast wersje rozwojowe na
<url id="&testing-info;" >, i
<url id="&testing-install;"> (ciągle nad tym pracujemy).
<p>
Pomimo, że ten rozdział został napisany podczas gdy używano instalatora Potato,
większość zawartości została zaktualizowana do instalatora z Woodiego, ale
są one dość podobne. Ponieważ Sarge będzie używał zupełnie nowego
instalatora, używaj tego rozdziału jako wprowadzenie.

<sect>Główne wskazówki dotyczące instalacji systemu Linux
<p>
Nie zapomnij sprawdzić <url id="&debian-netinst;"> jeśli szukasz
skromniejszego obrazu CD instalatora systemu &debian;.
<p>
Używanie wersji <tt>testing</tt> lub <tt>unstable</tt> Debiana zwiększa ryzyko 
poważnych błędów. Ryzyko może zostać ograniczone poprzez używanie 
wielorozruchowego schematu z bardziej stabilną wersją, lub stosując 
<prgn>chroot</prgn> tak jak jest to opisane w <ref id="chroot">.  Ten drugi 
sposób pozwoli na używanie różnych wersji Debiana jednocześnie na 
różnych konsolach.
<p>

<sect1>Podstawy zgodności sprzętowych
<p>
Linux współpracuje z większością sprzętu PC i może być zainstalowany
prawie na każdej maszynie. Dla mnie było to równie łatwe jak instalacja Windowsa 95/98/Me.
Lista wspieranego sprzętu stale się powiększa.
<p>
Jeśli masz laptopa, sprawdź
<url id="&linonlap;" name="Linux on Laptops">
w celu uzyskania wskazówek dotyczących modelu i marki.
<p>
Moja rekomendacja dla sprzętu PC to:
<list compact>
<item>SCSI zamiast IDE do pracy, IDE/ATAPI HD do użytku prywatnego.
<item>IDE/ATAPI CD-ROM (lub CD-RW).
<item>PCI zamiast ISA, zwłaszcza dla kart sieciowych (NIC).
<item>Użyć układu NIC. Dobre są Tulip dla PCI, NE2000 dla ISA.
<item>Unikać PCMCIA (notebook) przy pierwszej instalacji.
<item>Żadnej myszki, klawiatury itp. na USB, chyba, że lubisz wyzwania :)
</list>
<p>
Jeśli masz wolny komputer to dobrym pomysłem jest podłączenie dysku
do szybszej maszyny na czas instalacji.
</sect1>

<sect1>Określanie informacji o sprzęcie i układach płyty głównej.
<p>
Podczas instalacji będziesz musiał wybrać rodzaj swojego sprzętu lub układ 
płyty głównej. Czasami nie jest łatwo znaleźć takie informacje.
Proponuję wówczas:
<enumlist compact>
  <item>Rozkręć swój komputer i zajrzyj do środka.
  <item>Spisz numery większych układów na karcie graficznej i sieciowej,
  chip blisko portu szeregowego i IDE.
  <item>Spisz nazwy kart PCI i ISA, patrząc na ich tylną stronę.
</enumlist>
</sect1>

<sect1>Określanie informacji o sprzęcie za pomocą Debiana;
<p>
Następujące polecenia powinny Cię naprowadzić na rodzaj sprzętu i jego 
konfigurację.
<example>
$ lspci -v |pager
$ pager /proc/pci
$ pager /proc/interrupts
$ pager /proc/ioports
$ pager /proc/bus/usb/devices
</example>
Polecenia te mogą być wydawane podczas instalacji. W celu włączenia konsoli
wciśnij Alt-F2.
 <p>
 Typowa lista przerwań:
  	 <list compact>
  	 <item>IRQ0: timer output (8254)
  	 <item>IRQ1: kontroler klawiatury
  	 <item>IRQ2: kaskadowe połączenie z IRQ8&ndash;IRQ15 w PC-AT
  	 <item>IRQ3: drugi port szeregowy (io-port=0x2F8) (<file>/dev/ttyS1</file>)
  	 <item>IRQ4: drugi port szeregowy (io-port=0x3F8) (<file>/dev/ttyS0</file>)
  	 <item>IRQ5: wolne (bylo to przerwanie HD w komputerach klasy XT)
  	 <item>IRQ6: kontroler stacji dyskietek (io-port=0x3F0) (<file>/dev/fd0</file>, <file>/dev/fd1</file>)
  	 <item>IRQ7: port równoległy (io-port=0x378) (<file>/dev/lp0</file>)
  	 <item>IRQ8: rtc
  	 <item>IRQ9: przerwanie programowe (int 0x0A), przekierowanie do IRQ2
  	 <item>IRQ10: wolne
  	 <item>IRQ11: wolne
  	 <item>IRQ12: mysz PS/2
  	 <item>IRQ13: wolne (był kiedyś koprocesor 80287)
  	 <item>IRQ14: pierwszy kontroler IDE (<file>/dev/hda</file>, <file>/dev/hdb</file>)
  	 <item>IRQ15: drugi kontroler IDE (<file>/dev/hdc</file>, <file>/dev/hdd</file>)
  	 </list>
  	 <p>
<p>
Urządzenia podłączone do portów USB są wyszczególnione w
<file>/proc/bus/usb/devices</file> jako <tt>Cls=<var>nn</var></tt>:
<list compact>
<item>Cls=00 : nieużywane
<item>Cls=01 : Audio (głośniki itp.)
<item>Cls=02 : Communication (MODEM, NIC, ...)
<item>Cls=03 : HID (klawiatura, mysz, joystick itp)
<item>Cls=07 : Printer (drukarka)
<item>Cls=08 : Mass storage (pamięć masowa: FDD, napęd CD/DVD, HDD, Flash, ...)
<item>Cls=09 : Hub (USB hub)
<item>Cls=255 : specyficzny dla dostawcy
</list>
Jeśli klasa urządzenia jest różna od 255 to system je obsłuży.
</sect1>

<sect1>Określanie informacji o sprzęcie za pomocą innego systemu operacyjnego:
<p>
Informacje o sprzęcie można również uzyskać, używając innego systemu operacyjnego.
<p>
Zainstaluj inną komercyjną dystrybucję Linuksa. Wykrywanie sprzętu jest
w nich jak na razie dużo lepsze niż w Debianie. Ta sytuacja powinna się
jednak zmienić wraz z <prgn>debian-installer</prgn> 
wprowadzonym w dystrybucji Sarge.
<p>
Zainstaluj Windows. Konfiguracja sprzętowa może być ustalona poprzez kliknięcie
prawym klawiszem myszy na ikonę 'Mój komputer' w celu otworzenia właściwości, a
następnie 'Menedżera urządzeń'. Spisz wszystkie informacje takie jak IRQ, I/O adresy portów
i DMA. Niektóre stare karty ISA muszą być instalowane pod DOSem.
</sect1>

<sect1>Mity o Lilo
<p>
„Lilo jest ograniczone do 1024 cylindrów”. NIEPRAWDA !
<p>
Nowsze <prgn>lilo</prgn> używane po Debianie Potato posiada wsparcie dla
lba32. Jeśli BIOS na Twojej płycie głównej obsługuje lba32 to
<prgn>lilo</prgn> powinno być w stanie ładować spoza 1024 cylindra.
<p>
Tylko upewnij się, że istnieje wpis „lba32” w pliku <prgn>lilo.conf</prgn>
jeśli posiadasz stary odpowiednik.  Zobacz <file>&f-lilo;</file>
</sect1>

<sect1 id="instgrub">GRUB
<p>
Nowy program rozruchowy <package>grub</package> z projektu GNU Hurd może być
zainstalowany na Debianie Woody:
<example>
# apt-get update
# apt-get install grub-doc
# mc &f-grub-doc;
... przeczytaj zawartość
# apt-get install grub
# pager &f-grub;
... to też :)
</example>
By zmienić menu GRUB wyedytuj <file>&f-grub-menu;</file>. Zobacz
<ref id="bootgrub">, żeby się dowiedzieć jak to zrobić, ponieważ program ten
różni się w konfiguracji od <package>lilo</package>.
</sect1>

<sect1 id="bootfloppy">Wybór zestawu dyskietek startowych
<p>
Dla Potato i zwykłej instalacji dla domowego komputera lubię używać zestawu 
dyskietek IDEPCI. Dla Woodiego preferuję zestaw dyskietek bf2.4. Obie
używają pakietu <package>boot-floppies</package> do tworzenia dyskietek
startowych.
<p>
Jeśli posiadasz kartę sieciową PCMCIA, będziesz musiał użyć standardowego
zestawu dyskietek (większa ilość, ale wszystkie moduły sterowników są
dostępne) i skonfigurować kartę podczas ustawiania PCMCIA; nie próbuj
konfigurować karty podczas standardowej konfiguracji sieci.
<p>
Dla specyficznych systemów może wystąpić potrzeba stworzenia własnej
dyskietki ratunkowej. Można tego dokonać podmieniając obraz jądra o 
nazwie „linux” na standardowej dyskietce ratunkowej Debiana, 
na inny skompilowany wcześniej na innej maszynie. 
Szczegóły są opisane w pliku <file>readme.txt</file>, który
znajduje się na wspomnianej dyskietce. Dyskietka ratunkowa korzysta
z systemu plików MS-DOS, tak więc można użyć dowolnego systemu operacyjnego
by ją odczytać i zmodyfikować. To powinno uprościć życie ludziom
posiadającym specyficzne karty sieciowe itp. 
<p>
Dla Sarge zalecane jest używanie <prgn>debian-installer</prgn> i/lub
<package>pgi</package> do tworzenia dyskietek rozruchowych.
</sect1>

<sect1>Instalacja
<p>
Stosuj się do oficjalnych instrukcji przedstawionych na
<url id="&stable-install;">
lub
<url id="&testing-install;"> (ciągle nad tym pracujemy).
<p>
Jeśli instalujesz system używając <prgn>boot-floppies</prgn> w 
<tt>testowym</tt> wydaniu Debiana możesz być zmuszony do włączenia konsoli 
wciskając Alt-F2 i ręcznej edycji pliku <file>/etc/sources.list</file> 
w celu zmiany „stable” na „testing” by określić źródła APT.
<p>
Zamierzam umieścić <prgn>lilo</prgn> na partycji <file>/dev/hda3</file>,
podczas instalowania <prgn>mbr</prgn> na dysku <file>/dev/hda</file>. To
zmniejszy ryzyko nadpisania informacji startowych.
<p>
Podczas instalacji wybieram:
<list compact>
<item>MD5 passwords „tak”
<item>shadow passwords „tak”
<item>Instalacja „advanced” (dselect **) i wybieram
  <list compact>
    <item>Wyłączyć emacs (jeśli zaznaczony), nvi, tex, telnet, talk(d);
    <item>Załączyć mc, vim oraz nano-tiny lub elvis-tiny.
    <p>
     Zobacz <ref id="dselect">. Nawet jeśli jesteś przyzwyczajony do Emacsa
     unikaj go teraz i korzystaj z nano podczas instalacji. Na razie nie
     instaluj dużych pakietów takich jak TeX (miało to miejsce w Potato).
     Zobacz <ref id="bin-editor"> by dowiedzieć się o instalacji nano-tiny
     lub elvis-tiny.
  </list>
<item>Na wszelkie pytania podczas konfiguracji pakietów odpowiadam „y”.
<item><package>exim</package>: wybieram 2 dla maszyn ponieważ wysyłam
pocztę poprzez serwer SMTP mojego dostawcy Internetu.
</list>
<p>
Więcej informacji na temat dselect znajdziesz tu - <ref id="dselect">.
</sect1>

<sect1 id="ipmap">Nazwy hostów i adresy IP używane w sieci LAN
<p>
Przykład konfiguracji sieci LAN (C podsieć: 192.168.1.0/24):
<example>
Internet
   |
   +--- Zewnętrzny ISP zapewnia usługę POP (dostęp poprzez fetchmail)
   |
  Punkt dostępowy zapewnia usługi DHCP i SMTP
   |                     :
  Modem kablowy       (Dialup)
   |                     :
Bramka sieciowa, zewnętrzny interfejs: eth0 (numer IP przydzielony przez DHCP)
 używa starego notebooka PC (IBM Thinkpad, 486 DX2 50 MHz, 20MB RAM)
 uruchomione jądro Linux 2.4 z obsługą systemu plików ext3.
 uruchomiony pakiet „ipmasq” (z poprawkami NAT i firewall)
 uruchomiony pakiet „dhcp-client” ustawiony dla eth0 (podmienia ustawienia DNS)
 uruchomiony pakiet „dhcp” skonfigurowany dla eth1
 uruchomiony „exim” jako smarthost (tryb 2)
 uruchomiony „fetchmail” z długimi odstępami czasu (fallback)
 uruchomiony „bind” jako buforujący serwer nazw z sieci do Internetu
                    jako autorytatywny serwer nazw dla sieci wewnętrznej
 uruchomione „ssh” na portach 22 i 8080 (możliwość połączenia skądkolwiek)
 uruchomiony „squid” jako buforujący serwer dla archiwów Debiana (APT)
Bramka sieciowa, wewnętrzny interfejs: eth1 (IP = 192.168.1.1, stały)
                         |
         +--- LAN Switch (100base T) ---+
         |                              |
Kilka klientów ze stałymi IP     Kilka klientów DHCP
(IP = 192.168.1.2-127, stałe)    (IP = 192.168.1.128-200, dynamiczne)
</example>
Zobacz <ref id="gateway"> oraz <ref id="net-router"> by uzyskać więcej
szczegółów na temat konfiguracji sieci oraz bramki sieciowej.
</sect1>

<sect1>Konta użytkowników
<p>
By mieć poczucie spójności na różnych maszynach, na początku zakładam kilka 
takich samych kont.
<p>
Zawsze pierwsze konto które zakładam nosi nazwę „admin” lub podobną i kieruję
na nie wszystkie listy roota. Konto to przydzielam do grupy <tt>adm</tt>
(zobacz <ref id="wheel">), która pozwala na przyznanie wielu przywilejów
administratora poprzez <prgn>su</prgn> za pomocą PAM lub polecenia 
<prgn>sudo</prgn>.
Szczegóły znajdziesz w <ref id="newuser">.
</sect1>

<sect1>Tworzenie systemów plików
<p>
<sect2>Partycje twardego dysku
<p>
Wolę zakładać osobne partycje dla poszczególnych katalogów z drzewa „/” by
uniknąć utraty danych w przypadku awarii systemu itp.
<example>
/          == (/ + /boot + /bin + /sbin)
           == 50MB+
/tmp       == 100MB+
/var       == 100MB+
/home      == 100MB+
/usr       == 700MB+ z Xami
/usr/local == 100MB
</example>
<p>
Rozmiar katalogu <file>/usr</file> zależy od miejsca jakie zajmują aplikacje i
dokumentacja X Window.
<file>/usr</file> może mieć rozmiar 300MB jeśli ktoś używa tylko trybu
tekstowego, ale 2GB&ndash;3GB nie jest niczym szczególnym podczas korzystania z 
wielu aplikacji Gnome.
Gdy katalog <file>/usr</file> będzie zajmował zbyt dużo miejsca można
przenieść pliki z <file>/usr/share/</file> na inną partycje.
Przy jądrach 2.4 katalog root może potrzebować ponad 200MB
<p>
Obecny stan mojej maszyny wygląda następująco (wydruk uzyskasz wprowadzając
polecenie <tt>df -h</tt>):
<example>
System plików         rozm. użyte  dost. &percnt;uż. zamont. na
/dev/hda3             300M  106M  179M  38&percnt; /
/dev/hda7             100M   12M   82M  13&percnt; /home
/dev/hda8             596M   53M  513M  10&percnt; /var
/dev/hda6             100M  834k   94M   1&percnt; /var/lib/cvs
/dev/hda9             596M  222M  343M  40&percnt; /usr
/dev/hda10            596M  130M  436M  23&percnt; /var/cache/apt/archives
/dev/hda11            1.5G  204M  1.2G  14&percnt; /var/spool/squid
</example>
(Duży obszar zarezerwowany dla <file>/var/spool/squid</file> przeznaczony
jest na serwer pośredniczący dla pobierania pakietów.)
<p>
Wprowadzając polecenie <tt>fdisk -l</tt> uzyskujemy informacje o wszystkich
partycjach na twardym dysku:
<example>
# fdisk -l /dev/hda # komentarz

/dev/hda1             1        41    309928+   6  FAT16 # DOS
/dev/hda2            42        84    325080   83  Linux # (nie używana)
/dev/hda3   *        85       126    317520   83  Linux # Główna
/dev/hda4           127       629   3802680    5  Extended
/dev/hda5           127       143    128488+  82  Linux swap
/dev/hda6           144       157    105808+  83  Linux
/dev/hda7           158       171    105808+  83  Linux
/dev/hda8           172       253    619888+  83  Linux
/dev/hda9           254       335    619888+  83  Linux
/dev/hda10          336       417    619888+  83  Linux
/dev/hda11          418       629   1602688+  83  Linux
</example>
Istnieje kilka nieużywanych partycji. Są one założone z myślą o innych
systemach operacyjnych, bądź przenoszeniu danych z obciążonych części dysku.

<sect2>Montowanie systemów plików.
<p>
Poprawne montowanie powyższych systemów plików jest realizowane
następującym plikiem <file>/etc/fstab</file>:
<example>

# /etc/fstab: statyczna informacja o systemach plików.
#
# (system plikow)  (punkt montowania)  (typ)    (opcje) (dump) (pass)
/dev/hda3       /               ext2    defaults,errors=remount-ro 0 1
/dev/hda5       none            swap    sw                      0 0
proc            /proc           proc    defaults                0 0
/dev/fd0        /floppy         auto    defaults,user,noauto    0 0
/dev/cdrom      /cdrom          iso9660 defaults,ro,user,noauto 0 0
#
# trzymaj partycje osobno
/dev/hda7       /home           ext2    defaults                0 2
/dev/hda8       /var            ext2    defaults                0 2
/dev/hda6       /var/lib/cvs    ext2    defaults                0 2
# noatime przyspieszy odczyt plików
/dev/hda9       /usr            ext2    defaults,noatime        0 2
/dev/hda10      /var/cache/apt/archives ext2    defaults        0 2

# bardzo duża partycja dla serwera pośredniczacego (proxy)
/dev/hda11      /var/spool/squid ext2   rw                      0 2

# zapasowa partycja rozruchowa DOS
/dev/hda1       /mnt/dos        vfat    rw,noauto               0 0
# zapasowa partycja rozruchowa Linux (nie zrobiona)
/dev/hda2       /mnt/linux      ext2    rw,noauto               0 0
#
# punkty montowań nfs
mickey:/        /mnt/mickey     nfs     ro,noauto,intr          0 0
goofy:/         /mnt/goofy      nfs     ro,noauto,intr          0 0
# minnie:/ /mnt/minnie smbfs ro,soft,intr,credentials={filename} 0 2
</example>

Przy NFS, używam opcji <tt>noauto,intr</tt> w połączeniu z domyślną opcją
<tt>hard</tt>. Tym sposobem, istnieje możliwość wciskając kombinację
Ctrl-C, uratowania się z sytuacji gdy nie mamy połączenia i proces
montowania zawiesi się.
<p>
W przypadku maszyny z systemem Windows podłączonej poprzez Sambę (smbfs),
opcje <tt>rw,auto,soft,intr</tt> powinny być odpowiednie. 
Zobacz <ref id="samba">.
<p>
Dla stacji dyskietek użycie opcji <tt>noauto,rw,sync,user,exec</tt>
zapobiega uszkodzeniu plików przy przypadkowym wyjęciu dyskietki przed jej
odmontowaniem. Dzieje się to jednak kosztem wolniejszego zapisu.

<sect2>Montowanie autofs
<p>
Wskazówki do automatycznego montowania:
<list compact>
<item>Załaduj moduł <tt>vfat</tt> by <file>/etc/auto.misc</file> zawierało
<tt>-fstype=auto</tt>:
<example>
# modprobe vfat # przed próbą dostępu do dyskietki
 ... lub by zautomatyzować tę czynność,
# echo "vfat" &gt;&gt; /etc/modules
 ... następnie uruchom ponownie system.
</example>
<item>Ustaw <file>/etc/auto.misc</file> następująco:
<example>
floppy -fstype=auto,sync,nodev,nosuid,gid=100,umask=000 :/dev/fd0
 ... gdzie gid=100 to „users”.
</example>
<item>Stwórz dowiązania <file>cdrom</file> i <file>floppy</file>
w <file>/home/<var>user</var></file>, które wskazywać będą na 
 <file>/var/autofs/misc/cdrom</file> i
 <file>/var/autofs/misc/floppy</file>.
<item>Przydziel użytkownika <var>user</var> do grupy „users”.
</list>

<sect2>Montowanie NFS
<p>
Zewnętrzny serwer Linux NFS (goofy) znajduje się za ścianą ogniową (bramką
sieciową). Zasady bezpieczeństwa w mojej sieci w stosunku do niego są mniej
restrykcyjne ponieważ jestem jego jedynym użytkownikiem. By umożliwić
dostęp do NFS, trzeba po jego stronie dodać do <file>/etc/exports</file>
następujące wpisy:
<example>
# /etc/exports: the access control list for filesystems which may be
#               exported to NFS clients.  See exports(5).
/       (rw,no_root_squash)
</example>
Chcąc uruchomić serwer NFS potrzebne są powyższe wpisy oraz oczywiście
instalacja i uruchomienie klienta i serwer NFS.
<p>
Dla uproszczenia zazwyczaj tworzę pojedynczą partycję o rozmiarze 2GB na
eksperymentalne instalacje Linuksa. Opcjonalnie współdzielę pomiędzy tymi
instalacjami partycję wymiany oraz <file>/tmp</file>. Schematy zawierające
wiele partycji są również przydatne w takich instalacjach. Jeśli natomiast
potrzeba nam prostego systemu w trybie konsoli, w zupełności powinno
wystarczyć 500MB.
</sect1>

<sect1>Wytyczne dotyczące pamięci DRAM
<p>
Bezwzględne wytyczne dotyczące DRAM.
<example>
  4MB:  Absolutne minimum by jądro Linuksa mogło funkcjonować.
 16MB:  Minimum dla rozsądnej pracy w konsoli.
 32MB:  Minimum dla prostego systemu X.
 64MB:  Minimum dla systemu X z GNOME/KDE.
128MB:  Komfortowa praca w systemie X z GNOME/KDE.
256MB (lub więcej):  Dlaczego nie jeśli jesteś w stanie je zdobyć?  DRAM jest tani.
</example>
Możesz podczas rozruchu systemu użyć opcji <tt>mem=4m</tt> (lub w lilo
<tt>append="mem=4m"</tt>) by sprawdzić jak zachowa się system z 4MB pamięci
operacyjnej. Jeśli posiadasz stary BIOS i więcej niż 64MB pamięci to również 
musisz użyć odpowiedniego parametru w lilo.
</sect1>

<sect1>Przestrzeń wymiany
<p>
Używam następujących wytycznych dla przestrzeni wymiany:
<list compact>
<item>Każda partycja wymiany jest &lt; 128MB (jeśli używasz jąder 2.0 ), 
&lt; 2GB (dla nowszych jąder)
<item>Całość = albo (1 do 2 razy rozmiar zainstalowanego ramu) albo (128MB do 2GB) jako 
punkt wyjścia
<item>Rozdziel je na osobne napędy i zamontuj wszystkie z opcjami 
 <tt>sw,pri=1</tt> w <file>/etc/fstab</file>. Powoduje to, że jądro obsługuje 
przestrzeń wymiany jako paskowany RAID co gwarantuje maksymalną wydajność.
<item>Jeśli to możliwe używaj centralnej części dysku do stworzenia partycji 
wymiany.
</list>
<p>
Nawet jeśli nie potrzebujesz, to i tak pożądane jest ustawienie partycji
wymiany (128MB) po to by system zwolnił zanim zawiesi się z powodu programu
z wyciekiem pamięci.
</sect1>
</sect>

<sect id="bashconf">Konfiguracja Basha
<p>
Modyfikuję skrypty startowe powłoki znajdujące się w systemie tak by
spełniały moje zachcianki:
<example>
/etc/bash.bashrc        Zastępuję własnym
/etc/profile            Pozostawiam bez zmian(\w -&gt; \W)
/etc/skel/.bashrc       Zastępuję własnym
/etc/skel/.profile      Zastępuję własnym
/etc/skel/.bash_profile Zastępuje własnym
~/.bashrc               Zastępuję własnym dla każdego konta
~/.profile              Zastępuję własnym dla każdego konta
~/.bash_profile         Zastępuję własnym dla każdego konta
</example>
<url id="&examples;" name="Zobacz szczegóły moich przykładowych skryptów">.
Lubię mieć przejrzysty system więc ustawiam <prgn>umask</prgn> na 002 lub 022.
<p>
<prgn>PATH</prgn> jest ustawiany poprzez następujące pliki konfiguracyjne
w tej kolejności:
<example>
/etc/login.defs  - zanim powłoka ustawi zmienną PATH
/etc/profile     (może wywoływać /etc/bash.bashrc)
~/.bash_profile  (może wywoływać ~/.bashrc)
</example>
</sect>

<sect id="gpm">Konfiguracja myszy
<p>
<sect1>Myszy PS/2
<p>
W przypadku płyty głównej ATX i myszy podłączonej przez PS/2, przepływ
sygnału powinien być następujący:
<example>
mysz -&gt; /dev/psaux -&gt; gpm -&gt; /dev/gpmdata = /dev/mouse -&gt; X
</example>
W tym przypadku utworzone zostało dowiązanie symboliczne
<file>/dev/mouse</file> wskazujące na <file>/dev/gpmdata</file> po to by
niektóre narzędzia konfiguracyjne były szczęśliwe i by rekonfiguracja była
prostsza.
(Jeśli na przykład zrezygnujesz z używania <prgn>gpm</prgn> wystarczy,
że po jego usunięciu zmienisz dowiązanie symboliczne <file>/dev/mouse</file>
tak by wskazywało na <file>/dev/psaux</file>).
<p>
Taki przepływ sygnału pozwala na wyłączenie klawiatury oraz myszki
oraz po ponownym ich podłączeniu uruchamiając <prgn>gpm</prgn> umożliwia
jeszcze raz je zainicjalizować. Serwer X pozostanie uruchomiony!
<p>
Protokół sygnału przepływającego pomiędzy wyjściem <prgn>gpm</prgn>
a wejściem X może być zaimplementowany na dwa sposoby. Albo jako „ms3”
(używa protokołu dla szeregowych 3 przyciskowych myszek Microsoft) albo
jako „raw” (używa tego samego protokołu co podłączona myszka). Wybór ten
determinuje późniejszy wybór protokołu używanego w konfiguracji X.
<p>
By zademonstrować konfigurację, za przykład posłuży mi 3-przyciskowa mysz firmy
Logitech (tradycyjna mysz stylu Unix) podłączana do portu PS/2.
<p>
Jeśli twoja karta graficzna nie jest wspierana przez nowy X4 i musisz
używać starego X3 (niektóre 64 bitowe karty ATI), skonfiguruj
<tt>/etc/X11/XF86Config</tt> zamiast <tt>/etc/X11/XF86Config-4</tt>
w następujący sposób podczas instalacji pakietów X3.

<sect2 id="gpmms3">Wariant ms3
<p>
<example>
/etc/gpm.conf            | /etc/X11/XF86Config-4
=========================+======================================
device=/dev/psaux        | Section "InputDevice"
responsiveness=          |  Identifier "Configured Mouse"
repeat_type=ms3          |  Driver     "mouse"
type=autops2             |  Option     "CorePointer"
append=""                |  Option     "Device"   "/dev/mouse"
sample_rate=             |  Option     "Protocol" "IntelliMouse"
                         | EndSection
</example>
Jeśli używasz takiego podejścia, konfiguracja myszy odbywa się poprzez edycję
<file>gpm.conf</file>, natomiast konfiguracja X zostaje niezmieniona. 
Zobacz <url id="&examples;" name="przykłady moich skryptów konfiguracyjnych">.

<sect2 id="gpmraw">Wariant raw
<p>
<example>
/etc/gpm.conf            | /etc/X11/XF86Config-4
=========================+======================================
device=/dev/psaux        | Section "InputDevice"
responsiveness=          |  Identifier "Configured Mouse"
repeat_type=raw          |  Driver     "mouse"
type=autops2             |  Option     "CorePointer"
append=""                |  Option     "Device"   "/dev/mouse"
sample_rate=             |  Option     "Protocol" "MouseManPlusPS/2"
                         | EndSection
</example>
Jeśli używasz takiego podejścia, konfiguracja myszy odbywa się poprzez edycję
<file>gpm.conf</file> oraz konfigurację Xów.

<sect2>Jak dodać inną myszkę
<p>
Urządzenie <prgn>gpm</prgn> typu <tt>autops2</tt> powinno rozpoznać większość 
myszek PS/2 dostępnych na rynku. Niestety nie zawsze działa i nie jest 
dostępne w poprzednikach wersji Woody. Spróbuj w takich przypadkach użyć 
<tt>ps2</tt> lub <tt>imps2</tt> w pliku <file>gpm.conf</file> zamiast 
<tt>autops2</tt>. By dowiedzieć się więcej o typach myszy
<prgn>gpm</prgn> wpisz :<tt>gpm -t help</tt>.
Zobacz <manref name="gpm" section="8">.
<p>
Jeśli używasz 2-przyciskowej myszy PS/2, ustaw protokół X włączając opcje 
<tt>Emulate3Buttons</tt>. Różnice między protokołami 2-przyciskowej i
3-przyciskowej myszy są automatycznie rozpoznawane i ustawiane przez
<prgn>gpm</prgn> po naciśnięciu środkowego przycisku.
<p>
Dla protokołu X z <ref id="gpmraw"> lub bez <prgn>gpm</prgn> użyj:
<list compact>
<item><tt>IntelliMouse</tt>: szeregowy port myszy (<prgn>gpm</prgn> 
repeater with „ms3”)
<item><tt>PS/2</tt>: port myszy PS/2 (zawsze to testuj na początku)
<item><tt>IMPS/2</tt>: inny port PS/2 (2, 3, lub mysz z kółkiem, lepiej)
<item><tt>MouseManPlusPS/2</tt>: port myszy Logitech PS/2 
<item><tt>...</tt>
</list>
Zobacz więcej na <url id="&mousexf86;" name="Mouse Support in XFree86">.
<p>
Typowe myszy Microsoft z kółkiem najlepiej pracują z:
<example>
/etc/gpm.conf            | /etc/X11/XF86Config-4
=========================+======================================
device=/dev/psaux        | Section "InputDevice"
responsiveness=          |  Identifier "Configured Mouse"
repeat_type=raw          |  Driver     "mouse"
type=autops2             |  Option     "CorePointer"
append=""                |  Option     "Device"   "/dev/mouse"
sample_rate=             |  Option     "Protocol" "IMPS/2"
                         |  Option     "Buttons" "5"
                         |  Option  "ZAxisMapping" "4 5"
                         | EndSection
</example>
<p>
Dla nowszych laptopów Toshiba włączenie <prgn>gpm</prgn> przed PCMCIA 
w skryptach inicjalizujących System-V może pomóc przy zapobieganiu zawieszenia
systemu. Dziwne, ale to prawda.

<sect1>Mysz na USB
<p>
Upewnij się, że masz wkompilowane w jądro lub jako moduły 
wszystkie niezbędne funkcje:
<list compact>

<item>W części "Input core support":

<list compact>
<item>"Input core support" (CONFIG_INPUT, <file>input.o</file>),
<item>"Mouse support" (CONFIG_INPUT_MOUSEDEV, <file>mousedev.o</file>),
</list>

<item>W części "USB support":
<list compact>
<item>"Support for USB" (CONFIG_USB, <file>usbcore.o</file>),
<item>"Preliminary USB device filesystem" (CONFIG_USB_DEVICEFS),
<item>"UHCI" lub "OHCI" (CONFIG_USB_UHCI || CONFIG_USB_UHCI_ALT || 
CONFIG_USB_OHCI, <file>usb-uhci.o</file> || <file>uhci.o</file>
|| <file>usb-ohci.o</file>),
<item>"USB Human Interface Device (full HID) support" (CONFIG_USB_HID,
<file>hid.o</file>) i
<item>"HID input layer support" (CONFIG_USB_HIDINPUT)
</list>
</list>
Małymi literami wymienione są nazwy modułów.
<p>
Jeśli używasz devfs to stwórz wpis w <file>/dev/input/mice</file>
zawierający major 13 i minor 63 w następujący sposób:
<example>
# cd /dev
# mkdir input
# mknod input/mice c 13 63
</example>
<p>
Dla typowej myszki z kółkiem na <strong>USB</strong> konfiguracja powinna
wyglądać następująco:
<example>
/etc/gpm.conf            | /etc/X11/XF86Config-4
=========================+======================================
device=/dev/input/mice   | Section "InputDevice"
responsiveness=          |  Identifier "Generic Mouse"
repeat_type=raw          |  Driver     "mouse"
type=autops2             |  Option     "SendCoreEvents" "true"
append=""                |  Option     "Device"   "/dev/input/mice"
sample_rate=             |  Option     "Protocol" "IMPS/2"
                         |  Option     "Buttons" "5"
                         |  Option  "ZAxisMapping" "4 5"
                         | EndSection
</example>
<p>
By dowiedzieć się więcej odwiedź <url id="&linuxusb;" name="Linux USB Project">

<sect1>Touchpad
<p>
Pomimo, że touchpad w laptopach emuluje standardowo 2-przyciskową
mysz PS/2, pakiet <package>tpconfig</package> pozwala na pełną kontrolę nad 
urządzeniem. Przykładowo ustawienie <tt>OPTIONS="--tapmode=0"</tt> w 
<file>/etc/default/tpconfig</file> wyłączy zachowanie „click by tap”. Ustaw 
<file>/etc/gpm.conf</file> następująco, by używać jednocześnie touchpada i
myszy na porcie USB pod konsolą:
<example>
device=/dev/psaux
responsiveness=
repeat_type=ms3
type=autops2
append="-M -m /dev/input/mice -t autops2"
sample_rate=
</example>

</sect>

<sect id="nfs">Konfiguracja NFS
<p>
Konfiguracja NFS odbywa się poprzez przez ustawienie <file>/etc/exports</file>.
<example>
apt-get install nfs-kernel-server
# echo "/ *.nazwa-domeny-dla-lokalnych(rw,no_root_squash,nohide)" \
        &gt;&gt; /etc/exports
</example>
<url id="&examples;" name="Szczegóły znajdziesz w moich przykładowych skryptach">.
</sect>

<sect id="samba">Konfiguracja Samby
<p>
Szczegółowe informacje:
<list compact>
<item><url id="&sambahome;">
<item>pakiet <package>samba-doc</package>
</list>
<p>
Ustawienie serwera Samba w trybie „share” jest dużo prostsze ponieważ
tworzy współdzielone napędy typu WindowsForWorkgroups. Ale tryb „user” jest
preferowaną metodą.
<p>
Samba może zostać skonfigurowana poprzez <prgn>debconf</prgn> lub <prgn>vi</prgn>:
<example>
# dpkg-reconfigure --priority=<var>low</var> samba # w Woody
# vi /etc/samba/smb.conf
</example>
<url id="&examples;" name="Szczegóły znajdziesz w moich przykładowych skryptach">.
<p>
Dodawanie nowego użytkownika do pliku <file>smbpasswd</file> może być wykonane
poprzez
<prgn>smbpasswd</prgn>:
<example>
$ su -c "smbpasswd -a username"
</example>
Pamiętaj o użyciu zaszyfrowanych haseł dla optymalnej zgodności.
<p>
Ustaw <tt>os level</tt> zgodnie z następującymi odpowiednikami systemu
(im większa liczba, tym większy priorytet jako serwer)
<example>
0:      Samba ze swobodną pozycją (nigdy nie będzie przeglądarką nadrzędną)
1:      WfW 3.1, Win95, Win98, Win/Me?
16:     Win NT WS 3.51
17:     Win NT WS 4.0
32:     Win NT SVR 3.51
33:     Win NT SVR 4.0
255:    Samba z potężną mocą
</example>
Upewnij się, że użytkownicy są członkami grupy do której przynależy
katalog umożliwiający współdzielony dostęp, oraz że ścieżka do tego
katalogu posiada odpowiednio ustawione uprawnienia bitu wykonywalności.
</sect>

<sect id="printer">Konfiguracja drukarki
<p>
Tradycyjną metodą jest <prgn>lpr</prgn>/<prgn>lpd</prgn>. Istnieje nowy system
drukowania CUPS&trade; (Common UNIX Printing System). Inną możliwością jest PDQ.
Zobacz <url id="&printing-howto;" name="Linux Printing HOWTO"> w celu uzyskania
dodatkowych informacji.

<sect1 id="lprlpd"><prgn>lpr</prgn>/<prgn>lpd</prgn>
<p>
Dla programów kolejkujących typu <prgn>lpr</prgn>/<prgn>lpd</prgn>
(<package>lpr</package>, <package>lprng</package>
i <package>gnulpr</package>) podłączonych do drukarek PostScript lub
tekstowych ustaw <file>/etc/printcap</file> następująco (podstawy):
<example>
<var>lp</var>|<var>alias</var>:\
        :sd=/var/spool/lpd/<var>lp</var>:\
        :mx#0:\
        :sh:\
        :lp=/dev/lp0:
</example>
Znaczenie powyższych linii:
<list compact>
<item>Nagłówek: <var>lp</var> &ndash; nazwa kolejki, <var>alias</var> =
 alias
<item>mx#0 &ndash; maksymalny rozmiar pliku nieograniczony
<item>sh &ndash; wstrzymywanie drukowania sekwencji nagłówków stron
<item>lp=/dev/lp0 &ndash; lokalne urządzenie drukujące, lub port@komputer
dla zdalnych
</list>
To dobra konfiguracja jeśli posiadasz drukarkę PostScript.
Jest to również dobre ustawienie do drukowania z maszyny Windows poprzez
Sambę, dla każdej drukarki obsługiwanej przez Windows (nie jest obsługiwana
komunikacja dwukierunkowa). Musisz wybrać odpowiednie ustawienia drukarki
na maszynie z Windows.
<p>
Jeśli nie masz drukarki PostScript powinieneś ustawić filtrowanie za pomocą
<prgn>gs</prgn>.
Istnieje wiele narzędzi automatycznie konfigurujących 
<file>/etc/printcap</file>.
Każda z tych kombinacji jest właściwa:
<list compact>
<item><package>gnulpr</package>, (<package>lpr-ppd</package>) i
  <package>printtool</package> &mdash; Właśnie tego używam.
<item><package>lpr</package> i <package>apsfilter</package>
<item><package>lpr</package> i <package>magicfilter</package>
<item><package>lprng</package> i <package>lprngtool</package>
<item><package>lprng</package> i <package>apsfilter</package>
<item><package>lprng</package> i <package>magicfilter</package>
<!-- I can think of more combinations but I add them if someone
  actually report me they got it working with them.  -->
</list>
<p>
W przypadku uruchamiania narzędzia konfiguracyjnego wykorzystującego
graficzny interfejs użytkownika, jak na przykład <prgn>printtool</prgn>,
zobacz najpierw <ref id="ss-xsu"> aby dowiedzieć się jak uzyskać przywileje
administratora.

Kolejki wydruku utworzone przez <prgn>printtool</prgn> używają programu 
<prgn>gs</prgn> i występują jako drukarki PostScript. Dlatego, gdy z nich 
korzystasz, używaj sterowników PostScriptowych. W systemie Windows „Apple
LaserWriter” jest standardowym przykładem takiej drukarki..
</sect1>

<sect1 id="cups">CUPS&trade;
<p>
Zainstaluj Common UNIX Printing System (lub CUPS&trade;):
<example>
# apt-get install cupsys cupsys-bsd cupsys-client cupsys-driver-gimpprint
# apt-get install foomatic-db-engine foomatic-db-hpijs 
# apt-get install foomatic-filters-ppds foomatic-gui
</example>
<!-- CUPS dependencies: Recommends are not installed automatically -->
<p>
Następnie skonfiguruj system używając przeglądarki internetowej:
</p>
<p>
<example>
$ <var>mybrowser</var> http://localhost:631
</example>
</p>
<p>
Przykład w jaki sposób dodać drukarkę do listy dostępnych:
<list>
<item>na głównej stronie kliknij „Printers”, a następnie „Add Printer”,
<item>wpisz użytkownika „root” i podaj jego hasło,
<item>postępuj według instrukcji by dodać drukarkę
<item>wróć do strony „Printers” i kliknij „Configure Printer”, następnie
<item>ustaw rozmiar papieru, rozdzielczość i inne parametry.
</list>
Więcej informacji znajdziesz na
<url id="http://localhost:631/documentation.html"> i
<url id="&cups-help;">.
<p>
</sect1>
</sect>

<sect>Inne wskazówki instalacyjne

<sect1 id="post-inst">Doinstaluj jeszcze trochę pakietów po wstępnej instalacji
<p>
Jeśli wszystko przebiegło bez problemów to posiadasz już mały, funkcjonalny
system &debian;. Czas na instalację większych pakietów.
<list>
<item>Uruchom <prgn>tasksel</prgn>.  Zobacz <ref id="tasksel">.
<p>
Możesz wybrać następujące elementy jeśli są Ci potrzebne:
<list compact>
<item>End-user &ndash; X window system
<item>Development &ndash; C i C++
<item>Development &ndash; Python
<item>Development &ndash; Tcl/Tk
<item>Miscellaneous &ndash; środowisko TeX/LaTeX 
<item>Dla innych wolę używać <prgn>tasksel</prgn> jako przewodnika
po komponentach wyszczególnionych w &lt;Task Info&gt; i instalować je
programem <prgn>dselect</prgn>.
</list>

<item>Uruchom <prgn>dselect</prgn>.
<p>
Pierwszą rzeczą jaką możesz zrobić jest wybór Twojego ulubionego edytora i
innych programów, które są Ci potrzebne. Możesz zainstalować wiele odmian 
Emacsa na raz.
Zobacz <ref id="dselect"> i <ref id="pop-editor">.
<p>
Możesz również zastąpić niektóre domyślne pakiety takimi z większymi
możliwościami.
<list compact>
<item>... <!-- Add list in generic way. -->
</list>
<item>...
</list>

Zazwyczaj edytuję <file>/etc/inittab</file> w celu łatwego wyłączania komputera.
<example>
...
# Co zrobić gdy wciśnięte są klawisze CTRL-ALT-DEL
ca:12345:ctrlaltdel:/sbin/shutdown -t1 -a -h now
...
</example>
</sect1>

<sect1>Moduły
<p>
Moduły dla sterowników urządzeń są konfigurowane podczas podstawowej
instalacji. <prgn>modconf</prgn> oferuje możliwość konfiguracji modułów przy
pomocy systemu menu. Jest on bardzo użyteczny, gdy jakieś moduły zostały
opuszczone podczas instalacji nowego jądra.
<p>
Nazwy wszystkich wstępnie ładowanych modułów są wyszczególnione w pliku 
<file>/etc/modules</file>. Używam również <prgn>lsmod</prgn> i 
<prgn>depmod</prgn> by sterować nimi ręcznie.
<p>
Dla jądra 2.4 dodaj wpis w pliku <file>/etc/modules</file> pozwalający obsłużyć
IP masquerading (FTP, itp.).
Zobacz <ref id="kernel-modules">, a dokładniej <ref id="kernel-net">.

</sect1>

<sect1>Podstawy instalacji CD-RW
<p>
Wyedytuj następujące pliki:
<example>
/etc/lilo.conf  (dodaj append="hdc=ide-scsi ignore=hdc",
                 uruchom lilo w celu aktywacji)
/dev/cdrom      (symlink # cd /dev; ln -sf scd0 cdrom)
/etc/modules    (dodaj "ide-scsi" i "sg". Jeśli będzie to konieczne to również
"sr".)
</example>
Zobacz <ref id="cdrw"> by dowiedzieć się więcej.
</sect1>

<sect1 id="apm">Automatyczne wyłączanie komputera oraz komputery z większą
ilością pamięci
<p>
Zmodyfikuj <file>/etc/lilo.conf</file> wg instrukcji poniżej
aby uwzględnić obsługę większego rozmiaru pamięci (dla jąder 2.2) 
oraz automatycznego wyłączania (dla APM):
<example>
append="mem=128M apm=on apm=power-off noapic"
</example>
Teraz uruchom <prgn>lilo</prgn> aby zainstalować te ustawienia.
<tt>apm=power-off</tt> jest wymagane dla jąder z obsługą wielu procesorów,
a <tt>noapic</tt> jest potrzebne by unikać kłopotów z moim wadliwym
sprzętem. Tego samego można dokonać wpisując podane opcje
bezpośrednio podczas ukazania się znaku zachęty programu uruchomieniowego.
Zobacz <ref id="bootprompt">.
<p>
Jeśli APM jest kompilowany jako moduł, jak to ma miejsce w 
domyślnym jądrze Debiana 2.4, uruchom <tt>insmod apm power_off=1</tt> 
po wystartowaniu systemu lub wpisz odpowiednie opcje do 
<file>/etc/modules</file>, na przykład tak:
<example>
# echo "apm power_off=1" &gt;&gt;/etc/modules
</example>
<p>
Kompilując obsługę ACPI można osiągnąć to samo z nowszymi jądrami i wygląda
na to, że jest to bardziej przyjazne dla wieloprocesorowych maszyn (wymaga
to jednak nowszej płyty głównej). Na jądrach z serii 2.4 i nowszych płytach
głównych większe ilości pamięci powinny być wykrywane prawidłowo.
<example>
CONFIG_PM=y
CONFIG_ACPI=y
...
CONFIG_ACPI_BUSMGR=m
CONFIG_ACPI_SYS=m
</example>
i dodaj w tej kolejności poniższe linie do <file>/etc/modules</file>:
<example>
ospm_busmgr
ospm_system
</example>
Lub przekompiluj jądro z tymi opcjami ustawionymi na „y”. W żadnym
z przypadków użycia ACPI, nie są potrzebne żadne parametry podczas 
uruchamiania.
</sect1>

<sect1 id="killecn">Dziwne kłopoty z dostępem do witryn WWW.
<p>
W nowszych jądrach Linuksa standardowo włączone jest ECN. Może to powodować
problemy z dostępem do niektórych witryn WWW. By sprawdzić status ECN:
<example>
# cat /proc/sys/net/ipv4/tcp_ecn
 ... lub
# sysctl net.ipv4.tcp_ecn
</example>
Chcąc go wyłączyć, użyj:
<example>
# echo "0" > /proc/sys/net/ipv4/tcp_ecn
 ... lub
# sysctl -w net.ipv4.tcp_ecn=0
</example>
W celu wyłączenia ECN podczas każdego restartu, wyedytuj plik
<file>/etc/sysctl.conf</file> i dodaj:
<example>
net.ipv4.tcp_ecn = 0
</example>
</sect1>

<sect1>Konfiguracja połączenia modemowego (Dialup PPP)
<p>
Zainstaluj pakiet <package>pppconfig</package> w celu skonfigurowania połączenia
z Internetem za pomocą modemu.
<example>
# apt-get install pppconfig
# pppconfig
 ... stosuj się do wskazówek by skonfigurować połączenie modemowe
# adduser <var>nazwa_użytkownika</var> dip
 ... pozwól użytkownikowi <var>>nazwa_użytkownika</var> na dostęp do modemu
</example>
Połączenie modemowe może być zainicjowane przez użytkownika
(<var>>nazwa_użytkownika</var>):
<example>
$ pon <var>nazwa_ISP</var>   # rozpoczęcie dostępu poprzez modem do Twojego ISP
 ... możesz cieszyć się Internetem
$ poff <var>nazwa_ISP</var> # zatrzymuje dostęp, <var>nazwa_ISP</var> dowolna.
</example>
Więcej informacji znajdziesz na <file>&f-ppp-readme;</file>.
<p>
Do skonfigurowania połączenia modemowego może być też użyty pakiet
<package>wvdial</package>.
Zauważ, że jest dobrze znany błąd <url id="&bugs;82095">, który czasem
powoduje, że nie-administrator nie może się wdzwonić.
<p>
Wszystkie te programy używają demona <prgn>pppd</prgn>, który uruchamia
programy znalezione w <file>/etc/ppp/ip-up.d/</file> lub
<file>/etc/ppp/ip-down.d/</file> po tym gdy się połączy lub rozłączy.
Jest to używane do pobierania i wysyłania poczty.
</sect1>

<sect1>Inne pliki konfiguracyjne do dostrojenia w <file>/etc/</file>
<p>
Możesz chcieć dodać plik <file>/etc/cron.deny</file>, brakujący po podstawowej
instalacji Debiana (skopiuj <file>/etc/at.deny</file>)
</sect1>

</sect>

</chapt>
