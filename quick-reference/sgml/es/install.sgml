<!-- CVS revision of original english document "1.94"  -->

<chapt id="install">Consejos para la instalación de un sistema Debian

<p>
La documentación oficial para instalar Debian se encuentra en 
<url id="&stable-info;"> y
<url id="&stable-install;">.
<p>
Las versiones de desarrollo se encuentran en <url id="&testing-info;" >
y <url id="&testing-install;"> (en preparación, a veces puede no
existir).
<p>
Aunque este capítulo fue escrito durante la época del instalador 
Potato, la mayoría de su contenido ha sido actualizado para el instalador
Woody. Ambos instaladores son muy similares. Puesto que Sarge 
utilizará un instalador totalmente diferente, por favor
considere lo siguiente como punto referencia para el instalador Sarge.
Asimismo algunos paquetes claves han cambiado su nombre y prioridades. Por
ejemplo, el MTA predeterminado de Sarge es <package>exim4</package> en vez de  
<package>exim</package> y ha sido incluido <package>coreutils</package>
para reemplazar diversos paquetes. Puede que necesite realizar algunas
modificaciones. 

<sect>Consejos generales para la instalación de un sistema Linux
<p>
No se olvide visitar <url id="&debian-netinst;"> si está
buscado la imagen del instalador &debian; en CD.
<p>
Utilizar la versión <tt>de prueba</tt> o <tt>inestable</tt> de &debian;
conlleva el riesgo creciente de encontrarse con fallos graves.  Esto puede
evitarse, creando un esquema multi-arranque con versiones más estables de
&debian;, o utilizando un truco interesante proporcionado por <prgn>chroot</prgn>
en la versión más estable como se explica en <ref id="chroot">.  Esta última opción
nos permitirá ejecutar diferentes versiones de &debian; simultáneamente en
diferentes consolas.

<sect1>Fundamentos sobre la compatibilidad del hardware
<p>
Linux es compatible con la mayoría del hardware de PC y se puede instalar en
prácticamente cualquier sistema. Para mí, fue tan fácil como instalar Windows
95/98/Me. La lista de compatibilidad de hardware parece que no deja de crecer.
<p>
Si posee una PC portátil, consulte
<url id="&linonlap;" name="Linux on Laptops">
para consejos sobre instalación según marca y modelo.
<p>
Mi recomendación para el hardware de una PC de escritorio es: "simplemente
sea conservador":
<list compact>
<item>SCSI en vez de IDE para trabajar, disco duro IDE/ATAPI para uso personal.
<item>CD-ROM IDE/ATAPI CD-ROM (o CD-RW).
<item>PCI en vez de ISA, en especial para las tarjetas de red (NIC).
<item>Use un NIC económico.  Tulip para PCI, NE2000 para ISA es suficiente.
<item>Evite PCMCIA (portátiles) en su primera instalación de Linux.
<item>No utilice teclados o ratones USB ... a menos que le gusten los desafíos.
</list>
<p>
Si posee una máquina lenta, extraer el disco duro y conectarlo a otra máquina
más rápida para la instalación es muy buena idea.   
</sect1>

<sect1>Determinando el hardware del PC 
<p>
Durante la instalación, se le pedirá que identifique el hardware o chipset del
PC. A menudo, esta información no resulta fácil de encontrar. Veamos un método
<enumlist compact>
  <item>Abra el gabinete de su PC y mire su interior.
  <item>Anote los números de los chips más grandes de la tarjeta de video, la
  tarjeta de red, los chips situados cerca de los puertos seriales y puertos
  IDE.  
  <item>Anote los nombres impresos en la parte posterior de las tarjetas PCI
  e ISA.
</enumlist>
</sect1>

<sect1>Determinando el hardware del PC mediante &debian;
<p>
En un sistema Linux, los siguientes comandos deberían brindarle cierta idea
sobre su hardware actual y su configuración.
<example>

$ pager /proc/pci
$ pager /proc/interrupts
$ pager /proc/ioports
$ pager /proc/bus/usb/devices
</example>
Estos comandos se pueden ejecutar durante el proceso de instalación desde la
pantalla de la consola presionando Alt-F2.
<p>
Finalizada la primer etapa de instalación e instalando los paquetes opcionales 
<package>pciutils</package>, <package>usbutils</package> y <package>lshw</package>,
puede obtener información más detallada del sistema:
<example>
$ lspci -v |pager
$ lsusb -v |pager
# lshw  |pager
</example>

<p>
Usos típico de las interrupciones:
<list compact>
<item>IRQ0: salida del temporizador (reloj del sistema)(8254)
<item>IRQ1: controlador del teclado
<item>IRQ2: cascada para IRQ8&ndash;IRQ15 en una PC-AT
<item>IRQ3: puerto serie secundario (io-port=0x2F8) (<file>/dev/ttyS1</file>)
<item>IRQ4: puerto serie primario (io-port=0x3F8) (<file>/dev/ttyS0</file>)
<item>IRQ5: libre [tarjeta de sonido (SB16: io-port=0x220, DMA-low=1, DMA-high=5)] 
<!--(was the HD interrupt on the XT) Linux is for 386 or later -->
<item>IRQ6: controlador de la disquetera (io-port=0x3F0) (<file>/dev/fd0</file>, <file>/dev/fd1</file>)
<item>IRQ7: puerto paralelo (io-port=0x378) (<file>/dev/lp0</file>)
<item>IRQ8: rtc
<item>IRQ9: interrupción por software (int 0x0A), se redirige a IRQ2
<item>IRQ10: libre [interfaz de la tarjeta de red (NE2000: io-port=0x300)]
<item>IRQ11: libre [(SB16-SCSI: io-port=0x340, SB16-IDE: io-port=0x1E8,0x3EE)]
<item>IRQ12: ratón PS/2
<item>IRQ13: libre (era el coprocesador matématico 80287)
<item>IRQ14: controlador IDE primario (<file>/dev/hda</file>, <file>/dev/hdb</file>)
<item>IRQ15: controlador IDE secundario (<file>/dev/hdc</file>, <file>/dev/hdd</file>)
</list>
Para antiguas tarjeta ISA que no son del tipo PnP
puede que desee configurar IRQ5, IRQ10 y IRQ11 como 
no-PnP desde la BIOS.
<p>
Para los dispositivos USB, las clases de dispositivos se encuentran en 
<file>/proc/bus/usb/devices</file> como <tt>Cls=<var>nn</var></tt>:
<list compact>
<item>Cls=00 : Sin usar
<item>Cls=01 : Audio (parlante, etc.)
<item>Cls=02 : Comunicación (MODEM, NIC, ...)
<item>Cls=03 : HID (Human Interface Device: teclado, ratón, palanca de juegos)
<item>Cls=07 : Impresora
<item>Cls=08 : Almacenamiento (disquetera, lectora CD/DVD, disco duro, Flash, ...)
<item>Cls=09 : Hub (hub USB)
<item>Cls=255 : Específico del vendedor
</list>
Si la clase del dispositivo es diferente a 255, Linux lo soporta.

</sect1>

<sect1>Determinando el hardware del PC mediante otros SOs
<p>
La información de hardware se puede también obtener mediante mediante otros
SOs:
<p>
Instale otra distribución Linux comercial. La detección de hardware suele ser
mejor que en Debian por el momento (esta situación debería cambiar
una vez <prgn>debian-installer</prgn> forme parte de Sarge).
<p>
Instale Windows.  La configuración del hardware se puede obtener pulsando con
el botón derecho del ratón sobre "Mi PC" yendo a Propiedades / Administración
de Dispositivos. Anote toda la información disponible, tales como IRQ,
direcciones de los puertos de E/S y DMA. Algunas tarjetas ISA antiguas puede
necesitar ser configuradas en DOS y usadas en consecuencia.
</sect1>

<sect1>El mito sobre Lilo
<p>
"Lilo está limitado a los 1024 cilindros." ¡ INCORRECTO !
<p>
El nuevo <prgn>lilo</prgn> que se usa a partir de Debian Potato tiene soporte
lba32. Si la BIOS de su placa madre es lo suficientemente reciente para admitir
lba32, <prgn>lilo</prgn> debería ser capaz de cargarse más allá de la antigua
limitación de los 1024 cilindros.
<p>
Sólo asegúrese de añadir una línea que diga "lba32" en algún lugar cerca del
comienzo de su archivo <file>lilo.conf</file> si conserva una versión antigua
de él. Véase <file>&f-lilo;</file>
</sect1>

<sect1 id="instgrub">GRUB
<p>
El nuevo cargador <package>grub</package> del projecto Hurd GNU se puede
instalar en un sistema Woody &debian;:
<example>
# apt-get update
# apt-get install grub-doc
# mc &f-grub-doc;
... lea los contenidos
# apt-get install grub
# pager &f-grub;
... léalo :)
</example>
Para modificar el menú de GRUB, edite <file>&f-grub-menu;</file>.  Véase 
<ref id="bootgrub"> para ver cómo configurar los parámetros de arranque
durante el proceso de arranque ya que es ligeramente diferente al de la
configuración de <package>lilo</package>.
</sect1>

<sect1 id="bootfloppy">Elección de los discos de arranque
<p>
Para Potato, preferí el conjunto de discos IDEPCI para una instalación normal
en una PC de escritorio.  Para Woody, prefiero el conjunto de discos bf2.4.
Ambos utilizan una versión 
<package>boot-floppies</package> para crear los discos de arranque.
<p>
Si posee una tarjeta de red PCMCIA, necesita usar el conjunto de discos del
arranque estándar (el conjunto más grande de disketes pero con todos los
módulos de controladores disponibles) y configurar el NIC en el diálogo
PCMCIA; no intente configurarla en el diálogo de configuración de la red
estándar.
<p>
Para sistemas especiales, puede que necesite crear un disco de arranque
personalizado. Esto puede realizarse reemplazando la imagen del kernel
denominado "linux" en el disco de rescate de &debian; por otra imagen del
kernel comprimida, compilada en otro lugar de la máquina.  Los detalles se
encuentran documentados en el archivo <file>readme.txt</file> del disco de
rescate.  El disco de rescate utiliza el sistema de archivos MS-DOS, de modo
que puede usar cualquier sistema para leerlo y editarlo.  Esto debería
facilitar las cosas a las personas con una tarjeta de red particular, etc.
<p>
Para Sarge, se espera que <prgn>debian-installer</prgn> y/o
<package>pgi</package> se usen para crear los disketes de arranque.
</sect1>

<sect1>Instalación
<p>
Siga las instrucciones oficiales que se encuentran en 
<url id="&stable-install;">
o
<url id="&testing-install;"> (en preparación, a veces puede no existir).
<p>
Si está instalando un sistema usando los <prgn>discos de arranque</prgn> de la distribución
<tt>de prueba</tt>, puede que necesite abrir un terminal en la consola durante el
proceso de instalación presionando <tt>Alt-F2</tt> y editar manualmente
<file>/etc/apt/sources.list</file> para reemplazar las entradas "stable" por
"testing" para ajustar las fuentes de APT.
<p>
Tengo la costumbre de instalar <prgn>lilo</prgn> en lugares como <file>/dev/hda3</file>,
teniendo el <prgn>mbr</prgn> en <file>/dev/hda</file>.  Esto minimiza el
riesgo de la sobreescritura de la información de arranque.
<p>
Veamos lo que elegí durante el proceso de instalación.
<list compact>
<item>MD5 passwords "yes"
<item>shadow passwords "yes"
<item>Instalación "advanced" (dselect **) y en la selección
  <list compact>
    <item>Excluir emacs (si está seleccionado), nvi, tex, telnet, talk(d); 
    <item>Incluir mc, vim y nano-tiny o elvis-tiny.
    <p>
     Véase <ref id="dselect">. Aún si es un fanático de Emacs, evítelo por el
     momento y confórmese con nano durante la instalación. Asimismo evite
     instalar paquetes grandes como TeX en esta etapa (Potato lo hacía).
     Véase <ref id="bin-editor"> para conocer la razón de instalar nano-tiny
     o elvis-tiny.
  </list>
<item>A todas las preguntas de configuración = "y" (reemplazar el actual)
durante cada diálogo de instalación de cada paquete.
<item><package>exim</package>: seleccioné 2 por máquina ya que envío correo
  mediante el servidor SMTP de mi ISP.
</list>
<p>
Para más información sobre dselect, véase <ref id="dselect">.
</sect1>

<sect1 id="ipmap">Máquinas IP para usar en una LAN
<p>
Ejemplo de configuración de una LAN (subred Ct: 192.168.1.0/24):
<example>
Internet
   |
   +--- ISP externo brinda servicio POP (que se accede mediante fetchmail)
   | 
  Punto de acceso al ISP que brinda servicio DHCP y retransmición SMTP
   |                     :
  Cable módem         (Conexión telefónica)
   |                     :
Puerto externo de la puerta de enlace de la LAN: eth0 (IP dado por el DHCP del ISP)
 utilice una PC portátil antigua (IBM Thinkpad, 486 DX2 50 MHz, 20 MB RAM)
 ejecute el kernel 2.4 de Linux con sistema de archivos ext3.
 ejecute el paquete "ipmasq" (con protección, NAT y firewall)
 ejecute el paquete "dhcp-client" configurado para eth0 (no tiene en cuenta la
 configuración DNS)
 ejecute el paquete "dhcp" configurado para eth1
 ejecute "exim" como smarthost (modo 2)
 ejecute "fetchmail" con un intervalo largo (fallback)
 ejecute "bind" como servidor de nombres en caché para Internet desde la LAN
         como servidor de nombres oficial para el dominio de la red local
 ejecute "ssh" en el pueto 22 y 8080 (conexiones de cualquier lugar)
 ejecutar "squid" como servidor caché para el archivo Debian (para APT)
Puerto interno de la puerta de enlace de la LAN: eth1 (IP = 192.168.1.1, fija)
                         |
         +--Conector para LAN (100 base T)---+
         |                                  |
Algunos clientes de la LAN con IP fija   Algunos clientes DHCP de la LAN
(IP = 192.168.1.2-127, fija)            (IP = 192.168.1.128-200, dinámica)
</example>
Véase <ref id="gateway"> para detalles de cómo configurar una puerta de
enlace de una LAN.
Véase <ref id="net-router"> para detalles de cómo configurar el servidor
encaminador de una LAN.

</sect1>

<sect1>Cuentas de usuarios
<p>
A fin de lograr una organización coherente entre todas las máquinas, en mi
sistema las primeras cuentas son siempre las mismas.
<p>
Siempre creo una primer cuenta de usario con un nombre como "admin"
(uid=1000).  Reenvío todos los mensajes del superusuario a ella.  Esta
cuenta pertenece al grupo <tt>adm</tt> (véase <ref id="wheel">), al que
puede darse una buena cantidad de privilegios de superusuario mediante
el comando <prgn>su</prgn> usando PAM o con <prgn>sudo</prgn>.  Véase
<ref id="newuser"> para más detalles.
</sect1>

<sect1>Creando sistema de archivos
<p>
<sect2>Partición del disco duro
<p>
Prefiero usar diferentes particiones para distintos árboles de directorios para
limitar el daño luego de un cuelgue del sistema. Por ejemplo,
<example>
/          == (/ + /boot + /bin + /sbin)
           == 50MB+
/tmp       == 100MB+
/var       == 100MB+
/home      == 100MB+
/usr       == 700MB+ con X
/usr/local == 100MB
</example>
<p>
El tamaño del directorio <file>/usr</file> depende sustancialmente de las
aplicaciones X Window y de la documentación.  <file>/usr/</file> puede ser de
unos 300MB si se ejecuta un sólo terminal en la consola, mientras que
2GB&ndash;3GB no es un tamaño inusual si se tienen instaladas diversas
aplicaciones Gnome.  

Cuando <file>/usr/</file> crece demasiado, mover el directorio
<file>/usr/share/</file> a otra partición es la cura más efectiva. Con
los núcleos 2.4 de Linux preempaquetados,  <file>/</file> puede requerir
de más de 200MB.

<p>
Por ejemplo, el estado actual de mi puerta de enlace Internet es el siguiente
(salida del comando <tt>df -h</tt>):
<example>
Filesystem            Size  Used Avail Use&percnt; Montado en
/dev/hda3             300M  106M  179M  38&percnt; /
/dev/hda7             100M   12M   82M  13&percnt; /home
/dev/hda8             596M   53M  513M  10&percnt; /var
/dev/hda6             100M  834k   94M   1&percnt; /var/lib/cvs
/dev/hda9             596M  222M  343M  40&percnt; /usr
/dev/hda10            596M  130M  436M  23&percnt; /var/cache/apt/archives
/dev/hda11            1.5G  204M  1.2G  14&percnt; /var/spool/squid
</example>
(El gran espacio destinado a <file>/var/spool/squid</file> es para el caché
de un proxy para la descarga de paquetes)
<p>
A continuación se muestra la salida de <tt>fdisk -l</tt> que proporciona
una idea de la estructura de la partición:
<example>
# fdisk -l /dev/hda # comentario

/dev/hda1             1        41    309928+   6  FAT16 # DOS
/dev/hda2            42        84    325080   83  Linux # (sin usar)
/dev/hda3   *        85       126    317520   83  Linux # Principal
/dev/hda4           127       629   3802680    5  Extended
/dev/hda5           127       143    128488+  82  Linux swap
/dev/hda6           144       157    105808+  83  Linux
/dev/hda7           158       171    105808+  83  Linux
/dev/hda8           172       253    619888+  83  Linux
/dev/hda9           254       335    619888+  83  Linux
/dev/hda10          336       417    619888+  83  Linux
/dev/hda11          418       629   1602688+  83  Linux
</example>
Existen algunas pocas particiones sin uso. Éstas están para instalar una
segunda distribución de Linux o como espacio  para los árboles de
directorios en expansión.

<sect2>Montar los sistemas de archivos
<p>
El montaje correcto de los sistemas de archivos anteriores se lleva a
cabo mediante <file>/etc/fstab</file>:
<example>

# /etc/fstab: static file system information.
#
# sistema de    punto de        tipo    opciones            dump pass
# archivos      montaje
/dev/hda3       /               ext2    defaults,errors=remount-ro 0 1
/dev/hda5       none            swap    sw                      0 0
proc            /proc           proc    defaults                0 0
/dev/fd0        /floppy         auto    defaults,user,noauto    0 0
/dev/cdrom      /cdrom          iso9660 defaults,ro,user,noauto 0 0
#
# mantener particiones separadas
/dev/hda7       /home           ext2    rw                      0 2
/dev/hda8       /var            ext2    rw                      0 2
/dev/hda6       /var/lib/cvs    ext2    rw                      0 2
/dev/hda9       /usr            ext2    rw                      0 2
/dev/hda10      /var/cache/apt/archives ext2    rw              0 2

# una partición bien grande para el caché del proxy
/dev/hda11      /var/spool/squid ext2   rw                      0 2

# respaldo DOS arrancable
/dev/hda1       /mnt/dos        vfat    rw,noauto               0 0
# respaldo Linux arrancable (sin hacer)
/dev/hda2       /mnt/linux      ext2    rw,noauto               0 0
#
# montajes nfs
mickey:/        /mnt/mickey     nfs     ro,noauto,intr          0 0
goofy:/         /mnt/goofy      nfs     ro,noauto,intr          0 0
# minnie:/ /mnt/minnie smbfs ro,soft,intr,credentials={filename} 0 2
</example>

Para NFS, utilizo <tt>noauto,intr</tt> combinado con la opción
predeterminada <tt>hard</tt>. De esta manera, es posible detener un
proceso bloqueado por una desconexión usando Ctrl-C.
<p>
Para una máquina Windows conectada con Samba (smbfs),
<tt>rw,auto,soft,intr</tt> puede ser una buena idea. Véase <ref
id="samba">.
<p>
Para una disquetera, usar <tt>noauto,rw,sync,user,exec</tt> para preevenir
la corrupción de datos tras eyectar el diskette en forma accidental antes
de desmontarlo. Esto ralentiza el proceso de escritura.

<sect2>Montaje autofs
<p>
Puntos claves para el montaje automático:
<list compact>
<item>Cargue el módulo <tt>vfat</tt> para permitir que
<file>/etc/auto.misc</file> contenga <tt>-fstype=auto</tt>:
<example>
# modprobe vfat # antes de intentar acceder al diskete
 ... o para automatizar esta configuración,
# echo "vfat" &gt;&gt; /etc/modules
 ... y reinicie el sistema.
</example>
<item>Escriba en el archivo <file>/etc/auto.misc</file> lo siguiente:
<example>
floppy -fstype=auto,sync,nodev,nosuid,gid=100,umask=000 :/dev/fd0
 ... donde gid=100 es "users".
</example>
<item>Cree los enlaces <file>cdrom</file> y 
<file>floppy</file> en <file>/home/<var>user</var></file>
que apunten a <file>/var/autofs/misc/cdrom</file> y
 <file>/var/autofs/misc/floppy</file> respectivamente.
<item>Añada <var>user</var> al grupo "users".
</list>

<sect2>Montaje NFS
<p>
El servidor Linux NFS externo (goofy) se encuentra detrás de un firewall
(puerta de enlace). Tengo una política de seguridad bastante laxa en mi LAN ya
que soy el único usuario. Para activar el acceso NFS, del lado del
servidor es necesario añadir lo siguiente al
<file>/etc/exports</file>:
<example>
# /etc/exports: la lista de control de acceso para los sistemas de
#               archivos que se puede exportar a los clientes NFS. Véase(5).
/       (rw,no_root_squash)
</example>
Esto se necesita para activar el servidor NFS además de instalar y
activar los paquetes cliente y servidor NFS.
<p>
Por sencillez, generalmente creo una única partición de 2GB para una
instalación experimental o secundaria de Linux. Opcialmente comparto las
particiones de intercambio y <file>/tmp</file> para estas instalaciones.
El esquema de particiones múltiples es demasiado complicado para estos
usos. Si se necesita un sistema sencillo de consola, 500MB puede ser más
que suficiente.
</sect1>

<sect1>Lineamientos para la memoria DRAM
<p>
A continuación se da a grandes rasgos indicaciones para la DRAM.
<example>
  4 MB:  Mínimo suficiente para hacer funcionar el kernel de Linux.
 16 MB:  Mínimo para un uso razonable de un sistema en modo consola.
 32 MB:  Mínimo para un sistema X sencillo.
 64 MB:  Mínimo para un sistema X con GNOME/KDE.
128 MB:  Comfortable para un sistema X system con GNOME/KDE.
256 MB (o más):  ¿Por qué no disponer de ella? La memoria DRAM es económica.
</example>
Usando la opción de arranque <tt>mem=4m</tt> (o en lilo
<tt>append="mem=4m"</tt>) le mostrará como se comportaría el sistema con
4Mb de memoria instalada. Para un sistema con más de 64Mb de memoria con
una BIOS antigua es necesario un parámetro de arranque para lilo.
</sect1>

<sect1>Espacio de intercambio
<p>
Uso las siguientes directrices para el espacio de intercambio:
<list compact>
<item>Cada partición de intercambio es &lt; 128 MB (para un núcleo 2.0 antiguo),
 &lt; 2 GB (para núcleos recientes)
<item>Total = o bien 1 a 2 veces la RAM instalada o 128 MB para 2 GB
<item>Asígnelas en diferentes unidades y móntelas a todas con las opciones 
 <tt>sw,pri=1</tt> en el <file>/etc/fstab</file>.  Esto asegura que el kernel
 haga RAID por bandas en las particiones de intercambio y posibilita el máximo
 rendimiento de las mismas.
<item>En lo posible utilice una porción central del disco duro.
</list>
<p>
Incluso si nunca lo necesita, es conveniente contar con cierto espacio
de intercambio (128MB) ya que el sistema se ralentizará antes que se
cuelge debido a un programa que le falte  memoria.
</sect1>
</sect>

<sect id="bashconf">Configuración del bash
<p>
Modifiqué los scripts de inicio del intérprete de comandos en 
todo el sistema de acuerdo con mis preferencias:
<example>
/etc/bash.bashrc        Reemplazar con una personalizada
/etc/profile            Conservar la que acompaña a lai
                        distibución ( \w -&gt; \W)
/etc/skel/.bashrc       Reemplazar con una copia privada
/etc/skel/.profile      Reemplazar con una copia privada
/etc/skel/.bash_profile Reemplazar con una copia privada
~/.bashrc               Reemplazar con una copia privada para todas las cuentas
~/.profile              Reemplazar con una copia privada para todas las cuentas
~/.bash_profile         Reemplazar con una copia privada para todas las cuentas
</example>
<url id="&examples;" name="See details in my example scripts">. 
Me gusta un sistema transparente, por lo tanto fijé <prgn>umask</prgn> en 002 o 022.
<p>
<prgn>PATH</prgn> viene determinado por los siguientes archivos de configuración
en este orden:
<example>
/etc/login.defs  - antes que el intérprete de comandos fije PATH
/etc/profile     (puede llamar a /etc/bash.bashrc)
~/.bash_profile  (puede llamar a ~/.bashrc)
</example>
</sect>

<sect id="gpm">Configuración del ratón
<p>
<sect1>Ratón PS/2
<p>
En el caso de un ratón con conector PS/2 en una placa madre ATX, el
flujo de señales sería:
<example>
mouse -&gt; /dev/psaux -&gt; gpm -&gt; /dev/gpmdata = /dev/mouse -&gt; X
</example>
En este caso, se crea un enlace simbólico <file>/dev/mouse</file> que apunta a
<file>/dev/gpmdata</file> para dejar conforme a algunas utilidades de
configuración y permitir su fácil reconfiguración.  (si después de todo no
decide usar el demonio <prgn>gpm</prgn>, simplemente apunte el enlace simbólico
<file>/dev/mouse</file> a <file>/dev/psaux</file> luego de haver
eliminado el demonio <prgn>gpm</prgn>.)
<p>
Este flujo de señales permite al teclado y al ratón ser desconectados y
reinicializados lanzando <prgn>gpm</prgn> tras la reconexión.  ¡X permanecerá
activa! 
<p>
El protocolo del flujo de señales entre la salida de <prgn>gpm</prgn> y la
entrada de X se puede implementar de alguna de estas dos maneras, como "ms3"
(protocolo de los ratones seriales de Microsoft de 3 botones) o como "raw" (
protocolo del ratón conectado) y esta elección impone la
elección del protocolo usado en la configuración de X.
<p>
Veamos a continuación algunos ejemplos de configuración para un ratón PS/2
Logitech de tres botones (ratón tipo UNIX tradicional).
<p>
Si es uno de los desafortunados cuya tarjeta gráfica no está soportada por la
nueva X4 y necesita usar la antigua X3 (algunas tarjetas de 64 bits ATI),
instale los paquetes X3 y configure <tt>/etc/X11/XF86Config</tt> en vez de
<tt>/etc/X11/XF86Config-4</tt> en los siguientes ejemplos.

<sect2 id="gpmms3">Usando el protocolo ms3 
<p>
<example>
/etc/gpm.conf            | /etc/X11/XF86Config-4
=========================+======================================
device=/dev/psaux        | Section "InputDevice"
responsiveness=          |  Identifier "Configured Mouse"
repeat_type=ms3          |  Driver     "mouse"
type=autops2             |  Option     "CorePointer"
append=""                |  Option     "Device"   "/dev/mouse"
sample_rate=             |  Option     "Protocol" "IntelliMouse"
                         | EndSection
</example>
Si se utiliza este enfoque, el ajuste del tipo de ratón se realiza simplemente
editando el archivo <file>gpm.conf</file> y la configuración X se deja sin
modificar.
Véase <url id="&examples;" name="mis scripts de ejemplo">.

<sect2 id="gpmraw">Usando el protocolo raw
<p>
<example>
/etc/gpm.conf            | /etc/X11/XF86Config-4
=========================+======================================
device=/dev/psaux        | Section "InputDevice"
responsiveness=          |  Identifier "Configured Mouse"
repeat_type=raw          |  Driver     "mouse"
type=autops2             |  Option     "CorePointer"
append=""                |  Option     "Device"   "/dev/mouse"
sample_rate=             |  Option     "Protocol" "MouseManPlusPS/2"
                         | EndSection
</example>
Si se utiliza este enfoque, el ajuste del tipo de ratón se realiza editando el
archivo <file>gpm.conf</file> y ajustando la configuración de X.

<sect2>Cómo adaptar los diferentes ratones
<p>
Se supone que el tipo de dispositivo <tt>autops2</tt> de
<prgn>gpm</prgn> autodetecterá la mayoría de los ratones PS/2 del
mercado.  Lamentablemente no siempre funciona y no se encuentra
disponible en versiones anteriores a Woody. En estos casos intentar usar
<tt>ps2</tt> o <tt>imps2</tt> en el archivo <file>gpm.conf</file> en vez
de <tt>autops2</tt>.  Para ver los tipos de ratones que reconoce
<prgn>gpm</prgn>
escriba: <tt>gpm -t help</tt>.  Véase <manref name="gpm" section="8">.
<p>
Si se utiliza un ratón PS/2 de dos botones, configure el protocolo X para
activar <tt>Emulate3Buttons</tt>. La diferencia de protocolo entre un
ratón de 2 botones y otro de 3 botones, es detectado y ajustado
automáticamente por <prgn>gpm</prgn> luego de pulsar una sola vez el
botón central.
<p>
Para el protocolo X con <ref id="gpmraw"> o sin <prgn>gpm</prgn>, use:
<list compact>
<item><tt>IntelliMouse</tt>: puerto serial (repetidor <prgn>gpm</prgn> con "ms3")
<item><tt>PS/2</tt>: puerto PS/2 (siempre pruebe este primero)
<item><tt>IMPS/2</tt>: cualquier puerto PS/2 (2, 3, or scroll mice, better)
<item><tt>MouseManPlusPS/2</tt>: puerto PS/2 Logitech
<item><tt>...</tt>
</list>
Véase más en <url id="&mousexf86;" name="Mouse Support in XFree86">.
<p>
En el caso de los ratones de rueda estándar de Microsoft, se ha informado que
funcionan mejor con:
<example>
/etc/gpm.conf            | /etc/X11/XF86Config-4
=========================+======================================
device=/dev/psaux        | Section "InputDevice"
responsiveness=          |  Identifier "Configured Mouse"
repeat_type=raw          |  Driver     "mouse"
type=autops2             |  Option     "CorePointer"
append=""                |  Option     "Device"   "/dev/mouse"
sample_rate=             |  Option     "Protocol" "IMPS/2"
                         |  Option     "Buttons" "5"
                         |  Option  "ZAxisMapping" "4 5"
                         | EndSection
</example>
<p>
Para algunas PC portátiles Toshiba, el activar <prgn>gpm</prgn>
antes de PCMCIA en el script de inicio System-V puede ayudar a prevenir
cuelgues del sistema.  Extraño pero cierto.

<sect1>USB mice
<p>
Make sure you have all required kernel functions activated through
kernel compile time configuration or modules:
<list compact>
<item>Under "Input core support":
<list compact>
<item>"Input core support" (CONFIG_INPUT, <file>input.o</file>),
<item>"Mouse support" (CONFIG_INPUT_MOUSEDEV, <file>mousedev.o</file>),
</list>
<item>Under "USB support":
<list compact>
<item>"Support for USB" (CONFIG_USB, <file>usbcore.o</file>),
<item>"Preliminary USB device filesystem" (CONFIG_USB_DEVICEFS),
<item>"UHCI" or "OHCI" (CONFIG_USB_UHCI || CONFIG_USB_UHCI_ALT ||
       CONFIG_USB_OHCI, <file>usb-uhci.o</file> || <file>uhci.o</file> ||
       <file>usb-ohci.o</file>),
<item>"USB Human Interface Device (full HID) support" (CONFIG_USB_HID,
      <file>hid.o</file>), and
<item>"HID input layer support" (CONFIG_USB_HIDINPUT)
</list>
</list>
Here, lower case names are module names.

<p>
Si no está usando devfs, cree un nodo de dispositivo con
<file>/dev/input/mice</file> major 13 y minor 63 de la siguiente manera:
<example>
# cd /dev
# mkdir input
# mknod input/mice c 13 63
</example>
<p>
Para un ratón <strong>USB</strong> típico de tres botones,
la configuración podría ser:
<example>
/etc/gpm.conf            | /etc/X11/XF86Config-4
=========================+======================================
device=/dev/input/mice   | Section "InputDevice"
responsiveness=          |  Identifier "Generic Mouse"
repeat_type=raw          |  Driver     "mouse"
type=autops2             |  Option     "SendCoreEvents" "true"
append=""                |  Option     "Device"   "/dev/input/mice"
sample_rate=             |  Option     "Protocol" "IMPS/2"
                         |  Option     "Buttons" "5"
                         |  Option  "ZAxisMapping" "4 5"
                         | EndSection
</example>
<p>
Véase <url id="&linuxusb;" name="Linux USB Project"> para más información
<sect1>Touch pad
<p>
Aunque el comportamiento predeterminado del touch pad en una computadora
portátil emula un ratón PS/2 de dos botones, el paquete
<package>tpconfig</package> permite el control absoluto del dispositivo.  Por
ejemplo, incluyendo <tt>OPTIONS="--tapmode=0"</tt> en
<file>/etc/default/tpconfig</file> desactivará el comportamiento molesto de
"pulsar mediante un golpecito".  Configure el <file>/etc/gpm.conf</file> de la
siguiente manera para usar tanto el touch pad como el control USB externo en
la consola:
<example>
device=/dev/psaux
responsiveness=
repeat_type=ms3
type=autops2
append="-M -m /dev/input/mice -t autops2"
sample_rate=
</example>
</sect>

<sect id="nfs">Configuración NFS
<p>
Configurar NFS en <file>/etc/exports</file>.
<example>
# apt-get install nfs-kernel-server
# echo "/ *.domainname-for-lan-hosts(rw,no_root_squash,nohide)" \
        &gt;&gt; /etc/exports
</example>
<url id="&examples;" name="Véase mi script de ejemplo para más detalles">.
</sect>

<sect id="samba">Configuración de Samba
<p>
Referencias:
<list compact>
<item><url id="&sambahome;">
<item>paquete <package>samba-doc</package>
</list>
<p>
Configurando Samba en modo "share" resulta más fácil ya que crea 
unidades compartidas de tipo WfW.  Pero es conveniente
configurarlo en modo "user".
<p>
Samba se puede configurar mediante <prgn>debconf</prgn> o <prgn>vi</prgn>:
<example>
# dpkg-reconfigure --priority=<var>low</var> samba # en Woody
# vi /etc/samba/smb.conf
</example>
<url id="&examples;" name="Véase mi script de ejemplo para más detalles">.
<p>
Añadir un nuevo usuario al archivo smbpasswd puede hacerse mediante
<prgn>smbpasswd</prgn>:
<example>
$su -c "smbpasswd -a nombre_usuario"
</example>
Para una compatibilidad óptima, asegúrese de usar contraseñas encriptadas.
<p>
Elija <tt>el nivel del SO</tt> según el siguiente sistema de equivalencias (cuanto
más grande es el número, mayor es la prioridad del servidor):
<example>
0:      Samba con poca potencia (nunca se convertirá en un navegador principal)
1:      Wfw 3.1, Win95, Win98, Win/me?
16:     Win NT WS 3.51
17:     Win NT WS 4.0
32:     Win NT SVR 3.51
33:     Win NT SVR 4.0
255:    Samba con mucha potencia
</example>
Asegúrese que los usuarios sean miembros del grupo propietario del directorio
que brinda acceso compartido y que el bit de ejecución del directorio esté 
activado.
</sect>

<sect id="printer">Configuración de la impresora
<p>
El método tradicional es mediante <prgn>lpr</prgn>/<prgn>lpd</prgn>.  Existe un
nuevo sistema CUPS&trade; (Common UNIX Printing System).  PDQ constituye otro
enfoque.  Consulte el <url id="&printing-howto;" name="Linux Printing HOWTO">
para más información.

<sect1 id="lprlpd"><prgn>lpr</prgn>/<prgn>lpd</prgn>
<p>
Para los spoolers <prgn>lpr</prgn>/<prgn>lpd</prgn> (<package>lpr</package>, 
<package>lprng</package> y <package>gnulpr</package>), configure el archivo 
<file>/etc/printcap</file> de la siguiente manera si están conectados
a una impresora PostScript o de texto:
<example>
<var>lp</var>|<var>alias</var>:\
        :sd=/var/spool/lpd/<var>lp</var>:\
        :mx#0:\
        :sh:\
        :lp=/dev/lp0:
</example>
Significado de las líneas anteriores:
<list compact>
<item>Cabecera: <var>lp</var> &mdash; nombre de la cola, <var>alias</var> =
 alias
<item>mx#0 &mdash; tamaño máximo del archivo ilimitado
<item>sh &mdash; supresión de la impresión de la primera página de cabecera
<item>lp=/dev/lp0 &mdash; dispositivo de impresión local o port@host para
impresión remota
</list>
Esto es una buena configuración si está conectado a una impresora PostScript.
Asimismo, cuando imprima desde una máquina Windows mediante Samba, resulta
ser una buena configuración para cualquier impresora compatible Windows
(comunicación bidireccional no soportada).  Debe seleccionar la
correspondiente configuración de la impresora bajo Windows.
<p>
Si no posee una impresora PostScript, necesitará configurar un sistema
de filtros usando <prgn>gs</prgn>.  
Existe diversas herramientas de configuración automáticas para configurar el
archivo <file>/etc/printcap</file>.
Cualquiera de estas combinaciones resulta ser una opción:
<list compact>
<item><package>gnulpr</package>, (<package>lpr-ppd</package>) y 
  <package>printtool</package> &mdash; El que utilizo.
<item><package>lpr</package> y <package>apsfilter</package>
<item><package>lpr</package> y <package>magicfilter</package>
<item><package>lprng</package> y <package>lprngtool</package>
<item><package>lprng</package> y <package>apsfilter</package>
<item><package>lprng</package> y <package>magicfilter</package>
<!-- I can think of more combinations but I add them if someone  
  actually report me they got it working with them.  -->
</list>
<p>
Para ejecutar herramientas de configuración gráficas, tales como
<prgn>printtool</prgn>, véase <ref id="ss-xsu"> para adquirir derechos de
superusuario.  Las impresoras creadas con <prgn>printtool</prgn> usan
<prgn>gs</prgn> y se comportan como impresoras PostScript.  Por lo 
tando al acceder a ellas, utilizan los controladores de impresora 
PostScript.  En lo referente a Windows, la "Apple LaserWriter"
es el estándar.
</sect1>

<sect1 id="cups">CUPS&trade;
<p>
El Common UNIX Printing System (o CUPS&trade;) se instala con
<prgn>aptitude</prgn> 
"Tareas" -&gt; 
"Servidores" -&gt; 
"Servidor de impresión".  (Sarge)
Para un mejor resultado, configure <prgn>aptitude</prgn> haciendo
"F10" -&gt;
"Opciones" -&gt; 
"Manejo de dependencias" -&gt; 
"[X] Instalar los paquetes recomendados automáticamente". 
<p>
Los entornos de escritorio KDE y Gnome permiten una configuración secilla de las impresoras.
De forma alternativa, si tiene instalado <package>swat</package> puede configurar el 
sistema usando cualquier navegador:

</p>
<p>
<example>
$ <var>mi_navegador</var> http://localhost:631
</example>
</p>
<p>
Por ejemplo, para añadir una impresora en algún puerto usando la lista
de impresoras accesibles:
<list>
<item>Pulse "Printers" (Impresoras) en la página principal y, a continuación
"Add Printer" (Añadir impresora),
<item>escriba "root" como usuario e ingrese su contraseña,
<item>proceda a añadir la impresora siguiendo los indicaciones,
<item>vuelva a la página "Printers" y pulse "Configure Printer" (Configurar
impresora) y
<item>proceda a configurar el tamaño del papel, la resolución y otros parámetros.
</list>
Véase más información en 
<url id="http://localhost:631/documentation.html"> y
<url id="&cups-help;">.
<p>
</sect1>
</sect>

<sect>Otros consejos de instalación

<sect1 id="post-inst">Instalación adicional de paquetes
<p>
Una vez llegado hasta este punto, posee un sistema &debian; 
pequeño pero funcional. Es tiempo de instalar paquetes más
grandes.
<list>
<item>Ejecute <prgn>tasksel</prgn>.  Veáse <ref id="tasksel">.
<p>
Si los necesita, puede elegir los siguientes paquetes:
<list compact>
<item>Usuario final &mdash; sistema X window
<item>Desarrollo &mdash; C y C++
<item>Desarrollo &mdash; Python
<item>Desarrollo &mdash; Tcl/Tk
<item>Otros &mdash; entorno TeX/LaTeX 
<item>
Para el resto &mdash; prefiero usar <prgn>tasksel</prgn> como guía
mirando en &lt;Task Info&gt; e instalarlos selectivamente mediante
<prgn>dselect</prgn>.
</list>

<item>Ejecute <prgn>dselect</prgn>. 
<p>
Aquí, lo primero que puede querer hacer es elegir su editor favorito y
todos los programas que necesita. Puede instalar diversas variantes de
Emacs al mismo tiempo. Véase <ref id="dselect"> y <ref id="pop-editor">.
<p>
También puede reemplazar algunos paquetes predeterminados por otros
con más opciones.
<list compact>
<item>... <!-- Add list in generic way. -->
</list>
<item>...
</list>

Generalmente edito <file>/etc/inittab</file> para apagar con facilidad
mi máquina.
<example>
...
# Qué hacer al presionar CTRL-ALT-DEL 
ca:12345:ctrlaltdel:/sbin/shutdown -t1 -a -h now
...
</example>
</sect1>

<sect1>Módulos
<p>
Los módulos para los controladores de dispositivos se configuran durante
la instalación inicial.  <prgn>modconf</prgn> proporciona una interfaz
con menús para la configuración posterior de los módulos. Este programa
resulta bastante útil cuando se olvida incluir algunos módulos durante
la instalación inicial o se instala un nuevo kernel después de realizar
la misma. 
<p>
Todos los módulos a cargar se encuentran en el archivo
<file>/etc/modules</file>.  También utilizo <prgn>lsmod</prgn> y
<prgn>depmod</prgn> para controlarlos manualmente.
<p>
Asimismo, asegúrese añadir algunas líneas en el
<file>/etc/modules</file> para administrar el enmascaramiento ip (ftp,
etc.) para núcleos 2.4.  Véase <ref id="kernel-modules"> y, en especial,
<ref id="kernel-net">.

</sect1>

<sect1>Configuración básica de una grabadora de CDs
<p>
Para una unidad CD-RW IDE y un núcleo 2.4, edite los siguientes archivos:
<example>
/etc/lilo.conf  (agregue append="hdc=ide-scsi ignore=hdc", 
                 y ejecute lilo para la activación)
/dev/cdrom      (enlace simbólico # cd /dev; ln -sf scd0 cdrom)
/etc/modules    (añada "ide-scsi" y "sg". Después de esto "sr" si se
                 necesita.)
</example>
Véase <ref id="cdrw"> para más detalles.
</sect1>

<sect1 id="apm">Gran cantidad de memoria y apagado automático
<p>
Edite el <file>/etc/lilo.conf</file> de la siguiente manera para
grandes cantidades de memoria (para núcleos 2.2) y apagado automático (para apm):
<example>
append="mem=128M apm=on apm=power-off noapic"
</example>
Ejecutar <prgn>lilo</prgn> para reconocer la nueva configuración.
<tt>apm=power-off</tt> es necesario para un núcleo SMP y <tt>noapic</tt>
es necesario para minimizar los efectos de mi hardware defectuoso.  Lo
mismo se puede hacer directamente escribiendo las opciones en el
indicador de arranque.  Véase <ref id="bootprompt">.
<p>
Si apm fue compilado como módulo, como ocurre con los núcleos
predeterminados 2.4 de Debian, ejecute <tt># insmod apm power_off=1</tt>
después del arranque o configure <file>/etc/modules</file> haciendo:
<example>
# echo "apm power_off=1" &gt;&gt;/etc/modules
</example>
<p>
En forma alternativa, el compilar el soporte ACPI permite alcanzar el
mismo objetivo con los núcleos nuevos y para ser más compatible con SMP
(esto requiere de una placa madre nueva).  El núcleo 2.4 en placas madre
deberían detectar grandes cantidades de memoria correctamente.
<example>
CONFIG_PM=y
CONFIG_ACPI=y
...
CONFIG_ACPI_BUSMGR=m
CONFIG_ACPI_SYS=m
</example>
y añada las siguientes líneas en <file>/etc/modules</file> respetando el orden:
<example>
ospm_busmgr
ospm_system
</example>
O recompile el núcleo con todas las opciones anteriores en "y".  En
cualquier caso, con ACPI no se necesita ninguno de los parámetros del
indicador de arranque.
</sect1>

<sect1 id="killecn">Problemas extraños al acceder a ciertos sitios de Internet
<p>
Por defecto, los núcleos recientes de Linux activan ECN, que puede
ocasionar problemas de acceso en algunos sitios web situados detrás de
un enrutador mal configurado. Para verificar el estado del ECN:
<example>
# cat /proc/sys/net/ipv4/tcp_ecn
 ... o
# sysctl net.ipv4.tcp_ecn
</example>
Para desactivarlo, haga:
<example>
# echo "0" > /proc/sys/net/ipv4/tcp_ecn
 ... o
# sysctl -w net.ipv4.tcp_ecn=0
</example>
Para desactivar TCP ECN en cada arranque, edite
<file>/etc/sysctl.conf</file> y añada:
<example>
net.ipv4.tcp_ecn = 0
</example>
</sect1>

<sect1>Configuración de una conexión telefónica con PPP
<p>
Instale el paquete <package>pppconfig</package> para configurar un acceso
telefónico mediante PPP.
<example>
# apt-get install pppconfig
# pppconfig
 ... siga las indicaciones para configurar PPP
# adduser <var>usuario</var> dip
 ... permite al <var>usuario</var> acceder a Internet mediante PPP
</example>
El acceso PPP puede ser iniciado por el usuario (<var>usuario</var>):
<example>
$ pon <var>nombre_ISP</var>   # inicia el acceso PPP a su ISP
 ... disfrute Internet
$ poff <var>nombre_ISP</var>  # detiene el acceso PPP, el <var>nombre_ISP</var>
es opcional 
</example>
Véase <ref id="low-ppp"> para más detalles.
</sect1>

<sect1>Otros archivos de configuración files para modificar en <file>/etc</file>
<p>
Puede que quiera añadir un archivo <file>/etc/cron.deny</file> que falta
en la instalación estándar de Debian (puede copiar <file>/etc/at.deny</file>).
</sect1>

</sect>

</chapt>





