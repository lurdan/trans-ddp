<!-- CVS revision of this document "$Revision: 1.10 $"  -->
<!-- CVS revision of original english document "1.22"  -->
<chapt id="woody">Aggiornare una distribuzione 

<![%f-ref;[
<p>
Le note ufficiali di rilascio per l'aggiornamento si trovano presso
<url id="&stable-release;">
e
<url id="&testing-release;"> (lavoro in corso).

<sect>Preparare la transizione (da "stable a "testing")
<p>
L'aggiornamento a "testing" tramite la rete può essere eseguito come
segue (lanciate lo script <url id="&examples;"
name="go-woody"> per fare questo con un unico comando):
]]>

<sect id="woody-transition">Transition of APT to the Woody version
<p>
Network upgrade of the APT system and some core packages to the Woody versions 
can be done as follows after including <tt>stable</tt> sources 
in the <file>/etc/apt/sources.list</file> if you still run Potato.
<example>
# apt-get update
# apt-get install libc6 perl libdb2 debconf
# apt-get install apt apt-utils dselect dpkg
</example>
<example>
# cd /etc/apt
# cp -f sources.list sources.old 
# :&gt;sources.list  
# cd /
# apt-setup noprobe 
 ... seleziona http o ftp
# cd /etc/apt
# grep -e "^deb " sources.list             &gt;sources.deb
# grep -e "^deb-" sources.list             &gt;sources.src
# sed -e "s/^d/#d/" \
  /usr/share/doc/apt/examples/sources.list &gt;sources.list
# sed -e "s/stable/testing/"  \
  sources.deb &gt;&gt;sources.list
# apt-get update
# apt-get install apt apt-utils
# cat &gt;preferences &lt;&lt;EOF
 Package: *
 Pin: release a=testing
 Pin-Priority: 700
 
 Package: *
 Pin: release a=unstable
 Pin-Priority: 70

 EOF
# sed -e "s/stable/unstable/" sources.deb \
  &gt;&gt;sources.list
# sed -e "s/stable/unstable/" sources.src | \
 sed -e "s/^deb-/#deb-/"  &gt;&gt;sources.list
</example>
Linee guida per <file>/etc/apt/preferences</file> (vedere <manref
name="apt_preferences" section="5">):
<example>
Se sei su stable: cambia la Pin-Priority di testing ad 80 
Se sei su testing: mantienilo così com'è (installa unstable da 
  /unstable) 
Se vuoi tracciare testing(da unstable): cambia la Pin-Priority di unstable a 600
Se vuoi tracciare unstable(da testing): cambia la Pin-Priority di unstable a 800
</example>
La logica dietro le linee guida per la scelta della Pin-Priority è di muoversi dall'alto
verso il basso della tabella precedente, man mano che il tempo passa,
dal momento immediatamente successivo al rilascio di una distribuzione
fino al momento del freeze della successiva.
<p>
Esempi di <file>/etc/apt/preferences</file> che bloccano alcuni pacchetti chiave
a versioni più mature, mentre seguono le versioni più nuove di altri pacchetti
meno essenziali, sono reperibili nella 
<url id="&examples;" name="subdirectory degli esempi"> come
<file>preferences.testing</file> e <file>preferences.unstable</file>.  Dall'altro
lato, <file>preferences.stable</file> forza tutti i pacchetti ad essere retrocessi a
"stable".
<p>
Impostate apt per l'uso di un proxy impostando la variabile di
ambiente <tt>http_proxy</tt>, oppure impostate il file
<file>/etc/apt/apt.conf</file>.
<p>
Il metodo appena descritto aggiorna solamente APT ed un numero
limitato di altri pacchetti, per evitare problemi di dipendenze.
</sect>

<sect>Aggiornamento a "testing"
<p>
Dopo aver eseguito la preparazione precedente, il sistema può essere aggiornato.

<sect1>La migliore pratica di aggiornamento è tramite <prgn>dselect</prgn>
<p>
Se un sistema ha molti pacchetti, inclusi i pacchetti <tt>-dev</tt>, etc., 
il metodo seguente tramite <prgn>dselect</prgn> è il metodo di scelta per un più
raffinato controllo sui pacchetti.
<example>
# dselect update (aggiorna) # da fare sempre prima di un aggiornamento
# dselect select (seleziona) # sceglie i pacchetti sotto "suggerisce" e "raccomanda"
# dselect install (installa)
</example>
<prgn>dselect</prgn> funziona sempre :)

<![%f-ref;[
<sect1>Pratica deprecata di aggiornamento tramite <prgn>apt-get</prgn>
<p>
<strong>L'utilizzo di <prgn>apt-get</prgn> descritto sotto è largamente usato
ma <em>non</em> è raccomandato per gli aggiornamenti del sistema.</strong>
]]>

Se dovete fare un aggiornamento senza <prgn>dselect</prgn> dopo Woody,
considerate <prgn>aptitude</prgn> ed altre opzioni.

<![%f-ref;[
<p>
Se il sistema non ha molti pacchetti, o se l'archivio &debian; non presenta 
cambiamenti importanti, quanto segue potrebbe bastare (talvolta).
<example>
# apt-get update # eseguitelo sempre prima dell'upgrade 
 ... per aggiornare l'intero sistema seguendo le selezioni sotto "dipende" 
# apt-get upgrade # eseguitelo sempre prima dell'upgrade 
 ... per aggiornare l'intero sistema seguendo le selezioni sotto "dipende"
# apt-get -u dist-upgrade 
 ... per aggiornare seguendo le impostazioni correnti di dselect 
(nuovo metodo, migliore) 
# apt-get -u dselect-upgrade # utilizza le impostazioni di dselect 
</example>
<p>
Dato che questo metodo utilizza <prgn>apt-get</prgn>, le sue capacità di gestione di 
<em>raccomanda</em> e <em>suggerisce</em> sono limitate. 
Vedere <ref id="depends">.
]]>

</sect>

<sect>Configurare Woody
<p>
Se avete un sistema woody installato di fresco, modificate
<file>/etc/apt/sources.list</file>, <file>/etc/apt/apt.conf</file>, e
<file>/etc/apt/preferences</file> per ottenere la stessa struttura
descritta nella sezione precedente.
<p>
APT in Potato non ha le funzioni descritte in 
<manref name="apt_preferences" section="5">.
</sect>

<![%f-ref;[
<sect>Ottimizzare <file>sources.list</file>
<p>
Crea <file>sources.list</file> automaticamente, basandosi sulla latenza e larghezza di
banda di ogni mirror.
<example>
# apt-get install apt-spy
# cd /etc/apt ; mv sources.list sources.list.org
# apt-spy -d testing -l sources.apt
</example>
<prgn>netselect-apt</prgn> è molto simile a <prgn>apt-spy</prgn>.
Crea un <file>sources.list</file> più completo, ma utilizza un metodo 
meno efficace di scelta del mirror migliore (comparazione del tempo di ping).
<prgn>apt-setup</prgn> è il metodo manuale per scegliere i mirror 
in <file>sources.list</file>, ma è ancora il metodo migliore
finchè <prgn>apt-spy</prgn> non migliora.
<p>
Questi sforzi di ottimizzazione non hanno prodotto risultati significativi
per me.  Usare i siti più vicini scelti da <prgn>apt-setup</prgn> 
è stato sufficiente.
</sect>

]]>


</chapt>
