<!-- CVS revision of this document "$Revision: 1.17 $"  -->
<!-- CVS revision of original english document "1.56"  -->

<chapt id="install">Suggerimenti per l'installazione di un sistema Debian
<p>
La documentazione ufficiale sull'installazione di Debian è localizzata presso
<url id="&stable-info;"> e
<url id="&stable-install;">.
<p>
Per le versioni in fase di sviluppo è localizzata presso
<url id="&testing-info;" > e
<url id="&testing-install;"> (il lavoro è in corso, talvolta potrebbe non essere reperibile)
<p>
Sebbene "&book-title;" data dai giorni del rilascio della distribuzione Potato,
gran parte del suo contenuto è stato aggiornato per &stabledebian; e &testingdebian;.

<sect>Tracce generali per l'installazione di Linux
<p>
Nell'ottica di ridurre al minimo i rischi connessi con l'uso dei
pacchetti da "testing" ed "unstable", è buona pratica avere un sistema con
un boot alternativo, in un sistema piccolo e stabile.

<sect1>Le basi della compatibilità hardware
<p>
Linux è compatibile con la maggior parte dei componenti per PC
esistenti. Può essere installato praticamente in ogni
configurazione. Per quanto mi riguarda, l'installazione è stata
semplice come per Window$ 95/98/Me. La lista di componenti compatibili
cresce di giorno in giorno.
<p>
Se avete un laptop, andate su:
<url id="&linonlap;" name="Linux on Laptops">
per indirizzi per l'installazione divisi per marca e modello.
<p>
La mia raccomandazione per i componenti di un desktop è, invece,
"Siate conservativi."
<list compact>
<item>SCSI invece di IDE per il lavoro, IDE/ATAPI HD per uso privato.
<item>IDE/ATAPI CD-ROM (o CD-RW).  
<item>PCI invece di ISA. In particolare per le NIC.  
<item>Usate NIC economiche.  Tulip per PCI, NE2000 per ISA sono più
      che buone.  
<item>Evitare PCMCIA (notebook) se siete alla prima installazione.
<item>Evitate le tastiere, mouse, ecc. USB..a meno che vogliate accettare una sfida.
</list>
Per macchine lente, bypassarne il disco rigido ed interfacciarle con macchine
più veloci per eseguire l'installazione di Linux può essere una buona idea.
</sect1>

<sect1>Definire i componenti del PC ed il chipset
<p>
Durante l'installazione vi verranno richieste informazioni sull'hardware o sui
chipset, informazioni non sempre facili da reperire. Ecco un metodo:
<enumlist compact>
  <item>Aprite il PC e guardate dentro.  
  <item>Scrivete i numeri presenti sui grossi chip sulle schede grafiche, sulle schede di rete, sui chip situati
  vicino alle porte seriali ed alle porte IDE.  
  <item>Scrivete i nomi scritti sul dorso delle schede PCI ed ISA.
</enumlist>
</sect1>

<sect1>Definire i componenti del PC tramite &debian;
<p>
Dare i comandi seguenti all'interno di un sistema Linux già installato,
fornisce qualche idea sull'hardware presente e sulla sua configurazione.
<example>
$ lspci -v |pager 
$ pager /proc/pci 
$ pager /proc/interrupts 
$ pager /proc/ioports
</example>
Questi comandi possono essere dati durante il processo di installazione dalla console,
premendo ALT-F2.
</sect1>

<sect1>Definire i componenti del PC tramite altri S.O.
<p>
Una ulteriore fonte di informazione è rappresentata dagli altri sistemi
operativi.
<p>
Installate una distribuzione di Linux commerciale. I sistemi di riconoscimento
dell'hardware tendono ad essere migliori della Debian, al momento. Le
differenze si livelleranno all'introduzione del debian-installer con Sarge.
<p>
Installate Windows.  La configurazione attuale del PC può essere
ottenuta cliccando con il pulsante destro del mouse su "Risorse del
Computer" e poi "Proprietà", ottenendo informazioni tipo IRQ,
indirizzi di porta I/O, DMA. Alcune vecchie schede ISA potrebbero aver
bisogno di essere configurate sotto DOS, ed utilizzate di conseguenza.
</sect1>

<sect1>Il mito Lilo
<p>
Lilo è limitato ai primi 1024 cilindri. &mdash;SBAGLIATO !
<p>
Il nuovo <prgn>lilo</prgn>, usato nella Debian potato ha il supporto lba32. Se il
BIOS o la scheda madre sono abbastanza recenti da supportare lba32, <prgn>lilo</prgn>
dovrebbe essere in grado di caricarsi oltre il vecchio limite dei 1024
cilindri.
<p>
Se avete tenuto il vostro vecchio <prgn>lilo.conf</prgn>, vi basterà aggiungere una
riga con "lba32" da qualche parte vicino all'inizio del file.Vedere <file>&f-lilo;</file>
</sect1>

<sect1 id="instgrub">GRUB
<p>
Il nuovo boot loader <package>grub</package>, proveniente dal progetto GNU HURD, può 
essere installato su un sistema &debian; Woody:
<example>
# apt-get update
# apt-get install grub-doc
# mc &f-grub-doc;
... leggete il contenuto
# apt-get install grub
# pager &f-grub;
... leggetelo :)
</example>
Per modificare il menu di GRUB, aprite <file>&f-grub-menu;</file>.  Guardate 
<ref id="bootgrub"> su come impostare i parametri di boot durante il processo di 
inizializzazione, dato che sono lievemente diversi da <package>lilo</package>.
</sect1>

<sect1 id="bootfloppy">Scegliere i boot floppies
<p>
Per Potato ho apprezzato molto il set di dischi denominato IDEPCI per il
desktop.
Per Woody, apprezzo il set bf2.4.  Entrambi i set usano una versione di 
<package>boot-floppies</package> per creare i floppy di boot.
<p>
Se avete una scheda di rete PCMCIA, dovete usare il set di dischi boot standard
(numero di floppy maggiore, ma tutti i moduli dei driver disponibili)
e configurare la NIC nel setup PCMCIA; non provate ad impostare una card NIC 
dal daal'interfaccia di configurazione della rete standard.
<p>

Per sistemi particolari, potete creare un disco di salvataggio fatto
apposta, sostituendo l'immagine del kernel denominata "linux" sul
disco di salvataggio &debian; con un'altra immagine compilata apposta
altrove per la suddetta macchina.  
I dettagli dell'operazione li trovate sul <file>readme.txt</file> sul
dischetto di salvataggio.
Il floppy è formattato con il filesystem MSDOS, per cui potete utilizzare
qualunque sistema per leggerlo e modificarlo. Ciò dovrebbe rendere la vita più semplice a
coloro con particolari schede di rete, ecc...
<p>
Per Sarge, <package>debian-installer</package> e/o 
<package>pgi</package> si pensa verranno usati per creare i boot floppies.
</sect1>

<sect1>Installazione
<p>
Seguite le istruzioni ufficiali reperibili presso
<url id="&stable-install;">
e
<url id="&testing-install;"> (il lavoro è in corso, talvolta potrebbe non essere reperibile).
<p>
Se installate un sistema tramite i boot floppies della distribuzione testing, 
potreste avere bisogno di aprire un nuovo terminale durante il processo di installazione 
premendo <tt>ALT-F2</tt> e di modificare manualmente le voci di <file>/etc/sources.list</file>
da <tt>stable</tt> a <tt>testing</tt> per aggiustare le fonti di reperimento dei pacchetti di APT.
<p>
Io tendo ad installare <prgn>lilo</prgn> in posti tipo <file>/dev/hda3</file>,
mentre <prgn>mbr</prgn> in <file>/dev/hda</file>.  Ciò minimizza il rischio di sovrascrivere 
le informazioni di boot.
<p>
Ecco le mie scelte durante l'installazione.
<list compact>
<item>MD5 passwords "si"
<item>shadow passwords "si"
<item>Installazione "avanzata" (dselect **) e scegliere
  <list compact>
    <item>Escludere emacs (se è selezionato), nvi, tex, telnet, talk(d); 
    <item>Includere mc, vim, uno fra nano-tiny od elvis-tiny.
    <p>
     Vedere <ref id="dselect">. Anche se siete dei fanatici di Emacs, evitatelo per ora 
     ed accontentatevi di nano durante l'installazione.  Evitate anche di installare altri 
     grossi pacchetti, tipo TEX (Potato faceva questo) a questo stadio.
     Vedere <ref id="bin-editor"> per le ragioni per installare nano-tiny od elvis-tiny.
  </list>
<item>Rispondo a tutte le domande di configurazione = "y" (sostituisce l'attuale) durante 
  le domande per l'installazione di ciscun pacchetto.
<item><package>exim</package>: seleziono 2 per la macchina, dato che invio la posta tramite il  
  server SMTP del mio provider.
</list>
<p>
Per ulteriori informazioni su dselect, vedere <ref id="dselect">.
</sect1>

<sect1>Quale host ed IP usare per una LAN
<p>
Esempio di configurazione di una LAN (C subnet: 192.168.1.0/24):
<example>
Internet
   |
   +--- Un ISP esterno fornisce il servizio POP (raggiunto da fetchmail)
   | 
  Un punto di accesso dell'ISP fornisce i servizi DHCP e SMTP
   |                     :
  Modem              (Dial-up)
   |                     :
Porta esterna della macchina gateway della LAN: eth0 (IP dato dal DHCP dell'ISP)
 usa un vecchio notebook (IBM Thinkpad, 486 DX2 50 MHz, 20 MB RAM)
 gira Linux con kernel 2.4 e file system ext3.
 gira il pacchetto "ipmasq" (con patch più sicura, NAT e firewall)
 gira il pacchetto "dhcp-client" configurato per eth0 (scavalca le impostazioni DNS)
 gira il pacchetto "dhcp" configurato per eth1
 gira "exim" come smarthost (modo 2)
 gira "fetchmail" con un intervallo lungo (ripiego)
 gira "bind" come cache name server per Internet dalla LAN
            come name server autoritativo per il dominio LAN dalla LAN
 gira "ssh" sulle porte 22 e 8080 (connessione da ovunque)
 gira "squid" come cache server per l'archivio Debian (per APT)
Porta interna della macchina gateway della LAN: eth1 (IP = 192.168.1.1, fisso)
                         |
         +--- LAN Switch (10 base T) ---+
         |                              |
Alcuni clienti IP fissi sulla LAN     Alcuni clienti DHCP sulla LAN
(IP = 192.168.1.2-127, fisso)    (IP = 192.168.1.128-200, dinamico)
</example>
Vedere <ref id="gateway"> per i dettagli sulla configurazione del gateway server.
</sect1>

<sect1>Account utenti
<p>
Per avere lo stesso aspetto di "famiglia" tra le varie macchine, i
primi account che imposto sono sempre gli stessi.
<p>
Il primo account che creo è sempre uno del tipo "admin"
(uid=1000). Tutta la posta per il root viene reindirizzata lì. Questo
account è aggiunto al gruppo <tt>adm</tt> (vedere <ref id="wheel">), al quale viene data una certa
quota di privilegi di root tramite <prgn>su</prgn>, usando PAM, od il comando <prgn>sudo</prgn>. Vedere <ref
id="newuser"> per i dettagli.
</sect1>

<sect1>Creare i file systems
<p>
<sect2>Partizionare il disco rigido
<p>
Per limitare i danni in caso di crash del sistema, preferisco tenere
partizioni diverse per directory diverse. Per esempio,
<example>
/          == (/ + /boot + /bin + /sbin)
           == 50MB+
/tmp       == 100MB+
/var       == 100MB+
/home      == 100MB+
/usr       == 700MB+ con X
/usr/local == 100MB
</example>
<p>
Le dimensioni della directory <file>/usr</file> dipendono strettamente dal
tipo di applicazione X-window. <file>/usr</file> può essere di soli 300MB
per la sola console, mentre 2GB&ndash;3GB non sono inusuali se si vogliono installare varie
applicazioni di Gnome.

Quando <file>/usr</file> diventa troppo grande, la cura più efficace è spostare 
<file>/usr/share/</file> in una partizione diversa. Con i nuovi kernel 2.4 
pre-impacchettati, <file>/</file> può avere bisogno di più di 200MB di spazio.

<p>
Per esempio, la configurazione attuale della mia macchina che funge da
Internet gateway, è la seguente (output del comando <tt>df -h</tt>):
<example>
Filesystem            Size  Used Avail Use&percnt; Mounted on
/dev/hda3             300M  106M  179M  38&percnt; /
/dev/hda7             100M   12M   82M  13&percnt; /home
/dev/hda8             596M   53M  513M  10&percnt; /var
/dev/hda6             100M  834k   94M   1&percnt; /var/lib/cvs
/dev/hda9             596M  222M  343M  40&percnt; /usr
/dev/hda10            596M  130M  436M  23&percnt; /var/cache/apt/archives
/dev/hda11            1.5G  204M  1.2G  14&percnt; /var/spool/squid
</example>
(Le grosse dimensioni di <file>/var/spool/squid</file> sono per la funzione di proxy cache e per
lo scarico dei pacchetti).
<p>
Per dare un'idea della struttura delle partizioni, il seguente è l'output di <tt>fdisk -l</tt>.
<example>
# fdisk -l /dev/hda # commenti

/dev/hda1             1        41    309928+   6  FAT16 # DOS
/dev/hda2            42        84    325080   83  Linux # (not used)
/dev/hda3   *        85       126    317520   83  Linux # Main
/dev/hda4           127       629   3802680    5  Extended
/dev/hda5           127       143    128488+  82  Linux swap
/dev/hda6           144       157    105808+  83  Linux
/dev/hda7           158       171    105808+  83  Linux
/dev/hda8           172       253    619888+  83  Linux
/dev/hda9           254       335    619888+  83  Linux
/dev/hda10          336       417    619888+  83  Linux
/dev/hda11          418       629   1602688+  83  Linux
</example>
Ci sono alcune partizioni inutilizzate. Queste servono per installare una
seconda distribuzione di Linux, o come spazio per espandere qualche directory
in crescita.

<sect2>Montare i file systems
<p>
Il montaggio appropriato delle partizioni avviene mediante il seguente
<file>/etc/fstab</file>.
<example>

# /etc/fstab: static file system information.
#
# file system   mount point     type    options                dump pass
/dev/hda3       /               ext2    defaults,errors=remount-ro 0 1
/dev/hda5       none            swap    sw                      0 0
proc            /proc           proc    defaults                0 0
/dev/fd0        /floppy         auto    defaults,user,noauto    0 0
/dev/cdrom      /cdrom          iso9660 defaults,ro,user,noauto 0 0
#
# mantenete le partizioni separate 
/dev/hda7       /home           ext2    rw                      0 2
/dev/hda8       /var            ext2    rw                      0 2
/dev/hda6       /var/lib/cvs    ext2    rw                      0 2
/dev/hda9       /usr            ext2    rw                      0 2
/dev/hda10      /var/cache/apt/archives ext2    rw              0 2

# una partizione molto grande come proxy cache 
/dev/hda11      /var/spool/squid ext2   rw                      0 2

# DOS bootabile di backup 
/dev/hda1       /mnt/dos        vfat    rw,noauto               0 0
# Linux bootabile di backup (non ancora fatto) 
/dev/hda2       /mnt/linux      ext2    rw,noauto               0 0
#
# nfs mounts
mickey:/        /mnt/mickey     nfs     ro,noauto,intr          0 0
goofy:/         /mnt/goofy      nfs     ro,noauto,intr          0 0
# minnie:/ /mnt/minnie smbfs ro,soft,intr,credentials={filename} 0 2
</example>

Per NFS, uso qui le opzioni <tt>noauto,intr</tt> combinate con quella di default <tt>hard</tt>. 
In tal modo, un processo che si blocca in seguito alla perdita di
connessione può essere recuperato mediante Control-C.
<p>
Usare <tt>rw,auto,soft,intr</tt> per macchine Windows connesse tramite Samba
(smbfs), può essere una buona idea. Vedere <ref id="samba">.
<p>
Per i floppy, utilizzare <tt>noauto,rw,sync,user,exec</tt> previene la corruzione dei
file in caso di rimozione accidentale del disco prima di averlo smontato, però
rallenta il processo di scrittura.

<sect2>Montaggio con autofs
<p>
Punti chiave per il montaggio automatico (auto mount):
<list compact>
<item>Caricare il modulo <tt>vfat</tt> per permettere a <file>/etc/auto.misc</file>
 di contenere <tt>-fstype=auto</tt>:
<example>
# modprobe vfat # prima del tentativo di accedere al floppy
 ... oppure automatizzate il processo,
# cat >>/etc/modules
vfat
^D
 ... e riavviate il sistema.
</example>
<item>Impostate <file>/etc/auto.misc</file> come segue:
<example>
floppy -fstype=auto,sync,nodev,nosuid,gid=100,umask=000 :/dev/fd0
 ... dove gid=100 è "users".
</example>
<item>Create i collegamenti in <file>/home/<var>user</var></file>, <file>cdrom</file> 
 e <file>floppy</file>, che puntino a 
 <file>/var/autofs/misc/cdrom</file> e 
 <file>/var/autofs/misc/floppy</file>, rispettivamente.
<item>Rendete <var>user</var> membro del gruppo "users".
</list>

<sect2>Montaggio del NFS
<p>
Il server esterno nfs (goofy) risiede dietro il firewall (gateway). Dato che
sono l'unico ad usarla, ho delle regole di sicurezza sulla LAN molto
rilassate. Per abilitare l'accesso NFS, il server NFS necessita di aggiungere
<tt>/etc/exports</tt> come segue:
<example>
# /etc/exports: lista di controllo degli accessi per filesystems che possono
#               essere esportati ai clienti NFS. Vedere exports(5).  
/       (rw,no_root_squash)
</example>
Ciò è richiesto per attivare il server NFS, in aggiunta all'installazione e ad
attivazione del server/client NFS.
<p>
Per semplicità, in genere creo un partizione singola di circa 2GB per
installazioni sperimentali e/o secondarie di linux. Opzionalmente condivido le
partizioni di swap e <file>/tmp</file>. Per questi scopi lo schema a partizioni multiple è
eccessivo. Se vi serve un semplice sistema a console, bastano 500MB.
</sect1>

<sect1>Linee guida per la memoria DRAM
<p>
Di seguito presento alcune (grandi) linee guida per le DRAM.
<example>
  4 MB: Il minimo necessario a far funzionale il kernel di Linux.  
 16 MB: Il minimo per un sistema con console.
 32 MB: Il minimo per un semplice sistema X. 
 64 MB: Il minimo per X con GNOME/KDE.
128 MB: Il giusto per X con GNOME/KDE.
256+MB: Perché no? se ve le potete permettere. Le DRAM sono economiche.
</example>
L'opzione di boot <tt>mem=4m</tt> (o lilo <tt>append="mem=4m"</tt>) vi mostra come il sistema si
comporta con soli 4MB di memoria installati. Il parametro di boot per lilo è
necessario per sistemi con vecchi BIOS e più di 64MB di memoria.
</sect1>

<sect1>Lo spazio di swap
<p>
Uso la formula seguente:
<list compact>
<item>Ciascuna partizione di swap è di &lt; 128 MB (con vecchi kernel 2.0), &lt; 2 GB (kernel recenti)
<item>Totale = o (1 o 2 volte la RAM installata) o (da 128 MB a 2 GB) come guida generale
<item>Spalmatele su dischi diversi e montatele tutte con le opzioni 
 <tt>sw,pri=1</tt> in <file>/etc/fstab</file>.  Ciò assicura che il
 kernel faccia una sorta di RAID di partizioni swap ed offre il massimo
 di prestazioni di swap.
<item>Usste la porzione centrale del disco rigido quando possibile.
</list>
<p>
Anche se non ne avrete mai bisogno, un pò di spazio swap (128MB) è comunque
desiderabile, in modo che un programma che ha un leak di memoria rallenti
progressivamente il sistema prima di bloccarlo definitivamente.
</sect1>
</sect>

<sect>Configurare Bash
<p>
Modifico gli script di inizio della shell a mio piacimento:
<example>
/etc/bash.bashrc        Sostituire con copia privata
/etc/profile            Mantenere la copia della distribuzione ( \w -&gt; \W) 
/etc/skel/.bashrc       Sostituire con copia privata 
/etc/skel/.profile      Sostituire con copia privata
/etc/skel/.bash_profile Sostituire con copia privata 
~/.bashrc               Sostituire con copia privata per tutti gli accounts 
~/.profile              Sostituire con copia privata per tutti gli accounts 
~/.bash_profile         Sostituire con copia privata per tutti gli accounts
</example>
<url id="examples/" name="Per i dettagli vedere i miei esempi."> Mi piacciono
i sistemi trasparenti, così imposto <prgn>umask</prgn> a 002 o 022.
<p>
<prgn>PATH</prgn> viene impostato dai seguenti file di configurazione, in questo ordine.
<example>
/etc/login.defs   - prima del PATH impostato per la shell 
/etc/profile      ( può chiamare /etc/bash.bashrc) 
~/.bash_profile   ( può chiamare ~/.bashrc)
</example>
</sect>

<sect>Configurare il mouse
<p>
<sect1> Mouse PS/2 
<p>
In caso di un mouse PS/2 con scheda madre ATX, il flusso del segnale deve
essere:
<example>
mouse -&gt; /dev/psaux -&gt; gpm -&gt; /dev/gpmdata = /dev/mouse -&gt; X
</example>
In questo caso si crea un link simbolico <file>/dev/mouse</file> che punta a
<file>/dev/gpmdata</file> per rendere felici alcune utilità di configurazione
e per rendere facile la reconfigurazione. 
(Per esempio se decidete di non usare per niente il demone gpm, basta puntare
il link simbolico <file>/dev/mouse</file> a <file>/dev/psaux</file> dopo essersi
liberati del demone <prgn>gpm</prgn>.)
<p>
Il flusso del segnale permette di deconnettere e reinizializzare la tastiera ed il mouse
riavviando <prgn>gpm</prgn> dopo la riconnessione.  
X rimarrà funzionante! 
<p>
Il protocollo del flusso del segnale tra l'output di <prgn>gpm</prgn> e l'input di X 
può essere implementato in due modi, come "ms3" (protocollo del mouse seriale Microsoft 
a 3 pulsanti) o come "raw" (usa lo stesso protocollo del mouse che è connesso) e questa
scelta condiziona la scelta del protocollo usato nella configurazione di X.
<p>
Mostrerò gli esempi di configurazione usando un mouse Logitech a 3 pulsanti
(mouse tradizionale nello stile Unix) PS/2 come modello.
<p>
Se siete tra gli sfortunati la cui scheda grafica non è supportata dal
nuovo X4 e dovete utilizzare il vecchio X3 (alcune schede ATI 64), configurate 
<tt>/etc/X11/X86Config</tt> invece di <tt>/etc/X11/X86Config-4</tt>
come negli esempi seguenti, durante l'installazione dei pacchetti di X3.

<sect2 id="gpmms3">Approccio con protocollo ms3
<p>
<example>
/etc/gpm.conf            | /etc/X11/X86Config-4
=========================+======================================
device=/dev/psaux        | Section "InputDevice"
responsiveness=          |  Identifier "Configured Mouse"
repeat_type=ms3          |  Driver     "mouse"
type=autops2             |  Option     "CorePointer"
append=""                |  Option     "Device"   "/dev/mouse"
sample_rate=             |  Option     "Protocol" "IntelliMouse"
                         | EndSection
</example>
Usando questo approccio, le modifiche del tipo di mouse vanno fatte solo in
<file>gpm.conf</file>, mentre la configurazione di X rimane costante.
Vedere <url id="examples/" name="i miei script di esmpio">.

<sect2 id="gpmraw">Approccio con protocollo raw
<p>
<example>
/etc/gpm.conf            | /etc/X11/X86Config-4
=========================+======================================
device=/dev/psaux        | Section "InputDevice"
responsiveness=          |  Identifier "Configured Mouse"
repeat_type=raw          |  Driver     "mouse"
type=autops2             |  Option     "CorePointer"
append=""                |  Option     "Device"   "/dev/mouse"
sample_rate=             |  Option     "Protocol" "MouseManPlusPS/2"
                         | EndSection
</example>
Usando questo approccio, le modifiche del tipo di mouse vanno fatte sia in
<file>gpm.conf</file> che aggiustando la configurazione di X.

<sect2>Come adattarsi ai diversi tipi di mouse
<p>
Il dispositivo di <prgn>gpm</prgn> denominato <tt>autops2</tt> si suppone sia 
in grado di riconoscere la gran parte dei mouse PS/2 sul mercato.  Sfortunatamente non sempre 
funziona e non è disponibile nelle versioni pre-Woody.  
Provate ad usare <tt>ps2</tt>, o <tt>imps2</tt> in <file>gpm.conf</file> 
al posto di <tt>autops2</tt> in questi casi.  Per scoprire quali tipi di 
mouse gpm conosce date: <tt>gpm -t help</tt>.
Vedere <manref name="gpm" section="8">.
<p>
Se utilizzate un mouse a 2 pulsanti PS/2, impostate il protocollo di X
in modo da abilitare <tt>Emulate3Buttons</tt>. La differenza di protocollo fra 
un mouse a 2 pulsanti e quello a 3 viene riconosciuta ed impostata automaticamente 
da <prgn>gpm</prgn> dopo aver premuto il pulsante di mezzo una volta.
<p>
Per il protocollo X con <ref id="gpmraw"> o senza <prgn>gpm</prgn>, usate:
<list compact>
<item><tt>IntelliMouse</tt>: mouse seriale (ripetitore gpm con "ms3")
<item><tt>PS/2</tt>: mouse PS/2 (provatelo sempre, prima)
<item><tt>IMPS/2</tt>: qualsiasi mouse PS/2 (2, 3, o con rotella, migliore)
<item><tt>MouseManPlusPS/2</tt>: Mouse Logitech PS/2 
<item><tt>...</tt>
</list>
Per saperne di più vedere <url id="&mousexf86;" name="Supporto per il mouse in XFree86">.
<p>
Il mouse con rotella classico Microsoft funziona al meglio con:
<example>
/etc/gpm.conf            | /etc/X11/X86Config-4
=========================+======================================
device=/dev/psaux        | Section "InputDevice"
responsiveness=          |  Identifier "Configured Mouse"
repeat_type=raw          |  Driver     "mouse"
type=autops2             |  Option     "CorePointer"
append=""                |  Option     "Device"   "/dev/mouse"
sample_rate=             |  Option     "Protocol" "IMPS/2"
                         |  Option     "Buttons" "5"
                         |  Option  "ZAxisMapping" "4 5"
                         | EndSection
</example>
<p>
Per alcuni nuovi notebook Toshiba ultrapiatti: Attivare <prgn>gpm</prgn> prima di PCMCIA nello
script di inizializzazione del System-V. Ciò evita che gpm si pianti. Strano,
ma vero.

<sect1>Mouse USB
<p>
Accertatevi di avere:
<list compact>
<item>"Input Core Support" e "Input Core Support/Mouse Support"
       attivati nel kernel o come moduli.
<item>"Support for USB", "Preliminary USB device filesystem",
      "UHCI o OHCI" e "USB HID Support" attivati nel
       kernel o come moduli.
</list>
<p>
Se non usate devfs, create un device node <file>/dev/input/mice</file> 
con major 13 e minor 63 come segue:
<example>
# cd /dev
# mkdir input
# mknod input/mice c 13 63
</example>
<p>
Per i tipici mouse a 3 pulsanti <strong>USB</strong>, 
le combinazioni di configurazione dovrebbero essere:
<example>
/etc/gpm.conf            | /etc/X11/X86Config-4
=========================+======================================
device=/dev/input/mice   | Section "InputDevice"
responsiveness=          |  Identifier "Generic Mouse"
repeat_type=raw          |  Driver     "mouse"
type=autops2             |  Option     "SendCoreEvents" "true"
append=""                |  Option     "Device"   "/dev/input/mice"
sample_rate=             |  Option     "Protocol" "IMPS/2"
                         |  Option     "Buttons" "5"
                         |  Option  "ZAxisMapping" "4 5"
                         | EndSection
</example>
<p>
Vedere <url id="&linuxusb;" name="Linux USB Project"> per maggiori informazioni.
</sect>

<sect>Configurare NFS
<p>
Impostate NFS tramite <file>/etc/exports</file>.
<example>
# echo "/ *.domainname-for-lan-hosts(rw,no_root_squash,nohide)" \ 
        &gt;&gt; /etc/exports
</example>
<url id="examples/" name="Per i dettagli vedere i miei esempi.">
</sect>

<sect id="samba">Configurare Samba
<p>
Riferimenti:
<list compact>
<item><url id="&sambahome;">
<item>il pacchetto <package>samba-doc</package>
</list>
<p>
Impostare Samba in modalità "share" è molto più semplice, dato che crea dei
dischi di share sul modello WfW. E' comunque molto meglio l'impostazione in
modalità "user".
<p>
Samba può essere configurato con <prgn>debconf</prgn> o <prgn>vi</prgn>:
<example>
# dpkg-reconfigure --priority=<var>low</var> samba # in Woody
# vi /etc/samba/smb.conf
</example>
<url id="examples/" name="Per i dettagli vedere i miei esempi.">
<p>
L'aggiunta di un nuovo utente al file smbpasswd può essere fatta tramite
<prgn>smbpasswd</prgn>:
<example>
$su -c "smbpasswd -a nomeutente"
</example>
Per la migliore compatibilità, usate password criptate.
<p>
Impostate il <tt>os level</tt> sulla base delle equivalenze di sistema
seguenti (maggiore il numero, più alta la priorità come server).
<example>
0: Samba con attitudini molto lasse 1: Wfw 3.1, Win95, Win98, Win/me?  16: Win
NT WS 3.51 17: Win NT WS 4.0 32: Win NT SVR 3.51 33: Win NT SVR 4.0 255: Samba
con poteri estesi
</example>
Accertatevi che gli utenti siano membri del gruppo a cui appartiene la
directory che offre l'accesso condiviso e che il percorso alla directory abbia
il bit di esecuzione impostato.
</sect>

<sect id="printer">Configurare la stampante
<p>
Il metodo tradizionale è <prgn>lpr</prgn>/<prgn>lpd</prgn>.  Esiste un nuovo
sistema CUPS&trade; (Common UNIX Printing System).  PDQ è un altro approccio.
Vedere il <url id="&printing-howto;" name="Linux Printing HOWTO"> per
maggiori informazioni.

<sect1 id="lprlpd"><prgn>lpr</prgn>/<prgn>lpd</prgn>
<p>
Per i vari tipi di spooler <prgn>lpr</prgn>/<prgn>lpd</prgn>
(<package>lpr</package>, <package>lprng</package>, e
<package>gnulpr</package>), impostate <file>/etc/printcap</file> come segue se
sono connessi ad una stampante solo testo o PostScript (le basi):
<example>
<var>lp</var>|<var>alias</var>:\ :sd=/var/spool/lpd/<var>lp</var>:\ :mx#0:\
        :sh:\ :lp=/dev/lp0:
</example>
Cosa significano le righe precedenti:
<list compact>
<item>Riga di intestazione: <var>lp</var> &mdash; nome dello spool,
 <var>alias</var> = alias <item>mx#0 &mdash; dimensione massima del file
 illimitata <item>sh &mdash; sopprime la stampa dell' header di pagina
 <item>lp=/dev/lp0 &mdash; stampante locale, oppure porta@host se remota
</list>
Questa è una buona configurazione se siete connessi ad una stampante
PostScript.  In più è una buona configurazione anche se state stampando da una
macchina Windows tramite Samba per qualsiasi stampante supportata da Windows
(la comunicazione bidirezionale non è supportata).  Dovete solo selezionare la
configurazione della stampante corrispondente sulla macchina Windows.
<p>
Se non avete una stampante PostScript dovete impostare un sistema di filtro
usando <prgn>gs</prgn>.  
Esistono molti strumenti di autoconfigurazione per l'impostazione di 
<file>/etc/printcap</file>.
Potete scegliere una qualsiasi di queste combinazioni:
<list compact>
<item><package>gnulpr</package>, (<package>lpr-ppd</package>) e 
  <package>printtool</package> &mdash; Io uso questa.
<item><package>lpr</package> e <package>apsfilter</package>
<item><package>lpr</package> e <package>magicfilter</package>
<item><package>lprng</package> e <package>lprngtool</package>
<item><package>lprng</package> e <package>apsfilter</package>
<item><package>lprng</package> e <package>magicfilter</package> <!-- I can
think of more combinations but I add them if someone actually report me they
got it working with them.  -->
</list>
<p>
Per lanciare gli strumenti grafici di configurazione, tipo
<prgn>printtool</prgn>, vedere <ref id="ss-xsu"> per ottenere i privilegi di
root.  Gli spool creati con <prgn>printtool</prgn> usano <prgn>gs</prgn> ed
agiscono come stampanti PostScript.  Per cui, quando vi accedete, usate i
driver delle stampanti PostScript.  Sul lato Windows, lo standard è "Apple
LaserWriter".
</sect1>

<sect1 id="cups">CUPS&trade;
<p>
Installazione del Common UNIX Printing System (o CUPS&trade;):
<example>
# apt-get install cupsys cupsomatic-ppd apt-get install cupsys-bsd
# cupsys-driver-gimpprint
</example>
<!-- CUPS dependencies: Recommends are not installed automatically -->
<p>
Poi configuratelo con qualsiasi browser:
</p>
<p>
<example>
$ <var>miobrowser</var> http://localhost:631
</example>
</p>
<p>
Per esempio, per aggiungere la vostra stampante collegata ad una porta
qualsiasi all'elenco delle stampanti accessibili:
<list>
<item>cliccate "Printers" dalla pagina principale e poi "Add Printer",
<item>date "root" come username e la sua password,
<item>procedete ad aggiungere la stampante seguendo le istruzioni,
<item>tornate alla pagina "Printers" e cliccate "Configure Printer" e
<item>procedete alla configurazione delle dimensioni della carta, risoluzione, e degli altri 
 parametri.
</list>
per maggiori informazioni
<url id="http://localhost:631/documentation.html"> e
<url id="&cups-help;">.
<p>
Per i kernel 2.4 kernel, vedere anche <ref id="parport">.
</sect1>
</sect>

<sect>Altri consigli di configurazione per l'host

<sect1>Installate pochi altri pacchetti dopo l'installazione iniziale
<p>
Una volta qui, avete un piccolo, ma funzionante, sistema &debian;. 
E' il momento giusto per installare i pacchetti più grandi.
<list>
<item>Lanciate <prgn>tasksel</prgn>.  Vedere <ref id="tasksel">.
<p>
Potete scegliere fra i seguenti task, se ne avete bisogno:
<list compact>
<item>Utente finale (End-user) &mdash; X window system
<item>Sviluppo (Development) &mdash; C e C++
<item>Sviluppo &mdash; Python
<item>Sviluppo &mdash; Tcl/Tk
<item>Miscellanea &mdash; ambiente TeX/LaTeX
<item>
Per gli altri &mdash; preferisco usare <prgn>tasksel</prgn> come guida guardando 
fra i loro componenti elencati sotto &lt;Task Info&gt; ed installandoli
selettivamente attraverso <prgn>dselect</prgn>.
</list>

<item>Lanciate <prgn>dselect</prgn>. 
<p>
La prima cosa che dovreste fare è selezionare il vostro editor preferito e 
tutti i programmi di cui avete bisogno. Potete installare tutte le varianti di Emacs 
in un colpo solo. Vedere <ref id="dselect"> e <ref id="pop-editor">.
<p>
Potete anche sostituire alcuni dei pacchetti di default con quelli più completi.
<list compact>
<item>lynx-ssh (al posto di lynx)
<item>... <!-- Add list in generic way. -->
</list>
<item>...
</list>

In genere modifico <file>/etc/inittab</file> per un facile shutdown.
<example>
...
# Cosa succede quando si preme CTRL-ALT-DEL.
ca:12345:ctrlaltdel:/sbin/shutdown -t1 -a -h now
...
</example>
</sect1>

<sect1>Moduli
<p>
I moduli per i driver dei vari dispositivi vengono configurati durante
l'installazione iniziale.  <prgn>modconf</prgn> fornisce la possibilità di
configurare i moduli in un secondo momento attraverso un'interfaccia a
menu. Questo programma è estremamente utile quando alcuni moduli vengono
tralasciati durante l'installazione iniziale, o quando è stato installato un
nuovo kernel in un momento successivo.
<p>
Tutti i nomi dei moduli da precaricare devono essere elencati in
<file>/etc/modules</file>.  Io uso anche <prgn>lsmod</prgn> e
<prgn>depmod</prgn> per controllarli manualmente.
<p>
Assicuratevi anche di aggiungere alcune righe a <file>/etc/modules</file> per 
gestire ip-masquerading (ftp, etc.) per i kernel 2.4.  Vedere
<ref id="kernel-modules">, specificatamente <ref id="kernel-net">.

</sect1>

<sect1>Impostazione base del CD-RW
<p>
Modificate i seguenti file:
<example>
/etc/lilo.conf  (aggiungere append="hdc=ide-scsi ignore=hdc"
                 lanciate lilo per attivarlo)
/dev/cdrom      (symlink # cd /dev; ln -sf scd0 cdrom)
/etc/modules (aggiungere "ide-scsi" e "sg". "sr" a seguire, se necessario.)
</example>
Vedere <ref id="cdrw"> per i dettagli.
</sect1>

<sect1 id="apm">Grosse memorie e spegnimento automatico
<p>
Modificate <file>/etc/lilo.conf</file> come segue per impostare i parametri al
boot in caso di grosse memorie (per i kernel 2.2) e per lo
spegnimento automatico (per apm):
<example>
append="mem=128M apm=on apm=power-off noapic"
</example>
Lanciate <prgn>lilo</prgn> per attivare queste nuove impostazioni.
<<tt>apm=power-off</tt> è necessario per un kernel SMP e <tt>noapic</tt> è
necessario per ridurre i problemi del mio hardware SMP un pò bacato.  Si può fare lo stesso
direttamente al boot prompt. Vedere <ref id="bootprompt">.
<p>
Se apm è compilato come modulo, come avviene automaticamente nei
kernel Debian 2.4, lanciate <tt># insmod apm power_off=1</tt> dopo il boot,
oppure impostate <file>/etc/modules</file> con:
<example>
# echo "apm power_off=1" &gt;&gt;/etc/modules
</example>
<p>
In alternativa, compilare il supporto ACPI ottiene lo stesso scopo
con i kernel più nuovi, e sembra essere più "amichevole" con SMP
(richiede una scheda madre recente). I kernels 2.4 su schede madri più recenti dovrebbero
riconoscere correttamente le grosse memorie.
<example>
CONFIG_PM=y
CONFIG_ACPI=y
...
CONFIG_ACPI_BUSMGR=m
CONFIG_ACPI_SYS=m
</example>
ed aggiungete le seguenti righe a <file>/etc/modules</file> in quest'ordine.
<example>
ospm_busmgr
ospm_system
</example>
Oppure ricompilate il kernel con tutte le opzioni precedenti su "y". 
Nel caso dell'ACPI, non serve alcun parametro di boot.
</sect1>

<sect1 id="killecn">Strani problemi di accesso con alcuni siti web
<p>
I kernel Linux recenti attivano l'ECN di default, cosa che può causare problemi di
accesso ad alcuni siti web con dei cattivi routers. Per controllare lo stato dell'ECN:
<example>
# cat /proc/sys/net/ipv4/tcp_ecn
 ... oppure
# sysctl net.ipv4.tcp_ecn
</example>
Per disattivarlo usate:
<example>
# echo "0" > /proc/sys/net/ipv4/tcp_ecn
 ... oppure
# sysctl -w net.ipv4.tcp_ecn=0
</example>
Per disabilitare TCP ECN ad ogni boot, aprite <file>/etc/sysctl.conf</file> ed aggiungete:
<example>
net.ipv4.tcp_ecn = 0
</example>
</sect1>

<sect1>Configurazione di PPP per una connessione dial-up
<p>
Installate il pacchetto <package>pppconfig</package> per impostare un accesso dial-up con PPP.
<example>
# apt-get install pppconfig
# pppconfig
 ... seguite le istruzioni per configurare PPP
# adduser <var>nome_utente</var> dip
 ... permette a <var>nome_utente</var> di accedere a PPP
</example>
L'accesso dial-up PPP può essere iniziato dall'utente 
(<var>nome_utente</var>):
<example>
$ pon <var>nome_IP</var>   # inizia l'accesso PPP al vostro IP
 ... gustatevi Internet
$ poff <var>nome_IP</var> # termina l'accesso PPP, <var>nome_IP</var> è facoltativo
</example>
Vedere <file>&f-ppp-readme;</file> per maggiori dettagli.
<p>
In alternativa, il pacchetto <package>wvdial</package> può essere utilizzato per impostare  
l'accesso PPP dial-up.
</sect1>

<sect1>Altri file di configurazione da perfezionare in <file>/etc</file>
<p>
Potreste voler aggiungere un file <file>/etc/cron.deny</file>, che manca nella
installazione Debian standard (potete copiare <file>/etc/at.deny</file>).
</sect1>

</sect>

</chapt>



