<!-- CVS revision of this document "$Revision: 1.36 $"  -->
<!-- CVS revision of original english document "1.174"  -->

<chapt id="tune">Configurer un système &debian;
<p>
Ce chapitre décrit seulement les bases de la configuration du système. Avant de
lire ce chapitre, vous devriez lire <ref id="install">.
<p>
Pour ceux qui sont intéressés par la sécurité, il est hautement recommandé de
lire <url id="&securing-debian-howto;" name="Securing Debian Manual"> qui
se trouve dans le paquet <package>&p-securing-debian-howto;</package>.

<sect id="init-hints">Initialisation du système
<p>
&debian; utilise le système de scripts d'initialisation System V.
Voir <ref id="init"> pour une introduction.

<sect1 id="init-defaults">Personnaliser les scripts d'initialisation
<p>
Le moyen le plus facile de contrôler le comportement d'un script
d'initialisation est de changer les variables d'environnement dans le fichier
situé dans le répertoire <file>/etc/default</file> ayant le même nom que le
script d'initialisation.
<footnote>
Les fichiers de <file>/etc/default</file> contiennent des définitions de
variables d'environnement <strong>seulement</strong>.
Chaque fichier est ajouté au script d'initialisation de telle façon que ces
définitions remplacent des valeurs de variables par défaut définies dans le
script d'initialisation lui-même.
Le choix du nom du répertoire est <url id="&etc-defaults;" name="particulier">
à &debian;.
C'est à peu près l'équivalent du répertoire <file>/etc/sysconfig</file> de
RedHat ou d'autres distributions.
</footnote>
Par exemple, <file>/etc/default/hotplug</file> peut-être utilisé pour
contrôler comment <file>/etc/init.d/hotplug</file> fonctionne.
Le fichier <file>/etc/default/rcS</file> peut être utilisé pour personnaliser
les défauts au démarrage pour <prgn>motd</prgn>, <prgn>sulogin</prgn>, etc.
<p>
Si vous ne pouvez pas obtenir le comportement que vous souhaitez en changeant
ces variables, alors vous pouvez modifier les scripts eux-mêmes&nbsp;: ce sont
tous des fichiers de configuration.

<sect1 id="syslogd">Personnaliser le journal du système
<p>
Le journal du système peut être configuré par le fichier
<file>/etc/syslog.conf</file>. Utilisez le paquet <package>colorize</package>
pour colorier les fichiers du journal.
Voir <manref name="syslogd" section="8"> et <manref name="syslog.conf"
section="5">.
</sect1>

<sect1 id="hdtune">Optimisation de l'accès au matériel
<p>
Quelques outils pour l'optimisation du matériel sont donnés à l'administrateur
système avec &debian;.
<list>
<item><package>hdparm</package>
 <list compact>
<item>Optimisation du disque dur. Très efficace.
<item>Dangereux. Il faut lire <manref name="hdparm" section="8"> d'abord.
<item><tt>hdparm -tT <var>/dev/hda</var></tt> pour tester la vitesse du
disque.
<item><tt>hdparm -q -c3 -d1 -u1 -m16 <var>/dev/hda</var></tt> pour accélérer
un système IDE moderne. (Cela peut être dangereux.)
 </list>

<item><package>setcd</package>
 <list compact>
 <item>Optimisation de l'accès au lecteur de CD.
 <item><tt>setcd -x <var>2</var></tt> pour réduire à la vitesse <var>2</var>x.
 <item>Voir <manref name="setcd" section="1">.
 </list>

<item><package>setserial</package>
 <list compact>
<item>Collection d'outils pour gérer les ports série.
 </list>

<item><package>scsitools</package>
 <list compact>
<item>Collection d'outils pour gérer le matériel SCSI.
 </list>

<item><package>memtest86</package>
 <list compact>
<item>Collection d'outils pour gérer la mémoire.
 </list>

<item><package>hwtools</package>
 <list compact>
<item>Collection d'outils pour la gestion bas niveau du matériel.
  <list compact>
   <item><prgn>irqtune</prgn>&nbsp;: change la priorité d'IRQ des
   périphériques pour autoriser ceux qui ont besoin d'une priorité haute et
   d'un service rapide (par exemple ports série, modems) à l'avoir. Une
   accélération de 3 fois des débits du port série/modem est possible.
   
   <item><prgn>scanport</prgn>&nbsp;: scanne l'espace E/S de 0x100 à 0x3ff
   pour trouver les périphériques ISA installés.
   <item><prgn>inb</prgn>&nbsp;: un petit programme rapide qui lit un port E/S
   et retourne la valeur en hexadécimal et en binaire.
  </list>

 </list>

<item><package>schedutils</package>
 <list compact>
<item>Utilitaires pour l'ordonnanceur Linux.
<item><prgn>taskset</prgn>, <prgn>irqset</prgn>, <prgn>lsrt</prgn> et
<prgn>rt</prgn> sont inclus.
<item>Avec <prgn>nice</prgn> et <prgn>renice</prgn> (non inclus), ils
permettent un contrôle complet des paramètres de l'ordonnancement des
processus.
 </list>
</list>
<p>
Monter un système de fichiers avec l'option <tt>noatime</tt> permet aussi
d'accélérer les accès en lecture au fichier. Voir <manref name="fstab"
section="5"> et <manref name="mount" section="8">.
<p>
Certains matériels peuvent être optimisés directement dans le noyau Linux
lui-même à travers le système de fichiers proc. Voir <ref id="proc-sys">.
<p>
Il existe beaucoup d'utilitaires de configuration pour du matériel spécifique
dans Debian. Beaucoup d'entre eux répondent à des besoins spécifiques des
portables. Voici quelques paquets intéressants disponibles dans Debian.
 <list compact>
  <item><package>tpconfig</package> - Utilitaires pour Advanced Power
  Management (APM)
  <item><package>acpi</package> - Affiche des informations sur les
  périphériques ACPI
  <item><package>acpid</package> - Utilitaires pour utiliser ACPI
  <item><package>lphdisk</package> - Prépare une partition d'hibernation pour
  le NoteBIOS Phoenix
  <item><package>sleepd</package> - Met un portable en veille en cas
  d'inactivité
  <item><package>noflushd</package> - Permet aux disques durs de s'arrêter
  <item><package>big-cursor</package> - Curseurs de souris plus grands pour X
  <item><package>acme</package> - Active les boutons multimedia des portables
  <item><package>tpctl</package> - Ouils de configuration pour les IBM
  ThinkPad
  <item><package>mwavem</package> - Support pour les modems Mwave/ACP
  <item><package>toshset</package> - Accède à la plupart de l'interface
  matériel des portables Toshiba
  <item><package>toshutils</package> - Utilitaires pour portables Toshiba
  <item><package>sjog</package> - Un programme pour utiliser le Jog Dial sur
  les portables Sony Vaio
  <item><package>spicctrl</package> - Programme pour régler la luminosité de
  l'écran LCD sur Sony Vaio
 </list>
ACPI est un modèle de gestion d'énergie plus récent qu'APM.
<p>
Certains de ces paquets ont besoin de modules du noyau spéciaux, qui sont
inclus dans les dernières sources du noyau dans la plupart des cas. En cas de
problème, vous aurez peut-être besoin de patcher le noyau vous-même.

<sect>Contrôle d'accès

<sect1 id="loginctrl">Contrôle des connexions avec PAM
<p>
PAM (<em>Pluggable Authentication Modules</em>, Modules d'Authentification
Greffables) permet de contrôler les connexions des utilisateurs.
<example>
/etc/pam.d/*             # fichiers de contrôle de PAM
/etc/pam.d/login         # fichier de contrôle de PAM pour la connexion
/etc/security/*          # paramètres des modules de PAM
/etc/securetty           # contrôle les connexions de root sur la console
/etc/login.defs          # contrôle le comportement de login
</example
<p>
Changez le contenu du fichier <file>/etc/pam.d/login</file> comme suit, si
vous voulez des terminaux non sécurisés mais ne demandant pas de mot de passe.
Faites le à vos propres risques.
<example>
#auth       required   pam_unix.so nullok
auth       required   pam_permit.so
</example>
Des astuces similaires peuvent être appliquées pour <prgn>xdm</prgn>,
<prgn>gdm</prgn>, ..., pour avoir une console X sans mot de passe.
<p>
Au contraire, installez <package>cracklib2</package> et réglez
<file>/etc/pam.d/passwd</file> comme suit, si vous voulez forcez une bonne
politique de mots de passe.
<example>
password required       pam_cracklib.so retry=3 minlen=6 difok=3
</example>
Pour l'activation d'un compte, un mot de passe temporaire peut aussi être
utile. Pour cela utilisez la commande <prgn>passwd</prgn> avec l'option
<tt>-e</tt>. Voir <manref name="passwd" section="1">.
<p>
Le nombre maximum de processus peut être réglé avec <tt>ulimit -u 1000</tt>
dans un shell Bash ou avec la configuration de
<file>/etc/security/limits.conf</file>. D'autres paramètres comme
<tt>core</tt> peuvent être réglés d'une façon similaire. La valeur initiale de
<prgn>PATH</prgn> peut être réglée dans le fichier
<file>/etc/login.defs</file> avant le script de démarrage du shell.
<p>
La documentation de PAM est dans le paquet <package>libpam-doc</package>. Le
<em>Guide de l'Administrateur d'un Système Linux-PAM</em> couvre la
configuration de PAM, les modules disponibles, etc. La documentation inclut
aussi le <em>Guide du Développeur d'Applications Linux-PAM</em> et le
<em>Guide du Développeurs de Modules Linux-PAM</em>.
</sect1>

<sect1 id="wheel">Pourquoi <prgn>GNU su</prgn> ne supporte pas le groupe <tt>wheel</tt>
<p>
C'est la célèbre phrase de Richard M. Stallman à la fin de l'ancienne page
<tt>info su</tt>. Ne pas s'inquiéter&nbsp;: le <prgn>su</prgn> actuel de
&debian; utilise PAM, donc on peut restreindre l'accès de <prgn>su</prgn> à
n'importe quel groupe en utilisant <prgn>pam_wheel.so</prgn> dans
<file>/etc/pam.d/su</file>. Ce qui suit réglera le groupe <tt>adm</tt> du
système &debian; comme équivalent du groupe BSD <tt>wheel</tt> et autorisera
<prgn>su</prgn> sans mot de passe pour les membres du groupe.
<example>
# anti-RMS configuration in /etc/pam.d/su
auth       required   pam_wheel.so group=adm

# Wheel members to be able to su without a password
auth       sufficient pam_wheel.so trust group=adm
</example>

<sect1>Objet des groupes par défaut
<p>
Quelques groupes intéressants&nbsp;:
<list compact>
<item>Le groupe <tt>root</tt> est le groupe <tt>wheel</tt> par défaut pour
<prgn>su</prgn> si <prgn>pam_wheel.so</prgn> est utilisé sans l'argument
<tt>group=</tt>.
<item>Le groupe <tt>adm</tt> peut lire les fichiers du journal.
<item>Le groupe <tt>cdrom</tt> peut être utilisé localement pour donner accès
au lecteur de CDROM à un ensemble d'utilisateurs.
<item>Le groupe <tt>floppy</tt> peut être utilisé localement pour donner accès
au lecteur de disquettes à un ensemble d'utilisateurs.
<item>Le groupe <tt>audio</tt> peut être utilisé localement pour donner accès
à un périphérique audio à un ensemble d'utilisateurs.
<item>Le groupe <tt>src</tt> possède le code source, y compris les fichiers de
<file>/usr/src</file>. Il peut être utilisé localement pour donner la
possibilité de gérer le code source du système à un utilisateur.
<item>Le groupe <tt>staff</tt> est utile pour donner la possibilité de faire
des choses dans <file>/usr/local</file> et créer des répertoires dans
<file>/home</file> à plus d'administrateurs système (support/junior).
</list>
<p>
Pour une liste complète, voir la section «&nbsp;FAQ&nbsp;» dans <url
id="&securing-debian-howto;" name="Securing Debian Manual">, qui se trouve
aussi dans le paquet <package>&p-securing-debian-howto;</package> dans Woody.
De plus, le nouveau paquet <package>&p-base-passwd;</package> (>3.4.6)
contient une liste officielle&nbsp;:<file>&f-users-and-groups;</file>.

<sect1 id="sudo">Travailler de façon sûre &ndash; <prgn>sudo</prgn>
<p>
J'utilise <prgn>sudo</prgn> principalement comme protection contre ma
stupidité. Utiliser <prgn>sudo</prgn> est toujours mieux que d'utiliser le
système avec le compte root.
<p>
Installez <prgn>sudo</prgn> et activez-le en configurant <file><url
id="&examples;" name="/etc/sudoers"></file>. Réglez aussi les possibilités de
<tt>sudo</tt> pour les groupes dans <file>&dochome;sudo/OPTIONS</file>.
<p>
Cette configuration fournit aux membres du groupe «&nbsp;staff&nbsp;» un accès
à toutes les commandes lancées en tant que root avec <prgn>sudo</prgn> et
donne aux membres du groupe «&nbsp;src&nbsp;» un accès à certaines commandes
lancées en tant que root avec <prgn>sudo</prgn>.
<p>
L'avantage de <prgn>sudo</prgn> est qu'il requiert seulement les mots de passe
utilisateurs pour se connecter et que l'activité est surveillée. C'est un
moyen simple de donner des pouvoirs à un administrateur débutant. Par
exemple&nbsp;:
<example>
$ sudo chown -R <var>myself</var>:<var>mygrp</var> .
</example>
<p>
Bien sûr, si vous connaissez le mot de passe de root (comme beaucoup
d'utilisateurs individuels), n'importe quelle commande peut être lancée en
tant que root depuis un compte utilisateur&nbsp;:
<example>
$ su -c "shutdown -h now"
Password:
</example>
(Je sais que je devrais limiter les privilèges du compte administrateur avec
<prgn>sudo</prgn>. Mais comme c'est mon serveur personnel, je ne me suis
pas encore embêté avec ça.)
<p>
Un autre programme permet à des utilisateurs ordinaires de lancer des
commandes avec les privilèges de root, voir le paquet
<package>super</package>.
</sect1>

<sect1 id="tcpd">Contrôle d'accès aux services
<p>
Le <em>super-serveur</em> internet, <prgn>inetd</prgn>, est exécuté lors du
démarrage par <file>/etc/rc2.d/S20inetd</file> (pour le niveau d'exécution 2)
qui est un lien vers <file>/etc/init.d/inetd</file>.
<prgn>inetd</prgn> permet de n'exécuter qu'un démon qui en invoque plusieurs
autres, réduisant ainsi la charge du système.
<p>
Lorsqu'une requête pour un service arrive, le protocole et le service sont
identifiés en regardant dans la base de données stockée dans
<file>/etc/protocols</file> et <file>/etc/services</file>.
Pour un service internet normal, <prgn>inetd</prgn> utilise
<file>/etc/inetd.conf</file>. Pour un service basé sur Sun-RPC,
<prgn>inetd</prgn> utilise <file>/etc/rpc.conf</file>.
<p>
Pour la sécurité du système, assurez-vous de désactiver les services non
utilisés dans <file>/etc/inetd.conf</file>. Les services Sun-RPC doivent être
actifs pour NFS et d'autres programmes basés sur RPC.
<p>
Parfois, <prgn>inetd</prgn> n'exécute pas le serveur demandé directement, mais
exécute le programme d'enveloppe de démon TCP/IP <prgn>tcpd</prgn> avec le
serveur demandé comme argument dans <file>/etc/inetd.conf</file>. Dans ce cas,
<prgn>tcpd</prgn> lance le serveur approprié après avoir enregistré dans le
journal la requête et avoir fait quelques autres vérifications en utilisant
les fichiers <file>/etc/hosts.deny</file> et <file>/etc/hosts.allow</file>.
<p>
Si vous avez un problème avec l'accès à distance sur un système &debian;
récent, commentez la ligne "ALL: PARANOID" dans <file>/etc/hosts.deny</file>
si elle existe.
<p>
Pour plus de détails, voir
<manref name="inetd" section="8">,
<manref name="inetd.conf" section="5">,
<manref name="protocols" section="5">,
<manref name="services" section="5">,
<manref name="tcpd" section="8">,
<manref name="hosts_access" section="5">, et
<manref name="hosts_options" section="5">.
<p>
Pour plus d'information sur Sun-RPC, voir
<manref name="rpcinfo" section="8">,
<manref name="portmap" section="8">, et
<file>&f-portmap;</file>.

<sect1 id="ldap">Centraliser l'identification &ndash; LDAP
<p>
Utilisez <em>Lightweight Directory Access Protocol</em> (LDAP).
Références&nbsp;:
<list compact>
<item><url id="&openldaphome;" name="OpenLDAP">
<item>OpenLDAP Admin Guide dans le paquet <package>openldap-guide</package>
<item>LDP: <url id="&ldap-linux-howto;" name="LDAP Linux HOWTO">
<item>LDP: <url id="&ldap-implementation-howto;" name="LDAP Implementation
HOWTO">
<item><url id="&ldap-use1;" name="OpenLDAP, extensive use reports">
<item><url id="&ldap-use2;" name="Open LDAP with Courier IMAP and Postfix">
</list>
</sect>


<sect id="cdrw">Graveurs de CD
<p>
Les graveurs de CD sur interface ATAPI/IDE sont devenus des périphériques
courants. Le CD un bon média pour sauvegarder et archiver un système pour un
utilisateur individuel ayant besoin d'une capacité &lt; 640 Mo. Pour des
informations plus officielles, consultez le <url id="&cd-writing-howto;"
name="CD-Writing-HOWTO"> du LDP.

<sect1>Introduction
<p>
D'abord, sachez qu'une interruption de l'envoi des données vers le
graveur entraînera des erreurs irrécupérables sur le CD. Prenez donc un graveur
avec un cache aussi gros que possible. Si le prix n'a pas d'importance, optez
pour une version SCSI plutôt qu'ATAPI/IDE. Si vous avez le choix de
l'interface IDE sur laquelle connecter le graveur, préférez celle sur bus PCI
(une de celles de la carte mère) plutôt qu'une sur bus ISA (carte SB16, etc.).
<p>
Un graveur connecté sur interface IDE doit être piloté par le pilote IDE-SCSI
et non par le pilote CD IDE habituel pour les noyaux Linux 2.2 et 2.4. Le
pilote SCSI générique doit aussi être activé. Pour cela, deux approches
existent pour les noyaux distribués avec des distributions modernes (à la date
de mars 2001).
<p>
Pour le noyau Linux 2.6, vous devriez utiliser le pilote IDE et accéder au
graveur de CD directement avec le nom de périphérique
<file>/dev/hd<var>x</var></file>. Vous pouvez utiliser le DMA de cette façon.
</sect1>

<sect1>Première approche&nbsp;: modules + <prgn>lilo</prgn>
<p>
Ajoutez la ligne suivante à <file>/etc/lilo.conf</file> si vous utilisez le
noyau distribué avec Debian. Si vous utilisez plusieurs options, listez-les en
les séparant par des espaces.
<example>
append="hd<var>x</var>=ide-scsi ignore=hd<var>x</var>"
</example>
Ici, le graveur, accédé par le pilote ide-scsi, est identifié par
<tt>hd<var>x</var></tt>, où <var>x</var> représente&nbsp;:
<example>
hdb      esclave sur le premier port IDE
hdc      maître sur le second port IDE
hdd      esclave sur le second port IDE
hde ... hdh  sur un port IDE externe
</example>
Lancez les commandes suivantes, en tant que root, pour activer les options
après avoir terminé la configuration&nbsp;:
<example>
# lilo
# shutdown -h now
</example>
</sect1>


<sect1>Seconde approche&nbsp;: recompiler le noyau
<p>
Debian utilise <prgn>make-kpkg</prgn> pour créer le noyau.  Utilisez la
nouvelle option <tt>--append_to_version</tt> avec <prgn>make-kpkg</prgn> pour
créer plusieurs images du noyau.
Voir <ref id="kernel">.
<p>
Utilisez la configuration suivante avec <tt>make menuconfig</tt>&nbsp;:
<list>
<item>bzImage
<item>Excluez le pilote CD IDE (non obligatoire mais c'est plus simple comme ça)
<item>Ajoutez ide-scsi et sg, ou compilez-les en tant que modules
</list>
</sect1>

<sect1>Étapes post-configuration
<p>
Le support pour le graveur peut être activé dans le noyau lors du démarrage
avec les commandes suivantes&nbsp;:
<example>
# echo ide-scsi &gt;&gt;/etc/modules
# echo sg       &gt;&gt;/etc/modules
# cd /dev; ln -sf scd0 cdrom
</example>
Une activation manuelle peut aussi être effectuée avec&nbsp;:
<example>
# modprobe ide-scsi
# modprobe sg
</example>
Après un redémarrage, vous pouvez vérifier l'installation avec&nbsp;:
<example>
$ dmesg|less
# apt-get install cdrecord
# cdrecord -scanbus
</example>
<p>
[Par Warren Dodge] Quelquefois, il peut y avoir des conflits entre
<tt>ide-scsi</tt> et <tt>ide-cd</tt> s'il y a à la fois un lecteur de CDROM
et un graveur CD-R/RW sur le système. Essayez d'ajouter ce qui suit dans votre
fichier <file>/etc/modutils/aliases</file>, exécutez
<prgn>update-modules</prgn> et redémarrez.
<example>
pre-install      ide-scsi      modprobe ide-cd
</example>
Cela force le pilote IDE à être chargé avant <tt>ide-scsi</tt>. Le pilote
<tt>ide-cd</tt> prend le contrôle du lecteur de CDROM ATAPI&mdash;tout ce
qu'on ne lui a pas dit d'<strong>ignorer</strong>. Cela laisse simplement les
périphériques ignorés au contrôle de <tt>ide-scsi</tt>.
</sect1>

<sect1>Image de CD (bootable)
<p>
Pour créer un CDROM contenant des fichiers contenus dans le répertoire
<file>target-directory/</file> en tant qu'image nommée
<file>cd-image.raw</file> (CD bootable, format Joliet TRANS.TBL. Pour un CD
non bootable, enlevez les options <tt>-b</tt> et <tt>-c</tt>), insérez une
disquette de démarrage dans le premier lecteur de disquette et faites&nbsp;:
<example>
# dd if=<var>/dev/fd0</var> <var>target-directory/boot.img</var>
# mkisofs -r -V <var>volume_id</var> -b <var>boot.img</var> -c <var>bootcatalog</var> -J -T \
        -o <var>cd-image.raw</var> <var>target_directory/</var>
</example>
<p>
Une utilisation amusante est de créer un CDROM DOS bootable. Si
<file><var>boot.img</var></file> contient l'image d'une disquette de démarrage
DOS, le CDROM démarrera comme si une disquette DOS était dans le premier
lecteur de disquette (A:). Faire cela avec freeDOS est encore plus
intéressant. 
<p>
L'image créée peut être vérifiée en la montant en utilisant le périphérique de
boucle (loop device).
<example>
# mount -t iso9660 -o ro,loop <var>cd-image.raw</var> /cdrom
# cd /cdrom
# mc
# umount /cdrom
</example>
</sect1>

<sect1>Graver un CD (R, RW)
<p>
Premier test avec les commandes suivantes (cas d'un graveur double vitesse)
<example>
# nice --10 cdrecord -dummy speed=2 dev=0,0 <var>disk.img</var>
</example>
Si le test est réussi, gravez un CD-R avec
<example>
# nice --10 cdrecord -v -eject speed=2 dev=0,0 <var>disk.img</var>
</example>
Ou gravez un CD-RW avec
<example>
# nice --10 cdrecord -v -eject blank=fast speed=2 dev=0,0 <var>disk.img</var>
</example>
Certains graveurs de CD marchent mieux avec
<example>
# nice --10 cdrecord -v blank=all speed=2 dev=0,0 <var>disk.img</var>
</example>
suivi de
<example>
# nice --10 cdrecord -v -eject speed=2 dev=0,0 <var>disk.img</var>
</example>
Deux étapes sont nécessaires pour empêcher que des fins d'attente SCSI lors du
formatage n'interfèrent avec l'étape de gravure. Les arguments passés à
<prgn>nice</prgn> peuvent avoir besoin d'un ajustement.
</sect1>

<sect1>Créer l'image d'un CD
<p>
Certains CD-R et CD commerciaux ont des secteurs parasites à la fin qui les
rendent incopiables par <prgn>dd</prgn> (le CD de Windows 98 est l'un d'eux).
Le paquet <package>cdrecord</package> comprend la commande
<prgn>readcd</prgn>. Utilisez-la pour copier le contenu de n'importe quel CD
dans un fichier image. S'il s'agit d'un CD de données, montez-le et exécutez
<prgn>mount</prgn> pour connaître sa taille. Divisez le nombre affiché (en
blocs de 1024 octets) par 2 pour connaître le nombre de secteurs du CD (2048
octets). Lancez <prgn>readcd</prgn> avec les bonnes options et utilisez
l'image du CD pour graver un CD-R/RW.
<example>
# readcd <var>target</var>,<var>lun</var>,<var>scsibusno</var> # choisissez la fonction 11
</example> 
Ici, positionnez tous les paramètres de ligne de commande à 0 dans la plupart
des cas. Parfois, le nombre de secteurs donné par <prgn>readcd</prgn> est trop
important&nbsp;! Utilisez le nombre donné par mount pour de meilleurs
résultats.
<p>
Il faut noter que l'utilisation de <prgn>dd</prgn> pose des problèmes avec un
CD-ROM. La première exécution de <prgn>dd</prgn> peut causer un message
d'erreur et entraîner une image disque plus petite avec la perte de la fin. La
deuxième exécution de <prgn>dd</prgn> peut entraîner une image disque plus
grande avec des données à jeter à la fin sur certains systèmes si la taille
des données n'est pas spécifiée. Seule la seconde exécution de <prgn>dd</prgn>
avec la taille des données correcte spécifiée, et sans éjecter le CD après un
message d'erreur, semble permettre d'éviter ces problèmes. Si par exemple la
taille de l'image affichée par <prgn>df</prgn> est <tt>46301184</tt> blocs,
utilisez la commande suivante pour obtenir la bonne image disque (information
empirique)&nbsp;:
<example>
# dd if=/dev/cdrom of=cd.img bs=2048 count=$((46301184/2))
</example>
</sect1>

<sect1>Images de CD Debian
<p>
Pour obtenir les dernières informations, consultez le
<url id="http://cvs.debian.org/debian-cd/" name="site Debian CD."> 
<p>
Si vous avez une connexion Internet rapide, installez par le réseau en
utilisant&nbsp;:
<list compact>
<item>quelques <url id="&debian-floppyinst;" name="images de disquettes">.
<item>une <url id="&debian-netinst;" name="image de CD minimale">.
</list>
<p>
Si vous n'avez pas de connexion Internet rapide, achetez des CD depuis un <url
id="&debian-venders;" name="vendeur de CD">.
<p>
Merci de ne pas gâcher la bande passante en téléchargeant des images de CD
standard à moins que vous ne soyez un testeur d'images de CD (même avec la
nouvelle méthode jigdo).
<p>
Une image de CD à noter est celle de <url id="&knoppix;" name="KNOPPIX -
Système de Fichier Linux Fonctionnel sur CD">. Ce CD démarre avec un système
&debian; fonctionnel sans s'installer sur le disque dur.

<!-- old document section
$ export CVSROOT=anonymous@cvs.debian.org:/cvs/debian-boot
$ cvs co debian-cd
</example>
Les commandes suivantes permettent de créer une image de CD&nbsp;:
<example>
# apt-get install debian-cd
# cd /etc/debian-cd
# vim CONF.sh
$ . CONF.sh
$ make distclean
$ make status
$ make list COMPLETE=1 SIZELIMIT1=555000000 SRCSIZELIMIT=665000000
$ make official_images
 ou si vous souhaitez seulement des images avec les binaires&nbsp;:
$ make bin-official_images
-->
</sect1>

<sect1>Système de sauvegarde sur CD-R
<p>
Pour copier les fichiers de configuration et de données importants sur CD-R,
utilisez le script de sauvegarde <file><url id="&examples;"
name="backup"></file>.
Voir aussi <ref id="archiving"> et <ref id="diff-backup">.
</sect1>

<sect1>Copier un CD audio sur un CD-R
<p>
Je n'ai pas testé cela personnellement&nbsp;:
<example>
# apt-get get install cdrecord cdparanoia
# cdparanoia -s -B
# cdrecord dev=0,0,0 speed=2 -v -dao -eject defpregap=1 -audio *.wav
</example>
ou,
<example>
# apt-get install cdrdao #disk at once
# cdrdao read-cd --device /dev/cdrom --paranoia-mode 3 my_cd # lit le CD
# cdrdao write --device /dev/cdrom --speed 8 my_cd    # grave un nouveau CD
</example>
<prgn>cdrdao</prgn> fait une vraie copie (pas de trous, etc.).
</sect1>

<sect1 id="dvd">Graver des DVD-R, DVD-RW et DVD+RW
<p>
Pour graver des DVD, il existe deux approches&nbsp;:
<list compact>
<item>Utiliser <package>growisofs</package> avec <package>mkisofs</package>.
<item>Recompiler <package>cdrecord</package> avec l'option dvd pour créer un
paquet local en suivant <file>&f-readmedvd;</file>.
</list>
</sect1>
</sect>

<sect id="x">X
<p>
L'environnement X Window System est fourni par <url id="&xfree86home;"
name="Xfree86">. Il existe deux versions majeures du serveur X dans
&debian&nbsp;: XFree86 Version 3.3 (XF3) et la série des XFree86 Version 4.x
(XF4) toutes les deux basées sur les spécifications X11R6 de <url
id="&xorghome;" name="X.Org">.
<p>
Pour les bases sur X, référez-vous à <manref name="X" section="7">, et les <url
id="&xwindowuser-howto;" name="XWindow-User-HOWTO"> et <url
id="&remote-xapps-howto;" name="Remote X Apps mini-HOWTO"> du LDP. Pour un
guide d'utilisation spécifique à &debian;, lisez <file>&f-x-deb-faq;</file>
fournie dans le paquet <package>xfree86-common</package>. Elle contient une
revue intéressante et exhaustive des problèmes d'assignation des touches par
Branden Robinson.
<p>
<taglist>
<tag><ref id="xsrvr">
<item>un programme sur la machine locale qui affiche des fenêtres X et/ou un
bureau sur le moniteur (CRT, LCD) d'un utilisateur et accepte des entrées au
clavier et à la souris.
<tag><ref id="xclnt">
<item>un programme sur une machine (locale ou distante) qui exécute un
logiciel d'application compatible avec X-Window.
</taglist>
Cela inverse l'utilisation habituelle de «&nbsp;serveur&nbsp;» et
«&nbsp;client&nbsp;» dans d'autres contextes.
<p>
Il y a plusieurs façons de faire accepter les connexions distantes d'un client
X (côté application) à un serveur X (côté affichage)&nbsp;:
<list>
<item>Méthode <prgn>xhost</prgn>
<list compact>
<item>le mécanisme de liste d'hôtes (non sûr).
<item>protocole non chiffré (sujet à des attaques d'écoute de ligne).
<item>à ne pas utiliser, si possible.
<item>voir <ref id="xhost"> et <manref name="xhost" section="1x">.
</list>
<item>Méthode <strong><prgn>xauth</prgn></strong>
<list compact>
<item>le mécanisme des cookies magiques du MIT (non sûr mais mieux que <prgn>xhost</prgn>).
<item>protocole non chiffré (sujet à des attaques d'écoute de ligne).
<item>à utiliser seulement pour des connexions locales car il est moins
gourmand en temps processeur que <prgn>ssh -X</prgn>.
<item>voir <ref id="ss-xsu"> et <manref name="xauth" section="1x">.
</list>
<item>Méthodes <prgn>xdm</prgn>, <prgn>wdm</prgn>, <prgn>gdm</prgn>, <prgn>kdm</prgn>,...
<list compact>
<item>mécanisme des cookies magiques du MIT (aussi non sûr que <prgn>xauth</prgn>).
<item>voir <manref name="xdm" section="1x"> et <manref name="Xsecurity"
section="7"> pour les bases du contrôle d'accès à un affichage X.
<item>voir <manref name="wdm" section="1x">, <manref name="gdm" section="8">,
et <manref name="kdm.options" section="5"> pour plus d'information, si ces
programmes sont installés.
<item>voir <ref id="custombootscripts"> pour savoir comment désactiver <prgn>xdm</prgn>
pour avoir accès à la console Linux après le démarrage sans purger le paquet
<prgn>xdm</prgn>.
</list>
<item>Méthode <strong><prgn>ssh -X</prgn></strong>
<list compact>
<item>mécanisme de redirection de port à travers SSH (<strong>sûr</strong>).
<item>protocole chiffré (gâchis de ressources en utilisation locale).
<item>à utiliser pour des connexions distantes.
<item>voir <ref id="xssh">.
</list>
</list>
Toutes les méthodes de connexion distante, sauf <prgn>ssh</prgn>, ont besoin
de l'activation des connexions TCP/IP au serveur X. Voir <ref id="xtcp">.

<sect1 id="x-system">Paquets X
<p>
Il existe quelques paquets globaux pour installer X sur un système Woody.
<taglist>
<tag><package>x-window-system-core</package>
<item>
Ce paquet global fournit les composants essentiels pour une station de travail
exécutant X Window System. Il fournit les bibliothèques X, un serveur X
<package>xserver-xfree86</package>, un ensemble de polices, et un ensemble de
clients et utilitaires X de base.

<tag><package>x-window-system</package>
<item>
Ce paquet global fournit à peu près tous les composants de X Window System
tels que développés par XFree86 Project, ainsi qu'un ensemble d'accessoires
historiquement populaires. (Notamment, il dépend de <package>x-window-system-core</package>,
<package>twm</package>, et <package>xdm</package>, càd pas besoin d'installer
<package>x-window-system-core</package> si vous installez celui-ci.)

<tag><package>xserver-common-v3</package>
<item>
Fichiers et utilitaires communs aux serveurs X XFree86 3.x (XF3)

<tag><package>xserver-*</package>
<item>
Paquets supplémentaires pour le serveur XF3 afin de supporter du matériel non
supporté par le nouveau serveur XF4 (<package>xserver-xfree86</package>),
qu'elle qu'en soit la raison. Certaines cartes ATI mach64 anciennes ne sont
pas supportées par XF4, certaines cartes vidéo plantent avec la version de XF4
de Woody, etc. (Pour connaître les paquets disponibles, utilisez <tt>apt-cache
search xserver-|less</tt>. Tous les serveurs XF3 dépendent de
<package>xserver-common-v3</package>.)
</taglist>
<p>
Dans la plupart des cas, <package>x-window-system</package> est le paquet à
installer. (Si vous voulez vous connecter par la console, assurez-vous de
désactiver <package>xdm</package> tel que décrit dans <ref id="no-x-start">.)


<sect1 id="hdetect-x">Détection de matériel pour X
<p>
Pour activer la détection du matériel lors de la configuration de X, installez
les paquets suivants avant d'installer le système X&nbsp;:
<list>
<item><package>discover</package> &ndash; système d'identification du matériel
<item><package>mdetect</package> &ndash; outil d'autodétection de la souris
<item><package>read-edid</package> &ndash; outil pour récupérer des
informations matérielles pour les moniteurs VESA PnP.
</list>

<sect1 id="xsrvr">Le serveur X
<p>
Consultez <manref name="XFree86" section="1"> pour des informations sur le
serveur X.
<p>
Exécution du serveur X depuis une console locale&nbsp;:
<example>
$ startx -- :&lt;display&gt; <var>vtXX</var>
par exemple :
$ startx -- :1 vt8 -bpp 16
... exécution sur un terminal vt8 connecté à localhost:1 en mode 16 bpp
</example>
Les arguments donnés après <tt>--</tt> sont pour le serveur X.
<p>
Notez que lorsque vous utilisez le script <file>~/.xserverrc</file> pour
personnaliser le démarrage du serveur X, il faut utiliser <tt>exec</tt> avec
le serveur X réel. Sinon, cela peut rendre le serveur X lent à démarrer ou à
quitter. Par exemple&nbsp;:
<example>
#!/bin/sh
exec /usr/bin/X11/X -dpi 100 -nolisten tcp
</example>

<sect2 id="config-x4">Configurer le serveur X (version 4)
<p>
Pour (re-)configurer un serveur XF4,
<example>
# dpkg-reconfigure --priority=low xserver-common
# dpkg-reconfigure --priority=low xserver-xfree86
</example>
générera le fichier <file>/etc/X11/XF86Config-4</file> et configurera X avec
le script <prgn>dexconf</prgn>.

<sect2 id="config-x3">Configurer le serveur X (version 3)
<p>
Pour (re-)configurer un serveur XF3, par exemple pour une carte ATI mach64,
<example>
# dpkg-reconfigure --priority=low xserver-common-v3
# dpkg-reconfigure --priority=low xserver-mach64
</example>
générera le fichier <file>/etc/X11/XF86Config</file> et configurera X avec le
script <prgn>xf86config-v3</prgn>.

<sect2 id="manual-config-x">Configurer manuellement le serveur X
<p>
Avec Woody, pour ajouter des personnalisations à
<file>/etc/X11/XF86Config-4</file>, <strong>n'éditez pas le fichier de
configuration entre le texte</strong>&nbsp;:
<!-- FIXME for XF3 -->
<example>
### BEGIN DEBCONF SECTION
[snip]
### END DEBCONF SECTION
</example>
<p>
Au lieu de cela, <strong>ajoutez les personnalisations avant le
texte</strong>. Par exemple, pour utiliser une carte video personnalisée,
ajoutez quelquechose comme ce qui suit au début du fichier&nbsp;:
<example>
Section "Device"
  Identifier        "Custom Device"
  Driver            "ati"
  Option            "NoAccel"
EndSection

Section "Screen"
  Identifier  "Custom Screen"
  Device      "Custom Device"
  Monitor     "Generic Monitor"
  DefaultDepth 24
  Subsection "Display"
    Depth       8
    Modes       "1280x960" "1152x864" "1024x768" "800x600" "640x480"
  EndSubsection
  Subsection "Display"
    Depth       16
    Modes       "1280x960" "1152x864" "1024x768" "800x600" "640x480"
  EndSubsection
  Subsection "Display"
    Depth       24
    Modes       "1280x960" "1152x864" "1024x768" "800x600" "640x480"
  EndSubsection
EndSection

Section "ServerLayout"
    Identifier        "Custom"
    Screen            "Custom Screen"
    InputDevice       "Generic Keyboard" "CoreKeyboard"
    InputDevice       "Configured Mouse" "CorePointer"
EndSection
</example>
<p>
Pour Sarge (<tt>testing</tt> au moment de l'écriture), si vous souhaitez
garder les personnalisations de <file>/etc/X11/XF86Config</file> à travers la
mise-à-jour, lancez les commandes suivantes en tant que root&nbsp;:
<example>
# cp /etc/X11/XF86Config-4 /etc/X11/XF86Config-4.custom
# md5sum /etc/X11/XF86Config-4 &gt; /var/lib/xfree86/XF86Config-4.md5sum
# dpkg-reconfigure xserver-xfree86
</example>
Afin d'obtenir de <strong>belles polices de caractères</strong>, vous devez
éditer <file>/etc/X11/XF86Config-4</file> comme décrit dans <ref id="xfs-tt">.
<!--
<p>
Pour XF3, afin d'obtenir de <strong>belles polices de caractères</strong>,
vous devez éditer l'ordre de <tt>FontPath</tt> dans
<file>/etc/X11/XF86Config</file> et ajouter <tt>:unscaled</tt> comme
suit&nbsp;:
<example>
FontPath        "/usr/X11R6/lib/X11/fonts/misc:unscaled"
FontPath        "/usr/X11R6/lib/X11/fonts/100dpi:unscaled"
FontPath        "/usr/X11R6/lib/X11/fonts/75dpi:unscaled"
FontPath        "/usr/X11R6/lib/X11/fonts/Type1"
FontPath        "/usr/X11R6/lib/X11/fonts/Speedo"
FontPath        "/usr/X11R6/lib/X11/fonts/misc"
FontPath        "/usr/X11R6/lib/X11/fonts/100dpi"
FontPath        "/usr/X11R6/lib/X11/fonts/75dpi"
</example>
<p>
Si vous utilisez <prgn>xfs</prgn> pour servir les polices via une Unix Domain
Socket, vous devez aussi éditer l'entrée <tt>catalogue</tt> de
<file>/etc/X11/fs/config</file> comme suit&nbsp;:
<example>
catalogue = /usr/X11R6/lib/X11/fonts/misc:unscaled,
            /usr/X11R6/lib/X11/fonts/100dpi:unscaled,
            /usr/X11R6/lib/X11/fonts/75dpi:unscaled,
            /usr/X11R6/lib/X11/fonts/Type1,
            /usr/X11R6/lib/X11/fonts/Speedo,
            /usr/X11R6/lib/X11/fonts/misc,
            /usr/X11R6/lib/X11/fonts/100dpi,
            /usr/X11R6/lib/X11/fonts/75dpi,
</example>
<p>
Cette option <tt>:unscaled</tt> est obsolète dans XF4 et n'est plus
nécessaire.
-->
<!-- per /usr/share/doc/xfree86-common/README.fonts.gz in 4.2.1 -->
<p>
Vérifiez aussi les autres parties de votre configuration X. De mauvais
paramètres pour le moniteur peuvent donner un mal de tête plus important que
de mauvaises polices, aussi assurez-vous que le taux de rafraichissement est
aussi élevé que peut le supporter votre moniteur (85Hz est super, 75Hz est OK,
60Hz fait mal aux yeux).

<sect1 id="xclnt">Clients X
<p>
La plupart des clients X peuvent être démarrés comme ceci&nbsp;:
<example>
client $ xterm -geometry 80x24+30+200 -fn 6x10 -display <var>hostname</var>:0 &amp;
</example>
Ici, les arguments de ligne de commande optionnels signifient&nbsp;:
<list>
<item><tt>-geometry
<var>WIDTH</var>x<var>HEIGHT</var>+<var>XOFF</var>+<var>YOFF</var></tt>&nbsp;:
taille initiale et emplacement de la fenêtre.

<item><tt>-fn <var>FONTNAME</var></tt>&nbsp;: police utilisée pour l'affichage
du texte.
 <tt><var>FONTNAME</var></tt> peut être&nbsp;:
<list compact>
<item>a14&nbsp;: Taille normale
<item>a24&nbsp;: Grande taille
<item>... (consultez les polices disponibles avec <tt>xlsfont</tt>.)
</list>
<item><tt>-display <var>displayname</var></tt>&nbsp;: le nom du serveur X à
utiliser.
 <tt><var>displayname</var></tt> peut être&nbsp;:
<list compact>
<item><tt><var>hostname</var>:<var>D.S</var></tt> signifie écran <var>S</var>
sur affichage <var>D</var> de l'hôte <tt>hostname</tt>&nbsp;; le serveur X de
cet affichage écoute le port TCP 6000+D.

<item><tt><var>host</var>/unix:<var>D.S</var></tt> signifie écran <var>S</var>
sur affichage <var>D</var> de l'hôte <tt>host</tt>&nbsp;; le serveur X de cet
affichage écoute la socket UNIX <file>/tmp/.X11-unix/XD</file> (et n'est donc
utilisable depuis <tt><var>host</var></tt>).

<item><tt><var>:D.S</var></tt>  est équivalent
à <tt><var>host</var>/unix:<var>D.S</var></tt>, où <tt>host</tt> est le nom de
l'hôte local
</list>
</list>
<p>
Le <tt><var>displayname</var></tt> (nom d'affichage) par défaut pour un
programme client X (côté application) peut être défini par la variable
d'environnement DISPLAY. Par exemple, avant de lancer un programme client X, on
peut exécuter l'une des commandes suivantes pour cela&nbsp;:
<example>
$ export DISPLAY=:0 
        # Valeur par défaut, machine locale avec premier écran X
$ export DISPLAY=<var>hostname.fulldomain.name</var>:0.2
$ export DISPLAY=localhost:0
</example>
Le démarrage peut être personnalisé avec le fichier <file>~/.xinitrc</file>.
Par exemple&nbsp;:
<example>
xrdb -load $HOME/.Xresources
xsetroot -solid gray &amp;
xclock -g 50x50-0+0 -bw 0 &amp;
xload -g 50x50-50+0 -bw 0 &amp;
xterm -g 80x24+0+0 &amp;
xterm -g 80x24+0-0 &amp;
twm
</example>
Comme décrit dans <ref id="custom-x">, cela outrepasse tout ce qu'une
exécution normale de Xsession fait lorsqu'elle est démarrée depuis
<prgn>startx</prgn>. Utilisez plutôt <file>~/.xsession</file> et utilisez
cette approche seulement en dernier recours.
Voir <manref name="xsetroot" section="1x">, <manref name="xset" section="1x">
and <ref id="xresources">.
</sect1>

<sect1 id="x-session">Sessions X
<p>
Une session X (serveur X + client X) peut être lancée par&nbsp;:
<list compact>
<item><prgn>startx</prgn>&nbsp;: script encapsulant <prgn>xinit</prgn>
      pour démarrer le serveur et le client X depuis la console de Linux. Si
      <file>~/.xinitrc</file> n'existe pas, <file>/etc/X11/Xsession</file> est
      exécuté au travers de <file>/etc/X11/xinit/xinitrc</file>.
<item><prgn>xdm</prgn>, <prgn>gdm</prgn>, <prgn>kdm</prgn>, ou
      <prgn>wdm</prgn>&nbsp;: démon de gestion de l'affichage X pour démarrer
      le serveur et le client X, et contrôler les connexions depuis un écran
      graphique. <file>/etc/X11/Xsession</file> est exécuté directement.
</list>
La console peut être rappelée par <ref id="no-x-start">.

<sect2 id="custom-x">Sessions X personnalisées
<p>
Le script de démarrage par défaut <file>/etc/X11/Xsession</file> est une
combinaison de
<file>/etc/X11/Xsession.d/50xfree86-common_determine-startup</file> et
<file>/etc/X11/Xsession.d/99xfree86-common_start</file>.
<p>
L'exécution de <file>/etc/X11/Xsession</file> est affectée par
<file>/etc/X11/Xsession.options</file> et consiste essentiellement en
l'exécution d'un programme avec la commande <prgn>exec</prgn> trouvé en
premier, en cherchant dans l'ordre suivant&nbsp;:
<enumlist compact>
<item><file>~/.xsession</file> ou <file>~/.Xsession</file>, s'il existe.
<item><file>/usr/bin/x-session-manager</file>, s'il existe.
<item><file>/usr/bin/x-window-manager</file>, s'il existe.
<item><file>/usr/bin/x-terminal-emulator</file>, s'il existe.
</enumlist>
<p>
La signification exacte de ces commandes est déterminée par le système de
solutions de rechange de &debian; décrit dans <ref id="alternatives">. Par
exemple&nbsp;:
<example>
# update-alternatives --config x-session-manager
... ou
# update-alternatives --config x-window-manager
</example>
Pour que n'importe quel gestionnaire de fenêtre soit le défaut, tout en
gardant les gestionnaires de session de GNOME et KDE installés, remplacez le
fichier <file>/etc/X11/Xsession.d/50xfree86-common_determine-startup</file>
par celui attaché au deuxième rapport de bogue à <url id="&bug-xfree;">
(j'espère que cela sera inclus rapidement) et éditez
<file>/etc/X11/Xsession.options</file> comme suit pour désactiver le
gestionnaire de session X&nbsp;:
<example>
# /etc/X11/Xsession.options
#
# configuration options for /etc/X11/Xsession
# See Xsession.options(5) for an explanation of the available options.
# Default enabled
allow-failsafe
allow-user-resources
allow-user-xsession
use-ssh-agent
# Default disabled (enable them by uncommenting)
do-not-use-x-session-manager
#do-not-use-x-window-manager
</example>
<p>
Sans la modification ci-dessus, <package>gnome-session</package> et
<package>kdebase</package> sont les paquets contenant ces gestionnaires de
session X. Les enlever permet le gestionnaire de fenêtre d'être le défaut.
(Beurk, une autre idée&nbsp;?)
<p>
Sur un système où <file>/etc/X11/Xsession.options</file> contient une ligne
<tt>allow-user-xsession</tt> sans caractère la précédent, n'importe quel
utilisateur peut personnaliser l'action de <file>/etc/X11/Xsession</file> en
créant <file>~/.xsession</file> ou <file>~/.Xsession</file>.
<p>
La dernière commande dans le fichier <file>~/.xsession</file> devrait être de
la forme <tt>exec <var>some-window/session-manager</var></tt> pour démarrer
votre gestionnaire de fenêtres/session favori.
<p>
Un bon exemple de script <file>~/.xsession</file> est donné par
<file>&f-xsession;</file>.
<p>
J'utilise ceci pour définir le gestionnaire de fenêtres, l'accès à l'écran et
le support de la langue pour chaque compte utilisateur. Voir <ref
id="s-w-manager">, <ref id="ss-xsu">, et <ref id="x-cjk">.
<p>
Si vous souhaitez avoir plusieurs clients X lancés automatiquement, voir les
exemples de <ref id="xclnt"> et appelez-les depuis <file>~/.xsession</file>
plutôt que <file>~/.xinitrc</file>.
<p>
D'autres ressources X spécifiques à chaque utilisateur peuvent être stockées
dans <file>~/.Xresources</file>. Voir <ref id="xresources">.
<p>
Des cartes clavier personnalisées et des actions spécifiques associées aux
boutons de la souris peuvent être spécifiés dans le script de démarrage de
l'utilisateur. Voir <ref id="xmodmap">.

<sect2 id="s-w-manager">Démarrer une session X pour un utilisateur
<p>
Suivant les principes décrits à <ref id="custom-x">, un gestionnaire de
session/fenêtres X spécifique à chaque utilisateur peut être activé en
installant le paquet indiqué et en configurant le fichier
<file>~/.xsession</file> comme suit. (J'aime bien
<package>blackbox</package>/<package>fluxbox</package> pour son style simple
et sa rapidité.)&nbsp;:

<list>
<item>gestionnaire de session X par défaut.
<list compact>
<item>Voir <ref id="alternatives">.
<item><tt>exec /usr/bin/x-session-manager</tt>
</list>
<item>gestionnaire de fenêtres X par défaut.
<list compact>
<item>Voir <ref id="alternatives">.
<item><tt>exec /usr/bin/x-window-manager</tt>
</list>

<item>gestionnaire de session GNOME (lourd)
<list compact>
<item>Installer le paquet&nbsp;: <package>gnome-session</package>
<item><tt>exec /usr/bin/gnome-session</tt>
</list>

<item>gestionnaire de session KDE (lourd)
<list compact>
<item>Installer le paquet&nbsp;: <package>kdebase</package> (ou
<package>kdebase3</package> pour KDE3)
<item><tt>exec /usr/bin/kde2</tt>
</list>

<item>gestionnaire de fenêtres Blackbox (léger)
<list compact>
<item>Installer le paquet&nbsp;: <package>blackbox</package>
<item><tt>exec /usr/bin/blackbox</tt>
</list>

<item>gestionnaire de fenêtres Fluxbox (léger, nouveau Blackbox)
<list compact>
<item>Installer le paquet&nbsp;: <package>fluxbox</package>
<item><tt>exec /usr/bin/fluxbox</tt>
</list>

<item>gestionnaire de fenêtres Xfce (Ressemble à Mac OS-X, SUN CDE)
<list compact>
<item>Installer le paquet&nbsp;: <package>xfce</package>
<item><tt>exec /usr/bin/xfwm</tt>
</list>

<item>gestionnaire de fenêtres IceWM (léger, alternative à GNOME)
<list compact>
<item>Installer le paquet&nbsp;: <package>icewm</package>
<item><tt>exec /usr/bin/X11/icewm</tt>
</list>

<item>gestionnaire de fenêtres virtuel FVWM2 (léger, ressemble à Windows 95)
<list compact>
<item>Installer le paquet&nbsp;: <package>fvwm</package>
<item><tt>exec /usr/bin/fvwm2</tt>
</list>

<item>gestionnaire de fenêtres Windowmaker (ressemble à NeXT)
<list compact>
<item>Installer le paquet&nbsp;: <package>wmaker</package>
<item><tt>exec /usr/bin/wmaker</tt>
</list>

<item>gestionnaire de fenêtres Enlightenment (lourd)
<list compact>
<item>Installer le paquet&nbsp;: <package>enlightenment</package>
<item><tt>exec /usr/bin/enlightenment</tt>
</list>

</list>
Voir <url id="&windomanagerhome;" name="Window Managers for X">.


<sect2 id="kde-gnome">Configurer KDE et GNOME
<p>
Afin de configurer un environnement KDE ou GNOME complet, les meta-paquets
suivants sont utiles&nbsp;:
<list compact>
<item>KDE&nbsp;: installer le paquet <package>kde</package>
<item>GNOME&nbsp;: installer le paquet <package>gnome</package>
</list>
En installant ces paquets avec des outils qui gèrent la priorité
«&nbsp;<tt>recommends</tt>&nbsp;», comme <prgn>dselect</prgn> et
<prgn>aptitude</prgn>, vous aurez un choix de logiciel plus riche qu'en les
installant avec <prgn>apt-get</prgn>.
<p>
Si vous voulez une connexion à la console, assurez-vous de désactiver les
gestionnaires d'affichage X, comme <package>kdm</package>,
<package>gdm</package>, et <package>wdm</package>, qui peuvent être installés
par le système de dépendances, en suivant les instructions décrites à <ref
id="no-x-start">.
<p>
Si vous voulez avoir GNOME par défaut plutôt que KDE, configurez
<prgn>x-session-manager</prgn> comme décrit à <ref id="alternatives">.

<sect1 id="xtcp">Utiliser X sur TCP/IP
<p>
Comme les connexions TCP/IP distantes sans chiffrage peuvent être sujettes à
des attaques d'écoute de ligne, la configuration par défaut de X de &debian;
désactive les sockets TCP/IP. Pensez à utiliser <prgn>ssh</prgn> pour des
connexions X distantes (Voir <ref id="xssh">).
<p>
La méthode décrite ici n'est pas encouragée à moins que l'on soit dans un
environnement très sûr derrière un bon pare-feu et en présence d'utilisateurs
de confiance uniquement. La configuration suivante sur le serveur X restaure
les connexions TCP/IP&nbsp;:
<example>
# find /etc/X11 -type f -print0 | xargs -0 grep nolisten
/etc/X11/xinit/xserverrc:exec /usr/bin/X11/X -dpi 100 -nolisten tcp
</example>
Supprimez <tt>-nolisten</tt> pour permettre les connexions TCP/IP à X.
</sect1>
 
<sect1 id="xhost">Connexion à un serveur X distant &ndash; <prgn>xhost</prgn>
<p>
<prgn>xhost</prgn> autorise l'accès en se basant sur les noms d'hôtes, ce qui
n'est pas sûr du tout.  Les commandes suivantes permettent de désactiver la
vérification de l'hôte et autorisent des connexions de n'importe où si les
connexions TCP/IP sont autorisées (voir <ref id="xtcp">)&nbsp;:
<example>
$ xhost +
</example>
Vous pouvez réactiver la vérification de l'hôte avec&nbsp;:
<example>
$ xhost -
</example>
<p>
<prgn>xhost</prgn> ne fait pas la différence entre les utilisateurs sur l'hôte
distant. De plus, les noms d'hôtes (les adresses en fait) peuvent être
falsifiés.
<p>
Cette méthode doit être évitée même avec des critères sur les hôtes plus
restrictifs si vous êtes sur un réseau dans lequel vous ne pouvez avoir
confiance (par exemple avec une connexion PPP sur Internet).  Voir <manref
name="xhost" section="1x">.
</sect1>

<sect1 id="xssh">Connexion à un serveur X distante &ndash; <prgn>ssh</prgn>
<p>
L'utilisation de <prgn>ssh</prgn> active une connexion sûre d'un serveur X
local vers un serveur d'applications distant.
<list>
<item>Réglez <tt>X11Forwarding</tt> et <tt>AllowTcpForwarding</tt> à
<tt>yes</tt> dans <file>/etc/ssh/sshd_config</file> sur l'hôte distant.
<item>Démarrez le serveur X sur la station locale.
<item>Démarrez un <prgn>xterm</prgn> sur l'hôte local.
<item>Lancez <prgn>ssh</prgn> pour établir une connexion vers le site distant.
<example>
localname @ localhost $ ssh -q -X -l loginname remotehost.domain
Password:
.....
</example>
<item>Lancez des applications X sur le site distant.
<example>
loginname @ remotehost $ gimp &
</example>
</list>
Cette méthode permet l'affichage du client X distant comme s'il était connecté
par une socket UNIX locale.
</sect1>

<sect1 id="xtermfaq">L'émulateur de terminal X &ndash; <prgn>xterm</prgn>
<p>
Apprenez tout sur <prgn>xterm</prgn> à l'adresse <url id="&xtermfaq;">.
</sect1>

<sect1 id="xresources">Ressources X
<p>
Beaucoup d'anciens programmes X, comme <prgn>xterm</prgn>, utilisent la base de
données de ressources X pour configurer leur apparence. Le fichier
<file>~/.Xresources</file> est utilisé pour spécifier les ressources de
l'utilisateur. Ce fichier est automatiquement ajouté aux ressources X par
défaut au moment de la connexion. Les ressources X par défaut du système sont
stockées dans <file>/etc/X11/Xresources/*</file> et les ressources par défaut
des applications dans <file>/etc/X11/app-defaults/*</file>. Utilisez ces
paramètres comme point de départ.
<p>
Voici quelques paramètres intéressants à ajouter à
<file>~/.Xresources</file>&nbsp;:
<example>
! Règle la police à 9x15, plus lisible
XTerm*font: 9x15

! Affiche une barre de défilement
XTerm*scrollBar: true

! Règle la taille du tampon à 1000 lignes
XTerm*saveLines: 1000

! Large kterm screen
KTerm*VT100*fontList: -*-fixed-medium-r-normal--24-*,\
 -*-gothic-medium-r-normal--24-*,\
 -*-mincho-medium-r-normal--24-*
</example>
Pour que ces paramètres prennent effet immédiatement, ajoutez-les à la base de
données avec la commande&nbsp;:
<example>
xrdb -merge ~/.Xresources
</example>
Voir <manref name="xrdb" section="1x">.

<sect1 id="xmodmap">Clavier et souris sous X
<p>
Le programme <prgn>xmodmap</prgn> est utilisé pour éditer et afficher la carte
des modificateurs de clavier et la table des touches du clavier qui est
utilisée par les applications clientes pour converter les codes touches des
événements en symboles de touches sous X.
<example>
$ xmodmap -pm
 ... affiche la carte des modificateurs courante
$ xmodmap -pk | pager
 ... affiche la table clavier courante
$ xmodmap -e "pointer = 3 2 1" # configure la souris pour les gauchers
$ xmodmap ~/.xmodmaprc # configure le clavier comme dans ~/.xmodmaprc
</example>
Il est généralement exécuté depuis le script de démarrage de session d'un
utilisateur, <file>~/.xsession</file>.
<!--
Des tables clavier et des associations pour les boutons de la souris
personnalisés sous X peuvent être spécifiés dans <file>~/.xmodmaprc</file>.
-->
<p>
Pour obtenir le code touche, lancez <prgn>xev</prgn> sous X et appuyez sur
des touches. Pour obtenir la signification d'un symbole de touche, regardez
les définitions de MACRO dans <file>/usr/include/X11/keysymdef.h</file>. Tous
les <tt>#define</tt> de ce fichier ont le préfixe <tt>XK_</tt> suivi du nom du
symbole de touche.
<p>
Voir <manref name="xmodmap" section="1x">.

<sect1 id="ss-xsu">Devenir root sous X
<p>
Si une application graphique a besoin d'être lancée avec les privilèges de
root, utilisez les procédures suivantes pour le faire à partir du serveur X
d'un utilisateur. N'essayez jamais de démarrer un serveur X depuis le compte
root, pour vous garder d'éventuels risques de sécurité.
<p>
Démarrez le serveur X avec un utilisateur normal et ouvrez un
<prgn>xterm</prgn>. Ensuite&nbsp;:
<example>
$ XAUTHORITY=$HOME/.Xauthority
$ export XAUTHORITY
$ su root
Password:*****
# printtool &
</example>
Lorsque vous utilisez cette astuce pour effectuer un <prgn>su</prgn> vers un
utilisateur non root, faites attention à ce que le fichier
<file>~/.Xauthority</file> soit lisible par le groupe de cet utilisateur.
<p>

Cette séquence de commandes peut être automatisée en créant un fichier
<file>~/.xsession</file> sur le compte de l'utilisateur, avec les lignes
suivantes&nbsp;:
<example>
# Cela permet que X marche quand je fais un su pour devenir root
if [ -z "$XAUTHORITY" ]; then
    XAUTHORITY=$HOME/.Xauthority
    export XAUTHORITY
fi
unset XSTARTUP
# Si vous désirez un gestionnaire de fenêtres/session particulier,
# décommentez les lignes suivantes et éditez-les
#XSTARTUP=/usr/bin/blackbox
# Démarre le programme de gestion de fenêtres/session
if [ -z "$XSTARTUP" ]; then
  if [ -x /usr/bin/x-session-manager ]; then
    XSTARTUP=x-session-manager
  elif [ -x /usr/bin/x-window-manager ]; then
    XSTARTUP=x-window-manager
  elif [ -x /usr/bin/x-terminal-emulator ]; then
    XSTARTUP=x-terminal-emulator
  fi
fi
# exécute le gestionnaire de fenêtres/session sélectionné
exec $XSTARTUP
</example>
Ensuite, exécutez <prgn>su</prgn> (pas <tt>su -</tt>) dans une fenêtre
<prgn>xterm</prgn> de l'utilisateur.  Maintenant vous pouvez exécuter des
applications graphiques avec les privilèges de root sur l'écran X d'un
utilisateur normal.  Cette astuce fonctionne tant que le Xsession par défaut
est utilisé. Si un utilisateur personnalise <file>~/.xinit</file> ou
<file>~/.xsession</file>, la variable d'environnement <tt>XAUTHORITY</tt>
mentionnée ci-dessus doit être positionnée de la même façon dans ces scripts.

<p>Une autre méthode est d'utiliser le paquet <package>sudo</package>&nbsp;:
<example>
$ sudo xterm
... ou
$ sudo -H -s
</example>
Ici le fichier <file>/root/.bashrc</file> doit contenir&nbsp;:
<example>
if [ $SUDO_USER ]; then
    sudo -H -u $SUDO_USER xauth extract - $DISPLAY | xauth merge -
fi
</example>
Cela marche bien même si le répertoire home de l'utilisateur est sur une
partition NFS, puisque root ne lit pas le fichier <file>.Xauthority</file>.
<p>
Il existe aussi des paquets spécialisés dans ce but&nbsp;:
<package>kdesu</package>, <package>gksu</package>, <package>gksudo</package>,
<package>gnome-sudo</package>, et <package>xsu</package>. Enfin, trois autres
méthodes peuvent être utilisées pour atteindre des résultats similaires&nbsp;:
créer un lien symbolique depuis <file>/root/.Xauthority</file> vers celui de
l'utilisateur&nbsp;; utiliser le script <url id="&suxhome;"
name="&quot;sux&quot;">&nbsp;; ou mettre <tt>xauth merge
~<var>USER_RUNNING_X</var>/.Xauthority</tt> dans le script d'initialisation de
root.
<p>
Plus d'informations sur la <url id="&deb-dev-su;" name="liste de diffusion
debian-devel">.
</sect1>

<sect1 id="xfs-tt">Polices TrueType dans X
<p>
Le <prgn>xfs</prgn> standard de XFree86-4 fonctionne bien avec les polices
TrueType. Il faut installer un autre serveur de polices comme
<prgn>xfs-xtt</prgn> si vous utilisez XFree86-3.
<p>
Vous avez simplement besoin de vous assurer que les applications que vous
voulez utiliser avec les polices TrueType sont liées avec les bibliothèques
libXft ou libfreetype (vous n'avez probablement pas à vous en soucier si vous
utilisez des .deb précompilés).
<p>
D'abord, configurez l'infrastructure de support des polices.
<list compact>
<item>Installez les paquets <package>x-ttcidfont-conf</package> et
<package>defoma</package>. Cela automatise la génération des fichiers
<file>fonts.scale</file> et <file>fonts.dir</file>.
<example>
# apt-get install x-ttcidfont-conf
</example>
<item>Éditez <file>/etc/X11/XF86Config-4</file> dans la section <tt>Section
"Files"</tt> comme suit&nbsp;:
<example>
Section "Files"
    FontPath  "/var/lib/defoma/x-ttcidfont-conf.d/dirs/TrueType"
    FontPath  "/usr/share/fonts/truetype"
    FontPath  "/usr/lib/X11/fonts/CID"
    FontPath  "/usr/lib/X11/fonts/Speedo"
    FontPath  "/usr/lib/X11/fonts/misc"
    FontPath  "/usr/lib/X11/fonts/cyrillic"
    FontPath  "/usr/lib/X11/fonts/100dpi:unscaled"
    FontPath  "/usr/lib/X11/fonts/75dpi:unscaled"
    FontPath  "/usr/lib/X11/fonts/Type1"
EndSection
</example>
La première ligne configure XFree86 pour utiliser toutes les polices TrueType
que vous installez à partir de paquets &debian;.
L'entrée pour les polices Type1 est déplacée en bas car XFree86 ne rend pas
bien les polices Type1.
Les options <tt>:unscaled</tt> pour les polices bitmap ne sont en principe pas
nécessaires, mais je les inclus ici au cas où.
<!-- per /usr/share/doc/xfree86-common/README.fonts.gz in 4.2.1 -->
<p>
Afin de préserver les changements manuels de
<file>/etc/X11/XF86Config-4</file>, suivez les instructions de <ref
id="manual-config-x">.
</list>
<p>
Ensuite, installez des paquets de polices suivant les DFSG&nbsp;:
<list compact>
<item>Polices TrueType occidentales&nbsp;:
<list compact>
<item><package>ttf-bitstream-vera</package>&nbsp;: ensemble de polices
TrueType de grande qualité créées par Bitstream, Inc.
<footnote>
Bien que cela ne soit pas disponible dans Woody, vous pouvez les installer
depuis Sarge.
</footnote>
<item><package>ttf-freefont</package>&nbsp;: ensemble de polices TrueType
gratuites de grande qualité pour le jeu de caractères UCS.
<item><package>ttf-thryomanes</package>&nbsp;: police Unicode TrueType
pour les jeux de caractères latin, grec, cyrillique et IPA.
</list>
<item>Polices asiatiques&nbsp;:
<list compact>
<item><package>tfm-arphic-bsmi00lp</package>&nbsp;: police TrueType et
métriques de police TeX chinoise Arphic "AR PL Mingti2L Big5"
<item><package>tfm-arphic-bkai00mp</package>&nbsp;: police TrueType et
métriques de police TeX chinoise Arphic "AR PL KaitiM Big5"
<item><package>tfm-arphic-gbsn00lp</package>&nbsp;: police TrueType et
métriques de police TeX chinoise Arphic "AR PL SungtiL GB"
<item><package>tfm-arphic-gkai00mp</package>&nbsp;: police TrueType et
métriques de police TeX chinoise Arphic "AR PL KaitiM GB"
<item><package>ttf-baekmuk</package>&nbsp;: série de polices TrueType
coréennes Baekmuk
<item><package>hbf-jfs56</package>&nbsp;: police bitmap chinoise Jianti
Fangsong 56x56 (GB2312) pour CJK
<item><package>hbf-cns40-b5</package>&nbsp;: police bitmap chinoise Fanti Song
40x40 (Big5)  pour CJK
<item><package>hbf-kanji48</package>&nbsp;: police bitmap japonaise Kanji
48x48 (JIS X-0208)
</list>
</list>
<!-- Need to watch Japanese font issue -->
<p>
Puisque les polices <strong>libres</strong> sont parfois limitées,
l'installation ou le partage de certaines polices TrueType commerciales est
une option pour les utilisateurs &debian;. Afin de rendre ce processus facile
pour l'utilisateur, il existe certains paquets&nbsp;:
<list compact>
<item><package>ttf-commercial</package>
<item><package>msttcorefonts (>1.1.0)</package>
<footnote>
Le paquet de Woody ne marche plus depuis 8/2002 à cause d'un changement sur le
site web de Microsoft. Utilisez la version de Sarge à la place, même dans
Woody.
</footnote>
</list>
Vous aurez ainsi une très bonne sélection de polices TrueType au prix de la
contamination de votre système <strong>libre</strong> par des polices
non-libres.
<p>
Tous ces paquets de polices dans &debian; devraient marcher sans effort et
être disponibles pour tous les programmes X qui utilisent le système de
polices standard. Cela inclut par exemple Xterm, Emacs et la plupart des
autres applications non-KDE et non-GNOME.
<p>
Maintenant, lancez <prgn>xfontsel</prgn> et sélectionnez une police TrueType
dans le menu «&nbsp;fndry&nbsp;». Vous devriez voir un grand nombre d'entrées
non grisées dans le menu «&nbsp;fmly&nbsp;».
<p>
Pour KDE2.2 et GNOME1.4 (avec libgdkxft0, qui est un hack pour que GTK1.2
fasse de l'anticrénelage sur les polices), vous devez configurer Xft1 aussi.
Xft1 est obsolète, et n'est utilisé pratiquement que par GNOME1.4 et KDE2.2.
Éditez le fichier <file>/etc/X11/XftConfig</file> et ajoutez une ligne
<example>
    dir "/var/lib/defoma/x-ttcidfont-conf.d/dirs/TrueType"
</example>
<p>
avant les autres lignes <tt>dir</tt>.
<footnote>
Je n'ai plus Xft1 sur ma machine, donc je ne suis pas sûr s'il faut redémarrer
X ou pas avant que les changements prennent effet. Il me semble que
<prgn>xftcache</prgn> met à jour le cache Xft1, mais j'aimerais que quelqu'un
me le confirme.
</footnote>
<p>
Pour GNOME2 et KDE3 (après la sortie de Sarge), vous devez configurer
<package>fontconfig</package> que Xft2 utilise pour trouver les polices.
<footnote>
<package>fontconfig</package> n'existe pas dans Woody.
</footnote>
Vous ne devriez pas à avoir installer autre chose pour cela, puisque tous les
paquets utilisant <package>fontconfig</package> auront une dépendance sur lui.
<p>
D'abord, regardez le fichier <file>/etc/fonts/fonts.conf</file>. Il devrait y
avoir une ligne comme celle ci-dessous. Sinon, éditez
<file>/etc/fonts/local.conf</file> et ajoutez&nbsp;:
<example>
    &lt;dir&gt;/var/lib/defoma/x-ttcidfont-conf.d/dirs/TrueType&lt;/dir&gt;
</example>
juste après la ligne &lt;fontconfig&gt;
<p>
<package>fontconfig</package> devrait prendre cela en compte immédiatement et
<prgn>fc-list</prgn> devrait lister les nouvelles polices. Une autre
possibilité intéressante de <package>fontconfig</package> est que vous pouvez
mettredes polices dans <file>~/.fonts/</file> et tous les programmes utilisant
<package>fontconfig</package> y auront accès immédiatement.
<p>
Si vous installez manuellement un nouvel ensemble de polices TrueType dans X
sans un paquet &debian;, lancez
<example>
# xset fp rehash
</example>
pour que XFree86 les prenne en compte.

<sect1 id="ss-browser">Navigateurs Web pour X
<p>
Il existe quelques paquets de navigateurs web disponibles avec la sortie de
Woody&nbsp;:
<list compact>
<item><package>mozilla</package> Le navigateur Mozilla (nouveau)
<item><package>galeon</package> Navigateur basé sur Mozilla avec une interface Gnome (nouveau)
<item><package>konqueror</package> Navigateur KDE
<item><package>dillo</package> Navigateur GTK
<item><package>amaya-gtk</package> Navigateur de référence du W3C
<item><package>amaya-lesstif</package> Navigateur de référence du W3C
<item><package>netscape-...</package> (plusieurs, vieux)
<item><package>communicator-...</package> (plusieurs, vieux)
<item>...
</list>
La version de <package>mozilla</package> doit correspondre avec la version que
<package>galeon</package> requiert. A part l'interface graphique, ces deux
logiciels partagent le moteur de rendu HTML Gecko.
<p>
Des ajouts pour les navigateurs comme <package>mozilla</package> et
<package>galeon</package> peuvent être activés en installant des fichiers
<tt>*.so</tt> directement dans le répertoire <file>plugin</file> et en
relançant les navigateurs.
<p>
Ressources&nbsp;:
<list compact>
<item>Java&nbsp;: installer le binaire «&nbsp;J2SE&nbsp;» depuis <url id="&javasunhome;">.
<item>Flash&nbsp;: installer le binaire «&nbsp;Macromedia Flash Player
5&nbsp;» depuis <url id="&flashhome;">.
<item><package>freewrl</package>&nbsp;: navigateur VRML et plugin Netscape
<item>...
</list>
</sect1>

</sect>

<sect id="ssh">SSH
<p>
SSH (Secure SHell) est le moyen sécurisé de se connecter à d'autres machines
au travers d'Internet. Une version libre de SSH appelée OpenSSH est disponible
dans le paquet <package>ssh</package> de  &debian;.

<sect1 id="ssh-basics">Bases de SSH
<p>
Installez d'abord le serveur et le client OpenSSH.
<example>
# apt-get update && apt-get install ssh
</example>
Le fichier
<file>/etc/ssh/sshd_not_to_be_run</file> ne doit pas être présent si l'on veut
exécuter le serveur OpenSSH.
<p>
SSh possède deux protocoles d'identification&nbsp;:
<list>
<item>Protocole SSH version 1&nbsp;:
 <list compact>
<item>la version de Potato supporte seulement ce protocole.
<item>méthodes d'identification disponibles&nbsp;:
  <list compact>
<item>RSAAuthentication&nbsp;: identification basée sur une clé RSA
<item>RhostsAuthentication&nbsp;: identification basée sur .rhosts (non sûr,
désactivé)
<item>RhostsRSAAuthentication&nbsp;: identification .rhosts combinée avec clé
RSA (désactivé)
<item>ChallengeResponseAuthentication&nbsp;: identification par
challenge-response RSA
<item>PasswordAuthentication&nbsp;: identification basée sur un mot de passe
  </list>
 </list>
<item>Protocole SSH version 2&nbsp;:
 <list compact>
<item>les versions d'après Woody utilisent ce protocole par défaut.
<item>méthodes d'identification disponibles&nbsp;:
  <list compact>
<item>PubkeyAuthentication&nbsp;: identification de l'utilisateur basée sur
une clé publique
<item>HostbasedAuthentication&nbsp;: identification par <file>.rhosts</file>
ou <file>/etc/hosts.equiv</file> combinée avec identification de l'hôte par
clé publique (désactivé)
<item>ChallengeResponseAuthentication&nbsp;: identification par
challenge-response RSA
<item>PasswordAuthentication&nbsp;: identification basée sur un mot de passe
  </list>
 </list>
</list>

<p>
Faites attention avec ces différences si vous migrez vers Woody ou si vous
utilisez un système non &debian;.
<p>
Voir <file>/usr/share/doc/ssh/README.Debian.gz</file>,
<manref name="ssh" section="1">,
<manref name="sshd" section="8">,
<manref name="ssh-agent" section="1">, et
<manref name="ssh-keygen" section="1"> pour plus de détails.

<p>
Les fichiers suivants sont les fichiers de configuration importants.

<list>

<item><file>/etc/ssh/ssh_config</file>&nbsp;: valeurs par défaut pour le
client SSH. Voir <manref name="ssh" section="1">. Entrées importantes&nbsp;:

 <list compact>
<item><tt>Host</tt>&nbsp;: Restreint les entrées suivantes (jusqu'au prochain
Host) aux hôtes qui correspondent au motif donné après le mot clé.
<item><tt>Protocol</tt>&nbsp;: Spécifie la version du protocole SSH. Par
défaut, «&nbsp;2,1&nbsp;».
<item><tt>PreferredAuthentications</tt>&nbsp;: Spécifie la méthode
d'identification pour le client SSH2. Par défaut,
«&nbsp;hostbased,publickey,keyboard-interactive,password&nbsp;».
<item><tt>PasswordAuthentication</tt>&nbsp;: Si vous voulez vous connecter
avec un mot de passe, vous devez vous assurer que cela n'est pas mis à
<tt>no</tt>.
<item><tt>ForwardX11</tt>&nbsp;: Désactivé par défaut. Peut être outrepassé
par l'option <tt>-X</tt> en ligne de commande.
 </list>

<item><file>/etc/ssh/sshd_config</file>&nbsp;: valeurs par défaut pour le
serveur SSH. Voir <manref name="sshd" section="8">. Entrées à noter&nbsp;:

 <list compact>
<item><tt>ListenAddress</tt>&nbsp;: Spécifie les adresses locales que
<prgn>sshd</prgn> doit écouter. Plusieurs options sont permises.
<item><tt>AllowTcpForwarding</tt>&nbsp;: Désactivé par défaut.
<item><tt>X11Forwarding</tt>&nbsp;: Désactivé par défaut.
 </list>

<item><file>$HOME/.ssh/authorized_keys</file>&nbsp;: liste de clés publiques
par défaut utilisées pour se connecter à ce compte sur cette machine. Voir
<manref name="ssh-keygen" section="1">.

<item><file>$HOME/.ssh/identity</file>&nbsp;: Voir <manref name="ssh-add"
section="1"> et <manref name="ssh-agent" section="1">.
</list>

<p>
Les commandes suivantes permettent de démarrer une connexion <prgn>ssh</prgn>.
<example>
$ ssh username@hostname.domain.ext
$ ssh -1 username@hostname.domain.ext # Force SSH version 1
$ ssh -1 -o RSAAuthentication=no -l username foo.host
             # force un mot de passe avec SSH1
$ ssh -o PreferredAuthentications=password -l username foo.host
             # force un mot de passe avec SSH2
</example>
Pour un utilisateur, <prgn>ssh</prgn> est plus intelligent que
<prgn>telnet</prgn> (il ne crashe pas avec ^]).
</sect1>

<sect1 id="ssh-forward">Redirection de port pour un tunnel SMTP/POP3
<p>
Pour établir un tunnel pour se connecter au port 25 de <var>remote-server</var>
depuis le port 4025 de la machine locale, et au port 110 de
<var>remote-server</var> depuis le port 4110 de la machine locale par
<prgn>ssh</prgn>, exécutez les commandes suivantes sur la machine locale&nbsp;:
<example>
# ssh -q -L 4025:remote-server:25 4110:remote-server:110 \
           username@remote-server
</example>
C'est un moyen sécurisé d'effectuer une connexion vers un serveur SMTP/POP3 au
travers d'Internet. Positionnez l'entrée <tt>AllowTcpForwarding</tt> à
<tt>yes</tt> dans <file>/etc/ssh/sshd_config</file> sur la machine distante.
</sect1>

<sect1 id="ssh-rsa">Se connecter avec moins de mots de passe &ndash; RSA
<p>
On peut éviter de se rappeler le mot de passe pour chaque système distant en
utilisant RSAAuthentication (protocole SSH1) ou PubkeyAuthentication
(protocole SSH2).
<p>
Sur le système distant, le contenu de <file>/etc/ssh/sshd_config</file> doit
contenir «&nbsp;RSAAuthentication yes&nbsp;» ou «&nbsp;PubkeyAuthentication
yes&nbsp;».
<p>
Générez ensuite les clés d'identification localement et installez la clé
publique sur le système distant&nbsp;:
<example>
$ ssh-keygen          # RSAAuthentication : clé RSA1 pour SSH1
$ cat .ssh/identity.pub | ssh user1@remote \
        "cat - &gt;&gt;.ssh/authorized_keys"
...
$ ssh-keygen -t rsa   # PubkeyAuthentication : clé RSA pour SSH2
$ cat .ssh/id_rsa.pub | ssh user1@remote \
        "cat - &gt;&gt;.ssh/authorized_keys"
...
$ ssh-keygen -t dsa   # PubkeyAuthentication : clé DSA pour SSH2
$ cat .ssh/id_dsa.pub | ssh user1@remote \
        "cat - &gt;&gt;.ssh/authorized_keys"
</example>
On peut changer la phrase de passe par la suite avec <tt>ssh-keygen -p</tt>.
Assurez-vous de vérifier la configuration en testant la connexion. En cas de
problème, utilisez <tt>ssh -v</tt>.
<p>
Vous pouvez ajouter des options dans les entrées de
<prgn>authorized_keys</prgn> pour limiter les hôtes et exécuter des commandes
spécifiques. Consultez <manref name="sshd" section="8"> pour plus de détails.
<p>
Notez que SSH2 fait une identification de type
<tt>HostbasedAuthentication</tt>. Pour que cela fonctionne, il faut régler la
configuration de <tt>HostbasedAuthentication</tt> à <tt>yes</tt> dans
<file>/etc/ssh/sshd_config</file> sur le serveur et
<file>/etc/ssh/ssh_config</file> ou <file>$HOME/.ssh/config</file> sur le
client.
</sect1>

<sect1 id="ssh-client">Clients SSH étrangers
<p>
Il existe quelques clients SSH gratuits disponibles pour des systèmes non
Unix.
<taglist>
<tag>Windows
<item><url id="&puttyhome;" name="puTTY"> (GPL)
<tag>Windows (cygwin)
<item>SSH in <url id="&cygwinhome;" name="cygwin"> (GPL)
<tag>Macintosh Classic
<item><url id="&macsshhome;" name="macSSH"> (GPL) [Notez que Mac OS X inclut
OpenSSH&nbsp;; utilisez <tt>ssh</tt> depuis l'application Terminal]
</taglist>
Voir <url id="&sfdochome;" name="SourceForge.net, documentation du site">,
«&nbsp;6. CVS Instructions&nbsp;».

<sect1 id="ssh-agent">Configurer <prgn>ssh-agent</prgn>
<p>
Il est plus sûr de protéger votre clé d'identification SSH avec une phrase de
passe. Si elle n'a pas été configurée, exécutez <tt>ssh-keygen -p</tt>.
<p>
Mettez votre clé publique (par exemple <file>~/.ssh/id_rsa.pub</file>) dans
<file>~/.ssh/authorized_keys</file> sur un hôte distant comme décrit dans <ref
id="ssh-rsa">.
<example>
$ ssh-agent bash # ou lancez zsh/tcsh/pdksh à la place
$ ssh-add ~/.ssh/id_rsa
Enter passphrase for /home/osamu/.ssh/id_rsa:
Identity added: /home/osamu/.ssh/id_rsa (/home/osamu/.ssh/id_rsa)
$ scp <var>foo</var> <var>user@remote.host:foo</var>
 ... pas besoin de phrase de passe à partir de maintenant :-)
$^D
 ... fin de la session ssh-agent
</example>
Pour le serveur X, les scripts de démarrage de &debian; exécutent
<prgn>ssh-agent</prgn> comme processus parent. Donc, vous n'avez pas besoin
d'exécuter <prgn>ssh-add</prgn> qu'une seule fois.
<p>
Pour plus d'information, consultez <manref name="ssh-agent" section="1"> et
<manref name="ssh-add" section="1">.
</sect1>

<sect1 id="ssh-trouble">Résoudre les problèmes avec SSH
<p>
Si vous rencontrez des problèmes, vérifiez les permissions du fichier de
configuration et lancez <prgn>ssh</prgn> avec l'option <tt>-v</tt>.
<p>
Utilisez <tt>-P</tt> si vous êtes root et avez des problèmes avec un
pare-feu&nbsp;; cela évite d'utiliser des ports serveur 1&ndash;1023.
<p>
Si les connexions <prgn>ssh</prgn> vers un site distant arrêtent subitement de
fonctionner, cela peut être suite à des bidouilles de l'administrateur,
sûrement un changement de <prgn>host_key</prgn> pendant une maintenance du
système. Après s'être assuré que c'est bien le cas et que personne n'essaie de
se faire passer pour la machine distante par une bidouille, on peut se
reconnecter en enlevant l'entrée <prgn>host_key</prgn> de
<file>~/.ssh/known_hosts</file> sur la machine locale.
</sect1>
</sect>

<sect id="mail">Logiciels de courrier électronique
<p>
La configuration du courrier électronique se divise en trois parties&nbsp;:
<list>
<item>Agent de transfert de courriel (Mail Transfer Agent, MTA)&nbsp;:
<prgn>exim4</prgn>, <prgn>exim</prgn>, <prgn>postfix</prgn>,
<prgn>sendmail</prgn>, <prgn>qmail</prgn>, <prgn>ssmtp</prgn>,
<prgn>nullmailer</prgn>, ...
<item>Utilitaires&nbsp;: <prgn>procmail</prgn>, <prgn>fetchmail</prgn>,
<prgn>mailx</prgn>, <prgn>crm114</prgn>, ...
<item>MUA&nbsp;: <prgn>mutt</prgn>, <prgn>emacs</prgn>+<prgn>gnus</prgn>, ...
</list>

<sect1 id="mta">Agent de transport de courrier électronique
<p>
Pour un MTA (<em>Mail Transport Agent</em>) complet, utilisez
<package>exim</package> dans Woody et <package>exim4</package> dans Sarge.
<footnote>
Les sections suivantes utilisent <prgn>exim</prgn> dans les exemples. pour
Sarge, remplacez par <prgn>exim4</prgn>.
</footnote>
Références&nbsp;:
<list compact>
<item>paquets <package>exim-doc</package> et <package>exim-doc-html</package>
pour <package>exim</package>
<item>paquets <package>exim4-doc-info</package> et
<package>exim4-doc-html</package> pour <package>exim4</package>
<item><url id="&eximhome;">
</list>
La seule alternative raisonnable est <package>postfix</package> si vous vous
souciez de la sécurité. <package>sendmail</package> et
<package>qmail</package> sont disponibles dans &debian; mais ne sont pas
recommandés.
<p>
Si vous n'avez pas besoin de la capacité de relai d'un MTA comme dans le cas
d'un système satellite comme un portable, vous pouvez utiliser l'un de ces
paquets légers&nbsp;:
<list compact>
 <item><prgn>ssmtp</prgn>&nbsp;: a besoin d'une connexion SMTP et est capable
 de gérer des alias, ou
 <item><prgn>nullmailer</prgn>&nbsp;: gère une file d'attente mais n'est pas
 capable de gérer des alias.
</list>
A ce jour, je trouve qu'<prgn>exim</prgn> est le plus approprié même pour ma
station de travail personnelle, qui est un portable.
<p>
Vous pouvez avoir besoin de supprimer <prgn>exim</prgn> pour installer l'un de
ces paquets entrant en conflit avec&nbsp;:
<example>
# dpkg -P --force-depends exim
# apt-get install nullmailer         # ou ssmtp
</example>

<sect2 id="exim-smart">Smarthost
<p>
Si vous utilisez <prgn>exim4</prgn> ou <prgn>exim</prgn> sur une machine qui
est connectée par un service grand public, assurez-vous d'envoyer le courriel
sortant à travers le serveur offert par votre FAI ou un autre.
<footnote>
Vous devez suivre cette règle pour toute machine en accès RTC, DSL, câble ou
LAN par un routeur haut débit. Même si votre machine a une adresse IP fixe,
c'est toujours une bonne idée de suivre cette règle. La plupart des stations
de travail et serveurs à la maison tombent dans cette catégorie.
</footnote>
Voici quelques bonnes raisons pour le faire&nbsp;:
<list compact>
<item>pour assurer les ré-essais SMTP puisque le serveur de votre FAI a une
connexion de meilleure qualité&nbsp;;
<item>pour éviter d'envoyer le courriel directement d'une <strong>adresse IP
dynamique</strong> qui risque d'être bloquée par les listes anti-spam&nbsp;;
<item>pour sauver de la bande passante localement lors d'envois de courriels à
plusieurs destinataires.
</list>
<p>
Les seules exceptions éventuelles sont&nbsp;:
<list compact>
<item>pallier à une défaillance du serveur de votre FAI&nbsp;;
<item>une expérience à but éducatif&nbsp;;
<item>votre machine est un serveur professionnel.
</list>

<sect2 id="exim-base">Configuration de base d'Exim
<p>
Pour configurer <prgn>exim4</prgn> ou <prgn>exim</prgn> en tant que MTA,
configurez ce qui
suit&nbsp;:
<example>
/etc/exim.conf          "eximconfig" pour créer et éditer (exim)
/etc/exim4/*            "dpkg-reconfigure exim4-config" pour créer et éditer (exim4)
/etc/inetd.conf         mettez smtp en commentaire pour exécuter exim en
                        tant que daemon
/etc/email-addresses    ajoutez les listes d'adresses sources spoofées
</example>
Vérifiez les filtres avec <prgn>exim4</prgn> ou <prgn>exim</prgn> avec les
options <tt>-brw, -bf, -bF, -bV, ...</tt> etc.

<sect2 id="addr-catchall">Configurer Exim pour récupérer les adresses non
existantes
<p>
Dans <file>/etc/exim/exim.conf</file> (Woody ou plus), dans la partie
DIRECTORS, à la fin (après localuser: director) ajoutez une directive
"catch-all" qui correspond à toutes les adresses que la directive précédente
ne pouvait résoudre (par Miquel van Smoorenburg)&nbsp;:
<example>
catchall:
  driver = smartuser
    new_address = <var>webmaster@mydomain.com</var>
</example>
<p>
Si vous souhaitez une recette plus détaillée pour chaque domaine virtuel,
ajoutez ce qui suit à la fin de <file>exim.conf</file> (par moi, pas bien
testé)&nbsp;:
<example>
*@yourdomain.com ${lookup{$1}lsearch*{/etc/email-addresses} \
        {$value}fail} T
</example>
Et ajoutez une entrée «&nbsp;*&nbsp;» dans <file>/etc/email-addresses</file>.
</sect2>

<sect2 id="addr-rewrite">Configurer Exim pour réécrire les adresses
sélectionnées sur les courriels sortants
<p>
<!-- Derrick 'dman' Hudson dman@dman.ddts.net -->
La réécriture des adresses pour le courrier sortant afin d'avoir des en-têtes
«&nbsp;From:&nbsp;» corrects peut être réalisée avec <prgn>exim</prgn> avec la
configuration suivante près de la fin de
<file>/etc/exim/exim.conf</file>&nbsp;:
<example>
*@host1.something.dyndns.org \
  "${if eq {${lookup{$1}lsearch{/etc/passwd}{1}{0}}} {1}  \
   {$0}{$1@something.dyndns.org}}"  frFs
</example>
Cela réécrit toutes les adresses de type
<tt>*@host1.something.dyndns.org</tt>.
<enumlist>
<item>Cela cherche dans le fichier <file>/etc/password</file> pour voir si la
partie locale ($1) est un utilisateur local ou pas.
<item>Si c'est un utilisateur local, cela réécrit l'adresse telle qu'elle
était en premier lieu ($0).
<item>Si ce n'est pas un utilisateur local, cela réécrit le nom de domaine.
</enumlist>

<sect2 id="smtp-aauth">Configurer Exim pour l'authentification SMTP
<p>
Certains services SMTP comme yahoo.com demandent une authentification SMTP.
Configurez <file>/etc/exim/exim.conf</file> comme suit&nbsp;:
<example>
remote_smtp:
  driver = smtp
  authenticate_hosts = smtp.mail.yahoo.com
...

smarthost:
  driver = domainlist
  transport = remote_smtp
  route_list = "* smtp.mail.yahoo.com bydns_a"
...

plain:
  driver = plaintext
  public_name = PLAIN
  client_send = "^cmatheson3^this_is_my_password"
</example>
N'oubliez pas les double guillemets sur la dernière ligne.

<sect1 id="fetchmail">Récupérer le courrier électronique &ndash; Fetchmail
<p>
<prgn>fetchmail</prgn> est exécuté en mode démon et récupère le courrier
électronique du compte POP3 du FAI sur le système de mail local. Configurez&nbsp;:
<example>
/etc/init.d/fetchmail   voir ci-dessous pour le script
/etc/rc?.d/???fetchmail exécutez update-rc.d fetchmail defaults 30
/etc/fetchmailrc        fichier de configuration (chown 600)
</example>
<p>
Les informations pour démarrer <prgn>fetchmail</prgn> en mode démon depuis un
script <prgn>init.d</prgn> dans Potato ne sont pas claires (Woody corrige
cela). Voir les exemples <file>/etc/init.d/fetchmail</file> et
<file>/etc/fetchmailrc</file> dans <url id="&examples;" name="exemples de
scripts">.
<p>
Si vos en-têtes de courriers électroniques sont contaminées par des ^M dûs au
logiciel de courrier électronique de votre FAI, ajoutez «&nbsp;stripcr&nbsp;»
aux options dans <file>$HOME/.fetchmailrc</file>&nbsp;:
<example>
options fetchall no keep stripcr
</example>
</sect1>

<sect1 id="procmail">Traiter le courrier électronique &ndash; Procmail
<p>
<prgn>procmail</prgn> est un filtre pour le courrier électronique délivré.
Il faut créer un <file>$HOME/.procmailrc</file> pour chaque compte qui
l'utilise.
Exemple&nbsp;: <url id="&examples;" name="_procmailrc">.
</sect1>

<sect1 id="crm114">Filtrer le spam avec <package>crm114</package>
<p>
Le paquet <package>crm114</package> fournit le script
<prgn>/usr/share/crm114/mailfilter.crm</prgn> écrit en CRM114. Ce script
fournit un filtre anti-spam très efficace qui peut être entraîné en lui
fournissant du spam et des mails valides.
<p>
CRM114 est un petit langage conçu pour écrire des filtres&nbsp;; c'est un
espèce de grep avec des super pouvoirs. Voir <manref name="crm" section="1">.
</sect1>

<sect1 id="mutt">Lire le courrier électronique &ndash; Mutt
<p>
Utilisez <prgn>mutt</prgn> comme agent pour utilisateur de courrier
électronique (Mail User Agent, MUA) associé à <prgn>vim</prgn>.
Personnalisez-le dans
<file>~/.muttrc</file>&nbsp;:
<example>
# utiliser le mode visuel et "gq" pour reformater les citations
set editor="vim -c 'set tw=72 et ft=mail'"
#
# sélection des en-têtes prise dans le manuel (« Sven's Draconian header
# weeding »)
#
ignore *
unignore from: date subject to cc
unignore user-agent x-mailer
hdr_order from subject to cc date user-agent x-mailer
auto_view application/msword
....
</example>
<p>
Ajoutez ce qui suit dans <file>/etc/mailcap</file> ou
<file>$HOME/.mailcap</file> pour afficher les courriers électroniques en HTML
et les attachements MS Word dans le message&nbsp;:
<example>
text/html; lynx -force_html &percnt;s; needsterminal;
application/msword; /usr/bin/antiword '&percnt;s'; copiousoutput;
description="Microsoft Word Text"; nametemplate=&percnt;s.doc
</example>

</sect1>

</sect>

<sect id="l10n">Localisation (l10n)
<p>
&debian; est internationalisé et supporte un nombre toujours plus élevé de
langues et de conventions locales. La sous-section suivante liste quelques
formes de la diversité que &debian; supporte actuellement, et la sous-section
suivante parle de la <strong>localisation</strong>, processus de
personnalisation de votre environnment de travail pour permettre l'entrée et
l'affichage de votre langue et conventions pour les dates, les formats
numériques et monétaires, et d'autres aspects d'un système qui diffèrent selon
votre région.

<sect1 id="languages">Bases de la localisation
<p>
Il y a plusieurs aspects à la personnalisation de la localisation et du
support de la langue nationale.

<sect2 id="keyboard">Localiser le clavier
<p>
&debian; est distribuée avec le support pour près de deux douzaines de
claviers. Dans Woody, reconfigurez le clavier avec&nbsp;:

<list compact>
<item><tt>dpkg-reconfigure --priority=low console-data # console</tt>
<item><tt>dpkg-reconfigure --priority=low xserver-xfree86   # XF4</tt>
<item><tt>dpkg-reconfigure --priority=low xserver-common-v3 # XF3</tt>
</list>
</sect2>

<sect2 id="data-stream">Localiser les fichiers de données
<p>
La grande majorité des paquets de logiciels Debian supporte l'entrée de
caractères non US-ASCII avec la variable d'environnement LC_TYPE offerte par
la technologie des <strong>locales</strong> de la glibc.

<list compact>
<item>Propres en 8 bits&nbsp;: presque tous les programmes
<item>Autres langues latines (par exemple ISO-8859-1 ou ISO-8859-2)&nbsp;:
majorité des programmes
<item>Langues multi-octets comme le Japonais ou le Coréen&nbsp;: beaucoup de
nouvelles applications
</list>
</sect2>

<sect2 id="display">Localiser l'affichage
<p>
X peut afficher n'importe quel codage y compris UTF-8 et supporte toutes les
fontes. La liste inclut non seulement les polices 8 bits mais aussi des
polices 16 bits comme pour le Chinois, le Japonais et le Coréen. L'entrée de
caractères multi-octets est supportée par le mécanisme <ref id="x-input">.
Voir <ref id="x-cjk"> et <ref id="x-utf-8">.
<p>
L'affichage du codage japonais EUC est aussi possible sur la console graphique
(S)VGA avec le paquet <package>kon2</package>. Il existe aussi un nouvel
affichage japonais <package>jfbterm</package> qui utilise la console FB. Dans
ces environnements de console, la méthode d'entrée du Japonais doit être
fournie par l'application. Utilisez le paquet <package>egg</package> pour
Emacs et utilisez le paquet <package>jvim</package> pour Vim.
<p>
L'installation de polices non Unicode dans X aide à afficher des documents
ayant n'importe quel codage. Aussi ne vous inquiétez pas trop à propos du
codage des polices.
</sect2>

<sect2 id="translation">Localiser les messages et la documentation
<p>
Des traductions existent pour beaucoup de messages texte et documents qui sont
affichés par le système &debian;, comme les messages d'erreur, l'affichage
standard des programmes, les menus et les pages de manuel. Actuellement, le
support pour les langues Allemand, Espagnol, Finlandais, Français, Hongrois,
Italien, Japonais, Koréen et Polonais dans les pages de manuel est fourni par
les paquets <tt>manpages-<var>LANG</var></tt> (où <var>LANG</var> est le code
ISO à deux lettres du pays. Utilisez <tt>apt-cache search manpages-|less</tt>
pour avoir une liste des pages de manuel disponibles).
<p>
Pour accéder à une page de manuel NLS, l'utilisateur doit configurer la
variable du shell LC_MESSAGES de la façon appropriée. Par exemple, dans le cas
des pages de manuel en Italien, LC_MESSAGES doit être positionnée à
<tt>it</tt>. Le programme <prgn/man/ cherchera alors les pages de manuel en
Italien sous <file>/usr/share/man/it/</file>.
</sect2>
</sect1>

<sect1 id="locales">Locales
<p>
Debian supporte la technologie <strong>locale</strong>. C'est un mécanisme
qui permet aux programmes de fournir un affichage et des fonctionnalités
adaptés aux conventions locales comme le jeu de caractères, le format de la
date et de l'heure, le symbole de la monnaie, et ainsi de suite. Il utilise
des variables d'environnement pour déterminer le comportement approprié. Par
exemple, en supposant que vous avez les locales Anglais américain et Allemand 
installées sur votre système, les messages d'erreur de beaucoup de programmes
peuvent être multilingues&nbsp;:
<example>
$ LANG="en_US" cat foo
cat: foo: No such file or directory
$ LANG="de_DE" cat foo
cat: foo: Datei oder Verzeichnis nicht gefunden
</example>
La glibc offre le support pour cette fonctionnalité dans la bibliothèque. Voir
<manref name="locale" section="7">.

<sect1 id="base-locale">Introduction aux locales
<p>
La description complète d'une locale comprend trois parties&nbsp;:
<tt>xx_YY.ZZZZ</tt>.
<list compact>
<item><strong><tt>xx</tt></strong>&nbsp;: code de la langue ISO 639 (minuscule)
<item><strong><tt>YY</tt></strong>&nbsp;: code du pays ISO 3166 (majuscule)
<item><strong><tt>ZZZZ</tt></strong>&nbsp;: table du code, c-à-d table des
caractères ou identificateur de codage.
</list>
<p>
Pour les codes de langue et de pays, voir l'information de <tt>info
gettext</tt>.
<p>
Veuillez noter que la partie table du code peut être normalisée de façon
interne pour obtenir une compatibilité inter-plateformes en enlevant tous les
<tt>-</tt> et en convertissant tous les caractères en minuscules. Voici les
tables de code typiques&nbsp;:
<list compact>
  <item><strong>UTF-8</strong>&nbsp;: Unicode pour toutes les régions,
principalement en 1-3 octets (nouveau standard de fait)
  <item><strong>ISO-8859-1</strong>&nbsp;: Europe de l'ouest (ancien standard
de fait)
  <item><strong>ISO-8859-2</strong>&nbsp;: Europe de l'est (Bosniaque, Croate,
Tchèque, Hongrois, Polonais, Roumain, Serbe, Slovaque, Slovène)
  <item><strong>ISO-8859-3</strong>&nbsp;: Malte
  <item><strong>ISO-8859-5</strong>&nbsp;: Macédonien, Serbe
  <item><strong>ISO-8859-6</strong>&nbsp;: Arabe
  <item><strong>ISO-8859-7</strong>&nbsp;: Grec
  <item><strong>ISO-8859-8</strong>&nbsp;: Hébreux
  <item><strong>ISO-8859-9</strong>&nbsp;: Turc
  <item><strong>ISO-8859-11</strong>&nbsp;: Thai (=TIS-620)
  <item><strong>ISO-8859-13</strong>&nbsp;: Léton, Lithuanien, Maori
  <item><strong>ISO-8859-14</strong>&nbsp;: Gallois
  <item><strong>ISO-8859-15</strong>&nbsp;: Europe de l'ouest avec l'euro
  <item><strong>KOI8-R</strong>&nbsp;: Russe
  <item><strong>KOI8-U</strong>&nbsp;: Ukrainien
  <item><strong>CP1250</strong>&nbsp;: Tchèque, Hongrois, Polonais (sur MS
Windows à l'origine)
  <item><strong>CP1251</strong>&nbsp;: bulgare, Biélorusse (sur MS
Windows à l'origine)
  <item><strong>eucJP</strong>&nbsp;: Japonais façon Unix (=ujis)
  <item><strong>eucKR</strong>&nbsp;: Coréen façon Unix
  <item><strong>GB2312</strong>&nbsp;: Chinois Simplifié façon Unix (=GB,
=eucCN) pour zh_CN
  <item><strong>Big5</strong>&nbsp;: Chinois Traditionel pour zh_TW
  <item><strong>sjis</strong>&nbsp;: Japonais façon Microsoft (Shift-JIS)
</list>
Et voici la signification du jargon des systèmes de codage&nbsp;:
<list compact>
<item><strong>ASCII</strong>&nbsp;: 7 bits (0-0x7f)
<item><strong>ISO-8859-?</strong>&nbsp;: 8 bits (0-0xff)
<item><strong>ISO-10646-1</strong>&nbsp;: Universal Character Set (UCS) (31
bits, 0-0x7fffffff)
<item><strong>UCS-2</strong>&nbsp;: 16 premiers bits de UCS comme 2 octets
simples (Unicode: 0-0xffff)
<item><strong>UCS-4</strong>&nbsp;: UCS comme 4 octets simples (UCS&nbsp;:
0-0x7fffffff)
<item><strong>UTF-8</strong>&nbsp;: UCS codé sur 1-6 octets (généralement 3
octets)
<item><strong>ISO-2022</strong>&nbsp;: 7 bits (0-0xff) avec la séquence
d'échappement&nbsp;; c'est le codage japonais le plus populaire pour le courrier
électronique
<item><strong>EUC</strong>&nbsp;: 8 bits + 16 bits (0-0xff), façon Unix
<item><strong>Shift-JIS</strong>&nbsp;: 8 bits + 16 bits (0-0xff), façon
Microsoft
</list>
ISO-8859-?, EUC, ISO-10646-1, UCS-2, UCS-4 et UTF-8 partagent le même code
qu'ASCII pour les caractères de 7 bits. EUC ou Shift-JIS utilisent des
caractères de bit haut (0x80-0xff) pour indiquer qu'une partie du codage est
sur 16 bits. UTF-8 utilise aussi des caractères de bit haut (0x80-0xff) pour
indiquer les séquences de caractères sur plus de 7 bits. C'est le système de
codage le plus intelligent pour gérer les caractères non-ASCII.
<p>
Veuillez noter la différence d'ordre des octets des implémentations
d'Unicode&nbsp;:
<list compact>
<item><strong>Standard  UCS-2, UCS-4</strong>&nbsp;: big endian
<item><strong>Microsoft UCS-2, UCS-4</strong>&nbsp;: little endian pour ix86
(dépend de la machine)
</list>
Voir <ref id="recode"> pour convertir entre les jeux de caractères.
Pour plus d'information, consultez <url id="&intro-i18n;" name="Introduction
to i18n"> (en Anglais).

<sect1 id="activate-locales">Activer le support des locales
<p>
Debian n'est <strong>pas</strong> livrée avec toutes les locales disponibles
précompilées. Consultez le fichier <file>/usr/lib/locale</file> pour voir
quelles locales (à part le défaut, «&nbsp;C&nbsp;») sont compilées pour votre
système. Si celle dont vous avez besoin n'est pas présente, vous avez deux
possibilités&nbsp;:
<list compact>
 <item>Editer <file>/etc/locale.gen</file> pour ajouter la locale souhaitée,
 et lancer <prgn>locale-gen</prgn> en tant que root pour la compiler. Voir
 <manref name="locale-gen" section="8"> et les pages de manuel listées dans la
 section «&nbsp;Voir aussi&nbsp;».
 <item>Lancer <tt>dpkg-reconfigure locales</tt> pour reconfigurer le paquet
 <package>locales</package>. Ou s'il n'est pas déjà installé, l'installation
 de <package>locales</package> invoquera l'interface debconf pour choisir les
 locales désirées et les compiler.
</list>
<!--  XXX FIXME XXX
 <item>Exécutez <prgn>localedef</prgn> à la main depuis un compte utilisateur
pour compiler la base des locales et l'utiliser en paramétrant la variable
d'environnement <tt>LOC_PATH</tt>. Par exemple, pour
<tt>en_GB.UTF-8</tt>&nbsp;:
   <example>
$ localedef -v -c -i en_GB -f UTF-8 <var>somewhere/</var>en_GB.UTF-8
$ export LOC_PATH=<var>somewhere/</var>
   </example>
 -->

<sect1 id="env-locale">Activer une locale particulière
<p>
Les variables d'environnement suivantes sont évaluées dans cet ordre pour
fournir les valeurs de locale aux programmes&nbsp;:
<enumlist>
<item>LANGUAGE&nbsp;: cette variable d'environnement consiste en une liste de
locales séparées par deux points verticaux, dans l'ordre de priorité. Utilisé
seulement si la locale POSIX est positionnée à une valeur autre que "C" [dans
Woody&nbsp;; la version de Potato a toujours priorité sur la locale POSIX]. (GNU
extension)
<item>LC_ALL&nbsp;: Si cette variable est non nulle, sa valeur est utilisée
pour toutes les catégories de locales. (POSIX.1) Habituellement "" (null).
<item>LC_*&nbsp;: Si cette variable est non nulle, sa valeur est utilisée pour
la catégorie correspondante. (POSIX.1) Habituellement "C".
<p>
Les variables LC_* sont&nbsp;:
 <list compact>
<item>LC_CTYPE&nbsp;: Classification des caractères et conversion de casse.
<item>LC_COLLATE&nbsp;: Ordre de collation.
<item>LC_NUMERIC&nbsp;: Formats des nombres non monétaires.
<item>LC_MONETARY&nbsp;: Formats monétaires.
<item>LC_MESSAGES&nbsp;: Formats des messages d'information et de diagnostic
et des réponses intéractives.
<item>LC_PAPER&nbsp;: Taille du papier.
<item>LC_NAME&nbsp;: Formats des noms.
<item>LC_ADDRESS&nbsp;: Formats des adresses et information sur les lieux.
<item>LC_TELEPHONE&nbsp;: Formats des numéros de téléphone.
<item>LC_MEASUREMENT&nbsp;: Unités de mesure (Metric ou Other).
<item>LC_IDENTIFICATION&nbsp;: Donnée générale sur l'information de la locale.
 </list>
<item>LANG&nbsp;: Si cette variable est non nulle, et que LC_ALL n'est pas
définie, sa valeur est utilisée pour toutes les catégories de locales LC_*
sans valeur définie. (POSIX.1) Habituellement, "C".
</enumlist>
Notez que certaines applications (par exemple Netscape 4) ignorent les valeurs
LC_*.
<p>
Le programme <prgn>locale</prgn> peut afficher la locale active et les locales
disponibles&nbsp;; voir <manref name="locale" section="1">. (NOTE&nbsp;:
<tt>locale -a</tt> liste toutes les locales du système&nbsp;; cela ne signifie
pas qu'elles sont toutes compilées&nbsp;! Voir <ref id="activate-locales">.)

<sect1 id="ISO-locale">Format de date local ISO 8601
<p>
Le support de locale pour le standard international de la date
<tt>yyyy-mm-dd</tt> (format de date ISO 8601) est fournit par la locale
appelée <tt>en_DK</tt>, « Anglais au Danemark » qui est une espèce de blague
:-)
Cela semble ne marcher que sur la console pour <prgn>ls</prgn>.

<sect1 id="iso-8859-1">Exemple pour les États-Unis (ISO-8859-1)
<p>
Ajoutez les lignes suivantes dans <file>~/.bash_profile</file>&nbsp;:
<example>
LC_CTYPE=en_US.ISO-8859-1
export LC_CTYPE
</example>

<sect1 id="france">Exemple pour la France avec le caractère Euro (ISO-8859-15)
<p>
Ajoutez les lignes suivantes dans <file>~/.bash_profile</file>&nbsp;:
<example>
LANG=fr_FR@euro
export LANG
LC_CTYPE=fr_FR@euro
export LC_CTYPE
</example>
<p>
Configurez le clavier français «&nbsp;AZERTY&nbsp;» comme décrit dans la
section <ref id="keyboard"> et ajoutez les pages de manuel en Français en
installant <package>manpages-fr</package>. La touche Alt-Droite s'appelle
Alt-Gr en Europe. En appuyant dessus en même temps que d'autres touches on
obtient de nombreux caractères accentués et spéciaux. Par exemple, Alt-Gr+E
donne le signe Euro.
<p>
La plupart des langues d'Europe de l'Ouest peuvent être configurées de la même
façon.
<p>
Voir <url id="&debian-euro-support;" name="Debian Euro HOWTO"> pour ajouter le
support de la nouvelle monnaie Euro et <url
id="http://www.debian.org/doc/manuals/fr/debian-fr-howto/" name="Utiliser et
configurer Debian pour le Français"> pour plus de détails en Français.

<sect1 id="x-cjk">Exemple de système X bilingue
<p>
Configurons un système X bilingue qui supporte simultanément le Japonais,
l'Anglais, l'Allemand et le Français avec les codages EUC, UTF-8 et ISO-8859-1
dans différentes consoles.
<p>
Je vais vous montrer une personnalisation en utilisant le système de menu
&debian;. Pour les détails du système de menu &debian; consultez <url
id="&f-menu;">. Je crée aussi un raccourci pour le navigateur web
<prgn>mozilla</prgn> dans l'exemple.
<footnote>
Dans cet exemple, deux bogues de <prgn>blackbox</prgn> sont contournés.
J'utilise <tt>sh -c</tt> comme shell. De plus, <file>~/.menu/*</file> n'est
pas utilisé mais <file>/etc/menu/*</file>, qui requiert les privilèges root.
</footnote>
<list>

 <item>ajoutez le support de la locale pour le Japonais ja_JP.eucJP et les
autres locales requises avec la méthode décrite à la section <ref id="l10n">
(pour toutes).

 <item>installez un système de conversion et un dictionnaire Kana vers
 Kanji (pour le Japonais)&nbsp;:
  <list compact>
  <item><package>canna</package> &ndash; serveur local (licence gratuite), ou
  <item><package>freewnn-jserver</package> &ndash; serveur extensible par le
  réseau (domaine public)
  </list>

 <item>installez le système d'entrée pour le Japonais&nbsp;:
  <list compact>
  <item><package>kinput2-canna</package> &ndash; pour X, ou
  <item><package>kinput2-canna-wnn</package> &ndash; pour X, et
  <item><package>egg</package> &ndash; marche directement avec Emacsen même en
  console (optionnel)
  </list>

 <item>installez des terminaux compatibles (pour toutes)&nbsp;:
  <list compact>
  <item><package>xterm</package> &ndash; X (pour ISO-8859-1 and UTF-8),
  <item><package>kterm</package> &ndash; X (pour Japonais EUC), et
  <item><package>mlterm</package> &ndash; X (multilingue).
  </list>

 <item>ajoutez tous les paquets de polices nécessaires (pour toutes)

 <item>créez <file>~/.xsession</file> qui définit l'environnement X spécifique
 à l'utilisateur comme décrit dans <ref id="custom-x"> (pour toutes)&nbsp;:

<example>
#!/bin/sh
# Cela fait marcher su avec X
if [ -z "$XAUTHORITY" ]; then
        XAUTHORITY=$HOME/.Xauthority
        export XAUTHORITY
fi

# règle l'environnement spécifique par le système de menu debian
# remet à zéro la locale
unset LC_CTYPE LC_NUMERIC LC_TIME LC_COLLATE LC_MONETARY LC_MESSAGES
unset LC_PAPER LC_NAME LC_ADDRESS LC_TELEPHONE LC_MEASUREMENT
unset LC_IDENTIFICATION LC_ALL LANG LANGUAGE PAGER
# règle la locale par défaut dans X
LANG=C
# exporte la locale
export LC_CTYPE LC_NUMERIC LC_TIME LC_COLLATE LC_MONETARY LC_MESSAGES
export LC_PAPER LC_NAME LC_ADDRESS LC_TELEPHONE LC_MEASUREMENT
export LC_IDENTIFICATION LC_ALL LANG LANGUAGE PAGER
###

# active la méthode d'entrée pour le Japonais avec kinput2
kinput2 &
XMODIFIERS="@im=kinput2"
export XMODIFIERS
# gestionnaire de fenêtres blackbox (léger)
exec /usr/bin/blackbox
#exec xfwm
#exec wmaker
</example>

 <item>réglez la locale dans <file>~/.bash_profile</file> pour les consoles
Linux (pour toutes)

 <item>supprimez la configuration de la locale de <file>~/.bashrc</file>, si
elle existait (pour toutes)

 <item>créez quelques fichiers dans <file>/etc/menu</file> (pour toutes)&nbsp;:
 <list compact>
 <item><file>/etc/menu/xterm-local</file>&nbsp;: (ajoute de nouvelles entrées
 dans le menu)
  <footnote>
Utilisez un nom de fichier qui ne soit pas celui d'un nom de paquet.
  </footnote>
<example>
?package(xterm):\
 needs=x11\
 section=XShells\
 longtitle="XTerm: terminal emulator (en_US.ISO-8859-1)"\
 title="XTerm (en_US.ISO-8859-1)"\
 command="sh -c 'LC_ALL=en_US.ISO-8859-1 xterm'"
?package(xterm):\
 needs=x11\
 section=XShells\
 longtitle="XTerm: terminal emulator (de_DE.ISO-8859-1)"\
 title="XTerm (de_DE.ISO-8859-1)"\
 command="sh -c 'LC_ALL=de_DE.ISO-8859-1 xterm -T xterm-de'"
?package(xterm):\
 needs=x11\
 section=XShells\
 longtitle="XTerm: terminal emulator for X with Unicode support
 (Japanese)"\
 title="UXTerm (ja_JP.UTF-8)"\
 command="sh -c 'LC_ALL=ja_JP.UTF-8 uxterm'"
</example>
 <item><file>/etc/menu/kterm</file>&nbsp;: (remplace les entrées par défaut)
  <footnote>
Utilisez un nom qui remplace le nom du paquet.
  </footnote>
<example>
?package(kterm):\
 needs="x11"\
 section="XShells"\
 command="sh -c 'LC_ALL=ja_JP.eucJP PAGER=w3m /usr/X11R6/bin/kterm -xim'" \
 title="Kanji Terminal"
?package(kterm):\
 needs="x11"\
 section="XShells"\
 command="sh -c 'LANG=ja_JP.eucJP \
          LC_MESSAGES=en_US.ISO-8859-1  PAGER=w3m /usr/X11R6/bin/kterm -xim'"\
 title="Kanji Terminal (bilingal)"
</example>
 <item><file>/etc/menu/mozilla-local</file>&nbsp;: (ajoute un nouveau
raccourci)
  <footnote>
Le slash de <tt>section="/"</tt> permet d'ajouter l'entrée dans le menu
initial, et l'espace au début de <tt>title=" Mozilla Navigator"</tt> permet
d'avoir cette entrée en haut de la liste.
  </footnote>
<example>
?package(mozilla-browser):needs="x11" section="/" \
        title=" Mozilla Navigator" command="mozilla-1.5"
	hints="Web browsers"\
        icon=/usr/share/pixmaps/mozilla.xpm
</example>
 <item>exécutez <prgn>update-menus</prgn> depuis le compte root.
 </list>

 <item>ajoutez les lignes suivantes à <file>~/.muttrc</file> (pour le
Japonais)&nbsp;:
<example>
# le support UTF-8 n'est pas populaire dans l'environnement japonais
# EMACS
# codage 7 bits pour iso-2022-jp est plus facile pour tout le monde
# ordre de codage par défaut = us-ascii &gt; iso-8859-1 &gt; utf-8 &gt; iso-2022-jp
set send_charset="us-ascii:iso-8859-1:iso-2022-jp"
set allow_8bit=no
</example>
 <item>activez XIM <prgn>kinput2</prgn> pour les applications X (pour le
Japonais)&nbsp;:
  <list compact>
  <item>ajoutez <tt>*inputMethod: kinput2</tt> et <tt>KTerm*VT100*OpenIm:
true</tt> à votre fichier de ressources X <file>~/.Xresources</file> (on
dirait que Debian le fait automatiquement).
  <item>Quelques applications (comme <prgn>mlterm</prgn>) permettent aussi de
  configurer <tt>*inputMethod:</tt> et d'autres paramètres dynamiquement au
  démarrage (appuyez sur <strong>Ctrl-Bouton-3</strong> dans
  <prgn>mlterm</prgn>).
  </list>
 <item>lancez X avec <tt>startx</tt> ou à partir d'un des gestionnaires
 d'affichage (<prgn>xdm</prgn>, <prgn>gdm</prgn>, <prgn>kdm</prgn>,
 <prgn>wdm</prgn>, ...) (pour toutes)
 <item>lancez une application compatible avec le Japonais comme
  Vim 6, (x)emacs21, mc-4.5, mutt-1.4, ... dans <prgn>kterm</prgn> (pour le
Japonais). (Emacs semble être populaire, bien que je ne l'utilise pas.)
 <item>appuyez sur <strong>Shift+Space</strong> pour activer/désactiver
 l'entrée de caractères japonais (pour le Japonais).
 <item>lisez les pages de manuel localisées en tapant la commande dans la
console localisée (pour toutes).
</list>
Pour d'autre support sur CJK, consultez les sections suivantes et <url
id="&suse-cjk;" name="SuSE pages for CJK">.

<sect1 id="x-input">Méthodes d'entrée alternatives pour X
<!-- I need feed back from Chinese and Korean people for here -->
<p>
Il existe beaucoup de paquets pour le support de méthodes d'entée alternatives
pour X&nbsp;:
<example>
Language   LC_CTYPE     XIM server XMODIFIERS              Démarrage par
Japanese   ja_JP*       kinput2    "@im=kinput2"           Shift-Espace
Korean     ko_KR*       ami        "@im=Ami"               Shift-Espace
Chinese(T) zh_TW.Big5   xcin       "@im=xcin-zh_TW.big5"   Ctrl-Espace
Chinese(S) zh_CN.GB2312 xcin       "@im=xcin-zh_CN.GB2312" Ctrl-Espace
</example>
<p>
La méthode d'entrée japonaise <prgn>kinput2</prgn> est offerte par les paquets
tels que <package>kinput2-canna-wnn</package>,
<package>kinput2-canna</package> et <package>kinput2-wnn</package>. Le
Japonais a besoin d'un serveur de dictionnaire comme <package>canna</package>
et <package>freewnn-jserver</package> pour être utilisable.

<!--
<p>
Le Coréen et le Chinois peuvent aussi utiliser un serveur de dictionnaire
comme <package>freewnn-kserver</package> et
<package>freewnn-cserver</package>.
-->

<sect1 id="x-term">Émulateurs de terminal X
<p>
Il existe beaucoup de consoles X qui supportent les codages sur 8 bits simples
lorsque les bons paquets de polices sont installés&nbsp;:
<list compact>
  <item><package>xterm</package> &ndash; l'émulateur de terminal X
  <item><package>gnome-terminal</package> &ndash; <package>xterm</package>
pour Gnome
  <item><package>konsole</package> &ndash; <package>xterm</package> pour KDE
  <item><package>rxvt</package> &ndash; terminal VT102 (plus léger)
  <item><package>aterm</package> &ndash; VT102 pour Afterstep
  <item><package>eterm</package> &ndash; VT102 pour Enlightment
  <item><package>wterm</package> &ndash; VT102 pour WindowMaker
</list>
<p>
Le support des codages multi-octets pour la console X est fourni par
<package>xterm</package> par le codage UTF-8 (<ref id="x-utf-8">). Le support
d'autres codages traditionnels est en progrès (en 2003). Les paquets suivants
offrent le support de codages traditionnels&nbsp;:
<list compact>
  <item><package>aterm-ml</package> &ndash; multilingue
  <item><package>kterm</package> &ndash; multilinge (Japonais, ...)
  <item><package>rxvt-ml</package> &ndash; multilingue
  <item><package>wterm-ml</package> &ndash; multilingue
  <item><package>cxterm-big5</package> &ndash; Chinois (Trad., Big5)
  <item><package>cxterm-gb</package> &ndash; Chinois (Simp., GB)
  <item><package>cxterm-ks</package> &ndash; Chinois (KS)
  <item><package>cxterm-jis</package> &ndash; Japonais
  <item><package>hanterm-classic</package> &ndash; Coréen (Hangul)
  <item><package>hanterm-xf</package> &ndash; Coréen (Hangul)
  <item><package>hztty</package> &ndash; Chinois (GB, Big5, zW/HZ)
</list>
Pour <prgn>kterm</prgn> (et peut-être d'autres), vous pouvez activer XIM par
le menu après un Ctrl-click-milieu.

<sect1 id="x-utf-8">Support UTF-8 pour l'émulateur de terminal X
<p>
Le support UTF-8 pour l'émulateur de terminal X est founi par le programme
<prgn>uxterm</prgn> du paquet <package>xterm</package> de XFree86 4.x. Cela
permet le support pour toutes les langues. C'est une encapsulation de <manref
name="xterm" section="1"> qui l'invoque en paramétrant la classe de ressource
«&nbsp;UXTerm&nbsp;».
<p>
Par exemple, pour activer l'affichage de l'Anglais, du Russe, du Japonais, du
Chinois et du Coréen, ajoutez ce qui suit à votre <file>~/.Xresources</file>
après avoir installé les polices nécessaires&nbsp;:
<example>
! set large font
UXTerm*font: -misc-fixed-medium-r-normal-*-18-120-100-100-c-90-iso10646-1
! Use XIM for Japanese
*inputMethod: kinput2
</example>
Ensuite exécutez <tt>xrdb -merge ~/.Xresources</tt> pour mettre à jour les
ressources X, comme décrit dans <ref id="xresources">.
<p>
La plupart des programmes console les plus populaires, comme
<package>vim</package>, <package>mutt</package> et <package>emacs</package>,
aient été rendus compatibles avec UTF-8 récemment -Woody-Sarge). Des
programmes comme <package>mc</package> ne sont toujours pas compatibles UTF-8,
mais gèrent les codages 8 bits. Si vous éditez une partie en ASCII 7 bits d'un
fichier inconnu ou avec un codage mixte, il est plus prudent d'utiliser un
éditeur gérant les codages 8 bits.
<p>
Voir <url id="&unicode-howto;" name="The Unicode HOWTO">.

<sect1 id="fb-utf-8">Exemple pour UTF-8 avec la console framebuffer
<p>
Le support UTF-8 pour la console FB est fournit par <package>bterm</package>
utilisé dans <package>debian-installer</package>.

<sect1 id="beyond-locale">Après locale
<p>
Lorsque vous configurez un système pour la première fois pour un
<strong>environnement de langue nationale</strong>, considérez l'utilisation
de <prgn>tasksel</prgn> ou <prgn>aptitude</prgn> pour connaître les paquets
sélectionnés en choisissant la tâche d'environnement de langue correspondante.
Le choix de paquets est utile même pour la configuration multilingue. Si vous
rencontrez des problèmes de dépendances pendant l'installation de votre
système configuré, évitez d'installer les logiciels qui créent les conflits.
Vous aurez peut-être à utiliser <prgn>update-alternative</prgn> pour retrouver
l'état originel de certaines commandes puisque celles nouvellement installées
peuvent avoir des priorités plus élevées que celles existantes.
<p>
Les programmes importants les plus récents qui utilisent la glibc 2.2 sont
pour la plupart internationalisés. Les versions localisées spéciales comme
<prgn>jvim</prgn> pour VIM peuvent ne pas être nécessaires et ses
fonctionnalités sont offertes dans <prgn>vim</prgn> version 6.0 pour X. En
réalité, il est encore difficile à utiliser. Puisque <prgn>jvim</prgn> possède
une version avec le support de l'entrée des caractères japonais
(<prgn>canna</prgn>) compilé directement même avec la console et résoud
beaucoup d'autres problèmes spécifiques au Japonais, vous pouvez toujours en
avoir besoin :-)
<p>
Certains programmes peuvent nécessiter une configuration en plus de la
<tt>locale</tt> pour obtenir un environnement de travail confortable.  Le
paquet <package>language-env</package> avec sa commande
<prgn>set-language-env</prgn> est un script qui facilite la configuration de
l'environnement de langue nationale sur un système &debian;.
<p>
Voir aussi le document sur l'internationalisation, <url
id="&intro-i18n;" name="Introduction to i18n">. Il est destiné aux développeurs
mais est aussi utile aux administrateurs système.

</sect1>

</sect>

<sect id="m17n">Multilingualisation (m17n)
<p>
La <ref id="l10n">, activée par les paquets <package>language-env</package> et
d'autres, a pour objectif de permettre une localisation monolingue. Ces paquets
utilisent aussi les codages traditionnels pour le codage du texte. Vous ne
pouvez pas mélanger des textes en Français et en Japonais dans de tels
environnements car ils utilisent les codages incompatibles entre eux ISO-8859-1
et EUC-JP.
<p>
Vous pouvez obtenir un bureau multilingue utilisant le codage UTF-8 en
utilisant Gnome ou KDE avec l'une des locales UTF-8 disponibles. (Sarge) Dans
de tels environnements, vous pouvez mélanger des caractères Anglais, Chinois,
Russe et Japonais dans les logiciels compatibles avec UTF-8.
<footnote>
<package>language-env</package> n'est pas très utile dans un environnement
multilingue.
</footnote>
<p>
Dans un tel environnement, la nouvelle méthode d'entrée (IM, <em>Input
Method</em>) multilingue du paquet <package>scim</package> est préférée. La
méthode d'entrée de <package>scim</package> est activée et désactivée en
tapant <tt>Ctrl</tt>-<tt>Espace</tt>. Le moteur de conversion de l'entrée peut être
changé dans la petite fenêtre de SCIM.
<p>
<package>vim</package> offers the multilingualized environment and can
handle both UTF-8 and conventionally encoded files (EUC-JP, ISO-8859-1,
...) when it is run under the UTF-8 console such as
<prgn>gnome-teminal</prgn>.  See vim help message with pressing [Esc]
and typing <tt>:help mbyte.txt</tt>.
</sect>

</chapt>
