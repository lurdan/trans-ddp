<!-- CVS revision of this document "$Revision: 1.16 $"  -->
<!-- CVS revision of original english document "1.35"  -->
<chapt id="woody">Mise à jour d'une distribution vers <tt>testing</tt>

<![%f-ref;[
<p>
Les notes de version officielles pour mettre à jour sont situées à 
<url id="&stable-release;">
et
<url id="&testing-release;"> (en développement).

<p>
Le processus de mise à jour d'un système vers la version
<tt>testing/unstable</tt> est le suivant&nbsp;:
<list>
 <item>mettre à jour le système APT vers la version de Woody si vore système
 est Potato, car l'APT de Potato ne possédait pas les capacités décrites dans
 <manref name="apt_preferences" section="5"> de Woody.
 <item>modifier vos fichiers <file>/etc/apt/sources.list</file> et
 <file>/etc/apt/preferences</file>, pour ajouter des références vers la
 section «&nbsp;testing&nbsp;» des dépôts que vous utilisez. Si vous le
 souhaitez, vous pouvez aussi ajouter des références vers la section
 «&nbsp;unstable&nbsp;».
 <item>mettre à jour vos listes de paquets, et installer les paquets mis à
 jour.
</list>
]]>

<sect id="woody-transition">Transition de APT vers la version de Woody
<p>
Une mise à jour par le réseau du système APT et de certains paquets principaux
vers la version de Woody peut être effecttuée comme suit après avoir inclus
une source <tt>stable</tt> dans <file>/etc/apt/sources.list</file> si vous
utilisez toujours Potato.
<example>
# apt-get update
# apt-get install libc6 perl libdb2 debconf
# apt-get install apt apt-utils dselect dpkg
</example>


<sect id="testing-transition">Préparation de la transition
(«&nbsp;stable&nbsp;» vers «&nbsp;testing&nbsp;»)
<p>
Suivre la version <tt>testing</tt> de &debian; a l'effet de bord de recevoir
très lentement les correctifs de sécurité. Vous êtes prévenus.
<p>
Une mise à jour via le réseau vers «&nbsp;testing&nbsp;» peut être effectuée
comme suit (lancer le script suivant <url id="&examples;" name="go-woody">
pour le faire en une seule commande)&nbsp;:
<p>
Videz le fichier <file>/etc/apt/sources.list</file> existant
<example>
# cd /etc/apt
# cp -f sources.list sources.old
# :&gt;sources.list
</example>
<p>
Récupérez une liste propre de dépôts, pour «&nbsp;stable&nbsp;»
<example>
# cd /
# apt-setup noprobe 
 ... sélectionner http ou ftp
</example>
Ajoutez la section «&nbsp;testing&nbsp;» à cette nouvelle liste. Les lignes
<tt>deb-src</tt> sont commentées.
<example>
# cd /etc/apt
# grep -e "^deb " sources.list             &gt;sources.deb
# grep -e "^deb-" sources.list             &gt;sources.src
# sed -e "s/stable/testing/"  sources.deb \
     &gt;&gt;sources.list
# sed -e "s/stable/testing/" sources.src | \
     sed -e "s/^deb-/#deb-/"  &gt;&gt;sources.list

# apt-get update
# apt-get install apt apt-utils
# cat &gt;preferences &lt;&lt;EOF
 Package: *
 Pin: release a=testing
 Pin-Priority: 600
 
 Package: *
 Pin: release a=unstable
 Pin-Priority: 50

 EOF
</example>
Eventuellement, ajoutez la section «&nbsp;unstable&nbsp;» des archives.
<example>
# sed -e "s/stable/unstable/" sources.deb \
  &gt;&gt;sources.list
# sed -e "s/stable/unstable/" sources.src | \
 sed -e "s/^deb-/#deb-/"  &gt;&gt;sources.list
</example>
Voir <ref id="apt-install"> pour configurer <file>/etc/apt/sources.list</file>
et <file>/etc/apt/preferences</file>.
<p>
Vous pouvez maintenant mettre à jour, en utilisant une des méthodes décrites
dans la section suivante.
</sect>

<sect id="upgrade-system">Mise à jour du système &debian;
<p>
Après avoir configuré correctement <file>/etc/apt/sources.list</file> et
<file>/etc/apt/preferences</file>, le système peut être mis à jour vers
<tt>testing</tt>. Voir <ref id="package"> pour les bases, et <ref
id="apt-trouble"> si vous rencontrez des problèmes.

<sect1>Meilleure méthode de mise à jour avec <prgn>dselect</prgn>
<p>
Si le système comprend beaucoup de paquets <tt>-dev</tt>, etc., la méthode
suivante avec <prgn>dselect</prgn> est recommandée pour un contrôle fin des
paquets.
<example>
# dselect update # à faire avant chaque mise à jour
# dselect select # sélectionne des paquets additionnels
</example>
Tous vos paquets actuels seront sélectionnés lorsque <prgn>dselect</prgn>
démarre. <prgn>dselect</prgn> peut vous proposer d'autres paquets selon les
priorités <tt>depends</tt>, <tt>suggests</tt> et <tt>recommends</tt>. Si vous
ne voulez pas ajouter de paquet, tapez simplement <tt>Q</tt> pour sortir de
<prgn>dselect</prgn>.
<example>
# dselect install
</example>
Vous devrez répondre à quelques questions de configuration des paquets pendant
cette partie du processus, aussi ayez vos notes à portée de main et comptez un
peu de temps pour cette partie. Voir <ref id="dselect">.
<p>
Utilisez <prgn>dselect</prgn>. <strong>Il fonctionne toujours :)</strong>

<![%f-ref;[
<sect1>Méthode obsolète de mise à jour avec <prgn>apt-get</prgn>
<p>
<strong>L'utilisation de <prgn>apt-get</prgn> décrite ci-dessous est répandue
mais n'est <em>pas</em> recommandée pour des mises à jour du système.</strong>
]]>

Si vous devez mettre à jour sans <prgn>dselect</prgn> après Woody, considérez
l'utilisation d'<prgn>aptitude</prgn> ou d'autres options.

<![%f-ref;[
<p>
Si un système n'a pas beaucoup de paquets installés ou si l'archive &debian;
n'a pas de changements majeurs, ce qui suit peut être suffisant (parfois).
<example>
# apt-get update # à faire avant la mise à jour
 ... pour mettre à jour l'ensemble du système avec les sélections «&nbsp;depends&nbsp;»
# apt-get -u dist-upgrade # à faire avant la mise à jour
 ... pour mettre à jour le système entier avec les sélections «&nbsp;depends&nbsp;»
# apt-get -u dist-upgrade
 ... ou pour mettre à jour en gardant les sélections de dselect (meilleure solution)
# apt-get -u dselect-upgrade # utilise les sélections de dselect
</example>
<p>
Comme cette méthode de mise à jour utilise <prgn>apt-get</prgn>, la gestion
des paquets <em>recommends</em> et <em>suggests</em> est limitée. Voir <ref
id="depends">.
]]>
</sect>



</chapt>
