<chapt id="pkgtools">Gli strumenti di gestione pacchetti Debian

<sect id="pkgprogs">Quali programmi fornisce Debian per gestire i suoi pacchetti?

<sect1 id="dpkg">dpkg

<p>Questo è il principale programma di gestione dei pacchetti. <prgn/dpkg/ può essere
invocato con molte opzioni. Alcuni usi comuni sono:
<list>
  <item>Scoprire tutte le opzioni: <tt>dpkg --help</tt>.
  <item>Stampare il file di controllo (e altre informazioni) di un specifico
    pacchetto: <tt>dpkg --info foo_VVV-RRR.deb</tt>
  <item>Installare un pacchetto (incluso lo spacchettamento e la configurazione) nel
    file system dell'hard disk: <tt>dpkg --install foo_VVV-RRR.deb</tt>.
  <item>Spacchettare (ma non configurare) un archivio Debian sul file system
    dell'hard disk: <tt>dpkg --unpack foo_VVV-RRR.deb</tt>. Si noti che questa
    operazione <em>non</em> lascia necessariamente il pacchetto in uno stato utilizzabile;
    alcuni file possono necessitare di ulteriori adattamenti per funzionare correttamente.
    Questo comando rimuove qualsiasi versione già installata del programma e
    esegue lo script preinst (si veda <ref id="maintscripts">) associato al
    pacchetto.
  <item>Configurare un pacchetto che è già stato spacchettato:
    <tt>dpkg --configure foo</tt>. Tra le altre cose, questa azione esegue lo
    script postinst (si veda <ref id="maintscripts">) associato con il pacchetto.
    Aggiorna inoltre i file elencati nel <tt>conffiles</tt> per il nome di questo
    pacchetto. Si faccia attenzione che l'operazione 'configure' prende come suo argomento
    il nome del pacchetto (p.e., foo), <em/non/ il nome dell'archivio Debian
    (p.e., foo_VVV-RRR.deb).
  <item>Estrarre un unico file chiamato "blurf" (od un gruppo di file
    chiamati "blurf*" da un archivio Debian:
    <tt>dpkg --fsys-tarfile foo_VVV-RRR.deb | tar -xf - blurf*</tt>
  <item>Rimuovere un pacchetto (ma non i suoi file di configurazione):
    <tt>dpkg --remove foo</tt>.
  <item>Rimuovere un pacchetto (inclusi i suoi file di configurazione):
    <tt>dpkg --purge foo</tt>.
  <item>Elencare lo stato d'installazione dei pacchetti contenenti la stringa
    (o l'espressione regolare) "foo*": <tt>dpkg --list 'foo*'</tt>.
</list>

<sect1 id="dselect">dselect

<p>Questo programma è un'interfaccia a menu al sistema di gestione dei pacchetti
Debian. È particolarmente utile per le prime installazioni ed
aggiornamenti su larga scala.

<p><prgn/dselect/ può:
<list>
  <item>guidare l'utente sulla scelta dei pacchetti da installare o rimuovere,
    assicurare che nessun pacchetto in conflitto con un altro venga installato
    e che tutti i pacchetti richiesti per far funzionare correttamente ogni pacchetto
    vengano installati;
  <item>avvisare l'utente a proposito di inconsistenze o incompatibilità nelle proprie
    selezioni;
  <item>determinare l'ordine nel quale i pacchetti devono essere installati;
  <item>effettuare automaticamente l'installazione o la rimozione e
  <item>guidare l'utente attraverso qualsiasi processo di configurazione richiesto
    da ogni pacchetto.
</list>

<p><prgn/dselect/ parte presentando un menu di 7 voci, ognuna delle quali
rappresenta una specifica azione. L'utente può selezionare una delle azioni
usando i tasti freccia per muovere la barra evidenziata, poi premendo il
tasto <em>&lt;invio&gt;</em> (enter) per selezionare l'azione evidenziata.

<p>Cosa vede l'utente dopo dipende dall'azione che ha selezionato. Se ha selezionato
qualsiasi opzione tranne <tt>Metodo</tt> (Access) e <tt>Seleziona</tt> (Select), allora
<prgn/dselect/ procederà semplicemente nell'esecuzione dell'azione specificata:
p.e., se l'utente ha selezionato l'azione <tt>Rimuovi</tt> (Remove), allora dselect
procederà nella rimozione di tutti i file selezionati per la rimozione quando l'utente
li ha scelti nell'azione <tt>Seleziona</tt> (Select).

<p>Sia la voce di menu <tt>Metodo</tt> (Access) che la voce di menu <tt>Seleziona</tt>
(Select) portano a menu aggiuntivi. In entrambi i casi, i menu vengono presentati come
schermate divise; la schermata superiore dà una lista scorribile di scelte, mentre
la schermata inferiore dà una breve spiegazione ("info") per ogni scelta.

<p>È disponibile un aiuto esteso in linea, si usi il tasto '?' per avere una schermata
d'aiuto in qualsiasi momento.

<p>L'ordine nel quale le azioni sono presentate nel primo menu di <prgn/dselect/
rappresenta l'ordine nel quale un utente sceglierebbe normalmente
<prgn/dselect/ per installare pacchetti. Comunque, un utente può selezionare qualsiasi
voce del menu principale quanto spesso vuole (anche non tutte, dipende da
cosa si vuole fare).

<list>
  <item>Si inizi scegliendo un <strong/Metodo d'Accesso/. Questo è il
    modo in cui un utente stabilisce l'accesso ai pacchetti Debian; p.e., alcuni
    utenti hanno pacchetti Debian disponibili su CD-ROM, mentre altri stabiliscono
    di scaricarli usando FTP anonimo. Il "Metodo d'Accesso" selezionato viene memorizzato
    dopo che <prgn/dselect/ esce, così, se non cambia, questa opzione non necessita
    di essere invocata nuovamente.

  <item>Poi si aggiorni con <strong/Aggiorna/ (Update) la lista dei pacchetti disponibili.
    Per fare questo, <prgn/dselect/ legge il file "Packages.gz" che dovrebbe essere incluso
    nel livello più alto della directory dove sono memorizzati i pacchetti Debian
    da installare. (Ma se non è là, <prgn/dselect/ si offrirà di crearlo.)

  <item>Si selezionino con <strong/Seleziona/ (Select) i pacchetti da installare sul proprio
    sistema.
    Dopo aver scelto questa voce di menu, all'utente viene prima presentata una
    schermata completa di aiuto (a meno che non sia stata usata l'opzione da riga di
    comando '--expert').
    Una volta che l'utente esce dalla schermata di aiuto, vedrà il menu a schermata divisa
    per scegliere i pacchetti da installare (o rimuovere).

    <p>La parte superiore della schermata è una finestra relativamente stretta sulla
    lista dei &all-pkgs; pacchetti Debian; la parte inferiore della schermata
    contiene una descrizione del pacchetto o gruppo di pacchetti che è
    stato selezionato sopra.

    <p>Si può specificare su quali pacchetti si dovrebbe operare evidenziando
    un nome di un pacchetto o di una etichetta per un gruppo di pacchetti. Dopo di questo, si
    possono selezionare pacchetti:
    <taglist>
      <tag>da installare:
        <item>Questo è effettuato premendo il tasto '+'.
      <tag>da eliminare:
        <item>I pacchetti possono essere eliminati in due modi:
        <list>
          <item>rimossi: questo rimuove la maggior parte dei file associati al
          pacchetto, ma preserva i file elencati come file di configurazione
          (si veda <ref id="conffile">) e le informazioni di configurazione
          del pacchetto. Questo lo si fa premendo il tasto '-'.
          <item>eliminati: questo rimuove <em/ogni/ file che è parte del
          pacchetto. Questo lo si fa premendo il tasto '_'.
        </list>
        Si noti che non è possibile rimuovere "Tutti i pacchetti" ("All Packages"). Se
        si prova, il proprio sistema sarà invece ridotto ai pacchetti base
        dell'installazione iniziale.
      <tag>da mantenere (mettere "on hold")
        <item>Lo si effettua premendo '=' e dice effettivamente a
        <prgn/dselect/ di non aggiornare un pacchetto nemmeno se la versione
        correntemente installata sul proprio sistema non è recente come la versione
        disponibile nel deposito Debian che si sta usando (questo è stato specificato
        quando si è impostato il <strong/Metodo d'Accesso/ e ottenuto quando
        si è usato <strong/Aggiorna/).
        <p>Così come si può mantenere un pacchetto, si può invertire questa impostazione
        premendo ':'. Questo dice a <prgn/dselect/ che il pacchetto può
        essere aggiornato se una versione più recente è disponibile. Questa è
        l'impostazione predefinita.
    </taglist>

    <p>Si può selezionare un ordine differente per presentare i pacchetti
    usando il tasto 'o' per alternare varie opzioni di ordinamento dei
    pacchetti. L'ordine predefinito è di presentare i pacchetti in base alla Priorità; dentro
    ogni priorità i pacchetti vengono presentati in ordine di directory (a.k.a.
    sezioni) dell'archivio nel quale sono memorizzati. Dato quest'ordine,
    alcuni pacchetti nella sezione A possono essere presentati per primi, seguiti da
    alcuni pacchetti nella sezione B, seguiti da più pacchetti (con priorità
    minore) nella sezione A.

    <p>Si possono anche espandere le etichette in cima alla schermata,
    usando il tasto 'v' (verbose). Questa azione spinge sulla destra molto del
    testo che precedentemente si adattava nel display. Per vederlo si prema
    la freccia a destra; per scorrere alla sinistra si prema la freccia a sinistra.

    <p>Se si seleziona un pacchetto per l'installazione o la rimozione, p.e.
    <package/foo.deb/, e quel pacchetto dipende da (o raccomanda) un altro
    pacchetto, p.e. <package/blurf.deb/, allora <prgn/dselect/ vi porterà
    in una sottoschermata della schermata di selezione principale. Là si potrà scegliere
    tra pacchetti correlati, accettando le azioni suggerite (installare
    o no), o rifiutandole. Per fare quest'ultima azione, si prema Shift-D; per ritornare
    alla prima si prema Shift-U. In ogni caso, si possono salvare le proprie selezioni
    e ritornare alla schermata principale di selezione premendo Shift-Q.

  <item>Gli utenti che ritornano al menu principale possono poi selezionare la voce
    di menu "Installa" ("Install") per spacchettare e configurare i pacchetti selezionati.
    Alternativamente, gli utenti che desiderano rimuovere file possono scegliere la voce
    di menu "Rimuovi" ("Remove"). In ogni momento, gli utenti possono scegliere "Termina"
    ("Quit") per uscire da dselect; le selezioni sono preservate da <prgn/dselect/.
</list>

<sect1 id="dpkg-deb">dpkg-deb

<p>Questo programma manipola i file archivio Debian(<tt>.deb</tt>).
Alcuni usi comuni sono:
<list>
  <item>Scoprire tutte le opzioni: <tt>dpkg-deb --help</tt>.
  <item>Determinare quali file sono contenuti in un file archivio
    Debian: <tt>dpkg-deb --contents foo_VVV-RRR.deb</tt>)
  <item>Estrarre i file contenuti in un archivio Debian dentro una
    directory specificata dall'utente: <tt>dpkg-deb --extract foo_VVV-RRR.deb tmp</tt>
    estrae ognuno dei file dentro <tt>foo_VVV-RRR.deb</tt> nella directory
    <tt>tmp/</tt>. Questo è comodo per esaminare il contenuto
    di un pacchetto in una directory localizzata, senza installare il pacchetto
    nel file system di root.
</list>

<p>Si noti che ogni pacchetto che è stato semplicemente spacchettato usando <tt/dpkg-deb
--extract/ non sarà installato correttamente, invece si dovrebbe usare <tt/dpkg --install/.

<p>Maggiori informazioni sono fornite nella pagina di manuale <manref name="dpkg-deb"
section="1">.

<sect1 id="apt-get">apt-get

<p><prgn/apt-get/ fornisce una semplice maniera per installare pacchetti da riga
di comando. Diversamente da <prgn/dpkg/, <prgn/apt-get/ non comprende i file .deb,
lavora con il nome del pacchetto e può solo installare archivi .deb da una
sorgente specificata in <file>/etc/apt/sources.list</file>.

<p>Per maggiorni informazioni, si installi il pacchetto <package/apt/ e si legga
<manref name="apt-get" section="8">, <manref name="sources.list" section="5">
e <file>/usr/share/doc/apt/guide.html/index.html</file>.

<sect1 id="dpkg-split">dpkg-split

<p>Questo programma divide un grosso pacchetto in file più piccoli (p.e., per la scrittura
su una serie di floppy disk), e può anche essere usato per unire una serie di file
divisi in un file singolo. Può venire usato solo su di un sistema Debian (cioè
un sistema contenente il pacchetto <package/dpkg/), perché chiama il programma
<tt>dpkg-deb</tt> per analizzare il pacchetto debian nei suoi componenti.

<p>Per esempio, per dividere un grosso .deb in N parti,
<list>
  <item>Si esegua il comando <tt>dpkg-split --split foo.deb</tt>.
    Questo produrrà N file ognuno approssimativamente lungo 460 KByte nella
    directory corrente.
  <item>Si copino gli N file su dei floppy disk.
  <item>Si copi il contenuto dei floppy disk sull'hard disk di vostra
    scelta sull'altra macchina.
  <item>Si uniscano le parti dei file insieme usando <tt>dpkg-split --join "foo*"</tt>.
</list>

<sect id="updaterunning">Debian afferma di essere in grado di aggiornare un programma
  in esecuzione; come viene effettuato?

<p>Il kernel (file system) nei sistemi &debian; supporta la sostituzione dei file anche
quando sono in uso.

<p>Forniamo anche un programma chiamato <prgn/start-stop-daemon/ che viene usato
per avviare i demoni al boot o di fermare i demoni quando il llivello di esecuzione
(runlevel) del kernel cambia (p.e., da multiutente a monoutente o halt). Lo stesso programma
viene usato dagli script di installazione quando un nuovo pacchetto che contiene un demone
viene installato, per fermare i demoni in esecuzione e riavviarli se necessario.

<sect id="whatpackages">Come posso sapere quali pacchetti sono già installati su un
  sistema Debian?

<p>Per conoscere lo stato di tutti i pacchetti installati su di un sistema Debian,
si esegua il comando
  <example>dpkg --list</example>

Questo stampa un sommario di una linea per ogni pacchetto, dando un simbolo di stato
di due lettere (spiegato nell'intestazione), il nome del pacchetto, la versione
<em>installata</em> ed una breve descrizione.

<p>Per sapere lo stato dei pacchetti i cui nomi corrispondono con la
stringa iniziante con "foo" si esegua il comando:
  <example>dpkg --list 'foo*'</example>

<p>Per ottenere un rapporto più prolisso per un particolare pacchetto, si esegua il
comando:
  <example>dpkg --status nomepacchetto</example>

<sect id="filesearch">Come posso scoprire quale pacchetto ha prodotto un particolare file?

<p>Per identificare il pacchetto che ha prodotto il file chiamato <tt>foo</tt> si esegua
uno dei comandi:

<list>
  <item><tt>dpkg --search nomefile</tt>
    <p>Questo cerca <tt>nomefile</tt> nei pacchetti installati.
    (È (attualmente) equivalente a cercare tutti i file aventi
    <tt>.list</tt> come estensione del file nella directory
    <tt>/var/lib/dpkg/info/</tt> e sistemare l'output per stampare i nomi
    di tutti i pacchetti che lo contengono.)

  <item><tt>zgrep foo Contents-ARCH.gz</tt>
    <p>Questo cerca i file che contengono la sottostringa <tt>foo</tt>
    nel loro percorso completo. I file <tt>Contents-ARCH.gz</tt> (dove ARCH
    rappresenta l'architettura desiderata) risiedono nelle directory principali dei pacchetti
    (main, non-free, contrib) sui siti FTP Debian. Un file <tt>Contents</tt>
    si riferisce solo ai pacchetti nell'albero delle sottodirectory dove egli risiede.
    Quindi, un utente potrebbe dover cercare in più file <tt>Contents</tt>
    per trovare il pacchetto contenente il file <tt>foo</tt>.

    <p>Questo metodo ha il vantaggio rispetto a <tt>dpkg --search</tt> di
    trovare i file nei pacchetti che non sono attualmente installati sul proprio
    sistema.
</list>
