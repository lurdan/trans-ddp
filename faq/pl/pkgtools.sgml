<chapt id="pkgtools">Narzêdzia do zarz±dzania pakietami w systemie Debian

<sect id="pkgprogs">Jakie programy do zarz±dzania swoimi pakietami 
     udostêpnia?

<sect1 id="dpkg">dpkg
<p>Jest to g³ówny program s³u¿±cy do zarz±dzania pakietami. <prgn>dpkg</prgn> 
mo¿e byæ wywo³any z wieloma ró¿nymi opcjami. Najczê¶ciej stosowane to:
<list>
  <item><tt>dpkg --help</tt> przedstawia dostêpne opcje.
  <item><tt>dpkg --info foo_VVV-RRR.deb</tt> wy¶wietla informacje 
  o wybranym pakiecie.
  <item><tt>dpkg --install foo_VVV-RRR.deb</tt> instaluje
  (rozpakowuje i konfiguruje) pakiet na dysku twardym.
  <item><tt>dpkg --unpack foo_VVV-RRR.deb</tt> rozpakowuje, lecz pozostawia
  nieskonfigurowany pakiet.  Zauwa¿, ¿e nieskonfigurowany pakiet mo¿e okazaæ siê
  bezu¿yteczny. Niektóre pliki mog± wymagaæ dalszej obróbki i dostosowania do 
  Twoich potrzeb, aby pakiet/program dzia³a³ poprawnie. Polecenie to pozostawia
  wszelkie   zainstalowane dotychczas wersje programów i wykonuje polecenia
  przedinstalacyjne (zobacz <ref id="maintscripts">), zawarte w pakiecie.
  <item>Konfiguracja pakietu, który zosta³ wcze¶niej rozpakowany: 
  <tt>dpkg --configure foo</tt>.  To polecenie uruchamia, miêdzy innymi, 
  poinstalacyjne skrypty (zobacz: <ref id="maintscripts">), powi±zane z danym 
  pakietem. Uaktualnia równie¿ pliki wymienione w <tt>pliku konfiguracyjnym</tt>  danego pakietu. Zauwa¿, ¿e operacja ,,configure'' wymaga jako argumentu 
  nazwy pakietu (np. foo), a <em>nie</em> nazwy pliku z pakietem 
  (np. foo_VVV-RRR.deb).
  <item>Rozpakowanie pojedynczego pliku nazwanego ,,blurf'' (lub grupy plików
    nazwanych ,,blurf*'') z pakietu Debiana:
    <tt>dpkg --fsys-tarfile foo_VVV-RRR.deb | tar -xf - blurf*</tt>
  <item>Usuniêcie pakietu (bez jego plików konfiguracyjnych):
    <tt>dpkg --remove foo</tt>.
  <item>Usuniêcie pakietu (razem z jego plikami konfiguracyjnymi):
    <tt>dpkg --purge foo</tt>.
  <item>Wy¶wietlenie stanu instalacji pakietów zawieraj±cych
    ci±g znaków (lub wg wyra¿enia regularnego) ,,foo*'': 
    <tt>dpkg --list 'foo*'</tt>.
</list>

<sect1 id="dselect">dselect

<p>Ten program zapewnia Debianowi interfejs dla systemu zarz±dzania pakietami
z opcjami pogrupowanymi w menu. Jest on szczególnie przydatny przy 
instalowaniu i uaktualnianiu systemu na du¿± skalê.

<p><prgn>dselect</prgn> potrafi:
<list>
  <item>
     prowadziæ/wspomagaæ u¿ytkownika w trakcie, gdy ten wybiera pakiety
     do instalacji lub usuniêcia, wykluczaj±c jednocze¶nie mo¿liwo¶æ powstania
     konfliktów pomiêdzy zainstalowanymi pakietami i zapewniaj±c w³a¶ciw± pracê
     zainstalowanych programów poprzez instalacjê wszystkich wymaganych przez 
     nie pakietów.
  <item>
     ostrzegaæ u¿ytkownika o niespójno¶ci lub niekompatybilno¶ci pomiêdzy
     pakietami, które wybra³ do zainstalowania;
  <item>     
     ustalaæ w jakiej kolejno¶ci pakiety powinny zostaæ zainstalowane;
  <item>
     automatycznie przeprowadzaæ proces instalacji lub usuniêcia, oraz
  <item>
     prowadziæ u¿ytkownika przez proces wymaganej dla poszczególnych
     pakietów konfiguracji.
</list>

<p><prgn>dselect</prgn> przedstawia u¿ytkownikowi na pocz±tek menu z³o¿one
z 7 opcji/elementów, z których ka¿dy/a reprezentuje inny aspekt funkcjonalno¶ci
programu. U¿ytkownik mo¿e wybraæ jedn± z opcji u¿ywaj±c klawiszy strza³ek
aby pod¶wietliæ wybran± opcjê i zatwierdziæ wybór naciskaj±c klawisz/przycisk
<em>&lt;enter&gt;</em>.

<p>Dalsze zachowanie programu zale¿y od dokonanego wcze¶niej wyboru. Je¿eli 
nie wybrano <tt>Dostêp/Access</tt> ani <tt>Wybór/Select</tt>, wtedy
<prgn>dselect</prgn> po prostu wykona wybrane polecenie: np. je¿eli u¿ytkownik
wybra³ polecenie <tt>Usuwanie/Remove</tt> wtedy dselect przyst±pi
do usuwania wszystkich plików wybranych/zaznaczonych ostatnio 
do usuniêcia przy pomocy polecenia <tt>Wybór/Select</tt>.

<p>Zarówno opcja <tt>Dostêp/Access</tt>, jak i opcja <tt>Wybór/Select</tt>,
prowadz± do dodatkowego menu wyboru. W obydwu przypadkach, ka¿de menu zostaje
wy¶wietlone osobno, na podzielonym ekranie; w górnej czê¶ci ekranu znajduj± siê
opcje wyboru, a w dolnej czê¶ci krótkie opisy ("info") dla ka¿dej z wybranych opcji.

<p>Dostêpna jest tak¿e poszerzona/rozszerzona dokumentacja online, u¿yj
klawisza '?' aby uzyskaæ dostêp do pomocy w dowolnej chwili.

<p>Kolejno¶æ, w jakiej czynno¶ci s± prezentowane w pierwszym menu programu
<prgn>dselect</prgn>, reprezentuje kolejno¶æ w jakiej u¿ytkownik normalnie
dokonuje instalacji pakietów. Jednak¿e mo¿na wybraæ dowoln± pozycjê z menu, 
tak czêsto, jak to konieczne.

<list>
  <item>
     Rozpoczynamy od wybrania <strong>sposobu dostêpu</strong>. 
     (ang. ,,Access Method'').
     Jest to czynno¶æ, dziêki której mo¿na zaplanowaæ dostêp do ¼ród³a pakietów 
     Debiana. Przyk³adowo, niektórzy maj± pakiety na p³ytach CD, a inni 
     pobieraj± je z serwera FTP. Wybrany sposób jest zapamiêtywany tak¿e 
     po wyj¶ciu z programu, wiêc je¶li nie zmieniamy ¼ród³a od poprzedniego 
     razu, nie jest konieczne ponowne wywo³ywanie tej opcji.

  <item>
     Teraz <strong>uaktualnij</strong> (Update) listê dostêpnych 
     pakietów. Aby tego dokonaæ, <prgn>dselect</prgn> odczytuje plik
     ,,Packages.gz'', który powinien znajdowaæ siê w g³ównym katalogu 
     zawieraj±cym przeznaczone do instalacji pakiety Debiana. (Je¿eli 
     brak jest takiego pliku, <prgn>dselect</prgn> utworzy
     go dla Ciebie.
 
  <item>
     <strong>Wybór</strong> (Select) okre¶la pakiety do zainstalowania
     w tym systemie. Po wybraniu tej pozycji menu, u¿ytkownik jest najpierw
     zapoznawany z pe³nym zestawem pomocy (chyba ¿e zastosowano opcjê `--expert' 
     w linii poleceñ). Gdy opuszczamy ekran z pomoc±, pojawia siê ekran umo¿liwiaj±cy 
     wybór pakietów do instalacji lub usuniêcia.
     
     <p>Górna czê¶æ ekranu zawiera przewijan± listê pakietów pouk³adanych
     w grupy zwi±zane ze sob±. Dolna czê¶æ zawiera opis pakietu lub grupy 
     pakietów aktualnie pod¶wietlonych.
     
     <p>Pod¶wietlaj±c nazwê pakietu lub grupê pakietów, wskazujemy stan,
     który mamy zamiar zmieniaæ. Nastêpnie mo¿esz zaznaczyæ pakiet:

    <taglist>
      <tag>do instalacji:
        <item>Dokonuje siê tego przy pomocy klawisza `+'.
      <tag>do usuniêcia:
        <item>Pakiety mog± byæ usuwane dwoma sposobami:
        <list>
          <item>
          usuniêcie (remove): usuwa wiêkszo¶æ plików zwi±zanych z tym pakietem. 
          Pozostawia jednak pliki, okre¶lone jako konfiguracyjne
             (zobacz: <ref id="conffile">) oraz konfiguracjê pakietu
               Dokonuje siê tego klawiszem `-'.
          <item>
          oczyszczenie (purge): usuwa <em>wszystkie</em> pliki wchodz±ce w sk³ad
          tego pakietu. S³u¿y do tego klawisz `_'.
        </list>
     Zauwa¿, ¿e nie jest mo¿liwe usuniêcie grupy ,,Wszystkie pakiety''  
     ("All Packages"). Gdy tego spróbujesz, system zostanie zredukowany 
     do pocz±tkowego stanu po instalacji wersji podstawowej (base system)
      <tag>ustawienie ,,w zawieszeniu'' (,,on hold'')
        <item>
          Dokonuje siê tego klawiszem `=' i oznacza to ,,nie uaktualniaj, 
          nawet je¶li aktualnie zainstalowana wersja nie jest tak ¶wie¿a, 
          jak wersja ze ¼ród³a pakietów, z jakiego korzystasz (jakie zosta³o
          skonfigurowane przy pomocy opcji ,,Sposób dostêpu''), pobrana po 
          wyborze opcji <strong>Uaktualnij</strong> (Update)).
     
          <p>Tak, jak mo¿esz zawiesiæ uaktualnianie wersji danych pakietów, 
          tak mo¿esz anulowaæ zawieszenie poprzez naci¶niêcie `:'. Oznacza to
          zezwolenie na uaktualnianie wersji pakietów, je¶li nowsze s±
          dostêpne. Jest to domy¶lne ustawienie dla pakietu.
    </taglist>

    <p>
     Mo¿esz wybraæ ró¿ne sposoby prezentacji listy pakietów,
     u¿ywaj±c klawisza ,,o'' do prze³±czania pomiêdzy ró¿nymi
     metodami sortowania pakietów. Domy¶lne sortowanie przeprowadzane
     jest wed³ug parametru Priorytet. Wewn±trz tego samego priorytetu, 
     pakiety s± pouk³adane wed³ug katalogów (zwanych te¿ sekcjami) archiwum,
     w których s± przechowywane. W tym trybie, niektóre pakiety z sekcji 
     (powiedzmy) A mog± byæ umieszczane jako pierwsze, nastêpnie niektóre 
     pakiety z sekcji (powiedzmy) B, za¶ po nich znów pakiety z sekcji A, 
     ale posiadaj±ce ni¿szy priorytet.
 
    <p>
     Mo¿esz równie¿ poszerzyæ znaczenie etykiet na górze ekranu,
     wykorzystuj±c klawisz ,,v'' (ang. verbose = rozwlek³y). Ta metoda
     przesuwa du¿± cze¶æ widocznych poprzednio informacji poza praw±
     granicê ekranu. Aby je zobaczyæ, naci¶nij strza³kê w prawo, aby
     powróciæ na lewo, mo¿esz skorzystaæ z klawisza strza³ki w lewo.

    <p>
     Gdy zaznaczysz pakiet do instalacji lub do usuniêcia, przyk³adowo
     <package>foo.deb</package>, i ten pakiet jest powi±zany 
     zale¿no¶ciami z innym pakietem, przyk³adowo <package>blurf.deb</package>, 
     to <prgn>dselect</prgn> wy¶wietli odpowiednie okno, w którym mo¿esz wybraæ
     spo¶ród powi±zanych pakietów, akceptuj±c sugerowan± akcjê (instalowaæ 
     lub nie instalowaæ, oto jest pytanie) lub odrzuciæ je ca³kowicie.
     T± drug± czynno¶æ przeprowadzamy klawiszami Shift+D. Natomiast, aby 
     powróciæ do poprzedniego wyboru, naci¶nij Shift+U. W ka¿dym razie,
     mo¿esz zapisaæ swój wybór i powróciæ do g³ównego ekranu kombinacj± 
     klawiszy Shift+Q.
     
  <item>
     Mo¿na wybraæ menu ,,Instaluj'' (,,Install'') aby rozpakowaæ
     i skonfigurowaæ zaznaczone pakiety lub usun±æ pobrane pliki
     poleceniem ,,Usuñ'' (,,Remove''). Mo¿na tak¿e opu¶ciæ program
     wybieraj±c polecenie ,,Wyjd¼'' (,,Quit'').
</list>

<sect1 id="dpkg-deb">dpkg-deb

<p>Ten program s³u¿y do pracy z plikami-archiwami Debiana (<tt>*.deb</tt>).
Kilka najczêstszych zastosowañ to:
<list>
  <item>
     Poka¿ wszystkie opcje:  <tt>dpkg-deb --help</tt>.

  <item>
     Poka¿ jakie pliki znajduj± siê w podanym archiwum: 
     <tt>dpkg-deb --contents foo_VVV-RRR.deb</tt>)

  <item>
     Wypakuj pliki zawarte w podanym archiwum do zadanego katalogu:
     <tt>dpkg-deb --extract foo_VVV-RRR.deb KATALOG</tt>
     Polecenie wypakuje pliki z <tt>foo_VVV-RRR.deb</tt> do katalogu
     <tt>KATALOG/</tt>. To wygodny sposób na zbadanie zawarto¶ci 
     paczki bez jej instalacji do g³ównego systemu plików.
</list>

<p>
     Zauwa¿, ¿e dowolne pakiety, które by³y po prostu rozpakowane 
     przy pomocy <tt>dpkg-deb -extract</tt> nie zosta³y poprawnie
     zainstalowane. W celu instalacji nale¿y u¿yæ polecenia <tt>dpkg --install</tt>. 
     
<p>
     Wiêcej informacji na stronach podrêcznika systemowego: <manref name="dpkg-deb" section="1">.

<sect1 id="apt-get">apt-get

<p><prgn>apt-get</prgn> umo¿liwia prost± instalacjê pakietów z linii poleceñ.
W przeciwieñstwie do <prgn>dpkg</prgn>, <prgn>apt-get</prgn> nie obs³uguje nazw
plików .deb, ale pracuje w oparciu o w³a¶ciwe nazwy pakietów. Korzysta ze ¼róde³ 
pakietów wymienionych w <file>/etc/apt/sources.list</file>.

<p>Je¶li potrzebujesz wiêcej informacji, zainstaluj pakiet 
<package>apt</package> i przeczytaj strony podrêcznika systemowego:
<manref name="apt-get" section="8">, <manref name="sources.list" section="5">
oraz opis <file>/usr/share/doc/apt/guide.html/index.html</file>.

<sect1 id="dpkg-split">dpkg-split

<p>Ten program dzieli du¿e pakiety na ma³e pliki (na przyk³ad, w 
celu umieszczenia na dyskietkach -- kto teraz u¿ywa dyskietek :-) ) 
oraz scala takie podzielone pliki w jeden.

Mo¿e on byæ jedynie wykorzystany w systemie opartym o Debiana (to jest
takim, który zawiera pakiet <package>dpkg</package>), poniewa¿ uruchamia
on inny program, <tt>dpkg-deb</tt>, do rozbioru pliku pakietu Debiana na
jego rekordy sk³adowe.

<p>Dla przyk³adu, chc±c podzieliæ du¿y plik .deb na N kawa³ków:
<list>
  <item>
     Wykonaj polecenie: <tt>dpkg-split --split foo.deb</tt>. 
     Wyprodukuje ono N plików o przybli¿onej wielko¶ci 460 KBytes 
     w aktualnym katalogu.
  <item>
     Skopiuj te N plików na dyskietki. I id¼ do innego Debiana, 
     albo pochod¼ woko³o sto³u i udawaj, ¿e jeste¶ przy innym komputerze ;-).
  <item>
     Skopiuj zawarto¶æ dyskietek na twardy dysk na innej maszynie
  <item>
     Po³±cz kawa³ki u¿ywaj±c polecenia <tt>dpkg-split --join "foo*"</tt>.
</list>

<sect id="updaterunning">Debian twierdzi, ¿e mo¿na uaktualniaæ uruchomiony program; 
Jak to mo¿liwe?

<p>J±dro (system plików) w Debianie umo¿liwia podmianê plików, nawet je¶li s± u¿ywane.

<p>Dostarczamy tak¿e program o nazwie <prgn>start-stop-daemon</prgn>,
który jest u¿ywany do uruchamiania demonów w czasie startu systemu oraz do 
ich zatrzymywania, podczas gdy poziom startu (runlevel) jest zmieniany. 
Ten sam program jest u¿ywany przez skrypty instalacyjne podczas instalacji
nowego pakietu zawieraj±cego demona. 

<sect id="whatpackages">Jak mogê sprawdziæ, które pakiety s± ju¿ zainstalowane w Debianie?

<p>Aby poznaæ stan wszystkich pakietów zainstalowanych w systemie, wykonaj polecenie:
  <example>dpkg --list</example>

Wypisze ono jednolinijkowe podsumowanie dla ka¿dego pakietu, zawieraj±ce 
dwuznakowe oznaczenie statusu (wyja¶nione w nag³ówku), nazwê pakietu, 
wersjê, która jest <em>zainstalowana</em>, oraz krótki opis.

<p>Aby poznaæ stan pakietów, których nazwy zawieraj± okre¶lony ci±g znaków, 
mo¿esz wykonaæ polecenie (to polecenie pokazuje pakiety z nazwami rozpoczynaj±cymi
siê od ,,foo''):
  <example>dpkg --list 'foo*'</example>

<p>Aby otrzymaæ obszerniejsze informacje na temat okre¶lonego pakietu, wykonaj:
  <example>dpkg --status nazwa_pakietu</example>

<sect id="filesearch">Jak mam stwierdziæ, który pakiet tworzy okre¶lony plik?
<p>
     Aby zidentyfikowaæ pakiet odpowiedzialny za pojawienie siê
     pliku <tt>nazwa_pliku</tt> wykonaj:

<list>
  <item><tt>dpkg --search nazwa_pliku</tt>
    <p>
     To polecenie spowoduje wyszukanie pliku o nazwie <tt>nazwa_pliku</tt>
     w zainstalowanych paczkach. (Jest to ekwiwalent poszukiwania wszystkich 
     plików maj±cych rozszerzenie <tt>.list</tt> i znajduj±cych siê w katalogu
     <tt>/var/lib/dpkg/info/</tt>, a nastêpnie wypisywania nazw wszystkich 
     pakietów zawieraj±cych te pliki i odwrotnie).

  <item><tt>zgrep foo Contents-ARCH.gz</tt>
    <p> 
     To polecenie poszukuje plików zawieraj±cych tekst <tt>foo</tt>
     w ich pe³nej ¶cie¿ce dostêpu. Pliki <tt>Contents-ARCH.gz</tt>
     (gdzie ARCH oznacza w³a¶ciw± architekturê), znajduj± siê w
     g³ównym katalogu z pakietami (main, non-free, contrib), na serwerze 
     FTP Debiana.  

     Pliki <tt>Contents</tt> odnosz± siê tylko do pakietów z drzewa
     pakietów, do którego nale¿±. Z tego powodu u¿ytkownik mo¿e bêdzie musia³
     przeszukaæ wiêcej ni¿ jeden plik <tt>Contents</tt>, aby znale¼æ
     pakiet zawieraj±cy plik <tt>foo</tt>.

    <p>
     Ta metoda ma t± przewagê nad <tt>dpkg --search</tt>, ¿e znajduje
     dowolne pliki w dowolnych pakietach, nie tylko aktualnie zainstalowane
     w systemie.
</list>
